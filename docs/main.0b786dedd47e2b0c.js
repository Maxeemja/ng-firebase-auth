"use strict";var gj=Object.defineProperty,mj=Object.defineProperties,_j=Object.getOwnPropertyDescriptors,JP=Object.getOwnPropertySymbols,yj=Object.prototype.hasOwnProperty,vj=Object.prototype.propertyIsEnumerable,eO=(nt,Ce,F)=>Ce in nt?gj(nt,Ce,{enumerable:!0,configurable:!0,writable:!0,value:F}):nt[Ce]=F,tO=(nt,Ce)=>{for(var F in Ce||(Ce={}))yj.call(Ce,F)&&eO(nt,F,Ce[F]);if(JP)for(var F of JP(Ce))vj.call(Ce,F)&&eO(nt,F,Ce[F]);return nt},nO=(nt,Ce)=>mj(nt,_j(Ce));(self.webpackChunkng_firebase_auth=self.webpackChunkng_firebase_auth||[]).push([[179],{2011:(nt,Ce,F)=>{F.d(Ce,{Dh:()=>le,GT:()=>ye,cc:()=>Re,hO:()=>je,on:()=>z,pX:()=>ce,xv:()=>ve});var _=F(5e3),G=F(127),P=F(5813);nt=F.hmd(nt);const oe=["ngOnDestroy"],ce=(De,qe,Ge,Pe={})=>new Proxy(De,{get:(Ae,Te)=>Ge.runOutsideAngular(()=>{var We;if(De[Te])return(null===(We=null==Pe?void 0:Pe.spy)||void 0===We?void 0:We.get)&&Pe.spy.get(Te,De[Te]),De[Te];if(oe.indexOf(Te)>-1)return()=>{};const ne=qe.toPromise().then(pe=>{const Ee=pe&&pe[Te];return"function"==typeof Ee?Ee.bind(pe):Ee&&Ee.then?Ee.then(Q=>Ge.run(()=>Q)):Ge.run(()=>Ee)});return new Proxy(()=>{},{get:(pe,Ee)=>ne[Ee],apply:(pe,Ee,Q)=>ne.then(te=>{var ie;const we=te&&te(...Q);return(null===(ie=null==Pe?void 0:Pe.spy)||void 0===ie?void 0:ie.apply)&&Pe.spy.apply(Te,Q,we),we})})})}),ye=(De,qe)=>{qe.forEach(Ge=>{Object.getOwnPropertyNames(Ge.prototype||Ge).forEach(Pe=>{Object.defineProperty(De.prototype,Pe,Object.getOwnPropertyDescriptor(Ge.prototype||Ge,Pe))})})};class ge{constructor(qe){return qe}}const le=new _.OlP("angularfire2.app.options"),ve=new _.OlP("angularfire2.app.name");function z(De,qe,Ge){const Ae="object"==typeof Ge&&Ge||{};Ae.name=Ae.name||"string"==typeof Ge&&Ge||"[DEFAULT]";const We=G.Z.apps.filter(ne=>ne&&ne.name===Ae.name)[0]||qe.runOutsideAngular(()=>G.Z.initializeApp(De,Ae));try{JSON.stringify(De)!==JSON.stringify(We.options)&&q("error",`${We.name} Firebase App already initialized with different options${nt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(ne){}return new ge(We)}const q=(De,...qe)=>{(0,_.X6Q)()&&"undefined"!=typeof console&&console[De](...qe)},re={provide:ge,useFactory:z,deps:[le,_.R0b,[new _.FiY,ve]]};let je=(()=>{class De{constructor(Ge){G.Z.registerVersion("angularfire",P.q4.full,"core"),G.Z.registerVersion("angularfire",P.q4.full,"app-compat"),G.Z.registerVersion("angular",_.q4F.full,Ge.toString())}static initializeApp(Ge,Pe){return{ngModule:De,providers:[{provide:le,useValue:Ge},{provide:ve,useValue:Pe}]}}}return De.\u0275fac=function(Ge){return new(Ge||De)(_.LFG(_.Lbi))},De.\u0275mod=_.oAB({type:De}),De.\u0275inj=_.cJS({providers:[re]}),De})();function Re(De,qe,Ge,Pe,Ae){const[,Te,We]=globalThis.\u0275AngularfireInstanceCache.find(ne=>ne[0]===De)||[];if(Te)return function Ve(De,qe){try{return De.toString()===qe.toString()}catch(Ge){return De===qe}}(Ae,We)||(_e("error",`${qe} was already initialized on the ${Ge} Firebase App with different settings.${He?" You may need to reload as Firebase is not HMR aware.":""}`),_e("warn",{is:Ae,was:We})),Te;{const ne=Pe();return globalThis.\u0275AngularfireInstanceCache.push([De,ne,Ae]),ne}}const He=!!nt.hot,_e=(De,...qe)=>{(0,_.X6Q)()&&"undefined"!=typeof console&&console[De](...qe)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(nt,Ce,F)=>{F.d(Ce,{q4:()=>qt,iC:()=>$u,fc:()=>Wl,HU:()=>wd,vb:()=>sg,JM:()=>Bu});var _=F(5e3),G=F(5867),P=F(5861),oe=F(9681),ce=F(2090),ye=F(4859),ge=F(1877),le=F(8766);const ve="@firebase/installations",z="0.5.16",re=`w:${z}`,je="FIS_v2",qe=new ce.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Ge(b){return b instanceof ce.ZR&&b.code.includes("request-failed")}function Pe({projectId:b}){return`https://firebaseinstallations.googleapis.com/v1/projects/${b}/installations`}function Ae(b){return{token:b.token,requestStatus:2,expiresIn:te(b.expiresIn),creationTime:Date.now()}}function Te(b,D){return We.apply(this,arguments)}function We(){return(We=(0,P.Z)(function*(b,D){const j=(yield D.json()).error;return qe.create("request-failed",{requestName:b,serverCode:j.code,serverMessage:j.message,serverStatus:j.status})})).apply(this,arguments)}function ne({apiKey:b}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":b})}function pe(b,{refreshToken:D}){const R=ne(b);return R.append("Authorization",function ie(b){return`${je} ${b}`}(D)),R}function Ee(b){return Q.apply(this,arguments)}function Q(){return(Q=(0,P.Z)(function*(b){const D=yield b();return D.status>=500&&D.status<600?b():D})).apply(this,arguments)}function te(b){return Number(b.replace("s","000"))}function we(b,D){return de.apply(this,arguments)}function de(){return(de=(0,P.Z)(function*({appConfig:b,heartbeatServiceProvider:D},{fid:R}){const j=Pe(b),X=ne(b),se=D.getImmediate({optional:!0});if(se){const St=yield se.getHeartbeatsHeader();St&&X.append("x-firebase-client",St)}const ze={method:"POST",headers:X,body:JSON.stringify({fid:R,authVersion:je,appId:b.appId,sdkVersion:re})},yt=yield Ee(()=>fetch(j,ze));if(yt.ok){const St=yield yt.json();return{fid:St.fid||R,registrationStatus:2,refreshToken:St.refreshToken,authToken:Ae(St.authToken)}}throw yield Te("Create Installation",yt)})).apply(this,arguments)}function Fe(b){return new Promise(D=>{setTimeout(D,b)})}const en=/^[cdef][\w-]{21}$/;function Ze(){try{const b=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(b),b[0]=112+b[0]%16;const R=function ln(b){return function pt(b){return btoa(String.fromCharCode(...b)).replace(/\+/g,"-").replace(/\//g,"_")}(b).substr(0,22)}(b);return en.test(R)?R:""}catch(b){return""}}function Tn(b){return`${b.appName}!${b.appId}`}const cn=new Map;function tn(b,D){const R=Tn(b);Nn(R,D),function Qr(b,D){const R=function Fn(){return!ai&&"BroadcastChannel"in self&&(ai=new BroadcastChannel("[Firebase] FID Change"),ai.onmessage=b=>{Nn(b.data.key,b.data.fid)}),ai}();R&&R.postMessage({key:b,fid:D}),function ns(){0===cn.size&&ai&&(ai.close(),ai=null)}()}(R,D)}function Nn(b,D){const R=cn.get(b);if(R)for(const j of R)j(D)}let ai=null;const Hn="firebase-installations-store";let rs=null;function wt(){return rs||(rs=(0,le.X3)("firebase-installations-database",1,{upgrade:(b,D)=>{0===D&&b.createObjectStore(Hn)}})),rs}function kr(b,D){return wn.apply(this,arguments)}function wn(){return(wn=(0,P.Z)(function*(b,D){const R=Tn(b),X=(yield wt()).transaction(Hn,"readwrite"),se=X.objectStore(Hn),Me=yield se.get(R);return yield se.put(D,R),yield X.done,(!Me||Me.fid!==D.fid)&&tn(b,D.fid),D})).apply(this,arguments)}function dn(b){return Nr.apply(this,arguments)}function Nr(){return(Nr=(0,P.Z)(function*(b){const D=Tn(b),j=(yield wt()).transaction(Hn,"readwrite");yield j.objectStore(Hn).delete(D),yield j.done})).apply(this,arguments)}function Vr(b,D){return Br.apply(this,arguments)}function Br(){return(Br=(0,P.Z)(function*(b,D){const R=Tn(b),X=(yield wt()).transaction(Hn,"readwrite"),se=X.objectStore(Hn),Me=yield se.get(R),ze=D(Me);return void 0===ze?yield se.delete(R):yield se.put(ze,R),yield X.done,ze&&(!Me||Me.fid!==ze.fid)&&tn(b,ze.fid),ze})).apply(this,arguments)}function Dn(b){return pr.apply(this,arguments)}function pr(){return(pr=(0,P.Z)(function*(b){let D;const R=yield Vr(b.appConfig,j=>{const X=vs(j),se=Kt(b,X);return D=se.registrationPromise,se.installationEntry});return""===R.fid?{installationEntry:yield D}:{installationEntry:R,registrationPromise:D}})).apply(this,arguments)}function vs(b){return Fi(b||{fid:Ze(),registrationStatus:0})}function Kt(b,D){if(0===D.registrationStatus){if(!navigator.onLine)return{installationEntry:D,registrationPromise:Promise.reject(qe.create("app-offline"))};const R={fid:D.fid,registrationStatus:1,registrationTime:Date.now()},j=function gt(b,D){return rt.apply(this,arguments)}(b,R);return{installationEntry:R,registrationPromise:j}}return 1===D.registrationStatus?{installationEntry:D,registrationPromise:Ti(b)}:{installationEntry:D}}function rt(){return(rt=(0,P.Z)(function*(b,D){try{const R=yield we(b,D);return kr(b.appConfig,R)}catch(R){throw Ge(R)&&409===R.customData.serverCode?yield dn(b.appConfig):yield kr(b.appConfig,{fid:D.fid,registrationStatus:0}),R}})).apply(this,arguments)}function Ti(b){return jr.apply(this,arguments)}function jr(){return(jr=(0,P.Z)(function*(b){let D=yield Zt(b.appConfig);for(;1===D.registrationStatus;)yield Fe(100),D=yield Zt(b.appConfig);if(0===D.registrationStatus){const{installationEntry:R,registrationPromise:j}=yield Dn(b);return j||R}return D})).apply(this,arguments)}function Zt(b){return Vr(b,D=>{if(!D)throw qe.create("installation-not-found");return Fi(D)})}function Fi(b){return function Gn(b){return 1===b.registrationStatus&&b.registrationTime+1e4<Date.now()}(b)?{fid:b.fid,registrationStatus:0}:b}function pn(b,D){return _t.apply(this,arguments)}function _t(){return(_t=(0,P.Z)(function*({appConfig:b,heartbeatServiceProvider:D},R){const j=ui(b,R),X=pe(b,R),se=D.getImmediate({optional:!0});if(se){const St=yield se.getHeartbeatsHeader();St&&X.append("x-firebase-client",St)}const ze={method:"POST",headers:X,body:JSON.stringify({installation:{sdkVersion:re,appId:b.appId}})},yt=yield Ee(()=>fetch(j,ze));if(yt.ok)return Ae(yield yt.json());throw yield Te("Generate Auth Token",yt)})).apply(this,arguments)}function ui(b,{fid:D}){return`${Pe(b)}/${D}/authTokens:generate`}function Gt(b){return ar.apply(this,arguments)}function ar(){return(ar=(0,P.Z)(function*(b,D=!1){let R;const j=yield Vr(b.appConfig,se=>{if(!nn(se))throw qe.create("not-registered");const Me=se.authToken;if(!D&&W(Me))return se;if(1===Me.requestStatus)return R=Xe(b,D),se;{if(!navigator.onLine)throw qe.create("app-offline");const ze=Y(se);return R=It(b,ze),ze}});return R?yield R:j.authToken})).apply(this,arguments)}function Xe(b,D){return Se.apply(this,arguments)}function Se(){return(Se=(0,P.Z)(function*(b,D){let R=yield Ke(b.appConfig);for(;1===R.authToken.requestStatus;)yield Fe(100),R=yield Ke(b.appConfig);const j=R.authToken;return 0===j.requestStatus?Gt(b,D):j})).apply(this,arguments)}function Ke(b){return Vr(b,D=>{if(!nn(D))throw qe.create("not-registered");return function $(b){return 1===b.requestStatus&&b.requestTime+1e4<Date.now()}(D.authToken)?Object.assign(Object.assign({},D),{authToken:{requestStatus:0}}):D})}function It(b,D){return Et.apply(this,arguments)}function Et(){return(Et=(0,P.Z)(function*(b,D){try{const R=yield pn(b,D),j=Object.assign(Object.assign({},D),{authToken:R});return yield kr(b.appConfig,j),R}catch(R){if(!Ge(R)||401!==R.customData.serverCode&&404!==R.customData.serverCode){const j=Object.assign(Object.assign({},D),{authToken:{requestStatus:0}});yield kr(b.appConfig,j)}else yield dn(b.appConfig);throw R}})).apply(this,arguments)}function nn(b){return void 0!==b&&2===b.registrationStatus}function W(b){return 2===b.requestStatus&&!function H(b){const D=Date.now();return D<b.creationTime||b.creationTime+b.expiresIn<D+36e5}(b)}function Y(b){const D={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},b),{authToken:D})}function B(){return(B=(0,P.Z)(function*(b){const D=b,{installationEntry:R,registrationPromise:j}=yield Dn(D);return j?j.catch(console.error):Gt(D).catch(console.error),R.fid})).apply(this,arguments)}function Le(){return(Le=(0,P.Z)(function*(b,D=!1){const R=b;return yield et(R),(yield Gt(R,D)).token})).apply(this,arguments)}function et(b){return ut.apply(this,arguments)}function ut(){return(ut=(0,P.Z)(function*(b){const{registrationPromise:D}=yield Dn(b);D&&(yield D)})).apply(this,arguments)}function Ca(b){return qe.create("missing-app-config-values",{valueName:b})}const li="installations",jt=b=>{const D=b.getProvider("app").getImmediate(),R=function vr(b){if(!b||!b.options)throw Ca("App Configuration");if(!b.name)throw Ca("App Name");const D=["projectId","apiKey","appId"];for(const R of D)if(!b.options[R])throw Ca(R);return{appName:b.name,projectId:b.options.projectId,apiKey:b.options.apiKey,appId:b.options.appId}}(D);return{app:D,appConfig:R,heartbeatServiceProvider:(0,oe._getProvider)(D,"heartbeat"),_delete:()=>Promise.resolve()}},_n=b=>{const D=b.getProvider("app").getImmediate(),R=(0,oe._getProvider)(D,li).getImmediate();return{getId:()=>function N(b){return B.apply(this,arguments)}(R),getToken:X=>function ae(b){return Le.apply(this,arguments)}(R,X)}};(function Xr(){(0,oe._registerComponent)(new ye.wA(li,jt,"PUBLIC")),(0,oe._registerComponent)(new ye.wA("installations-internal",_n,"PRIVATE"))})(),(0,oe.registerVersion)(ve,z),(0,oe.registerVersion)(ve,z,"esm2017");const ws="@firebase/remote-config",Wn=new ce.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Wc{constructor(D,R,j,X){this.client=D,this.storage=R,this.storageCache=j,this.logger=X}isCachedDataFresh(D,R){if(!R)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const j=Date.now()-R,X=j<=D;return this.logger.debug(`Config fetch cache check. Cache age millis: ${j}. Cache max age millis (minimumFetchIntervalMillis setting): ${D}. Is cache hit: ${X}.`),X}fetch(D){var R=this;return(0,P.Z)(function*(){const[j,X]=yield Promise.all([R.storage.getLastSuccessfulFetchTimestampMillis(),R.storage.getLastSuccessfulFetchResponse()]);if(X&&R.isCachedDataFresh(D.cacheMaxAgeMillis,j))return X;D.eTag=X&&X.eTag;const se=yield R.client.fetch(D),Me=[R.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===se.status&&Me.push(R.storage.setLastSuccessfulFetchResponse(se)),yield Promise.all(Me),se})()}}function bu(b=navigator){return b.languages&&b.languages[0]||b.language}class ur{constructor(D,R,j,X,se,Me){this.firebaseInstallations=D,this.sdkVersion=R,this.namespace=j,this.projectId=X,this.apiKey=se,this.appId=Me}fetch(D){var R=this;return(0,P.Z)(function*(){var j,X,se;const[Me,ze]=yield Promise.all([R.firebaseInstallations.getId(),R.firebaseInstallations.getToken()]),St=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${R.projectId}/namespaces/${R.namespace}:fetch?key=${R.apiKey}`,kt={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":D.eTag||"*"},dt={sdk_version:R.sdkVersion,app_instance_id:Me,app_instance_id_token:ze,app_id:R.appId,language_code:bu()},Tr={method:"POST",headers:kt,body:JSON.stringify(dt)},tr=fetch(St,Tr),ro=new Promise((ps,Gi)=>{D.signal.addEventListener(()=>{const so=new Error("The operation was aborted.");so.name="AbortError",Gi(so)})});let io;try{yield Promise.race([tr,ro]),io=yield tr}catch(ps){let Gi="fetch-client-network";throw"AbortError"===(null===(j=ps)||void 0===j?void 0:j.name)&&(Gi="fetch-timeout"),Wn.create(Gi,{originalErrorMessage:null===(X=ps)||void 0===X?void 0:X.message})}let ks=io.status;const za=io.headers.get("ETag")||void 0;let ca,Ka;if(200===io.status){let ps;try{ps=yield io.json()}catch(Gi){throw Wn.create("fetch-client-parse",{originalErrorMessage:null===(se=Gi)||void 0===se?void 0:se.message})}ca=ps.entries,Ka=ps.state}if("INSTANCE_STATE_UNSPECIFIED"===Ka?ks=500:"NO_CHANGE"===Ka?ks=304:("NO_TEMPLATE"===Ka||"EMPTY_CONFIG"===Ka)&&(ca={}),304!==ks&&200!==ks)throw Wn.create("fetch-status",{httpStatus:ks});return{status:ks,eTag:za,config:ca}})()}}class Is{constructor(D,R){this.client=D,this.storage=R}fetch(D){var R=this;return(0,P.Z)(function*(){const j=(yield R.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return R.attemptFetch(D,j)})()}attemptFetch(D,{throttleEndTimeMillis:R,backoffCount:j}){var X=this;return(0,P.Z)(function*(){yield function qc(b,D){return new Promise((R,j)=>{const X=Math.max(D-Date.now(),0),se=setTimeout(R,X);b.addEventListener(()=>{clearTimeout(se),j(Wn.create("fetch-throttle",{throttleEndTimeMillis:D}))})})}(D.signal,R);try{const se=yield X.client.fetch(D);return yield X.storage.deleteThrottleMetadata(),se}catch(se){if(!function qp(b){if(!(b instanceof ce.ZR&&b.customData))return!1;const D=Number(b.customData.httpStatus);return 429===D||500===D||503===D||504===D}(se))throw se;const Me={throttleEndTimeMillis:Date.now()+(0,ce.$s)(j),backoffCount:j+1};return yield X.storage.setThrottleMetadata(Me),X.attemptFetch(D,Me)}})()}}class Kp{constructor(D,R,j,X,se){this.app=D,this._client=R,this._storageCache=j,this._storage=X,this._logger=se,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Ta(b,D){var R;const j=b.target.error||void 0;return Wn.create(D,{originalErrorMessage:j&&(null===(R=j)||void 0===R?void 0:R.message)})}const Qo="app_namespace_store";class Zc{constructor(D,R,j,X=function Yp(){return new Promise((b,D)=>{var R;try{const j=indexedDB.open("firebase_remote_config",1);j.onerror=X=>{D(Ta(X,"storage-open"))},j.onsuccess=X=>{b(X.target.result)},j.onupgradeneeded=X=>{0===X.oldVersion&&X.target.result.createObjectStore(Qo,{keyPath:"compositeKey"})}}catch(j){D(Wn.create("storage-open",{originalErrorMessage:null===(R=j)||void 0===R?void 0:R.message}))}})}()){this.appId=D,this.appName=R,this.namespace=j,this.openDbPromise=X}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(D){return this.set("last_fetch_status",D)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(D){return this.set("last_successful_fetch_timestamp_millis",D)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(D){return this.set("last_successful_fetch_response",D)}getActiveConfig(){return this.get("active_config")}setActiveConfig(D){return this.set("active_config",D)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(D){return this.set("active_config_etag",D)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(D){return this.set("throttle_metadata",D)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(D){var R=this;return(0,P.Z)(function*(){const j=yield R.openDbPromise;return new Promise((X,se)=>{var Me;const yt=j.transaction([Qo],"readonly").objectStore(Qo),St=R.createCompositeKey(D);try{const kt=yt.get(St);kt.onerror=dt=>{se(Ta(dt,"storage-get"))},kt.onsuccess=dt=>{const Tr=dt.target.result;X(Tr?Tr.value:void 0)}}catch(kt){se(Wn.create("storage-get",{originalErrorMessage:null===(Me=kt)||void 0===Me?void 0:Me.message}))}})})()}set(D,R){var j=this;return(0,P.Z)(function*(){const X=yield j.openDbPromise;return new Promise((se,Me)=>{var ze;const St=X.transaction([Qo],"readwrite").objectStore(Qo),kt=j.createCompositeKey(D);try{const dt=St.put({compositeKey:kt,value:R});dt.onerror=Tr=>{Me(Ta(Tr,"storage-set"))},dt.onsuccess=()=>{se()}}catch(dt){Me(Wn.create("storage-set",{originalErrorMessage:null===(ze=dt)||void 0===ze?void 0:ze.message}))}})})()}delete(D){var R=this;return(0,P.Z)(function*(){const j=yield R.openDbPromise;return new Promise((X,se)=>{var Me;const yt=j.transaction([Qo],"readwrite").objectStore(Qo),St=R.createCompositeKey(D);try{const kt=yt.delete(St);kt.onerror=dt=>{se(Ta(dt,"storage-delete"))},kt.onsuccess=()=>{X()}}catch(kt){se(Wn.create("storage-delete",{originalErrorMessage:null===(Me=kt)||void 0===Me?void 0:Me.message}))}})})()}createCompositeKey(D){return[this.appId,this.appName,this.namespace,D].join()}}class Xo{constructor(D){this.storage=D}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var D=this;return(0,P.Z)(function*(){const R=D.storage.getLastFetchStatus(),j=D.storage.getLastSuccessfulFetchTimestampMillis(),X=D.storage.getActiveConfig(),se=yield R;se&&(D.lastFetchStatus=se);const Me=yield j;Me&&(D.lastSuccessfulFetchTimestampMillis=Me);const ze=yield X;ze&&(D.activeConfig=ze)})()}setLastFetchStatus(D){return this.lastFetchStatus=D,this.storage.setLastFetchStatus(D)}setLastSuccessfulFetchTimestampMillis(D){return this.lastSuccessfulFetchTimestampMillis=D,this.storage.setLastSuccessfulFetchTimestampMillis(D)}setActiveConfig(D){return this.activeConfig=D,this.storage.setActiveConfig(D)}}function P_(){return Da.apply(this,arguments)}function Da(){return(Da=(0,P.Z)(function*(){if(!(0,ce.hl)())return!1;try{return yield(0,ce.eu)()}catch(b){return!1}})).apply(this,arguments)}!function Qp(){(0,oe._registerComponent)(new ye.wA("remote-config",function b(D,{instanceIdentifier:R}){const j=D.getProvider("app").getImmediate(),X=D.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw Wn.create("registration-window");if(!(0,ce.hl)())throw Wn.create("indexed-db-unavailable");const{projectId:se,apiKey:Me,appId:ze}=j.options;if(!se)throw Wn.create("registration-project-id");if(!Me)throw Wn.create("registration-api-key");if(!ze)throw Wn.create("registration-app-id");const yt=new Zc(ze,j.name,R=R||"firebase"),St=new Xo(yt),kt=new ge.Yd(ws);kt.logLevel=ge.in.ERROR;const dt=new ur(X,oe.SDK_VERSION,R,se,Me,ze),Tr=new Is(dt,yt),tr=new Wc(Tr,yt,St,kt),ro=new Kp(j,tr,St,yt,kt);return function gn(b){const D=(0,ce.m9)(b);D._initializePromise||(D._initializePromise=D._storageCache.loadFromStorage().then(()=>{D._isInitializationComplete=!0}))}(ro),ro},"PUBLIC").setMultipleInstances(!0)),(0,oe.registerVersion)(ws,"0.3.15"),(0,oe.registerVersion)(ws,"0.3.15","esm2017")}();const zs="/firebase-messaging-sw.js",Ai="/firebase-cloud-messaging-push-scope",Jo="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Aa="google.c.a.c_id",Hh="google.c.a.c_l",Xp="google.c.a.ts",_o="google.c.a.e";var Cs=(()=>{return(b=Cs||(Cs={})).PUSH_RECEIVED="push-received",b.NOTIFICATION_CLICKED="notification-clicked",Cs;var b})();function Vi(b){const D=new Uint8Array(b);return btoa(String.fromCharCode(...D)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Qc(b){const R=(b+"=".repeat((4-b.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),j=atob(R),X=new Uint8Array(j.length);for(let se=0;se<j.length;++se)X[se]=j.charCodeAt(se);return X}const Gr="fcm_token_details_db",Xc="fcm_token_object_Store";function Jc(b){return Cu.apply(this,arguments)}function Cu(){return Cu=(0,P.Z)(function*(b){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(se=>se.name).includes(Gr))return null;let D=null;return(yield(0,le.X3)(Gr,5,{upgrade:(j=(0,P.Z)(function*(X,se,Me,ze){var yt;if(se<2||!X.objectStoreNames.contains(Xc))return;const St=ze.objectStore(Xc),kt=yield St.index("fcmSenderId").get(b);if(yield St.clear(),kt)if(2===se){const dt=kt;if(!dt.auth||!dt.p256dh||!dt.endpoint)return;D={token:dt.fcmToken,createTime:null!==(yt=dt.createTime)&&void 0!==yt?yt:Date.now(),subscriptionOptions:{auth:dt.auth,p256dh:dt.p256dh,endpoint:dt.endpoint,swScope:dt.swScope,vapidKey:"string"==typeof dt.vapidKey?dt.vapidKey:Vi(dt.vapidKey)}}}else if(3===se){const dt=kt;D={token:dt.fcmToken,createTime:dt.createTime,subscriptionOptions:{auth:Vi(dt.auth),p256dh:Vi(dt.p256dh),endpoint:dt.endpoint,swScope:dt.swScope,vapidKey:Vi(dt.vapidKey)}}}else if(4===se){const dt=kt;D={token:dt.fcmToken,createTime:dt.createTime,subscriptionOptions:{auth:Vi(dt.auth),p256dh:Vi(dt.p256dh),endpoint:dt.endpoint,swScope:dt.swScope,vapidKey:Vi(dt.vapidKey)}}}}),function(se,Me,ze,yt){return j.apply(this,arguments)})})).close(),yield(0,le.Lj)(Gr),yield(0,le.Lj)("fcm_vapid_details_db"),yield(0,le.Lj)("undefined"),Tu(D)?D:null;var j}),Cu.apply(this,arguments)}function Tu(b){if(!b||!b.subscriptionOptions)return!1;const{subscriptionOptions:D}=b;return"number"==typeof b.createTime&&b.createTime>0&&"string"==typeof b.token&&b.token.length>0&&"string"==typeof D.auth&&D.auth.length>0&&"string"==typeof D.p256dh&&D.p256dh.length>0&&"string"==typeof D.endpoint&&D.endpoint.length>0&&"string"==typeof D.swScope&&D.swScope.length>0&&"string"==typeof D.vapidKey&&D.vapidKey.length>0}const Ts="firebase-messaging-store";let Ml=null;function En(){return Ml||(Ml=(0,le.X3)("firebase-messaging-database",1,{upgrade:(b,D)=>{0===D&&b.createObjectStore(Ts)}})),Ml}function xa(b){return Ks.apply(this,arguments)}function Ks(){return(Ks=(0,P.Z)(function*(b){const D=wr(b),j=yield(yield En()).transaction(Ts).objectStore(Ts).get(D);if(j)return j;{const X=yield Jc(b.appConfig.senderId);if(X)return yield mn(b,X),X}})).apply(this,arguments)}function mn(b,D){return Su.apply(this,arguments)}function Su(){return(Su=(0,P.Z)(function*(b,D){const R=wr(b),X=(yield En()).transaction(Ts,"readwrite");return yield X.objectStore(Ts).put(D,R),yield X.done,D})).apply(this,arguments)}function Ra(b){return yo.apply(this,arguments)}function yo(){return(yo=(0,P.Z)(function*(b){const D=wr(b),j=(yield En()).transaction(Ts,"readwrite");yield j.objectStore(Ts).delete(D),yield j.done})).apply(this,arguments)}function wr({appConfig:b}){return b.appId}const qn=new ce.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Ds(b,D){return Er.apply(this,arguments)}function Er(){return(Er=(0,P.Z)(function*(b,D){var R;const j=yield Ys(b),X=vo(D),se={method:"POST",headers:j,body:JSON.stringify(X)};let Me;try{Me=yield(yield fetch(Zs(b.appConfig),se)).json()}catch(ze){throw qn.create("token-subscribe-failed",{errorInfo:null===(R=ze)||void 0===R?void 0:R.toString()})}if(Me.error)throw qn.create("token-subscribe-failed",{errorInfo:Me.error.message});if(!Me.token)throw qn.create("token-subscribe-no-token");return Me.token})).apply(this,arguments)}function ea(b,D){return ss.apply(this,arguments)}function ss(){return(ss=(0,P.Z)(function*(b,D){var R;const j=yield Ys(b),X=vo(D.subscriptionOptions),se={method:"PATCH",headers:j,body:JSON.stringify(X)};let Me;try{Me=yield(yield fetch(`${Zs(b.appConfig)}/${D.token}`,se)).json()}catch(ze){throw qn.create("token-update-failed",{errorInfo:null===(R=ze)||void 0===R?void 0:R.toString()})}if(Me.error)throw qn.create("token-update-failed",{errorInfo:Me.error.message});if(!Me.token)throw qn.create("token-update-no-token");return Me.token})).apply(this,arguments)}function kl(b,D){return ci.apply(this,arguments)}function ci(){return(ci=(0,P.Z)(function*(b,D){var R;const X={method:"DELETE",headers:yield Ys(b)};try{const Me=yield(yield fetch(`${Zs(b.appConfig)}/${D}`,X)).json();if(Me.error)throw qn.create("token-unsubscribe-failed",{errorInfo:Me.error.message})}catch(se){throw qn.create("token-unsubscribe-failed",{errorInfo:null===(R=se)||void 0===R?void 0:R.toString()})}})).apply(this,arguments)}function Zs({projectId:b}){return`https://fcmregistrations.googleapis.com/v1/projects/${b}/registrations`}function Ys(b){return bt.apply(this,arguments)}function bt(){return(bt=(0,P.Z)(function*({appConfig:b,installations:D}){const R=yield D.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":b.apiKey,"x-goog-firebase-installations-auth":`FIS ${R}`})})).apply(this,arguments)}function vo({p256dh:b,auth:D,endpoint:R,vapidKey:j}){const X={web:{endpoint:R,auth:D,p256dh:b}};return j!==Jo&&(X.web.applicationPubKey=j),X}const xu=6048e5;function ed(b){return Ma.apply(this,arguments)}function Ma(){return(Ma=(0,P.Z)(function*(b){const D=yield Ru(b.swRegistration,b.vapidKey),R={vapidKey:b.vapidKey,swScope:b.swRegistration.scope,endpoint:D.endpoint,auth:Vi(D.getKey("auth")),p256dh:Vi(D.getKey("p256dh"))},j=yield xa(b.firebaseDependencies);if(j){if(nd(j.subscriptionOptions,R))return Date.now()>=j.createTime+xu?Gh(b,{token:j.token,createTime:Date.now(),subscriptionOptions:R}):j.token;try{yield kl(b.firebaseDependencies,j.token)}catch(X){console.warn(X)}return Ne(b.firebaseDependencies,R)}return Ne(b.firebaseDependencies,R)})).apply(this,arguments)}function td(b){return ta.apply(this,arguments)}function ta(){return(ta=(0,P.Z)(function*(b){const D=yield xa(b.firebaseDependencies);D&&(yield kl(b.firebaseDependencies,D.token),yield Ra(b.firebaseDependencies));const R=yield b.swRegistration.pushManager.getSubscription();return!R||R.unsubscribe()})).apply(this,arguments)}function Gh(b,D){return Qs.apply(this,arguments)}function Qs(){return(Qs=(0,P.Z)(function*(b,D){try{const R=yield ea(b.firebaseDependencies,D),j=Object.assign(Object.assign({},D),{token:R,createTime:Date.now()});return yield mn(b.firebaseDependencies,j),R}catch(R){throw yield td(b),R}})).apply(this,arguments)}function Ne(b,D){return Wt.apply(this,arguments)}function Wt(){return(Wt=(0,P.Z)(function*(b,D){const j={token:yield Ds(b,D),createTime:Date.now(),subscriptionOptions:D};return yield mn(b,j),j.token})).apply(this,arguments)}function Ru(b,D){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,P.Z)(function*(b,D){return(yield b.pushManager.getSubscription())||b.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Qc(D)})})).apply(this,arguments)}function nd(b,D){return D.vapidKey===b.vapidKey&&D.endpoint===b.endpoint&&D.auth===b.auth&&D.p256dh===b.p256dh}function Ss(b){const D={from:b.from,collapseKey:b.collapse_key,messageId:b.fcmMessageId};return function os(b,D){if(!D.notification)return;b.notification={};const R=D.notification.title;R&&(b.notification.title=R);const j=D.notification.body;j&&(b.notification.body=j);const X=D.notification.image;X&&(b.notification.image=X);const se=D.notification.icon;se&&(b.notification.icon=se)}(D,b),function Nl(b,D){!D.data||(b.data=D.data)}(D,b),function ka(b,D){var R,j,X,se,Me;if(!D.fcmOptions&&!(null===(R=D.notification)||void 0===R?void 0:R.click_action))return;b.fcmOptions={};const ze=null!==(X=null===(j=D.fcmOptions)||void 0===j?void 0:j.link)&&void 0!==X?X:null===(se=D.notification)||void 0===se?void 0:se.click_action;ze&&(b.fcmOptions.link=ze);const yt=null===(Me=D.fcmOptions)||void 0===Me?void 0:Me.analytics_label;yt&&(b.fcmOptions.analyticsLabel=yt)}(D,b),D}function Wh(b){return"object"==typeof b&&!!b&&Aa in b}function rd(b,D){const R=[];for(let j=0;j<b.length;j++)R.push(b.charAt(j)),j<D.length&&R.push(D.charAt(j));return R.join("")}function wo(b){return qn.create("missing-app-config-values",{valueName:b})}rd("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),rd("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Ir{constructor(D,R,j){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const X=function id(b){if(!b||!b.options)throw wo("App Configuration Object");if(!b.name)throw wo("App Name");const D=["projectId","apiKey","appId","messagingSenderId"],{options:R}=b;for(const j of D)if(!R[j])throw wo(j);return{appName:b.name,projectId:R.projectId,apiKey:R.apiKey,appId:R.appId,senderId:R.messagingSenderId}}(D);this.firebaseDependencies={app:D,appConfig:X,installations:R,analyticsProvider:j}}_delete(){return Promise.resolve()}}function as(b){return na.apply(this,arguments)}function na(){return(na=(0,P.Z)(function*(b){var D;try{b.swRegistration=yield navigator.serviceWorker.register(zs,{scope:Ai}),b.swRegistration.update().catch(()=>{})}catch(R){throw qn.create("failed-service-worker-registration",{browserErrorMessage:null===(D=R)||void 0===D?void 0:D.message})}})).apply(this,arguments)}function ra(b,D){return di.apply(this,arguments)}function di(){return(di=(0,P.Z)(function*(b,D){if(!D&&!b.swRegistration&&(yield as(b)),D||!b.swRegistration){if(!(D instanceof ServiceWorkerRegistration))throw qn.create("invalid-sw-registration");b.swRegistration=D}})).apply(this,arguments)}function qh(b,D){return ia.apply(this,arguments)}function ia(){return(ia=(0,P.Z)(function*(b,D){D?b.vapidKey=D:b.vapidKey||(b.vapidKey=Jo)})).apply(this,arguments)}function Na(){return(Na=(0,P.Z)(function*(b,D){if(!navigator)throw qn.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw qn.create("permission-blocked");return yield qh(b,null==D?void 0:D.vapidKey),yield ra(b,null==D?void 0:D.serviceWorkerRegistration),ed(b)})).apply(this,arguments)}function Pl(b,D,R){return sa.apply(this,arguments)}function sa(){return(sa=(0,P.Z)(function*(b,D,R){const j=od(D);(yield b.firebaseDependencies.analyticsProvider.get()).logEvent(j,{message_id:R[Aa],message_name:R[Hh],message_time:R[Xp],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function od(b){switch(b){case Cs.NOTIFICATION_CLICKED:return"notification_open";case Cs.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Ol(){return(Ol=(0,P.Z)(function*(b,D){const R=D.data;if(!R.isFirebaseMessaging)return;b.onMessageHandler&&R.messageType===Cs.PUSH_RECEIVED&&("function"==typeof b.onMessageHandler?b.onMessageHandler(Ss(R)):b.onMessageHandler.next(Ss(R)));const j=R.data;Wh(j)&&"1"===j[_o]&&(yield Pl(b,R.messageType,j))})).apply(this,arguments)}const Pa="@firebase/messaging",Eo=b=>{const D=new Ir(b.getProvider("app").getImmediate(),b.getProvider("installations-internal").getImmediate(),b.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",R=>function ad(b,D){return Ol.apply(this,arguments)}(D,R)),D},ud=b=>{const D=b.getProvider("messaging").getImmediate();return{getToken:j=>function sd(b,D){return Na.apply(this,arguments)}(D,j)}};function Mu(){return hi.apply(this,arguments)}function hi(){return(hi=(0,P.Z)(function*(){try{yield(0,ce.eu)()}catch(b){return!1}return"undefined"!=typeof window&&(0,ce.hl)()&&(0,ce.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function zh(){(0,oe._registerComponent)(new ye.wA("messaging",Eo,"PUBLIC")),(0,oe._registerComponent)(new ye.wA("messaging-internal",ud,"PRIVATE")),(0,oe.registerVersion)(Pa,"0.11.0"),(0,oe.registerVersion)(Pa,"0.11.0","esm2017")}();const ld="analytics",Jp="firebase_id",La="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Fa="https://www.googletagmanager.com/gtag/js",_r=new ge.Yd("@firebase/analytics");function dd(b){return Promise.all(b.map(D=>D.catch(R=>R)))}function eg(b,D){const R=document.createElement("script");R.src=`${Fa}?l=${b}&id=${D}`,R.async=!0,document.head.appendChild(R)}function oa(b,D,R,j,X,se){return hd.apply(this,arguments)}function hd(){return(hd=(0,P.Z)(function*(b,D,R,j,X,se){const Me=j[X];try{if(Me)yield D[Me];else{const yt=(yield dd(R)).find(St=>St.measurementId===X);yt&&(yield D[yt.appId])}}catch(ze){_r.error(ze)}b("config",X,se)})).apply(this,arguments)}function Fl(b,D,R,j,X){return Io.apply(this,arguments)}function Io(){return(Io=(0,P.Z)(function*(b,D,R,j,X){try{let se=[];if(X&&X.send_to){let Me=X.send_to;Array.isArray(Me)||(Me=[Me]);const ze=yield dd(R);for(const yt of Me){const St=ze.find(dt=>dt.measurementId===yt),kt=St&&D[St.appId];if(!kt){se=[];break}se.push(kt)}}0===se.length&&(se=Object.values(D)),yield Promise.all(se),b("event",j,X||{})}catch(se){_r.error(se)}})).apply(this,arguments)}function An(b){const D=window.document.getElementsByTagName("script");for(const R of Object.values(D))if(R.src&&R.src.includes(Fa)&&R.src.includes(b))return R;return null}const st=new ce.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Ua=new class xi{constructor(D={},R=1e3){this.throttleMetadata=D,this.intervalMillis=R}getThrottleMetadata(D){return this.throttleMetadata[D]}setThrottleMetadata(D,R){this.throttleMetadata[D]=R}deleteThrottleMetadata(D){delete this.throttleMetadata[D]}};function aa(b){return new Headers({Accept:"application/json","x-goog-api-key":b})}function fd(b){return In.apply(this,arguments)}function In(){return(In=(0,P.Z)(function*(b){var D;const{appId:R,apiKey:j}=b,X={method:"GET",headers:aa(j)},se=La.replace("{app-id}",R),Me=yield fetch(se,X);if(200!==Me.status&&304!==Me.status){let ze="";try{const yt=yield Me.json();(null===(D=yt.error)||void 0===D?void 0:D.message)&&(ze=yt.error.message)}catch(yt){}throw st.create("config-fetch-failed",{httpStatus:Me.status,responseMessage:ze})}return Me.json()})).apply(this,arguments)}function Yh(b){return ls.apply(this,arguments)}function ls(){return(ls=(0,P.Z)(function*(b,D=Ua,R){const{appId:j,apiKey:X,measurementId:se}=b.options;if(!j)throw st.create("no-app-id");if(!X){if(se)return{measurementId:se,appId:j};throw st.create("no-api-key")}const Me=D.getThrottleMetadata(j)||{backoffCount:0,throttleEndTimeMillis:Date.now()},ze=new Vl;return setTimeout((0,P.Z)(function*(){ze.abort()}),void 0!==R?R:6e4),Rs({appId:j,apiKey:X,measurementId:se},Me,ze,D)})).apply(this,arguments)}function Rs(b,D,R){return Ct.apply(this,arguments)}function Ct(){return(Ct=(0,P.Z)(function*(b,{throttleEndTimeMillis:D,backoffCount:R},j,X=Ua){var se,Me;const{appId:ze,measurementId:yt}=b;try{yield ng(j,D)}catch(St){if(yt)return _r.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${yt} provided in the "measurementId" field in the local Firebase config. [${null===(se=St)||void 0===se?void 0:se.message}]`),{appId:ze,measurementId:yt};throw St}try{const St=yield fd(b);return X.deleteThrottleMetadata(ze),St}catch(St){const kt=St;if(!pd(kt)){if(X.deleteThrottleMetadata(ze),yt)return _r.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${yt} provided in the "measurementId" field in the local Firebase config. [${null==kt?void 0:kt.message}]`),{appId:ze,measurementId:yt};throw St}const dt=503===Number(null===(Me=null==kt?void 0:kt.customData)||void 0===Me?void 0:Me.httpStatus)?(0,ce.$s)(R,X.intervalMillis,30):(0,ce.$s)(R,X.intervalMillis),Tr={throttleEndTimeMillis:Date.now()+dt,backoffCount:R+1};return X.setThrottleMetadata(ze,Tr),_r.debug(`Calling attemptFetch again in ${dt} millis`),Rs(b,Tr,j,X)}})).apply(this,arguments)}function ng(b,D){return new Promise((R,j)=>{const X=Math.max(D-Date.now(),0),se=setTimeout(R,X);b.addEventListener(()=>{clearTimeout(se),j(st.create("fetch-throttle",{throttleEndTimeMillis:D}))})})}function pd(b){if(!(b instanceof ce.ZR&&b.customData))return!1;const D=Number(b.customData.httpStatus);return 429===D||500===D||503===D||504===D}class Vl{constructor(){this.listeners=[]}addEventListener(D){this.listeners.push(D)}abort(){this.listeners.forEach(D=>D())}}let Bl,$a;function Js(){return(Js=(0,P.Z)(function*(b,D,R,j,X){if(X&&X.global)b("event",R,j);else{const se=yield D;b("event",R,Object.assign(Object.assign({},j),{send_to:se}))}})).apply(this,arguments)}function Nu(b){$a=b}function Ha(b){Bl=b}function Pu(){return ei.apply(this,arguments)}function ei(){return(ei=(0,P.Z)(function*(){var b;if(!(0,ce.hl)())return _r.warn(st.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,ce.eu)()}catch(D){return _r.warn(st.create("indexeddb-unavailable",{errorInfo:null===(b=D)||void 0===b?void 0:b.toString()}).message),!1}return!0})).apply(this,arguments)}function er(){return(er=(0,P.Z)(function*(b,D,R,j,X,se,Me){var ze;const yt=Yh(b);yt.then(tr=>{R[tr.measurementId]=tr.appId,b.options.measurementId&&tr.measurementId!==b.options.measurementId&&_r.warn(`The measurement ID in the local Firebase config (${b.options.measurementId}) does not match the measurement ID fetched from the server (${tr.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(tr=>_r.error(tr)),D.push(yt);const St=Pu().then(tr=>{if(tr)return j.getId()}),[kt,dt]=yield Promise.all([yt,St]);An(se)||eg(se,kt.measurementId),$a&&(X("consent","default",$a),Nu(void 0)),X("js",new Date);const Tr=null!==(ze=null==Me?void 0:Me.config)&&void 0!==ze?ze:{};return Tr.origin="firebase",Tr.update=!0,null!=dt&&(Tr[Jp]=dt),X("config",kt.measurementId,Tr),Bl&&(X("set",Bl),Ha(void 0)),kt.measurementId})).apply(this,arguments)}class jl{constructor(D){this.app=D}_delete(){return delete Or[this.app.options.appId],Promise.resolve()}}let Or={},lr=[];const Co={};let fi,xn,ds="dataLayer",Bi=!1;function Ou(b,D,R){!function hs(){const b=[];if((0,ce.ru)()&&b.push("This is a browser extension environment."),(0,ce.zI)()||b.push("Cookies are not available."),b.length>0){const D=b.map((j,X)=>`(${X+1}) ${j}`).join(" "),R=st.create("invalid-analytics-context",{errorInfo:D});_r.warn(R.message)}}();const j=b.options.appId;if(!j)throw st.create("no-app-id");if(!b.options.apiKey){if(!b.options.measurementId)throw st.create("no-api-key");_r.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${b.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Or[j])throw st.create("already-exists",{id:j});if(!Bi){!function xs(b){let D=[];Array.isArray(window[b])?D=window[b]:window[b]=D}(ds);const{wrappedGtag:se,gtagCore:Me}=function tg(b,D,R,j,X){let se=function(...Me){window[j].push(arguments)};return window[X]&&"function"==typeof window[X]&&(se=window[X]),window[X]=function Ul(b,D,R,j){function se(){return(se=(0,P.Z)(function*(Me,ze,yt){try{"event"===Me?yield Fl(b,D,R,ze,yt):"config"===Me?yield oa(b,D,R,j,ze,yt):"consent"===Me?b("consent","update",yt):b("set",ze)}catch(St){_r.error(St)}})).apply(this,arguments)}return function X(Me,ze,yt){return se.apply(this,arguments)}}(se,b,D,R),{gtagCore:se,wrappedGtag:window[X]}}(Or,lr,Co,ds,"gtag");xn=se,fi=Me,Bi=!0}return Or[j]=function gd(b,D,R,j,X,se,Me){return er.apply(this,arguments)}(b,lr,Co,D,fi,ds,R),new jl(b)}function md(){return _d.apply(this,arguments)}function _d(){return(_d=(0,P.Z)(function*(){if((0,ce.ru)()||!(0,ce.zI)()||!(0,ce.hl)())return!1;try{return yield(0,ce.eu)()}catch(b){return!1}})).apply(this,arguments)}const Vn="@firebase/analytics";!function So(){(0,oe._registerComponent)(new ye.wA(ld,(D,{options:R})=>Ou(D.getProvider("app").getImmediate(),D.getProvider("installations-internal").getImmediate(),R),"PUBLIC")),(0,oe._registerComponent)(new ye.wA("analytics-internal",function b(D){try{const R=D.getProvider(ld).getImmediate();return{logEvent:(j,X,se)=>function ji(b,D,R,j){b=(0,ce.m9)(b),function zn(b,D,R,j,X){return Js.apply(this,arguments)}(xn,Or[b.app.options.appId],D,R,j).catch(X=>_r.error(X))}(R,j,X,se)}}catch(R){throw st.create("interop-component-reg-failed",{reason:R})}},"PRIVATE")),(0,oe.registerVersion)(Vn,"0.8.4"),(0,oe.registerVersion)(Vn,"0.8.4","esm2017")}();var ig=F(4408),qr=F(7565);const Hl=new class pi extends qr.v{}(class $l extends ig.o{constructor(D,R){super(D,R),this.scheduler=D,this.work=R}schedule(D,R=0){return R>0?super.schedule(D,R):(this.delay=R,this.state=D,this.scheduler.flush(this),this)}execute(D,R){return R>0||this.closed?super.execute(D,R):this._execute(D,R)}requestAsyncId(D,R,j=0){return null!=j&&j>0||null==j&&this.delay>0?super.requestAsyncId(D,R,j):(D.flush(this),0)}});var qa=F(4986),to=F(8505),Fu=F(5363),yd=F(9468);const qt=new _.GfV("7.4.1"),vd="__angularfire_symbol__analyticsIsSupportedValue",$i="__angularfire_symbol__analyticsIsSupported",Cr="__angularfire_symbol__remoteConfigIsSupportedValue",Ao="__angularfire_symbol__remoteConfigIsSupported",no="__angularfire_symbol__messagingIsSupportedValue",Uu="__angularfire_symbol__messagingIsSupported";function Bu(b,D,R){if(D){if(1===D.length)return D[0];const se=D.filter(Me=>Me.app===R);if(1===se.length)return se[0]}return R.container.getProvider(b).getImmediate({optional:!0})}globalThis[$i]||(globalThis[$i]=md().then(b=>globalThis[vd]=b).catch(()=>globalThis[vd]=!1)),globalThis[Uu]||(globalThis[Uu]=Mu().then(b=>globalThis[no]=b).catch(()=>globalThis[no]=!1)),globalThis[Ao]||(globalThis[Ao]=P_().then(b=>globalThis[Cr]=b).catch(()=>globalThis[Cr]=!1));const sg=(b,D)=>{const R=D?[D]:(0,G.C6)(),j=[];return R.forEach(X=>{X.container.getProvider(b).instances.forEach(Me=>{j.includes(Me)||j.push(Me)})}),j};function yn(){}class gi{constructor(D,R=Hl){this.zone=D,this.delegate=R}now(){return this.delegate.now()}schedule(D,R,j){const X=this.zone;return this.delegate.schedule(function(Me){X.runGuarded(()=>{D.apply(this,[Me])})},R,j)}}class ju{constructor(D){this.zone=D,this.task=null}call(D,R){const j=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",yn,{},yn,yn)),R.pipe((0,to.b)({next:j,complete:j,error:j})).subscribe(D).add(j)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let wd=(()=>{class b{constructor(R){this.ngZone=R,this.outsideAngular=R.runOutsideAngular(()=>new gi(Zone.current)),this.insideAngular=R.run(()=>new gi(Zone.current,qa.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return b.\u0275fac=function(R){return new(R||b)(_.LFG(_.R0b))},b.\u0275prov=_.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})();function ti(){const b=globalThis.\u0275AngularFireScheduler;if(!b)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return b}function Wl(b){return b.pipe((0,Fu.Q)(ti().outsideAngular))}function $u(b){return ti(),function ql(b){return function(R){return(R=R.lift(new ju(b.ngZone))).pipe((0,yd.R)(b.outsideAngular),(0,Fu.Q)(b.insideAngular))}}(ti())(b)}},8247:(nt,Ce,F)=>{F.d(Ce,{$:()=>Zs,A:()=>q,B:()=>Re,G:()=>_n,H:()=>hn,J:()=>Is,L:()=>W,M:()=>Da,N:()=>Sa,P:()=>qa,Q:()=>Aa,R:()=>Do,T:()=>Hh,U:()=>Jo,V:()=>Cs,W:()=>Vi,X:()=>Jc,Y:()=>Au,Z:()=>Ds,_:()=>ea,a:()=>Jr,a0:()=>ed,a1:()=>td,a2:()=>Gh,a3:()=>Ne,a4:()=>Ru,a5:()=>nd,a6:()=>os,a7:()=>Nl,a8:()=>Wh,a9:()=>rd,aA:()=>H,aB:()=>yt,aC:()=>Wl,aD:()=>fs,aE:()=>$e,aI:()=>aa,aL:()=>_o,aa:()=>as,ab:()=>ra,ac:()=>qh,af:()=>Pl,ag:()=>od,ah:()=>ad,ak:()=>Ts,al:()=>Ll,an:()=>Fa,ao:()=>hd,ap:()=>Ee,aq:()=>it,ar:()=>et,as:()=>Ge,at:()=>sf,au:()=>za,av:()=>on,aw:()=>Pe,ax:()=>ne,ay:()=>tr,az:()=>te,b:()=>st,c:()=>no,d:()=>Jh,e:()=>Vu,f:()=>ql,g:()=>j,h:()=>b,i:()=>ei,j:()=>Me,k:()=>lg,l:()=>Lu,m:()=>dg,o:()=>le,r:()=>ig,s:()=>rg,u:()=>Hl});var _=F(5861),G=F(2090),P=F(9681),oe=F(1877),ce=F(655),ye=F(4859);const le={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},q={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Re=function re(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Ve=function je(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},He=new G.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),De=new oe.Yd("@firebase/auth");function qe(w,...p){De.logLevel<=oe.in.ERROR&&De.error(`Auth (${P.SDK_VERSION}): ${w}`,...p)}function Ge(w,...p){throw We(w,...p)}function Pe(w,...p){return We(w,...p)}function Ae(w,p,m){const I=Object.assign(Object.assign({},Ve()),{[p]:m});return new G.LL("auth","Firebase",I).create(p,{appName:w.name})}function Te(w,p,m){if(!(p instanceof m))throw m.name!==p.constructor.name&&Ge(w,"argument-error"),Ae(w,"argument-error",`Type of ${p.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function We(w,...p){if("string"!=typeof w){const m=p[0],I=[...p.slice(1)];return I[0]&&(I[0].appName=w.name),w._errorFactory.create(m,...I)}return He.create(w,...p)}function ne(w,p,...m){if(!w)throw We(p,...m)}function pe(w){const p="INTERNAL ASSERTION FAILED: "+w;throw qe(p),new Error(p)}function Ee(w,p){w||pe(p)}const Q=new Map;function te(w){Ee(w instanceof Function,"Expected a class definition");let p=Q.get(w);return p?(Ee(p instanceof w,"Instance stored in cache mismatched with class"),p):(p=new w,Q.set(w,p),p)}function de(){var w;return"undefined"!=typeof self&&(null===(w=self.location)||void 0===w?void 0:w.href)||""}function Fe(){return"http:"===pt()||"https:"===pt()}function pt(){var w;return"undefined"!=typeof self&&(null===(w=self.location)||void 0===w?void 0:w.protocol)||null}class Ze{constructor(p,m){this.shortDelay=p,this.longDelay=m,Ee(m>p,"Short delay should be less than long delay!"),this.isMobile=(0,G.uI)()||(0,G.b$)()}get(){return function en(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Fe()||(0,G.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ln(w,p){Ee(w.emulator,"Emulator should always be set here");const{url:m}=w.emulator;return p?`${m}${p.startsWith("/")?p.slice(1):p}`:m}class Tn{static initialize(p,m,I){this.fetchImpl=p,m&&(this.headersImpl=m),I&&(this.responseImpl=I)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void pe("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void pe("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void pe("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const cn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},tn=new Ze(3e4,6e4);function $t(w,p){return w.tenantId&&!p.tenantId?Object.assign(Object.assign({},p),{tenantId:w.tenantId}):p}function Yt(w,p,m,I){return Nn.apply(this,arguments)}function Nn(){return(Nn=(0,_.Z)(function*(w,p,m,I,x={}){return Qr(w,x,(0,_.Z)(function*(){let O={},J={};I&&("GET"===p?J=I:O={body:JSON.stringify(I)});const xe=(0,G.xO)(Object.assign({key:w.config.apiKey},J)).slice(1),tt=yield w._getAdditionalHeaders();return tt["Content-Type"]="application/json",w.languageCode&&(tt["X-Firebase-Locale"]=w.languageCode),Tn.fetch()(bi(w,w.config.apiHost,m,xe),Object.assign({method:p,headers:tt,referrerPolicy:"no-referrer"},O))}))})).apply(this,arguments)}function Qr(w,p,m){return ai.apply(this,arguments)}function ai(){return(ai=(0,_.Z)(function*(w,p,m){w._canInitEmulator=!1;const I=Object.assign(Object.assign({},cn),p);try{const x=new Ci(w),O=yield Promise.race([m(),x.promise]);x.clearNetworkTimeout();const J=yield O.json();if("needConfirmation"in J)throw Hn(w,"account-exists-with-different-credential",J);if(O.ok&&!("errorMessage"in J))return J;{const xe=O.ok?J.errorMessage:J.error.message,[tt,vt]=xe.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===tt)throw Hn(w,"credential-already-in-use",J);if("EMAIL_EXISTS"===tt)throw Hn(w,"email-already-in-use",J);if("USER_DISABLED"===tt)throw Hn(w,"user-disabled",J);const Vt=I[tt]||tt.toLowerCase().replace(/[_\s]+/g,"-");if(vt)throw Ae(w,Vt,vt);Ge(w,Vt)}}catch(x){if(x instanceof G.ZR)throw x;Ge(w,"network-request-failed")}})).apply(this,arguments)}function Fn(w,p,m,I){return ns.apply(this,arguments)}function ns(){return(ns=(0,_.Z)(function*(w,p,m,I,x={}){const O=yield Yt(w,p,m,I,x);return"mfaPendingCredential"in O&&Ge(w,"multi-factor-auth-required",{_serverResponse:O}),O})).apply(this,arguments)}function bi(w,p,m,I){const x=`${p}${m}?${I}`;return w.config.emulator?ln(w.config,x):`${w.config.apiScheme}://${x}`}class Ci{constructor(p){this.auth=p,this.timer=null,this.promise=new Promise((m,I)=>{this.timer=setTimeout(()=>I(Pe(this.auth,"network-request-failed")),tn.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Hn(w,p,m){const I={appName:w.name};m.email&&(I.email=m.email),m.phoneNumber&&(I.phoneNumber=m.phoneNumber);const x=Pe(w,p,I);return x.customData._tokenResponse=m,x}function wt(){return(wt=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:delete",p)})).apply(this,arguments)}function kr(w,p){return wn.apply(this,arguments)}function wn(){return(wn=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function dn(w,p){return Nr.apply(this,arguments)}function Nr(){return(Nr=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:lookup",p)})).apply(this,arguments)}function Vr(w){if(w)try{const p=new Date(Number(w));if(!isNaN(p.getTime()))return p.toUTCString()}catch(p){}}function pr(){return(pr=(0,_.Z)(function*(w,p=!1){const m=(0,G.m9)(w),I=yield m.getIdToken(p),x=Kt(I);ne(x&&x.exp&&x.auth_time&&x.iat,m.auth,"internal-error");const O="object"==typeof x.firebase?x.firebase:void 0,J=null==O?void 0:O.sign_in_provider;return{claims:x,token:I,authTime:Vr(vs(x.auth_time)),issuedAtTime:Vr(vs(x.iat)),expirationTime:Vr(vs(x.exp)),signInProvider:J||null,signInSecondFactor:(null==O?void 0:O.sign_in_second_factor)||null}})).apply(this,arguments)}function vs(w){return 1e3*Number(w)}function Kt(w){var p;const[m,I,x]=w.split(".");if(void 0===m||void 0===I||void 0===x)return qe("JWT malformed, contained fewer than 3 sections"),null;try{const O=(0,G.tV)(I);return O?JSON.parse(O):(qe("Failed to decode base64 JWT payload"),null)}catch(O){return qe("Caught error parsing JWT payload as JSON",null===(p=O)||void 0===p?void 0:p.toString()),null}}function rt(w,p){return Ti.apply(this,arguments)}function Ti(){return(Ti=(0,_.Z)(function*(w,p,m=!1){if(m)return p;try{return yield p}catch(I){throw I instanceof G.ZR&&jr(I)&&w.auth.currentUser===w&&(yield w.auth.signOut()),I}})).apply(this,arguments)}function jr({code:w}){return"auth/user-disabled"===w||"auth/user-token-expired"===w}class Zt{constructor(p){this.user=p,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(p){var m;if(p){const I=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),I}{this.errorBackoff=3e4;const x=(null!==(m=this.user.stsTokenManager.expirationTime)&&void 0!==m?m:0)-Date.now()-3e5;return Math.max(0,x)}}schedule(p=!1){var m=this;if(!this.isRunning)return;const I=this.getInterval(p);this.timerId=setTimeout((0,_.Z)(function*(){yield m.iteration()}),I)}iteration(){var p=this;return(0,_.Z)(function*(){var m;try{yield p.user.getIdToken(!0)}catch(I){return void("auth/network-request-failed"===(null===(m=I)||void 0===m?void 0:m.code)&&p.schedule(!0))}p.schedule()})()}}class Fi{constructor(p,m){this.createdAt=p,this.lastLoginAt=m,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vr(this.lastLoginAt),this.creationTime=Vr(this.createdAt)}_copy(p){this.createdAt=p.createdAt,this.lastLoginAt=p.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Gn(w){return pn.apply(this,arguments)}function pn(){return(pn=(0,_.Z)(function*(w){var p;const m=w.auth,I=yield w.getIdToken(),x=yield rt(w,dn(m,{idToken:I}));ne(null==x?void 0:x.users.length,m,"internal-error");const O=x.users[0];w._notifyReloadListener(O);const J=(null===(p=O.providerUserInfo)||void 0===p?void 0:p.length)?ar(O.providerUserInfo):[],xe=Gt(w.providerData,J),Vt=!!w.isAnonymous&&!(w.email&&O.passwordHash||(null==xe?void 0:xe.length)),Rn={uid:O.localId,displayName:O.displayName||null,photoURL:O.photoUrl||null,email:O.email||null,emailVerified:O.emailVerified||!1,phoneNumber:O.phoneNumber||null,tenantId:O.tenantId||null,providerData:xe,metadata:new Fi(O.createdAt,O.lastLoginAt),isAnonymous:Vt};Object.assign(w,Rn)})).apply(this,arguments)}function ui(){return(ui=(0,_.Z)(function*(w){const p=(0,G.m9)(w);yield Gn(p),yield p.auth._persistUserIfCurrent(p),p.auth._notifyListenersIfCurrent(p)})).apply(this,arguments)}function Gt(w,p){return[...w.filter(I=>!p.some(x=>x.providerId===I.providerId)),...p]}function ar(w){return w.map(p=>{var{providerId:m}=p,I=(0,ce._T)(p,["providerId"]);return{providerId:m,uid:I.rawId||"",displayName:I.displayName||null,email:I.email||null,phoneNumber:I.phoneNumber||null,photoURL:I.photoUrl||null}})}function Se(){return(Se=(0,_.Z)(function*(w,p){const m=yield Qr(w,{},(0,_.Z)(function*(){const I=(0,G.xO)({grant_type:"refresh_token",refresh_token:p}).slice(1),{tokenApiHost:x,apiKey:O}=w.config,J=bi(w,x,"/v1/token",`key=${O}`),xe=yield w._getAdditionalHeaders();return xe["Content-Type"]="application/x-www-form-urlencoded",Tn.fetch()(J,{method:"POST",headers:xe,body:I})}));return{accessToken:m.access_token,expiresIn:m.expires_in,refreshToken:m.refresh_token}})).apply(this,arguments)}class Ke{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(p){ne(p.idToken,"internal-error"),ne(void 0!==p.idToken,"internal-error"),ne(void 0!==p.refreshToken,"internal-error");const m="expiresIn"in p&&void 0!==p.expiresIn?Number(p.expiresIn):function gt(w){const p=Kt(w);return ne(p,"internal-error"),ne(void 0!==p.exp,"internal-error"),ne(void 0!==p.iat,"internal-error"),Number(p.exp)-Number(p.iat)}(p.idToken);this.updateTokensAndExpiration(p.idToken,p.refreshToken,m)}getToken(p,m=!1){var I=this;return(0,_.Z)(function*(){return ne(!I.accessToken||I.refreshToken,p,"user-token-expired"),m||!I.accessToken||I.isExpired?I.refreshToken?(yield I.refresh(p,I.refreshToken),I.accessToken):null:I.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(p,m){var I=this;return(0,_.Z)(function*(){const{accessToken:x,refreshToken:O,expiresIn:J}=yield function Xe(w,p){return Se.apply(this,arguments)}(p,m);I.updateTokensAndExpiration(x,O,Number(J))})()}updateTokensAndExpiration(p,m,I){this.refreshToken=m||null,this.accessToken=p||null,this.expirationTime=Date.now()+1e3*I}static fromJSON(p,m){const{refreshToken:I,accessToken:x,expirationTime:O}=m,J=new Ke;return I&&(ne("string"==typeof I,"internal-error",{appName:p}),J.refreshToken=I),x&&(ne("string"==typeof x,"internal-error",{appName:p}),J.accessToken=x),O&&(ne("number"==typeof O,"internal-error",{appName:p}),J.expirationTime=O),J}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(p){this.accessToken=p.accessToken,this.refreshToken=p.refreshToken,this.expirationTime=p.expirationTime}_clone(){return Object.assign(new Ke,this.toJSON())}_performRefresh(){return pe("not implemented")}}function It(w,p){ne("string"==typeof w||void 0===w,"internal-error",{appName:p})}class Et{constructor(p){var{uid:m,auth:I,stsTokenManager:x}=p,O=(0,ce._T)(p,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Zt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=m,this.auth=I,this.stsTokenManager=x,this.accessToken=x.accessToken,this.displayName=O.displayName||null,this.email=O.email||null,this.emailVerified=O.emailVerified||!1,this.phoneNumber=O.phoneNumber||null,this.photoURL=O.photoURL||null,this.isAnonymous=O.isAnonymous||!1,this.tenantId=O.tenantId||null,this.providerData=O.providerData?[...O.providerData]:[],this.metadata=new Fi(O.createdAt||void 0,O.lastLoginAt||void 0)}getIdToken(p){var m=this;return(0,_.Z)(function*(){const I=yield rt(m,m.stsTokenManager.getToken(m.auth,p));return ne(I,m.auth,"internal-error"),m.accessToken!==I&&(m.accessToken=I,yield m.auth._persistUserIfCurrent(m),m.auth._notifyListenersIfCurrent(m)),I})()}getIdTokenResult(p){return function Dn(w){return pr.apply(this,arguments)}(this,p)}reload(){return function _t(w){return ui.apply(this,arguments)}(this)}_assign(p){this!==p&&(ne(this.uid===p.uid,this.auth,"internal-error"),this.displayName=p.displayName,this.photoURL=p.photoURL,this.email=p.email,this.emailVerified=p.emailVerified,this.phoneNumber=p.phoneNumber,this.isAnonymous=p.isAnonymous,this.tenantId=p.tenantId,this.providerData=p.providerData.map(m=>Object.assign({},m)),this.metadata._copy(p.metadata),this.stsTokenManager._assign(p.stsTokenManager))}_clone(p){return new Et(Object.assign(Object.assign({},this),{auth:p,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(p){ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=p,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(p){this.reloadListener?this.reloadListener(p):this.reloadUserInfo=p}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(p,m=!1){var I=this;return(0,_.Z)(function*(){let x=!1;p.idToken&&p.idToken!==I.stsTokenManager.accessToken&&(I.stsTokenManager.updateFromServerResponse(p),x=!0),m&&(yield Gn(I)),yield I.auth._persistUserIfCurrent(I),x&&I.auth._notifyListenersIfCurrent(I)})()}delete(){var p=this;return(0,_.Z)(function*(){const m=yield p.getIdToken();return yield rt(p,function rs(w,p){return wt.apply(this,arguments)}(p.auth,{idToken:m})),p.stsTokenManager.clearRefreshToken(),p.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(p=>Object.assign({},p)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(p,m){var I,x,O,J,xe,tt,vt,Vt;const Rn=null!==(I=m.displayName)&&void 0!==I?I:void 0,Wi=null!==(x=m.email)&&void 0!==x?x:void 0,Ro=null!==(O=m.phoneNumber)&&void 0!==O?O:void 0,da=null!==(J=m.photoURL)&&void 0!==J?J:void 0,Dd=null!==(xe=m.tenantId)&&void 0!==xe?xe:void 0,lf=null!==(tt=m._redirectEventId)&&void 0!==tt?tt:void 0,cf=null!==(vt=m.createdAt)&&void 0!==vt?vt:void 0,Sd=null!==(Vt=m.lastLoginAt)&&void 0!==Vt?Vt:void 0,{uid:zu,emailVerified:mg,isAnonymous:Ku,providerData:ki,stsTokenManager:nr}=m;ne(zu&&nr,p,"internal-error");const _g=Ke.fromJSON(this.name,nr);ne("string"==typeof zu,p,"internal-error"),It(Rn,p.name),It(Wi,p.name),ne("boolean"==typeof mg,p,"internal-error"),ne("boolean"==typeof Ku,p,"internal-error"),It(Ro,p.name),It(da,p.name),It(Dd,p.name),It(lf,p.name),It(cf,p.name),It(Sd,p.name);const Zu=new Et({uid:zu,auth:p,email:Wi,emailVerified:mg,displayName:Rn,isAnonymous:Ku,photoURL:da,phoneNumber:Ro,tenantId:Dd,stsTokenManager:_g,createdAt:cf,lastLoginAt:Sd});return ki&&Array.isArray(ki)&&(Zu.providerData=ki.map(Yu=>Object.assign({},Yu))),lf&&(Zu._redirectEventId=lf),Zu}static _fromIdTokenResponse(p,m,I=!1){return(0,_.Z)(function*(){const x=new Ke;x.updateFromServerResponse(m);const O=new Et({uid:m.localId,auth:p,stsTokenManager:x,isAnonymous:I});return yield Gn(O),O})()}}const W=(()=>{class w{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,_.Z)(function*(){return!0})()}_set(m,I){var x=this;return(0,_.Z)(function*(){x.storage[m]=I})()}_get(m){var I=this;return(0,_.Z)(function*(){const x=I.storage[m];return void 0===x?null:x})()}_remove(m){var I=this;return(0,_.Z)(function*(){delete I.storage[m]})()}_addListener(m,I){}_removeListener(m,I){}}return w.type="NONE",w})();function H(w,p,m){return`firebase:${w}:${p}:${m}`}class Y{constructor(p,m,I){this.persistence=p,this.auth=m,this.userKey=I;const{config:x,name:O}=this.auth;this.fullUserKey=H(this.userKey,x.apiKey,O),this.fullPersistenceKey=H("persistence",x.apiKey,O),this.boundEventHandler=m._onStorageEvent.bind(m),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(p){return this.persistence._set(this.fullUserKey,p.toJSON())}getCurrentUser(){var p=this;return(0,_.Z)(function*(){const m=yield p.persistence._get(p.fullUserKey);return m?Et._fromJSON(p.auth,m):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(p){var m=this;return(0,_.Z)(function*(){if(m.persistence===p)return;const I=yield m.getCurrentUser();return yield m.removeCurrentUser(),m.persistence=p,I?m.setCurrentUser(I):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(p,m,I="authUser"){return(0,_.Z)(function*(){if(!m.length)return new Y(te(W),p,I);const x=(yield Promise.all(m.map(function(){var vt=(0,_.Z)(function*(Vt){if(yield Vt._isAvailable())return Vt});return function(Vt){return vt.apply(this,arguments)}}()))).filter(vt=>vt);let O=x[0]||te(W);const J=H(I,p.config.apiKey,p.name);let xe=null;for(const vt of m)try{const Vt=yield vt._get(J);if(Vt){const Rn=Et._fromJSON(p,Vt);vt!==O&&(xe=Rn),O=vt;break}}catch(Vt){}const tt=x.filter(vt=>vt._shouldAllowMigration);return O._shouldAllowMigration&&tt.length?(O=tt[0],xe&&(yield O._set(J,xe.toJSON())),yield Promise.all(m.map(function(){var vt=(0,_.Z)(function*(Vt){if(Vt!==O)try{yield Vt._remove(J)}catch(Rn){}});return function(Vt){return vt.apply(this,arguments)}}())),new Y(O,p,I)):new Y(O,p,I)})()}}function $(w){const p=w.toLowerCase();if(p.includes("opera/")||p.includes("opr/")||p.includes("opios/"))return"Opera";if(Le(p))return"IEMobile";if(p.includes("msie")||p.includes("trident/"))return"IE";if(p.includes("edge/"))return"Edge";if(N(p))return"Firefox";if(p.includes("silk/"))return"Silk";if(ut(p))return"Blackberry";if(Mt(p))return"Webos";if(B(p))return"Safari";if((p.includes("chrome/")||ae(p))&&!p.includes("edge/"))return"Chrome";if(et(p))return"Android";{const I=w.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==I?void 0:I.length))return I[1]}return"Other"}function N(w=(0,G.z$)()){return/firefox\//i.test(w)}function B(w=(0,G.z$)()){const p=w.toLowerCase();return p.includes("safari/")&&!p.includes("chrome/")&&!p.includes("crios/")&&!p.includes("android")}function ae(w=(0,G.z$)()){return/crios\//i.test(w)}function Le(w=(0,G.z$)()){return/iemobile/i.test(w)}function et(w=(0,G.z$)()){return/android/i.test(w)}function ut(w=(0,G.z$)()){return/blackberry/i.test(w)}function Mt(w=(0,G.z$)()){return/webos/i.test(w)}function it(w=(0,G.z$)()){return/iphone|ipad|ipod/i.test(w)||/macintosh/i.test(w)&&/mobile/i.test(w)}function on(w=(0,G.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(w)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(w)}function $r(w=(0,G.z$)()){return it(w)||et(w)||Mt(w)||ut(w)||/windows phone/i.test(w)||Le(w)}function vr(w,p=[]){let m;switch(w){case"Browser":m=$((0,G.z$)());break;case"Worker":m=`${$((0,G.z$)())}-${w}`;break;default:m=w}const I=p.length?p.join(","):"FirebaseCore-web";return`${m}/JsCore/${P.SDK_VERSION}/${I}`}class Ca{constructor(p){this.auth=p,this.queue=[]}pushCallback(p,m){const I=O=>new Promise((J,xe)=>{try{J(p(O))}catch(tt){xe(tt)}});I.onAbort=m,this.queue.push(I);const x=this.queue.length-1;return()=>{this.queue[x]=()=>Promise.resolve()}}runMiddleware(p){var m=this;return(0,_.Z)(function*(){var I;if(m.auth.currentUser===p)return;const x=[];try{for(const O of m.queue)yield O(p),O.onAbort&&x.push(O.onAbort)}catch(O){x.reverse();for(const J of x)try{J()}catch(xe){}throw m.auth._errorFactory.create("login-blocked",{originalMessage:null===(I=O)||void 0===I?void 0:I.message})}})()}}class li{constructor(p,m,I){this.app=p,this.heartbeatServiceProvider=m,this.config=I,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jt(this),this.idTokenSubscription=new jt(this),this.beforeStateQueue=new Ca(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=He,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=p.name,this.clientVersion=I.sdkClientVersion}_initializeWithPersistence(p,m){var I=this;return m&&(this._popupRedirectResolver=te(m)),this._initializationPromise=this.queue((0,_.Z)(function*(){var x,O;if(!I._deleted&&(I.persistenceManager=yield Y.create(I,p),!I._deleted)){if(null===(x=I._popupRedirectResolver)||void 0===x?void 0:x._shouldInitProactively)try{yield I._popupRedirectResolver._initialize(I)}catch(J){}yield I.initializeCurrentUser(m),I.lastNotifiedUid=(null===(O=I.currentUser)||void 0===O?void 0:O.uid)||null,!I._deleted&&(I._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var p=this;return(0,_.Z)(function*(){if(p._deleted)return;const m=yield p.assertedPersistence.getCurrentUser();if(p.currentUser||m){if(p.currentUser&&m&&p.currentUser.uid===m.uid)return p._currentUser._assign(m),void(yield p.currentUser.getIdToken());yield p._updateCurrentUser(m,!0)}})()}initializeCurrentUser(p){var m=this;return(0,_.Z)(function*(){var I;const x=yield m.assertedPersistence.getCurrentUser();let O=x,J=!1;if(p&&m.config.authDomain){yield m.getOrInitRedirectPersistenceManager();const xe=null===(I=m.redirectUser)||void 0===I?void 0:I._redirectEventId,tt=null==O?void 0:O._redirectEventId,vt=yield m.tryRedirectSignIn(p);(!xe||xe===tt)&&(null==vt?void 0:vt.user)&&(O=vt.user,J=!0)}if(!O)return m.directlySetCurrentUser(null);if(!O._redirectEventId){if(J)try{yield m.beforeStateQueue.runMiddleware(O)}catch(xe){O=x,m._popupRedirectResolver._overrideRedirectResult(m,()=>Promise.reject(xe))}return O?m.reloadAndSetCurrentUserOrClear(O):m.directlySetCurrentUser(null)}return ne(m._popupRedirectResolver,m,"argument-error"),yield m.getOrInitRedirectPersistenceManager(),m.redirectUser&&m.redirectUser._redirectEventId===O._redirectEventId?m.directlySetCurrentUser(O):m.reloadAndSetCurrentUserOrClear(O)})()}tryRedirectSignIn(p){var m=this;return(0,_.Z)(function*(){let I=null;try{I=yield m._popupRedirectResolver._completeRedirectFn(m,p,!0)}catch(x){yield m._setRedirectUser(null)}return I})()}reloadAndSetCurrentUserOrClear(p){var m=this;return(0,_.Z)(function*(){var I;try{yield Gn(p)}catch(x){if("auth/network-request-failed"!==(null===(I=x)||void 0===I?void 0:I.code))return m.directlySetCurrentUser(null)}return m.directlySetCurrentUser(p)})()}useDeviceLanguage(){this.languageCode=function Ft(){if("undefined"==typeof navigator)return null;const w=navigator;return w.languages&&w.languages[0]||w.language||null}()}_delete(){var p=this;return(0,_.Z)(function*(){p._deleted=!0})()}updateCurrentUser(p){var m=this;return(0,_.Z)(function*(){const I=p?(0,G.m9)(p):null;return I&&ne(I.auth.config.apiKey===m.config.apiKey,m,"invalid-user-token"),m._updateCurrentUser(I&&I._clone(m))})()}_updateCurrentUser(p,m=!1){var I=this;return(0,_.Z)(function*(){if(!I._deleted)return p&&ne(I.tenantId===p.tenantId,I,"tenant-id-mismatch"),m||(yield I.beforeStateQueue.runMiddleware(p)),I.queue((0,_.Z)(function*(){yield I.directlySetCurrentUser(p),I.notifyAuthListeners()}))})()}signOut(){var p=this;return(0,_.Z)(function*(){return yield p.beforeStateQueue.runMiddleware(null),(p.redirectPersistenceManager||p._popupRedirectResolver)&&(yield p._setRedirectUser(null)),p._updateCurrentUser(null,!0)})()}setPersistence(p){var m=this;return this.queue((0,_.Z)(function*(){yield m.assertedPersistence.setPersistence(te(p))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(p){this._errorFactory=new G.LL("auth","Firebase",p())}onAuthStateChanged(p,m,I){return this.registerStateListener(this.authStateSubscription,p,m,I)}beforeAuthStateChanged(p,m){return this.beforeStateQueue.pushCallback(p,m)}onIdTokenChanged(p,m,I){return this.registerStateListener(this.idTokenSubscription,p,m,I)}toJSON(){var p;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(p=this._currentUser)||void 0===p?void 0:p.toJSON()}}_setRedirectUser(p,m){var I=this;return(0,_.Z)(function*(){const x=yield I.getOrInitRedirectPersistenceManager(m);return null===p?x.removeCurrentUser():x.setCurrentUser(p)})()}getOrInitRedirectPersistenceManager(p){var m=this;return(0,_.Z)(function*(){if(!m.redirectPersistenceManager){const I=p&&te(p)||m._popupRedirectResolver;ne(I,m,"argument-error"),m.redirectPersistenceManager=yield Y.create(m,[te(I._redirectPersistence)],"redirectUser"),m.redirectUser=yield m.redirectPersistenceManager.getCurrentUser()}return m.redirectPersistenceManager})()}_redirectUserForId(p){var m=this;return(0,_.Z)(function*(){var I,x;return m._isInitialized&&(yield m.queue((0,_.Z)(function*(){}))),(null===(I=m._currentUser)||void 0===I?void 0:I._redirectEventId)===p?m._currentUser:(null===(x=m.redirectUser)||void 0===x?void 0:x._redirectEventId)===p?m.redirectUser:null})()}_persistUserIfCurrent(p){var m=this;return(0,_.Z)(function*(){if(p===m.currentUser)return m.queue((0,_.Z)(function*(){return m.directlySetCurrentUser(p)}))})()}_notifyListenersIfCurrent(p){p===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var p,m;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const I=null!==(m=null===(p=this.currentUser)||void 0===p?void 0:p.uid)&&void 0!==m?m:null;this.lastNotifiedUid!==I&&(this.lastNotifiedUid=I,this.authStateSubscription.next(this.currentUser))}registerStateListener(p,m,I,x){if(this._deleted)return()=>{};const O="function"==typeof m?m:m.next.bind(m),J=this._isInitialized?Promise.resolve():this._initializationPromise;return ne(J,this,"internal-error"),J.then(()=>O(this.currentUser)),"function"==typeof m?p.addObserver(m,I,x):p.addObserver(m)}directlySetCurrentUser(p){var m=this;return(0,_.Z)(function*(){m.currentUser&&m.currentUser!==p&&m._currentUser._stopProactiveRefresh(),p&&m.isProactiveRefreshEnabled&&p._startProactiveRefresh(),m.currentUser=p,p?yield m.assertedPersistence.setCurrentUser(p):yield m.assertedPersistence.removeCurrentUser()})()}queue(p){return this.operations=this.operations.then(p,p),this.operations}get assertedPersistence(){return ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(p){!p||this.frameworks.includes(p)||(this.frameworks.push(p),this.frameworks.sort(),this.clientVersion=vr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var p=this;return(0,_.Z)(function*(){var m;const I={"X-Client-Version":p.clientVersion};p.app.options.appId&&(I["X-Firebase-gmpid"]=p.app.options.appId);const x=yield null===(m=p.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===m?void 0:m.getHeartbeatsHeader();return x&&(I["X-Firebase-Client"]=x),I})()}}function $e(w){return(0,G.m9)(w)}class jt{constructor(p){this.auth=p,this.observer=null,this.addObserver=(0,G.ne)(m=>this.observer=m)}get next(){return ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function _n(w,p,m){const I=$e(w);ne(I._canInitEmulator,I,"emulator-config-failed"),ne(/^https?:\/\//.test(p),I,"invalid-emulator-scheme");const x=!!(null==m?void 0:m.disableWarnings),O=Xr(p),{host:J,port:xe}=function ws(w){const p=Xr(w),m=/(\/\/)?([^?#/]+)/.exec(w.substr(p.length));if(!m)return{host:"",port:null};const I=m[2].split("@").pop()||"",x=/^(\[[^\]]+\])(:|$)/.exec(I);if(x){const O=x[1];return{host:O,port:Xn(I.substr(O.length+1))}}{const[O,J]=I.split(":");return{host:O,port:Xn(J)}}}(p);I.config.emulator={url:`${O}//${J}${null===xe?"":`:${xe}`}/`},I.settings.appVerificationDisabledForTesting=!0,I.emulatorConfig=Object.freeze({host:J,port:xe,protocol:O.replace(":",""),options:Object.freeze({disableWarnings:x})}),x||function Es(){function w(){const p=document.createElement("p"),m=p.style;p.innerText="Running in emulator mode. Do not use with production credentials.",m.position="fixed",m.width="100%",m.backgroundColor="#ffffff",m.border=".1em solid #000000",m.color="#b50000",m.bottom="0px",m.left="0px",m.margin="0px",m.zIndex="10000",m.textAlign="center",p.classList.add("firebase-emulator-warning"),document.body.appendChild(p)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",w):w())}()}function Xr(w){const p=w.indexOf(":");return p<0?"":w.substr(0,p+1)}function Xn(w){if(!w)return null;const p=Number(w);return isNaN(p)?null:p}class hn{constructor(p,m){this.providerId=p,this.signInMethod=m}toJSON(){return pe("not implemented")}_getIdTokenResponse(p){return pe("not implemented")}_linkToIdToken(p,m){return pe("not implemented")}_getReauthenticationResolver(p){return pe("not implemented")}}function po(w,p){return Wn.apply(this,arguments)}function Wn(){return(Wn=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:resetPassword",$t(w,p))})).apply(this,arguments)}function Pt(w,p){return zo.apply(this,arguments)}function zo(){return(zo=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function Ko(w,p){return Zo.apply(this,arguments)}function Zo(){return(Zo=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:update",$t(w,p))})).apply(this,arguments)}function mr(){return(mr=(0,_.Z)(function*(w,p){return Fn(w,"POST","/v1/accounts:signInWithPassword",$t(w,p))})).apply(this,arguments)}function Ws(w,p){return go.apply(this,arguments)}function go(){return(go=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:sendOobCode",$t(w,p))})).apply(this,arguments)}function Hr(w,p){return gn.apply(this,arguments)}function gn(){return(gn=(0,_.Z)(function*(w,p){return Ws(w,p)})).apply(this,arguments)}function Hc(w,p){return mo.apply(this,arguments)}function mo(){return(mo=(0,_.Z)(function*(w,p){return Ws(w,p)})).apply(this,arguments)}function Ui(w,p){return Di.apply(this,arguments)}function Di(){return(Di=(0,_.Z)(function*(w,p){return Ws(w,p)})).apply(this,arguments)}function Gc(w,p){return Iu.apply(this,arguments)}function Iu(){return(Iu=(0,_.Z)(function*(w,p){return Ws(w,p)})).apply(this,arguments)}function Si(){return(Si=(0,_.Z)(function*(w,p){return Fn(w,"POST","/v1/accounts:signInWithEmailLink",$t(w,p))})).apply(this,arguments)}function Wc(){return(Wc=(0,_.Z)(function*(w,p){return Fn(w,"POST","/v1/accounts:signInWithEmailLink",$t(w,p))})).apply(this,arguments)}class bu extends hn{constructor(p,m,I,x=null){super("password",I),this._email=p,this._password=m,this._tenantId=x}static _fromEmailAndPassword(p,m){return new bu(p,m,"password")}static _fromEmailAndCode(p,m,I=null){return new bu(p,m,"emailLink",I)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(p){const m="string"==typeof p?JSON.parse(p):p;if((null==m?void 0:m.email)&&(null==m?void 0:m.password)){if("password"===m.signInMethod)return this._fromEmailAndPassword(m.email,m.password);if("emailLink"===m.signInMethod)return this._fromEmailAndCode(m.email,m.password,m.tenantId)}return null}_getIdTokenResponse(p){var m=this;return(0,_.Z)(function*(){switch(m.signInMethod){case"password":return function Yo(w,p){return mr.apply(this,arguments)}(p,{returnSecureToken:!0,email:m._email,password:m._password});case"emailLink":return function qs(w,p){return Si.apply(this,arguments)}(p,{email:m._email,oobCode:m._password});default:Ge(p,"internal-error")}})()}_linkToIdToken(p,m){var I=this;return(0,_.Z)(function*(){switch(I.signInMethod){case"password":return Pt(p,{idToken:m,returnSecureToken:!0,email:I._email,password:I._password});case"emailLink":return function jh(w,p){return Wc.apply(this,arguments)}(p,{idToken:m,email:I._email,oobCode:I._password});default:Ge(p,"internal-error")}})()}_getReauthenticationResolver(p){return this._getIdTokenResponse(p)}}function ur(w,p){return qc.apply(this,arguments)}function qc(){return(qc=(0,_.Z)(function*(w,p){return Fn(w,"POST","/v1/accounts:signInWithIdp",$t(w,p))})).apply(this,arguments)}class Is extends hn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(p){const m=new Is(p.providerId,p.signInMethod);return p.idToken||p.accessToken?(p.idToken&&(m.idToken=p.idToken),p.accessToken&&(m.accessToken=p.accessToken),p.nonce&&!p.pendingToken&&(m.nonce=p.nonce),p.pendingToken&&(m.pendingToken=p.pendingToken)):p.oauthToken&&p.oauthTokenSecret?(m.accessToken=p.oauthToken,m.secret=p.oauthTokenSecret):Ge("argument-error"),m}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(p){const m="string"==typeof p?JSON.parse(p):p,{providerId:I,signInMethod:x}=m,O=(0,ce._T)(m,["providerId","signInMethod"]);if(!I||!x)return null;const J=new Is(I,x);return J.idToken=O.idToken||void 0,J.accessToken=O.accessToken||void 0,J.secret=O.secret,J.nonce=O.nonce,J.pendingToken=O.pendingToken||null,J}_getIdTokenResponse(p){return ur(p,this.buildRequest())}_linkToIdToken(p,m){const I=this.buildRequest();return I.idToken=m,ur(p,I)}_getReauthenticationResolver(p){const m=this.buildRequest();return m.autoCreate=!1,ur(p,m)}buildRequest(){const p={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)p.pendingToken=this.pendingToken;else{const m={};this.idToken&&(m.id_token=this.idToken),this.accessToken&&(m.access_token=this.accessToken),this.secret&&(m.oauth_token_secret=this.secret),m.providerId=this.providerId,this.nonce&&!this.pendingToken&&(m.nonce=this.nonce),p.postBody=(0,G.xO)(m)}return p}}function zp(w,p){return zc.apply(this,arguments)}function zc(){return(zc=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:sendVerificationCode",$t(w,p))})).apply(this,arguments)}function Ta(){return(Ta=(0,_.Z)(function*(w,p){return Fn(w,"POST","/v1/accounts:signInWithPhoneNumber",$t(w,p))})).apply(this,arguments)}function Kc(){return(Kc=(0,_.Z)(function*(w,p){const m=yield Fn(w,"POST","/v1/accounts:signInWithPhoneNumber",$t(w,p));if(m.temporaryProof)throw Hn(w,"account-exists-with-different-credential",m);return m})).apply(this,arguments)}const Zp={USER_NOT_FOUND:"user-not-found"};function Zc(){return(Zc=(0,_.Z)(function*(w,p){return Fn(w,"POST","/v1/accounts:signInWithPhoneNumber",$t(w,Object.assign(Object.assign({},p),{operation:"REAUTH"})),Zp)})).apply(this,arguments)}class Xo extends hn{constructor(p){super("phone","phone"),this.params=p}static _fromVerification(p,m){return new Xo({verificationId:p,verificationCode:m})}static _fromTokenResponse(p,m){return new Xo({phoneNumber:p,temporaryProof:m})}_getIdTokenResponse(p){return function Kp(w,p){return Ta.apply(this,arguments)}(p,this._makeVerificationRequest())}_linkToIdToken(p,m){return function Qo(w,p){return Kc.apply(this,arguments)}(p,Object.assign({idToken:m},this._makeVerificationRequest()))}_getReauthenticationResolver(p){return function Yp(w,p){return Zc.apply(this,arguments)}(p,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:p,phoneNumber:m,verificationId:I,verificationCode:x}=this.params;return p&&m?{temporaryProof:p,phoneNumber:m}:{sessionInfo:I,code:x}}toJSON(){const p={providerId:this.providerId};return this.params.phoneNumber&&(p.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(p.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(p.verificationCode=this.params.verificationCode),this.params.verificationId&&(p.verificationId=this.params.verificationId),p}static fromJSON(p){"string"==typeof p&&(p=JSON.parse(p));const{verificationId:m,verificationCode:I,phoneNumber:x,temporaryProof:O}=p;return I||m||x||O?new Xo({verificationId:m,verificationCode:I,phoneNumber:x,temporaryProof:O}):null}}class bs{constructor(p){var m,I,x,O,J,xe;const tt=(0,G.zd)((0,G.pd)(p)),vt=null!==(m=tt.apiKey)&&void 0!==m?m:null,Vt=null!==(I=tt.oobCode)&&void 0!==I?I:null,Rn=function Qp(w){switch(w){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(x=tt.mode)&&void 0!==x?x:null);ne(vt&&Vt&&Rn,"argument-error"),this.apiKey=vt,this.operation=Rn,this.code=Vt,this.continueUrl=null!==(O=tt.continueUrl)&&void 0!==O?O:null,this.languageCode=null!==(J=tt.languageCode)&&void 0!==J?J:null,this.tenantId=null!==(xe=tt.tenantId)&&void 0!==xe?xe:null}static parseLink(p){const m=function $h(w){const p=(0,G.zd)((0,G.pd)(w)).link,m=p?(0,G.zd)((0,G.pd)(p)).deep_link_id:null,I=(0,G.zd)((0,G.pd)(w)).deep_link_id;return(I?(0,G.zd)((0,G.pd)(I)).link:null)||I||m||p||w}(p);try{return new bs(m)}catch(I){return null}}}let Da=(()=>{class w{constructor(){this.providerId=w.PROVIDER_ID}static credential(m,I){return bu._fromEmailAndPassword(m,I)}static credentialWithLink(m,I){const x=bs.parseLink(I);return ne(x,"argument-error"),bu._fromEmailAndCode(m,x.code,x.tenantId)}}return w.PROVIDER_ID="password",w.EMAIL_PASSWORD_SIGN_IN_METHOD="password",w.EMAIL_LINK_SIGN_IN_METHOD="emailLink",w})();class zs{constructor(p){this.providerId=p,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(p){this.defaultLanguageCode=p}setCustomParameters(p){return this.customParameters=p,this}getCustomParameters(){return this.customParameters}}class Ai extends zs{constructor(){super(...arguments),this.scopes=[]}addScope(p){return this.scopes.includes(p)||this.scopes.push(p),this}getScopes(){return[...this.scopes]}}class Jo extends Ai{static credentialFromJSON(p){const m="string"==typeof p?JSON.parse(p):p;return ne("providerId"in m&&"signInMethod"in m,"argument-error"),Is._fromParams(m)}credential(p){return this._credential(Object.assign(Object.assign({},p),{nonce:p.rawNonce}))}_credential(p){return ne(p.idToken||p.accessToken,"argument-error"),Is._fromParams(Object.assign(Object.assign({},p),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(p){return Jo.oauthCredentialFromTaggedObject(p)}static credentialFromError(p){return Jo.oauthCredentialFromTaggedObject(p.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{oauthIdToken:m,oauthAccessToken:I,oauthTokenSecret:x,pendingToken:O,nonce:J,providerId:xe}=p;if(!I&&!x&&!m&&!O||!xe)return null;try{return new Jo(xe)._credential({idToken:m,accessToken:I,nonce:J,pendingToken:O})}catch(tt){return null}}}let Sa=(()=>{class w extends Ai{constructor(){super("facebook.com")}static credential(m){return Is._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.FACEBOOK_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return w.credential(m.oauthAccessToken)}catch(I){return null}}}return w.FACEBOOK_SIGN_IN_METHOD="facebook.com",w.PROVIDER_ID="facebook.com",w})(),Aa=(()=>{class w extends Ai{constructor(){super("google.com"),this.addScope("profile")}static credential(m,I){return Is._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GOOGLE_SIGN_IN_METHOD,idToken:m,accessToken:I})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthIdToken:I,oauthAccessToken:x}=m;if(!I&&!x)return null;try{return w.credential(I,x)}catch(O){return null}}}return w.GOOGLE_SIGN_IN_METHOD="google.com",w.PROVIDER_ID="google.com",w})(),Hh=(()=>{class w extends Ai{constructor(){super("github.com")}static credential(m){return Is._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GITHUB_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return w.credential(m.oauthAccessToken)}catch(I){return null}}}return w.GITHUB_SIGN_IN_METHOD="github.com",w.PROVIDER_ID="github.com",w})();class _o extends hn{constructor(p,m){super(p,p),this.pendingToken=m}_getIdTokenResponse(p){return ur(p,this.buildRequest())}_linkToIdToken(p,m){const I=this.buildRequest();return I.idToken=m,ur(p,I)}_getReauthenticationResolver(p){const m=this.buildRequest();return m.autoCreate=!1,ur(p,m)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(p){const m="string"==typeof p?JSON.parse(p):p,{providerId:I,signInMethod:x,pendingToken:O}=m;return I&&x&&O&&I===x?new _o(I,O):null}static _create(p,m){return new _o(p,m)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Cs extends zs{constructor(p){ne(p.startsWith("saml."),"argument-error"),super(p)}static credentialFromResult(p){return Cs.samlCredentialFromTaggedObject(p)}static credentialFromError(p){return Cs.samlCredentialFromTaggedObject(p.customData||{})}static credentialFromJSON(p){const m=_o.fromJSON(p);return ne(m,"argument-error"),m}static samlCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{pendingToken:m,providerId:I}=p;if(!m||!I)return null;try{return _o._create(I,m)}catch(x){return null}}}let Vi=(()=>{class w extends Ai{constructor(){super("twitter.com")}static credential(m,I){return Is._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.TWITTER_SIGN_IN_METHOD,oauthToken:m,oauthTokenSecret:I})}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthAccessToken:I,oauthTokenSecret:x}=m;if(!I||!x)return null;try{return w.credential(I,x)}catch(O){return null}}}return w.TWITTER_SIGN_IN_METHOD="twitter.com",w.PROVIDER_ID="twitter.com",w})();function Qc(w,p){return Gr.apply(this,arguments)}function Gr(){return(Gr=(0,_.Z)(function*(w,p){return Fn(w,"POST","/v1/accounts:signUp",$t(w,p))})).apply(this,arguments)}class Wr{constructor(p){this.user=p.user,this.providerId=p.providerId,this._tokenResponse=p._tokenResponse,this.operationType=p.operationType}static _fromIdTokenResponse(p,m,I,x=!1){return(0,_.Z)(function*(){const O=yield Et._fromIdTokenResponse(p,I,x),J=Xc(I);return new Wr({user:O,providerId:J,_tokenResponse:I,operationType:m})})()}static _forOperation(p,m,I){return(0,_.Z)(function*(){yield p._updateTokensIfNecessary(I,!0);const x=Xc(I);return new Wr({user:p,providerId:x,_tokenResponse:I,operationType:m})})()}}function Xc(w){return w.providerId?w.providerId:"phoneNumber"in w?"phone":null}function Jc(w){return Cu.apply(this,arguments)}function Cu(){return(Cu=(0,_.Z)(function*(w){var p;const m=$e(w);if(yield m._initializationPromise,null===(p=m.currentUser)||void 0===p?void 0:p.isAnonymous)return new Wr({user:m.currentUser,providerId:null,operationType:"signIn"});const I=yield Qc(m,{returnSecureToken:!0}),x=yield Wr._fromIdTokenResponse(m,"signIn",I,!0);return yield m._updateCurrentUser(x.user),x})).apply(this,arguments)}class Tu extends G.ZR{constructor(p,m,I,x){var O;super(m.code,m.message),this.operationType=I,this.user=x,Object.setPrototypeOf(this,Tu.prototype),this.customData={appName:p.name,tenantId:null!==(O=p.tenantId)&&void 0!==O?O:void 0,_serverResponse:m.customData._serverResponse,operationType:I}}static _fromErrorAndOperation(p,m,I,x){return new Tu(p,m,I,x)}}function Du(w,p,m,I){return("reauthenticate"===p?m._getReauthenticationResolver(w):m._getIdTokenResponse(w)).catch(O=>{throw"auth/multi-factor-auth-required"===O.code?Tu._fromErrorAndOperation(w,O,p,I):O})}function Rl(w){return new Set(w.map(({providerId:p})=>p).filter(p=>!!p))}function Ts(w,p){return Ml.apply(this,arguments)}function Ml(){return(Ml=(0,_.Z)(function*(w,p){const m=(0,G.m9)(w);yield Ks(!0,m,p);const{providerUserInfo:I}=yield kr(m.auth,{idToken:yield m.getIdToken(),deleteProvider:[p]}),x=Rl(I||[]);return m.providerData=m.providerData.filter(O=>x.has(O.providerId)),x.has("phone")||(m.phoneNumber=null),yield m.auth._persistUserIfCurrent(m),m})).apply(this,arguments)}function En(w,p){return xa.apply(this,arguments)}function xa(){return(xa=(0,_.Z)(function*(w,p,m=!1){const I=yield rt(w,p._linkToIdToken(w.auth,yield w.getIdToken()),m);return Wr._forOperation(w,"link",I)})).apply(this,arguments)}function Ks(w,p,m){return mn.apply(this,arguments)}function mn(){return(mn=(0,_.Z)(function*(w,p,m){yield Gn(p);const x=!1===w?"provider-already-linked":"no-such-provider";ne(Rl(p.providerData).has(m)===w,p.auth,x)})).apply(this,arguments)}function Su(w,p){return Ra.apply(this,arguments)}function Ra(){return(Ra=(0,_.Z)(function*(w,p,m=!1){var I;const{auth:x}=w,O="reauthenticate";try{const J=yield rt(w,Du(x,O,p,w),m);ne(J.idToken,x,"internal-error");const xe=Kt(J.idToken);ne(xe,x,"internal-error");const{sub:tt}=xe;return ne(w.uid===tt,x,"user-mismatch"),Wr._forOperation(w,O,J)}catch(J){throw"auth/user-not-found"===(null===(I=J)||void 0===I?void 0:I.code)&&Ge(x,"user-mismatch"),J}})).apply(this,arguments)}function yo(w,p){return wr.apply(this,arguments)}function wr(){return(wr=(0,_.Z)(function*(w,p,m=!1){const I="signIn",x=yield Du(w,I,p),O=yield Wr._fromIdTokenResponse(w,I,x);return m||(yield w._updateCurrentUser(O.user)),O})).apply(this,arguments)}function Au(w,p){return qn.apply(this,arguments)}function qn(){return(qn=(0,_.Z)(function*(w,p){return yo($e(w),p)})).apply(this,arguments)}function Ds(w,p){return Er.apply(this,arguments)}function Er(){return(Er=(0,_.Z)(function*(w,p){const m=(0,G.m9)(w);return yield Ks(!1,m,p.providerId),En(m,p)})).apply(this,arguments)}function ea(w,p){return ss.apply(this,arguments)}function ss(){return(ss=(0,_.Z)(function*(w,p){return Su((0,G.m9)(w),p)})).apply(this,arguments)}function kl(w,p){return ci.apply(this,arguments)}function ci(){return(ci=(0,_.Z)(function*(w,p){return Fn(w,"POST","/v1/accounts:signInWithCustomToken",$t(w,p))})).apply(this,arguments)}function Zs(w,p){return Ys.apply(this,arguments)}function Ys(){return(Ys=(0,_.Z)(function*(w,p){const m=$e(w),I=yield kl(m,{token:p,returnSecureToken:!0}),x=yield Wr._fromIdTokenResponse(m,"signIn",I);return yield m._updateCurrentUser(x.user),x})).apply(this,arguments)}class bt{constructor(p,m){this.factorId=p,this.uid=m.mfaEnrollmentId,this.enrollmentTime=new Date(m.enrolledAt).toUTCString(),this.displayName=m.displayName}static _fromServerResponse(p,m){return"phoneInfo"in m?vo._fromServerResponse(p,m):Ge(p,"internal-error")}}class vo extends bt{constructor(p){super("phone",p),this.phoneNumber=p.phoneInfo}static _fromServerResponse(p,m){return new vo(m)}}function xu(w,p,m){var I;ne((null===(I=m.url)||void 0===I?void 0:I.length)>0,w,"invalid-continue-uri"),ne(void 0===m.dynamicLinkDomain||m.dynamicLinkDomain.length>0,w,"invalid-dynamic-link-domain"),p.continueUrl=m.url,p.dynamicLinkDomain=m.dynamicLinkDomain,p.canHandleCodeInApp=m.handleCodeInApp,m.iOS&&(ne(m.iOS.bundleId.length>0,w,"missing-ios-bundle-id"),p.iOSBundleId=m.iOS.bundleId),m.android&&(ne(m.android.packageName.length>0,w,"missing-android-pkg-name"),p.androidInstallApp=m.android.installApp,p.androidMinimumVersionCode=m.android.minimumVersion,p.androidPackageName=m.android.packageName)}function ed(w,p,m){return Ma.apply(this,arguments)}function Ma(){return(Ma=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w),x={requestType:"PASSWORD_RESET",email:p};m&&xu(I,x,m),yield Hc(I,x)})).apply(this,arguments)}function td(w,p,m){return ta.apply(this,arguments)}function ta(){return(ta=(0,_.Z)(function*(w,p,m){yield po((0,G.m9)(w),{oobCode:p,newPassword:m})})).apply(this,arguments)}function Gh(w,p){return Qs.apply(this,arguments)}function Qs(){return(Qs=(0,_.Z)(function*(w,p){yield Ko((0,G.m9)(w),{oobCode:p})})).apply(this,arguments)}function Ne(w,p){return Wt.apply(this,arguments)}function Wt(){return(Wt=(0,_.Z)(function*(w,p){const m=(0,G.m9)(w),I=yield po(m,{oobCode:p}),x=I.requestType;switch(ne(x,m,"internal-error"),x){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ne(I.newEmail,m,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ne(I.mfaInfo,m,"internal-error");default:ne(I.email,m,"internal-error")}let O=null;return I.mfaInfo&&(O=bt._fromServerResponse($e(m),I.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.newEmail:I.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.email:I.newEmail)||null,multiFactorInfo:O},operation:x}})).apply(this,arguments)}function Ru(w,p){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,_.Z)(function*(w,p){const{data:m}=yield Ne((0,G.m9)(w),p);return m.email})).apply(this,arguments)}function nd(w,p,m){return Ss.apply(this,arguments)}function Ss(){return(Ss=(0,_.Z)(function*(w,p,m){const I=$e(w),x=yield Qc(I,{returnSecureToken:!0,email:p,password:m}),O=yield Wr._fromIdTokenResponse(I,"signIn",x);return yield I._updateCurrentUser(O.user),O})).apply(this,arguments)}function os(w,p,m){return Au((0,G.m9)(w),Da.credential(p,m))}function Nl(w,p,m){return ka.apply(this,arguments)}function ka(){return(ka=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w),x={requestType:"EMAIL_SIGNIN",email:p};ne(m.handleCodeInApp,I,"argument-error"),m&&xu(I,x,m),yield Ui(I,x)})).apply(this,arguments)}function Wh(w,p){const m=bs.parseLink(p);return"EMAIL_SIGNIN"===(null==m?void 0:m.operation)}function rd(w,p,m){return id.apply(this,arguments)}function id(){return(id=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w),x=Da.credentialWithLink(p,m||de());return ne(x._tenantId===(I.tenantId||null),I,"tenant-id-mismatch"),Au(I,x)})).apply(this,arguments)}function wo(w,p){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:createAuthUri",$t(w,p))})).apply(this,arguments)}function as(w,p){return na.apply(this,arguments)}function na(){return(na=(0,_.Z)(function*(w,p){const I={identifier:p,continueUri:Fe()?de():"http://localhost"},{signinMethods:x}=yield wo((0,G.m9)(w),I);return x||[]})).apply(this,arguments)}function ra(w,p){return di.apply(this,arguments)}function di(){return(di=(0,_.Z)(function*(w,p){const m=(0,G.m9)(w),x={requestType:"VERIFY_EMAIL",idToken:yield w.getIdToken()};p&&xu(m.auth,x,p);const{email:O}=yield Hr(m.auth,x);O!==w.email&&(yield w.reload())})).apply(this,arguments)}function qh(w,p,m){return ia.apply(this,arguments)}function ia(){return(ia=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w),O={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield w.getIdToken(),newEmail:p};m&&xu(I.auth,O,m);const{email:J}=yield Gc(I.auth,O);J!==w.email&&(yield w.reload())})).apply(this,arguments)}function sd(w,p){return Na.apply(this,arguments)}function Na(){return(Na=(0,_.Z)(function*(w,p){return Yt(w,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function Pl(w,p){return sa.apply(this,arguments)}function sa(){return(sa=(0,_.Z)(function*(w,{displayName:p,photoURL:m}){if(void 0===p&&void 0===m)return;const I=(0,G.m9)(w),O={idToken:yield I.getIdToken(),displayName:p,photoUrl:m,returnSecureToken:!0},J=yield rt(I,sd(I.auth,O));I.displayName=J.displayName||null,I.photoURL=J.photoUrl||null;const xe=I.providerData.find(({providerId:tt})=>"password"===tt);xe&&(xe.displayName=I.displayName,xe.photoURL=I.photoURL),yield I._updateTokensIfNecessary(J)})).apply(this,arguments)}function od(w,p){return Ol((0,G.m9)(w),p,null)}function ad(w,p){return Ol((0,G.m9)(w),null,p)}function Ol(w,p,m){return Pa.apply(this,arguments)}function Pa(){return(Pa=(0,_.Z)(function*(w,p,m){const{auth:I}=w,O={idToken:yield w.getIdToken(),returnSecureToken:!0};p&&(O.email=p),m&&(O.password=m);const J=yield rt(w,Pt(I,O));yield w._updateTokensIfNecessary(J,!0)})).apply(this,arguments)}class Eo{constructor(p,m,I={}){this.isNewUser=p,this.providerId=m,this.profile=I}}class ud extends Eo{constructor(p,m,I,x){super(p,m,I),this.username=x}}class zh extends Eo{constructor(p,m){super(p,"facebook.com",m)}}class Mu extends ud{constructor(p,m){super(p,"github.com",m,"string"==typeof(null==m?void 0:m.login)?null==m?void 0:m.login:null)}}class hi extends Eo{constructor(p,m){super(p,"google.com",m)}}class Kh extends ud{constructor(p,m,I){super(p,"twitter.com",m,I)}}function Ll(w){const{user:p,_tokenResponse:m}=w;return p.isAnonymous&&!m?{providerId:null,isNewUser:!1,profile:null}:function Oa(w){var p,m;if(!w)return null;const{providerId:I}=w,x=w.rawUserInfo?JSON.parse(w.rawUserInfo):{},O=w.isNewUser||"identitytoolkit#SignupNewUserResponse"===w.kind;if(!I&&(null==w?void 0:w.idToken)){const J=null===(m=null===(p=Kt(w.idToken))||void 0===p?void 0:p.firebase)||void 0===m?void 0:m.sign_in_provider;if(J)return new Eo(O,"anonymous"!==J&&"custom"!==J?J:null)}if(!I)return null;switch(I){case"facebook.com":return new zh(O,x);case"github.com":return new Mu(O,x);case"google.com":return new hi(O,x);case"twitter.com":return new Kh(O,x,w.screenName||null);case"custom":case"anonymous":return new Eo(O,null);default:return new Eo(O,I,x)}}(m)}class As{constructor(p,m,I){this.type=p,this.credential=m,this.auth=I}static _fromIdtoken(p,m){return new As("enroll",p,m)}static _fromMfaPendingCredential(p){return new As("signin",p)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(p){var m,I;if(null==p?void 0:p.multiFactorSession){if(null===(m=p.multiFactorSession)||void 0===m?void 0:m.pendingCredential)return As._fromMfaPendingCredential(p.multiFactorSession.pendingCredential);if(null===(I=p.multiFactorSession)||void 0===I?void 0:I.idToken)return As._fromIdtoken(p.multiFactorSession.idToken)}return null}}class La{constructor(p,m,I){this.session=p,this.hints=m,this.signInResolver=I}static _fromError(p,m){const I=$e(p),x=m.customData._serverResponse,O=(x.mfaInfo||[]).map(xe=>bt._fromServerResponse(I,xe));ne(x.mfaPendingCredential,I,"internal-error");const J=As._fromMfaPendingCredential(x.mfaPendingCredential);return new La(J,O,function(){var xe=(0,_.Z)(function*(tt){const vt=yield tt._process(I,J);delete x.mfaInfo,delete x.mfaPendingCredential;const Vt=Object.assign(Object.assign({},x),{idToken:vt.idToken,refreshToken:vt.refreshToken});switch(m.operationType){case"signIn":const Rn=yield Wr._fromIdTokenResponse(I,m.operationType,Vt);return yield I._updateCurrentUser(Rn.user),Rn;case"reauthenticate":return ne(m.user,I,"internal-error"),Wr._forOperation(m.user,m.operationType,Vt);default:Ge(I,"internal-error")}});return function(tt){return xe.apply(this,arguments)}}())}resolveSignIn(p){var m=this;return(0,_.Z)(function*(){return m.signInResolver(p)})()}}function Fa(w,p){var m;const I=(0,G.m9)(w),x=p;return ne(p.customData.operationType,I,"argument-error"),ne(null===(m=x.customData._serverResponse)||void 0===m?void 0:m.mfaPendingCredential,I,"argument-error"),La._fromError(I,x)}function _r(w,p){return Yt(w,"POST","/v2/accounts/mfaEnrollment:start",$t(w,p))}class xs{constructor(p){this.user=p,this.enrolledFactors=[],p._onReload(m=>{m.mfaInfo&&(this.enrolledFactors=m.mfaInfo.map(I=>bt._fromServerResponse(p.auth,I)))})}static _fromUser(p){return new xs(p)}getSession(){var p=this;return(0,_.Z)(function*(){return As._fromIdtoken(yield p.user.getIdToken(),p.user.auth)})()}enroll(p,m){var I=this;return(0,_.Z)(function*(){const x=p,O=yield I.getSession(),J=yield rt(I.user,x._process(I.user.auth,O,m));return yield I.user._updateTokensIfNecessary(J),I.user.reload()})()}unenroll(p){var m=this;return(0,_.Z)(function*(){var I;const x="string"==typeof p?p:p.uid,O=yield m.user.getIdToken(),J=yield rt(m.user,function eg(w,p){return Yt(w,"POST","/v2/accounts/mfaEnrollment:withdraw",$t(w,p))}(m.user.auth,{idToken:O,mfaEnrollmentId:x}));m.enrolledFactors=m.enrolledFactors.filter(({uid:xe})=>xe!==x),yield m.user._updateTokensIfNecessary(J);try{yield m.user.reload()}catch(xe){if("auth/user-token-expired"!==(null===(I=xe)||void 0===I?void 0:I.code))throw xe}})()}}const oa=new WeakMap;function hd(w){const p=(0,G.m9)(w);return oa.has(p)||oa.set(p,xs._fromUser(p)),oa.get(p)}const Fl="__sak";class Io{constructor(p,m){this.storageRetriever=p,this.type=m}_isAvailable(){try{return this.storage?(this.storage.setItem(Fl,"1"),this.storage.removeItem(Fl),Promise.resolve(!0)):Promise.resolve(!1)}catch(p){return Promise.resolve(!1)}}_set(p,m){return this.storage.setItem(p,JSON.stringify(m)),Promise.resolve()}_get(p){const m=this.storage.getItem(p);return Promise.resolve(m?JSON.parse(m):null)}_remove(p){return this.storage.removeItem(p),Promise.resolve()}get storage(){return this.storageRetriever()}}const st=(()=>{class w extends Io{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(m,I)=>this.onStorageEvent(m,I),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Ul(){const w=(0,G.z$)();return B(w)||it(w)}()&&function is(){try{return!(!window||window===window.top)}catch(w){return!1}}(),this.fallbackToPolling=$r(),this._shouldAllowMigration=!0}forAllChangedKeys(m){for(const I of Object.keys(this.listeners)){const x=this.storage.getItem(I),O=this.localCache[I];x!==O&&m(I,O,x)}}onStorageEvent(m,I=!1){if(!m.key)return void this.forAllChangedKeys((xe,tt,vt)=>{this.notifyListeners(xe,vt)});const x=m.key;if(I?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const xe=this.storage.getItem(x);if(m.newValue!==xe)null!==m.newValue?this.storage.setItem(x,m.newValue):this.storage.removeItem(x);else if(this.localCache[x]===m.newValue&&!I)return}const O=()=>{const xe=this.storage.getItem(x);!I&&this.localCache[x]===xe||this.notifyListeners(x,xe)},J=this.storage.getItem(x);!function Ut(){return(0,G.w1)()&&10===document.documentMode}()||J===m.newValue||m.newValue===m.oldValue?O():setTimeout(O,10)}notifyListeners(m,I){this.localCache[m]=I;const x=this.listeners[m];if(x)for(const O of Array.from(x))O(I&&JSON.parse(I))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((m,I,x)=>{this.onStorageEvent(new StorageEvent("storage",{key:m,oldValue:I,newValue:x}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(m,I){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[m]||(this.listeners[m]=new Set,this.localCache[m]=this.storage.getItem(m)),this.listeners[m].add(I)}_removeListener(m,I){this.listeners[m]&&(this.listeners[m].delete(I),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(m,I){var x=()=>super._set,O=this;return(0,_.Z)(function*(){yield x().call(O,m,I),O.localCache[m]=JSON.stringify(I)})()}_get(m){var I=()=>super._get,x=this;return(0,_.Z)(function*(){const O=yield I().call(x,m);return x.localCache[m]=JSON.stringify(O),O})()}_remove(m){var I=()=>super._remove,x=this;return(0,_.Z)(function*(){yield I().call(x,m),delete x.localCache[m]})()}}return w.type="LOCAL",w})(),Jr=(()=>{class w extends Io{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(m,I){}_removeListener(m,I){}}return w.type="SESSION",w})();let Ua=(()=>{class w{constructor(m){this.eventTarget=m,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(m){const I=this.receivers.find(O=>O.isListeningto(m));if(I)return I;const x=new w(m);return this.receivers.push(x),x}isListeningto(m){return this.eventTarget===m}handleEvent(m){var I=this;return(0,_.Z)(function*(){const x=m,{eventId:O,eventType:J,data:xe}=x.data,tt=I.handlersMap[J];if(!(null==tt?void 0:tt.size))return;x.ports[0].postMessage({status:"ack",eventId:O,eventType:J});const vt=Array.from(tt).map(function(){var Rn=(0,_.Z)(function*(Wi){return Wi(x.origin,xe)});return function(Wi){return Rn.apply(this,arguments)}}()),Vt=yield function xi(w){return Promise.all(w.map(function(){var p=(0,_.Z)(function*(m){try{return{fulfilled:!0,value:yield m}}catch(I){return{fulfilled:!1,reason:I}}});return function(m){return p.apply(this,arguments)}}()))}(vt);x.ports[0].postMessage({status:"done",eventId:O,eventType:J,response:Vt})})()}_subscribe(m,I){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[m]||(this.handlersMap[m]=new Set),this.handlersMap[m].add(I)}_unsubscribe(m,I){this.handlersMap[m]&&I&&this.handlersMap[m].delete(I),(!I||0===this.handlersMap[m].size)&&delete this.handlersMap[m],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return w.receivers=[],w})();function aa(w="",p=10){let m="";for(let I=0;I<p;I++)m+=Math.floor(10*Math.random());return w+m}class fd{constructor(p){this.target=p,this.handlers=new Set}removeMessageHandler(p){p.messageChannel&&(p.messageChannel.port1.removeEventListener("message",p.onMessage),p.messageChannel.port1.close()),this.handlers.delete(p)}_send(p,m,I=50){var x=this;return(0,_.Z)(function*(){const O="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!O)throw new Error("connection_unavailable");let J,xe;return new Promise((tt,vt)=>{const Vt=aa("",20);O.port1.start();const Rn=setTimeout(()=>{vt(new Error("unsupported_event"))},I);xe={messageChannel:O,onMessage(Wi){const Ro=Wi;if(Ro.data.eventId===Vt)switch(Ro.data.status){case"ack":clearTimeout(Rn),J=setTimeout(()=>{vt(new Error("timeout"))},3e3);break;case"done":clearTimeout(J),tt(Ro.data.response);break;default:clearTimeout(Rn),clearTimeout(J),vt(new Error("invalid_response"))}}},x.handlers.add(xe),O.port1.addEventListener("message",xe.onMessage),x.target.postMessage({eventType:p,eventId:Vt,data:m},[O.port2])}).finally(()=>{xe&&x.removeMessageHandler(xe)})})()}}function In(){return window}function ls(){return void 0!==In().WorkerGlobalScope&&"function"==typeof In().importScripts}function Ct(){return(Ct=(0,_.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(w){return null}})).apply(this,arguments)}const Vl="firebaseLocalStorageDb",zn="firebaseLocalStorage",Js="fbase_key";class bo{constructor(p){this.request=p}toPromise(){return new Promise((p,m)=>{this.request.addEventListener("success",()=>{p(this.request.result)}),this.request.addEventListener("error",()=>{m(this.request.error)})})}}function eo(w,p){return w.transaction([zn],p?"readwrite":"readonly").objectStore(zn)}function cs(){const w=indexedDB.open(Vl,1);return new Promise((p,m)=>{w.addEventListener("error",()=>{m(w.error)}),w.addEventListener("upgradeneeded",()=>{const I=w.result;try{I.createObjectStore(zn,{keyPath:Js})}catch(x){m(x)}}),w.addEventListener("success",(0,_.Z)(function*(){const I=w.result;I.objectStoreNames.contains(zn)?p(I):(I.close(),yield function Va(){const w=indexedDB.deleteDatabase(Vl);return new bo(w).toPromise()}(),p(yield cs()))}))})}function Ba(w,p,m){return ua.apply(this,arguments)}function ua(){return(ua=(0,_.Z)(function*(w,p,m){const I=eo(w,!0).put({[Js]:p,value:m});return new bo(I).toPromise()})).apply(this,arguments)}function Ms(){return(Ms=(0,_.Z)(function*(w,p){const m=eo(w,!1).get(p),I=yield new bo(m).toPromise();return void 0===I?null:I.value})).apply(this,arguments)}function $a(w,p){const m=eo(w,!0).delete(p);return new bo(m).toPromise()}const ei=(()=>{class w{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var m=this;return(0,_.Z)(function*(){return m.db||(m.db=yield cs()),m.db})()}_withRetries(m){var I=this;return(0,_.Z)(function*(){let x=0;for(;;)try{const O=yield I._openDb();return yield m(O)}catch(O){if(x++>3)throw O;I.db&&(I.db.close(),I.db=void 0)}})()}initializeServiceWorkerMessaging(){var m=this;return(0,_.Z)(function*(){return ls()?m.initializeReceiver():m.initializeSender()})()}initializeReceiver(){var m=this;return(0,_.Z)(function*(){m.receiver=Ua._getInstance(function pd(){return ls()?self:null}()),m.receiver._subscribe("keyChanged",function(){var I=(0,_.Z)(function*(x,O){return{keyProcessed:(yield m._poll()).includes(O.key)}});return function(x,O){return I.apply(this,arguments)}}()),m.receiver._subscribe("ping",function(){var I=(0,_.Z)(function*(x,O){return["keyChanged"]});return function(x,O){return I.apply(this,arguments)}}())})()}initializeSender(){var m=this;return(0,_.Z)(function*(){var I,x;if(m.activeServiceWorker=yield function Rs(){return Ct.apply(this,arguments)}(),!m.activeServiceWorker)return;m.sender=new fd(m.activeServiceWorker);const O=yield m.sender._send("ping",{},800);!O||(null===(I=O[0])||void 0===I?void 0:I.fulfilled)&&(null===(x=O[0])||void 0===x?void 0:x.value.includes("keyChanged"))&&(m.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(m){var I=this;return(0,_.Z)(function*(){if(I.sender&&I.activeServiceWorker&&function ng(){var w;return(null===(w=null==navigator?void 0:navigator.serviceWorker)||void 0===w?void 0:w.controller)||null}()===I.activeServiceWorker)try{yield I.sender._send("keyChanged",{key:m},I.serviceWorkerReceiverAvailable?800:50)}catch(x){}})()}_isAvailable(){return(0,_.Z)(function*(){try{if(!indexedDB)return!1;const m=yield cs();return yield Ba(m,Fl,"1"),yield $a(m,Fl),!0}catch(m){}return!1})()}_withPendingWrite(m){var I=this;return(0,_.Z)(function*(){I.pendingWrites++;try{yield m()}finally{I.pendingWrites--}})()}_set(m,I){var x=this;return(0,_.Z)(function*(){return x._withPendingWrite((0,_.Z)(function*(){return yield x._withRetries(O=>Ba(O,m,I)),x.localCache[m]=I,x.notifyServiceWorker(m)}))})()}_get(m){var I=this;return(0,_.Z)(function*(){const x=yield I._withRetries(O=>function ja(w,p){return Ms.apply(this,arguments)}(O,m));return I.localCache[m]=x,x})()}_remove(m){var I=this;return(0,_.Z)(function*(){return I._withPendingWrite((0,_.Z)(function*(){return yield I._withRetries(x=>$a(x,m)),delete I.localCache[m],I.notifyServiceWorker(m)}))})()}_poll(){var m=this;return(0,_.Z)(function*(){const I=yield m._withRetries(J=>{const xe=eo(J,!1).getAll();return new bo(xe).toPromise()});if(!I)return[];if(0!==m.pendingWrites)return[];const x=[],O=new Set;for(const{fbase_key:J,value:xe}of I)O.add(J),JSON.stringify(m.localCache[J])!==JSON.stringify(xe)&&(m.notifyListeners(J,xe),x.push(J));for(const J of Object.keys(m.localCache))m.localCache[J]&&!O.has(J)&&(m.notifyListeners(J,null),x.push(J));return x})()}notifyListeners(m,I){this.localCache[m]=I;const x=this.listeners[m];if(x)for(const O of Array.from(x))O(I)}startPolling(){var m=this;this.stopPolling(),this.pollTimer=setInterval((0,_.Z)(function*(){return m._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(m,I){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[m]||(this.listeners[m]=new Set,this._get(m)),this.listeners[m].add(I)}_removeListener(m,I){this.listeners[m]&&(this.listeners[m].delete(I),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return w.type="LOCAL",w})();function gd(w,p){return Yt(w,"POST","/v2/accounts/mfaSignIn:start",$t(w,p))}function Or(){return(Or=(0,_.Z)(function*(w){return(yield Yt(w,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Co(w){return new Promise((p,m)=>{const I=document.createElement("script");I.setAttribute("src",w),I.onload=p,I.onerror=x=>{const O=Pe("internal-error");O.customData=x,m(O)},I.type="text/javascript",I.charset="UTF-8",function lr(){var w,p;return null!==(p=null===(w=document.getElementsByTagName("head"))||void 0===w?void 0:w[0])&&void 0!==p?p:document}().appendChild(I)})}function ds(w){return`__${w}${Math.floor(1e6*Math.random())}`}const xn=1e12;class Bi{constructor(p){this.auth=p,this.counter=xn,this._widgets=new Map}render(p,m){const I=this.counter;return this._widgets.set(I,new br(p,this.auth.name,m||{})),this.counter++,I}reset(p){var m;const I=p||xn;null===(m=this._widgets.get(I))||void 0===m||m.delete(),this._widgets.delete(I)}getResponse(p){var m;return(null===(m=this._widgets.get(p||xn))||void 0===m?void 0:m.getResponse())||""}execute(p){var m=this;return(0,_.Z)(function*(){var I;return null===(I=m._widgets.get(p||xn))||void 0===I||I.execute(),""})()}}class br{constructor(p,m,I){this.params=I,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const x="string"==typeof p?document.getElementById(p):p;ne(x,"argument-error",{appName:m}),this.container=x,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function hs(w){const p=[],m="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let I=0;I<w;I++)p.push(m.charAt(Math.floor(Math.random()*m.length)));return p.join("")}(50);const{callback:p,"expired-callback":m}=this.params;if(p)try{p(this.responseToken)}catch(I){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,m)try{m()}catch(I){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Ou=ds("rcb"),Qh=new Ze(3e4,6e4);class md{constructor(){var p;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(p=In().grecaptcha)||void 0===p?void 0:p.render)}load(p,m=""){return ne(function _d(w){return w.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(w)}(m),p,"argument-error"),this.shouldResolveImmediately(m)?Promise.resolve(In().grecaptcha):new Promise((I,x)=>{const O=In().setTimeout(()=>{x(Pe(p,"network-request-failed"))},Qh.get());In()[Ou]=()=>{In().clearTimeout(O),delete In()[Ou];const xe=In().grecaptcha;if(!xe)return void x(Pe(p,"internal-error"));const tt=xe.render;xe.render=(vt,Vt)=>{const Rn=tt(vt,Vt);return this.counter++,Rn},this.hostLanguage=m,I(xe)},Co(`https://www.google.com/recaptcha/api.js??${(0,G.xO)({onload:Ou,render:"explicit",hl:m})}`).catch(()=>{clearTimeout(O),x(Pe(p,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(p){var m;return!!(null===(m=In().grecaptcha)||void 0===m?void 0:m.render)&&(p===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Ga{load(p){return(0,_.Z)(function*(){return new Bi(p)})()}clearedOneInstance(){}}const Ri="recaptcha",L_={theme:"light",type:"image"};class Do{constructor(p,m=Object.assign({},L_),I){this.parameters=m,this.type=Ri,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=$e(I),this.isInvisible="invisible"===this.parameters.size,ne("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const x="string"==typeof p?document.getElementById(p):p;ne(x,this.auth,"argument-error"),this.container=x,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ga:new md,this.validateStartingState()}verify(){var p=this;return(0,_.Z)(function*(){p.assertNotDestroyed();const m=yield p.render(),I=p.getAssertedRecaptcha();return I.getResponse(m)||new Promise(O=>{const J=xe=>{!xe||(p.tokenChangeListeners.delete(J),O(xe))};p.tokenChangeListeners.add(J),p.isInvisible&&I.execute(m)})})()}render(){try{this.assertNotDestroyed()}catch(p){return Promise.reject(p)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(p=>{throw this.renderPromise=null,p})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(p=>{this.container.removeChild(p)})}validateStartingState(){ne(!this.parameters.sitekey,this.auth,"argument-error"),ne(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ne("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(p){return m=>{if(this.tokenChangeListeners.forEach(I=>I(m)),"function"==typeof p)p(m);else if("string"==typeof p){const I=In()[p];"function"==typeof I&&I(m)}}}assertNotDestroyed(){ne(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var p=this;return(0,_.Z)(function*(){if(yield p.init(),!p.widgetId){let m=p.container;if(!p.isInvisible){const I=document.createElement("div");m.appendChild(I),m=I}p.widgetId=p.getAssertedRecaptcha().render(m,p.parameters)}return p.widgetId})()}init(){var p=this;return(0,_.Z)(function*(){ne(Fe()&&!ls(),p.auth,"internal-error"),yield function Xh(){let w=null;return new Promise(p=>{"complete"!==document.readyState?(w=()=>p(),window.addEventListener("load",w)):p()}).catch(p=>{throw w&&window.removeEventListener("load",w),p})}(),p.recaptcha=yield p._recaptchaLoader.load(p.auth,p.auth.languageCode||void 0);const m=yield function jl(w){return Or.apply(this,arguments)}(p.auth);ne(m,p.auth,"internal-error"),p.parameters.sitekey=m})()}getAssertedRecaptcha(){return ne(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class ji{constructor(p,m){this.verificationId=p,this.onConfirmation=m}confirm(p){const m=Xo._fromVerification(this.verificationId,p);return this.onConfirmation(m)}}function rg(w,p,m){return Vn.apply(this,arguments)}function Vn(){return(Vn=(0,_.Z)(function*(w,p,m){const I=$e(w),x=yield qr(I,p,(0,G.m9)(m));return new ji(x,O=>Au(I,O))})).apply(this,arguments)}function Lu(w,p,m){return So.apply(this,arguments)}function So(){return(So=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w);yield Ks(!1,I,"phone");const x=yield qr(I.auth,p,(0,G.m9)(m));return new ji(x,O=>Ds(I,O))})).apply(this,arguments)}function ig(w,p,m){return $l.apply(this,arguments)}function $l(){return($l=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w),x=yield qr(I.auth,p,(0,G.m9)(m));return new ji(x,O=>ea(I,O))})).apply(this,arguments)}function qr(w,p,m){return pi.apply(this,arguments)}function pi(){return(pi=(0,_.Z)(function*(w,p,m){var I;const x=yield m.verify();try{let O;if(ne("string"==typeof x,w,"argument-error"),ne(m.type===Ri,w,"argument-error"),O="string"==typeof p?{phoneNumber:p}:p,"session"in O){const J=O.session;if("phoneNumber"in O)return ne("enroll"===J.type,w,"internal-error"),(yield _r(w,{idToken:J.credential,phoneEnrollmentInfo:{phoneNumber:O.phoneNumber,recaptchaToken:x}})).phoneSessionInfo.sessionInfo;{ne("signin"===J.type,w,"internal-error");const xe=(null===(I=O.multiFactorHint)||void 0===I?void 0:I.uid)||O.multiFactorUid;return ne(xe,w,"missing-multi-factor-info"),(yield gd(w,{mfaPendingCredential:J.credential,mfaEnrollmentId:xe,phoneSignInInfo:{recaptchaToken:x}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:J}=yield zp(w,{phoneNumber:O.phoneNumber,recaptchaToken:x});return J}}finally{m._reset()}})).apply(this,arguments)}function Hl(w,p){return Wa.apply(this,arguments)}function Wa(){return(Wa=(0,_.Z)(function*(w,p){yield En((0,G.m9)(w),p)})).apply(this,arguments)}let qa=(()=>{class w{constructor(m){this.providerId=w.PROVIDER_ID,this.auth=$e(m)}verifyPhoneNumber(m,I){return qr(this.auth,m,(0,G.m9)(I))}static credential(m,I){return Xo._fromVerification(m,I)}static credentialFromResult(m){return w.credentialFromTaggedObject(m)}static credentialFromError(m){return w.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{phoneNumber:I,temporaryProof:x}=m;return I&&x?Xo._fromTokenResponse(I,x):null}}return w.PROVIDER_ID="phone",w.PHONE_SIGN_IN_METHOD="phone",w})();function to(w,p){return p?te(p):(ne(w._popupRedirectResolver,w,"argument-error"),w._popupRedirectResolver)}class Fu extends hn{constructor(p){super("custom","custom"),this.params=p}_getIdTokenResponse(p){return ur(p,this._buildIdpRequest())}_linkToIdToken(p,m){return ur(p,this._buildIdpRequest(m))}_getReauthenticationResolver(p){return ur(p,this._buildIdpRequest())}_buildIdpRequest(p){const m={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return p&&(m.idToken=p),m}}function yd(w){return yo(w.auth,new Fu(w),w.bypassAuthState)}function qt(w){const{auth:p,user:m}=w;return ne(m,p,"internal-error"),Su(m,new Fu(w),w.bypassAuthState)}function vd(w){return $i.apply(this,arguments)}function $i(){return($i=(0,_.Z)(function*(w){const{auth:p,user:m}=w;return ne(m,p,"internal-error"),En(m,new Fu(w),w.bypassAuthState)})).apply(this,arguments)}class Cr{constructor(p,m,I,x,O=!1){this.auth=p,this.resolver=I,this.user=x,this.bypassAuthState=O,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(m)?m:[m]}execute(){var p=this;return new Promise(function(){var m=(0,_.Z)(function*(I,x){p.pendingPromise={resolve:I,reject:x};try{p.eventManager=yield p.resolver._initialize(p.auth),yield p.onExecution(),p.eventManager.registerConsumer(p)}catch(O){p.reject(O)}});return function(I,x){return m.apply(this,arguments)}}())}onAuthEvent(p){var m=this;return(0,_.Z)(function*(){const{urlResponse:I,sessionId:x,postBody:O,tenantId:J,error:xe,type:tt}=p;if(xe)return void m.reject(xe);const vt={auth:m.auth,requestUri:I,sessionId:x,tenantId:J||void 0,postBody:O||void 0,user:m.user,bypassAuthState:m.bypassAuthState};try{m.resolve(yield m.getIdpTask(tt)(vt))}catch(Vt){m.reject(Vt)}})()}onError(p){this.reject(p)}getIdpTask(p){switch(p){case"signInViaPopup":case"signInViaRedirect":return yd;case"linkViaPopup":case"linkViaRedirect":return vd;case"reauthViaPopup":case"reauthViaRedirect":return qt;default:Ge(this.auth,"internal-error")}}resolve(p){Ee(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(p),this.unregisterAndCleanUp()}reject(p){Ee(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(p),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ao=new Ze(2e3,1e4);function no(w,p,m){return Uu.apply(this,arguments)}function Uu(){return(Uu=(0,_.Z)(function*(w,p,m){const I=$e(w);Te(w,p,zs);const x=to(I,m);return new Bu(I,"signInViaPopup",p,x).executeNotNull()})).apply(this,arguments)}function Vu(w,p,m){return Hi.apply(this,arguments)}function Hi(){return(Hi=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w);Te(I.auth,p,zs);const x=to(I.auth,m);return new Bu(I.auth,"reauthViaPopup",p,x,I).executeNotNull()})).apply(this,arguments)}function Jh(w,p,m){return Gl.apply(this,arguments)}function Gl(){return(Gl=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w);Te(I.auth,p,zs);const x=to(I.auth,m);return new Bu(I.auth,"linkViaPopup",p,x,I).executeNotNull()})).apply(this,arguments)}let Bu=(()=>{class w extends Cr{constructor(m,I,x,O,J){super(m,I,O,J),this.provider=x,this.authWindow=null,this.pollId=null,w.currentPopupAction&&w.currentPopupAction.cancel(),w.currentPopupAction=this}executeNotNull(){var m=this;return(0,_.Z)(function*(){const I=yield m.execute();return ne(I,m.auth,"internal-error"),I})()}onExecution(){var m=this;return(0,_.Z)(function*(){Ee(1===m.filter.length,"Popup operations only handle one event");const I=aa();m.authWindow=yield m.resolver._openPopup(m.auth,m.provider,m.filter[0],I),m.authWindow.associatedEvent=I,m.resolver._originValidation(m.auth).catch(x=>{m.reject(x)}),m.resolver._isIframeWebStorageSupported(m.auth,x=>{x||m.reject(Pe(m.auth,"web-storage-unsupported"))}),m.pollUserCancellation()})()}get eventId(){var m;return(null===(m=this.authWindow)||void 0===m?void 0:m.associatedEvent)||null}cancel(){this.reject(Pe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,w.currentPopupAction=null}pollUserCancellation(){const m=()=>{var I,x;this.pollId=(null===(x=null===(I=this.authWindow)||void 0===I?void 0:I.window)||void 0===x?void 0:x.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(Pe(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(m,Ao.get())};m()}}return w.currentPopupAction=null,w})();const yn=new Map;class gi extends Cr{constructor(p,m,I=!1){super(p,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],m,void 0,I),this.eventId=null}execute(){var p=()=>super.execute,m=this;return(0,_.Z)(function*(){let I=yn.get(m.auth._key());if(!I){try{const O=(yield function ju(w,p){return wd.apply(this,arguments)}(m.resolver,m.auth))?yield p().call(m):null;I=()=>Promise.resolve(O)}catch(x){I=()=>Promise.reject(x)}yn.set(m.auth._key(),I)}return m.bypassAuthState||yn.set(m.auth._key(),()=>Promise.resolve(null)),I()})()}onAuthEvent(p){var m=()=>super.onAuthEvent,I=this;return(0,_.Z)(function*(){if("signInViaRedirect"===p.type)return m().call(I,p);if("unknown"!==p.type){if(p.eventId){const x=yield I.auth._redirectUserForId(p.eventId);if(x)return I.user=x,m().call(I,p);I.resolve(null)}}else I.resolve(null)})()}onExecution(){return(0,_.Z)(function*(){})()}cleanUp(){}}function wd(){return(wd=(0,_.Z)(function*(w,p){const m=$u(p),I=ef(w);if(!(yield I._isAvailable()))return!1;const x="true"===(yield I._get(m));return yield I._remove(m),x})).apply(this,arguments)}function ti(w,p){return la.apply(this,arguments)}function la(){return(la=(0,_.Z)(function*(w,p){return ef(w)._set($u(p),"true")})).apply(this,arguments)}function fs(){yn.clear()}function Wl(w,p){yn.set(w._key(),p)}function ef(w){return te(w._redirectPersistence)}function $u(w){return H("pendingRedirect",w.config.apiKey,w.name)}function ql(w,p,m){return function Hu(w,p,m){return Mi.apply(this,arguments)}(w,p,m)}function Mi(){return(Mi=(0,_.Z)(function*(w,p,m){const I=$e(w);Te(w,p,zs);const x=to(I,m);return yield ti(x,I),x._openRedirect(I,p,"signInViaRedirect")})).apply(this,arguments)}function b(w,p,m){return function D(w,p,m){return R.apply(this,arguments)}(w,p,m)}function R(){return(R=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w);Te(I.auth,p,zs);const x=to(I.auth,m);yield ti(x,I.auth);const O=yield kt(I);return x._openRedirect(I.auth,p,"reauthViaRedirect",O)})).apply(this,arguments)}function j(w,p,m){return function X(w,p,m){return se.apply(this,arguments)}(w,p,m)}function se(){return(se=(0,_.Z)(function*(w,p,m){const I=(0,G.m9)(w);Te(I.auth,p,zs);const x=to(I.auth,m);yield Ks(!1,I,p.providerId),yield ti(x,I.auth);const O=yield kt(I);return x._openRedirect(I.auth,p,"linkViaRedirect",O)})).apply(this,arguments)}function Me(w,p){return ze.apply(this,arguments)}function ze(){return(ze=(0,_.Z)(function*(w,p){return yield $e(w)._initializationPromise,yt(w,p,!1)})).apply(this,arguments)}function yt(w,p){return St.apply(this,arguments)}function St(){return(St=(0,_.Z)(function*(w,p,m=!1){const I=$e(w),x=to(I,p),J=yield new gi(I,x,m).execute();return J&&!m&&(delete J.user._redirectEventId,yield I._persistUserIfCurrent(J.user),yield I._setRedirectUser(null,p)),J})).apply(this,arguments)}function kt(w){return dt.apply(this,arguments)}function dt(){return(dt=(0,_.Z)(function*(w){const p=aa(`${w.uid}:::`);return w._redirectEventId=p,yield w.auth._setRedirectUser(w),yield w.auth._persistUserIfCurrent(w),p})).apply(this,arguments)}class tr{constructor(p){this.auth=p,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(p){this.consumers.add(p),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,p)&&(this.sendToConsumer(this.queuedRedirectEvent,p),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(p){this.consumers.delete(p)}onEvent(p){if(this.hasEventBeenHandled(p))return!1;let m=!1;return this.consumers.forEach(I=>{this.isEventForConsumer(p,I)&&(m=!0,this.sendToConsumer(p,I),this.saveEventToCache(p))}),this.hasHandledPotentialRedirect||!function ks(w){switch(w.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return io(w);default:return!1}}(p)||(this.hasHandledPotentialRedirect=!0,m||(this.queuedRedirectEvent=p,m=!0)),m}sendToConsumer(p,m){var I;if(p.error&&!io(p)){const x=(null===(I=p.error.code)||void 0===I?void 0:I.split("auth/")[1])||"internal-error";m.onError(Pe(this.auth,x))}else m.onAuthEvent(p)}isEventForConsumer(p,m){const I=null===m.eventId||!!p.eventId&&p.eventId===m.eventId;return m.filter.includes(p.type)&&I}hasEventBeenHandled(p){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ro(p))}saveEventToCache(p){this.cachedEventUids.add(ro(p)),this.lastProcessedEventTime=Date.now()}}function ro(w){return[w.type,w.eventId,w.sessionId,w.tenantId].filter(p=>p).join("-")}function io({type:w,error:p}){return"unknown"===w&&"auth/no-auth-event"===(null==p?void 0:p.code)}function za(w){return ca.apply(this,arguments)}function ca(){return(ca=(0,_.Z)(function*(w,p={}){return Yt(w,"GET","/v1/projects",p)})).apply(this,arguments)}const Ka=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ps=/^https?/;function so(){return(so=(0,_.Z)(function*(w){if(w.config.emulator)return;const{authorizedDomains:p}=yield za(w);for(const m of p)try{if(F_(m))return}catch(I){}Ge(w,"unauthorized-domain")})).apply(this,arguments)}function F_(w){const p=de(),{protocol:m,hostname:I}=new URL(p);if(w.startsWith("chrome-extension://")){const J=new URL(w);return""===J.hostname&&""===I?"chrome-extension:"===m&&w.replace("chrome-extension://","")===p.replace("chrome-extension://",""):"chrome-extension:"===m&&J.hostname===I}if(!ps.test(m))return!1;if(Ka.test(w))return I===w;const x=w.replace(/\./g,"\\.");return new RegExp("^(.+\\."+x+"|"+x+")$","i").test(I)}const Lw=new Ze(3e4,6e4);function tf(){const w=In().___jsl;if(null==w?void 0:w.H)for(const p of Object.keys(w.H))if(w.H[p].r=w.H[p].r||[],w.H[p].L=w.H[p].L||[],w.H[p].r=[...w.H[p].L],w.CP)for(let m=0;m<w.CP.length;m++)w.CP[m]=null}let zl=null;function nf(w){return zl=zl||function og(w){return new Promise((p,m)=>{var I,x,O;function J(){tf(),gapi.load("gapi.iframes",{callback:()=>{p(gapi.iframes.getContext())},ontimeout:()=>{tf(),m(Pe(w,"network-request-failed"))},timeout:Lw.get()})}if(null===(x=null===(I=In().gapi)||void 0===I?void 0:I.iframes)||void 0===x?void 0:x.Iframe)p(gapi.iframes.getContext());else{if(!(null===(O=In().gapi)||void 0===O?void 0:O.load)){const xe=ds("iframefcb");return In()[xe]=()=>{gapi.load?J():m(Pe(w,"network-request-failed"))},Co(`https://apis.google.com/js/api.js?onload=${xe}`).catch(tt=>m(tt))}J()}}).catch(p=>{throw zl=null,p})}(w),zl}const xo=new Ze(5e3,15e3),Ed={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Wu=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function qu(w){const p=w.config;ne(p.authDomain,w,"auth-domain-config-required");const m=p.emulator?ln(p,"emulator/auth/iframe"):`https://${w.config.authDomain}/__/auth/iframe`,I={apiKey:p.apiKey,appName:w.name,v:P.SDK_VERSION},x=Wu.get(w.config.apiHost);x&&(I.eid=x);const O=w._getFrameworks();return O.length&&(I.fw=O.join(",")),`${m}?${(0,G.xO)(I).slice(1)}`}function ug(){return ug=(0,_.Z)(function*(w){const p=yield nf(w),m=In().gapi;return ne(m,w,"internal-error"),p.open({where:document.body,url:qu(w),messageHandlersFilter:m.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ed,dontclear:!0},I=>new Promise(function(){var x=(0,_.Z)(function*(O,J){yield I.restyle({setHideOnLeave:!1});const xe=Pe(w,"network-request-failed"),tt=In().setTimeout(()=>{J(xe)},xo.get());function vt(){In().clearTimeout(tt),O(I)}I.ping(vt).then(vt,()=>{J(xe)})});return function(O,J){return x.apply(this,arguments)}}()))}),ug.apply(this,arguments)}const Za={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Zl{constructor(p){this.window=p,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(p){}}}function sf(w,p,m,I,x,O){ne(w.config.authDomain,w,"auth-domain-config-required"),ne(w.config.apiKey,w,"invalid-api-key");const J={apiKey:w.config.apiKey,appName:w.name,authType:m,redirectUrl:I,v:P.SDK_VERSION,eventId:x};if(p instanceof zs){p.setDefaultLanguage(w.languageCode),J.providerId=p.providerId||"",(0,G.xb)(p.getCustomParameters())||(J.customParameters=JSON.stringify(p.getCustomParameters()));for(const[tt,vt]of Object.entries(O||{}))J[tt]=vt}if(p instanceof Ai){const tt=p.getScopes().filter(vt=>""!==vt);tt.length>0&&(J.scopes=tt.join(","))}w.tenantId&&(J.tid=w.tenantId);const xe=J;for(const tt of Object.keys(xe))void 0===xe[tt]&&delete xe[tt];return`${function Ns({config:w}){return w.emulator?ln(w,"emulator/auth/handler"):`https://${w.authDomain}/__/auth/handler`}(w)}?${(0,G.xO)(xe).slice(1)}`}const Ps="webStorageSupport",lg=class af{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Jr,this._completeRedirectFn=yt,this._overrideRedirectResult=Wl}_openPopup(p,m,I,x){var O=this;return(0,_.Z)(function*(){var J;Ee(null===(J=O.eventManagers[p._key()])||void 0===J?void 0:J.manager,"_initialize() not called before _openPopup()");const xe=sf(p,m,I,de(),x);return function U_(w,p,m,I=500,x=600){const O=Math.max((window.screen.availHeight-x)/2,0).toString(),J=Math.max((window.screen.availWidth-I)/2,0).toString();let xe="";const tt=Object.assign(Object.assign({},Za),{width:I.toString(),height:x.toString(),top:O,left:J}),vt=(0,G.z$)().toLowerCase();m&&(xe=ae(vt)?"_blank":m),N(vt)&&(p=p||"http://localhost",tt.scrollbars="yes");const Vt=Object.entries(tt).reduce((Wi,[Ro,da])=>`${Wi}${Ro}=${da},`,"");if(function gr(w=(0,G.z$)()){var p;return it(w)&&!!(null===(p=window.navigator)||void 0===p?void 0:p.standalone)}(vt)&&"_self"!==xe)return function Yl(w,p){const m=document.createElement("a");m.href=w,m.target=p;const I=document.createEvent("MouseEvent");I.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),m.dispatchEvent(I)}(p||"",xe),new Zl(null);const Rn=window.open(p||"",xe,Vt);ne(Rn,w,"popup-blocked");try{Rn.focus()}catch(Wi){}return new Zl(Rn)}(p,xe,aa())})()}_openRedirect(p,m,I,x){var O=this;return(0,_.Z)(function*(){return yield O._originValidation(p),function Yh(w){In().location.href=w}(sf(p,m,I,de(),x)),new Promise(()=>{})})()}_initialize(p){const m=p._key();if(this.eventManagers[m]){const{manager:x,promise:O}=this.eventManagers[m];return x?Promise.resolve(x):(Ee(O,"If manager is not set, promise should be"),O)}const I=this.initAndGetManager(p);return this.eventManagers[m]={promise:I},I.catch(()=>{delete this.eventManagers[m]}),I}initAndGetManager(p){var m=this;return(0,_.Z)(function*(){const I=yield function ag(w){return ug.apply(this,arguments)}(p),x=new tr(p);return I.register("authEvent",O=>(ne(null==O?void 0:O.authEvent,p,"invalid-auth-event"),{status:x.onEvent(O.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),m.eventManagers[p._key()]={manager:x},m.iframes[p._key()]=I,x})()}_isIframeWebStorageSupported(p,m){this.iframes[p._key()].send(Ps,{type:Ps},x=>{var O;const J=null===(O=null==x?void 0:x[0])||void 0===O?void 0:O[Ps];void 0!==J&&m(!!J),Ge(p,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(p){const m=p._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function Gi(w){return so.apply(this,arguments)}(p)),this.originValidationPromises[m]}get _shouldInitProactively(){return $r()||B()||it()}};class cg extends class j_{constructor(p){this.factorId=p}_process(p,m,I){switch(m.type){case"enroll":return this._finalizeEnroll(p,m.credential,I);case"signin":return this._finalizeSignIn(p,m.credential);default:return pe("unexpected MultiFactorSessionType")}}}{constructor(p){super("phone"),this.credential=p}static _fromCredential(p){return new cg(p)}_finalizeEnroll(p,m,I){return function dd(w,p){return Yt(w,"POST","/v2/accounts/mfaEnrollment:finalize",$t(w,p))}(p,{idToken:m,displayName:I,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(p,m){return function er(w,p){return Yt(w,"POST","/v2/accounts/mfaSignIn:finalize",$t(w,p))}(p,{mfaPendingCredential:m,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let dg=(()=>{class w{constructor(){}static assertion(m){return cg._fromCredential(m)}}return w.FACTOR_ID="phone",w})();var $_="@firebase/auth",uf="0.20.11";class H_{constructor(p){this.auth=p,this.internalListeners=new Map}getUid(){var p;return this.assertAuthConfigured(),(null===(p=this.auth.currentUser)||void 0===p?void 0:p.uid)||null}getToken(p){var m=this;return(0,_.Z)(function*(){return m.assertAuthConfigured(),yield m.auth._initializationPromise,m.auth.currentUser?{accessToken:yield m.auth.currentUser.getIdToken(p)}:null})()}addAuthTokenListener(p){if(this.assertAuthConfigured(),this.internalListeners.has(p))return;const m=this.auth.onIdTokenChanged(I=>{var x;p((null===(x=I)||void 0===x?void 0:x.stsTokenManager.accessToken)||null)});this.internalListeners.set(p,m),this.updateProactiveRefresh()}removeAuthTokenListener(p){this.assertAuthConfigured();const m=this.internalListeners.get(p);!m||(this.internalListeners.delete(p),m(),this.updateProactiveRefresh())}assertAuthConfigured(){ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,G.Pz)("authIdTokenMaxAge"),function Td(w){(0,P._registerComponent)(new ye.wA("auth",(p,{options:m})=>{const I=p.getProvider("app").getImmediate(),x=p.getProvider("heartbeat"),{apiKey:O,authDomain:J}=I.options;return((xe,tt)=>{ne(O&&!O.includes(":"),"invalid-api-key",{appName:xe.name}),ne(!(null==J?void 0:J.includes(":")),"argument-error",{appName:xe.name});const vt={apiKey:O,authDomain:J,clientPlatform:w,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vr(w)},Vt=new li(xe,tt,vt);return function we(w,p){const m=(null==p?void 0:p.persistence)||[],I=(Array.isArray(m)?m:[m]).map(te);(null==p?void 0:p.errorMap)&&w._updateErrorMap(p.errorMap),w._initializeWithPersistence(I,null==p?void 0:p.popupRedirectResolver)}(Vt,m),Vt})(I,x)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((p,m,I)=>{p.getProvider("auth-internal").initialize()})),(0,P._registerComponent)(new ye.wA("auth-internal",p=>{const m=$e(p.getProvider("auth").getImmediate());return new H_(m)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,P.registerVersion)($_,uf,function hg(w){switch(w){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(w)),(0,P.registerVersion)($_,uf,"esm2017")}("Browser")},2090:(nt,Ce,F)=>{F.d(Ce,{$s:()=>Ke,BH:()=>Ft,DV:()=>Hn,Dv:()=>Ti,G6:()=>Te,GJ:()=>bi,L:()=>le,LL:()=>cn,Pz:()=>en,Sg:()=>Ze,UG:()=>Ve,UI:()=>wt,US:()=>ye,Wj:()=>Fi,Wl:()=>Nn,Yr:()=>Ae,ZB:()=>q,ZR:()=>Tn,aH:()=>pt,b$:()=>De,cI:()=>Yt,dS:()=>pn,eu:()=>ne,g5:()=>P,gK:()=>jr,gQ:()=>Dn,h$:()=>ge,hl:()=>We,hu:()=>G,jU:()=>He,lb:()=>Gn,m9:()=>nn,ne:()=>pr,p$:()=>z,pd:()=>Br,r3:()=>Ci,ru:()=>_e,tV:()=>ve,uI:()=>Re,ug:()=>_t,vZ:()=>kr,w1:()=>Ge,w9:()=>ns,xO:()=>Nr,xb:()=>rs,z$:()=>je,zI:()=>pe,zd:()=>Vr});const G=function(W,H){if(!W)throw P(H)},P=function(W){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+W)},oe=function(W){const H=[];let Y=0;for(let $=0;$<W.length;$++){let N=W.charCodeAt($);N<128?H[Y++]=N:N<2048?(H[Y++]=N>>6|192,H[Y++]=63&N|128):55296==(64512&N)&&$+1<W.length&&56320==(64512&W.charCodeAt($+1))?(N=65536+((1023&N)<<10)+(1023&W.charCodeAt(++$)),H[Y++]=N>>18|240,H[Y++]=N>>12&63|128,H[Y++]=N>>6&63|128,H[Y++]=63&N|128):(H[Y++]=N>>12|224,H[Y++]=N>>6&63|128,H[Y++]=63&N|128)}return H},ye={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(W,H){if(!Array.isArray(W))throw Error("encodeByteArray takes an array as a parameter");this.init_();const Y=H?this.byteToCharMapWebSafe_:this.byteToCharMap_,$=[];for(let N=0;N<W.length;N+=3){const B=W[N],ae=N+1<W.length,Le=ae?W[N+1]:0,et=N+2<W.length,ut=et?W[N+2]:0;let on=(15&Le)<<2|ut>>6,gr=63&ut;et||(gr=64,ae||(on=64)),$.push(Y[B>>2],Y[(3&B)<<4|Le>>4],Y[on],Y[gr])}return $.join("")},encodeString(W,H){return this.HAS_NATIVE_SUPPORT&&!H?btoa(W):this.encodeByteArray(oe(W),H)},decodeString(W,H){return this.HAS_NATIVE_SUPPORT&&!H?atob(W):function(W){const H=[];let Y=0,$=0;for(;Y<W.length;){const N=W[Y++];if(N<128)H[$++]=String.fromCharCode(N);else if(N>191&&N<224){const B=W[Y++];H[$++]=String.fromCharCode((31&N)<<6|63&B)}else if(N>239&&N<365){const et=((7&N)<<18|(63&W[Y++])<<12|(63&W[Y++])<<6|63&W[Y++])-65536;H[$++]=String.fromCharCode(55296+(et>>10)),H[$++]=String.fromCharCode(56320+(1023&et))}else{const B=W[Y++],ae=W[Y++];H[$++]=String.fromCharCode((15&N)<<12|(63&B)<<6|63&ae)}}return H.join("")}(this.decodeStringToByteArray(W,H))},decodeStringToByteArray(W,H){this.init_();const Y=H?this.charToByteMapWebSafe_:this.charToByteMap_,$=[];for(let N=0;N<W.length;){const B=Y[W.charAt(N++)],Le=N<W.length?Y[W.charAt(N)]:0;++N;const ut=N<W.length?Y[W.charAt(N)]:64;++N;const it=N<W.length?Y[W.charAt(N)]:64;if(++N,null==B||null==Le||null==ut||null==it)throw Error();$.push(B<<2|Le>>4),64!==ut&&($.push(Le<<4&240|ut>>2),64!==it&&$.push(ut<<6&192|it))}return $},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let W=0;W<this.ENCODED_VALS.length;W++)this.byteToCharMap_[W]=this.ENCODED_VALS.charAt(W),this.charToByteMap_[this.byteToCharMap_[W]]=W,this.byteToCharMapWebSafe_[W]=this.ENCODED_VALS_WEBSAFE.charAt(W),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[W]]=W,W>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(W)]=W,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(W)]=W)}}},ge=function(W){const H=oe(W);return ye.encodeByteArray(H,!0)},le=function(W){return ge(W).replace(/\./g,"")},ve=function(W){try{return ye.decodeString(W,!0)}catch(H){console.error("base64Decode failed: ",H)}return null};function z(W){return q(void 0,W)}function q(W,H){if(!(H instanceof Object))return H;switch(H.constructor){case Date:return new Date(H.getTime());case Object:void 0===W&&(W={});break;case Array:W=[];break;default:return H}for(const Y in H)!H.hasOwnProperty(Y)||!re(Y)||(W[Y]=q(W[Y],H[Y]));return W}function re(W){return"__proto__"!==W}function je(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Re(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(je())}function Ve(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(W){return!1}}function He(){return"object"==typeof self&&self.self===self}function _e(){const W="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof W&&void 0!==W.id}function De(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Ge(){const W=je();return W.indexOf("MSIE ")>=0||W.indexOf("Trident/")>=0}function Ae(){return!1}function Te(){return!Ve()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function We(){return"object"==typeof indexedDB}function ne(){return new Promise((W,H)=>{try{let Y=!0;const $="validate-browser-context-for-indexeddb-analytics-module",N=self.indexedDB.open($);N.onsuccess=()=>{N.result.close(),Y||self.indexedDB.deleteDatabase($),W(!0)},N.onupgradeneeded=()=>{Y=!1},N.onerror=()=>{var B;H((null===(B=N.error)||void 0===B?void 0:B.message)||"")}}catch(Y){H(Y)}})}function pe(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}const we=()=>{try{return function Ee(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const W=process.env.__FIREBASE_DEFAULTS__;return W?JSON.parse(W):void 0})()||(()=>{if("undefined"==typeof document)return;let W;try{W=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Y){return}const H=W&&ve(W[1]);return H&&JSON.parse(H)})()}catch(W){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${W}`)}},pt=()=>{var W;return null===(W=we())||void 0===W?void 0:W.config},en=W=>{var H;return null===(H=we())||void 0===H?void 0:H[`_${W}`]};class Ft{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((H,Y)=>{this.resolve=H,this.reject=Y})}wrapCallback(H){return(Y,$)=>{Y?this.reject(Y):this.resolve($),"function"==typeof H&&(this.promise.catch(()=>{}),1===H.length?H(Y):H(Y,$))}}}function Ze(W,H){if(W.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const $=H||"demo-project",N=W.iat||0,B=W.sub||W.user_id;if(!B)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ae=Object.assign({iss:`https://securetoken.google.com/${$}`,aud:$,iat:N,exp:N+3600,auth_time:N,sub:B,user_id:B,firebase:{sign_in_provider:"custom",identities:{}}},W);return[le(JSON.stringify({alg:"none",type:"JWT"})),le(JSON.stringify(ae)),""].join(".")}class Tn extends Error{constructor(H,Y,$){super(Y),this.code=H,this.customData=$,this.name="FirebaseError",Object.setPrototypeOf(this,Tn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cn.prototype.create)}}class cn{constructor(H,Y,$){this.service=H,this.serviceName=Y,this.errors=$}create(H,...Y){const $=Y[0]||{},N=`${this.service}/${H}`,B=this.errors[H],ae=B?function tn(W,H){return W.replace($t,(Y,$)=>{const N=H[$];return null!=N?String(N):`<${$}?>`})}(B,$):"Error";return new Tn(N,`${this.serviceName}: ${ae} (${N}).`,$)}}const $t=/\{\$([^}]+)}/g;function Yt(W){return JSON.parse(W)}function Nn(W){return JSON.stringify(W)}const Qr=function(W){let H={},Y={},$={},N="";try{const B=W.split(".");H=Yt(ve(B[0])||""),Y=Yt(ve(B[1])||""),N=B[2],$=Y.d||{},delete Y.d}catch(B){}return{header:H,claims:Y,data:$,signature:N}},ns=function(W){const Y=Qr(W).claims;return!!Y&&"object"==typeof Y&&Y.hasOwnProperty("iat")},bi=function(W){const H=Qr(W).claims;return"object"==typeof H&&!0===H.admin};function Ci(W,H){return Object.prototype.hasOwnProperty.call(W,H)}function Hn(W,H){if(Object.prototype.hasOwnProperty.call(W,H))return W[H]}function rs(W){for(const H in W)if(Object.prototype.hasOwnProperty.call(W,H))return!1;return!0}function wt(W,H,Y){const $={};for(const N in W)Object.prototype.hasOwnProperty.call(W,N)&&($[N]=H.call(Y,W[N],N,W));return $}function kr(W,H){if(W===H)return!0;const Y=Object.keys(W),$=Object.keys(H);for(const N of Y){if(!$.includes(N))return!1;const B=W[N],ae=H[N];if(wn(B)&&wn(ae)){if(!kr(B,ae))return!1}else if(B!==ae)return!1}for(const N of $)if(!Y.includes(N))return!1;return!0}function wn(W){return null!==W&&"object"==typeof W}function Nr(W){const H=[];for(const[Y,$]of Object.entries(W))Array.isArray($)?$.forEach(N=>{H.push(encodeURIComponent(Y)+"="+encodeURIComponent(N))}):H.push(encodeURIComponent(Y)+"="+encodeURIComponent($));return H.length?"&"+H.join("&"):""}function Vr(W){const H={};return W.replace(/^\?/,"").split("&").forEach($=>{if($){const[N,B]=$.split("=");H[decodeURIComponent(N)]=decodeURIComponent(B)}}),H}function Br(W){const H=W.indexOf("?");if(!H)return"";const Y=W.indexOf("#",H);return W.substring(H,Y>0?Y:void 0)}class Dn{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let H=1;H<this.blockSize;++H)this.pad_[H]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(H,Y){Y||(Y=0);const $=this.W_;if("string"==typeof H)for(let it=0;it<16;it++)$[it]=H.charCodeAt(Y)<<24|H.charCodeAt(Y+1)<<16|H.charCodeAt(Y+2)<<8|H.charCodeAt(Y+3),Y+=4;else for(let it=0;it<16;it++)$[it]=H[Y]<<24|H[Y+1]<<16|H[Y+2]<<8|H[Y+3],Y+=4;for(let it=16;it<80;it++){const on=$[it-3]^$[it-8]^$[it-14]^$[it-16];$[it]=4294967295&(on<<1|on>>>31)}let ut,Mt,N=this.chain_[0],B=this.chain_[1],ae=this.chain_[2],Le=this.chain_[3],et=this.chain_[4];for(let it=0;it<80;it++){it<40?it<20?(ut=Le^B&(ae^Le),Mt=1518500249):(ut=B^ae^Le,Mt=1859775393):it<60?(ut=B&ae|Le&(B|ae),Mt=2400959708):(ut=B^ae^Le,Mt=3395469782);const on=(N<<5|N>>>27)+ut+et+Mt+$[it]&4294967295;et=Le,Le=ae,ae=4294967295&(B<<30|B>>>2),B=N,N=on}this.chain_[0]=this.chain_[0]+N&4294967295,this.chain_[1]=this.chain_[1]+B&4294967295,this.chain_[2]=this.chain_[2]+ae&4294967295,this.chain_[3]=this.chain_[3]+Le&4294967295,this.chain_[4]=this.chain_[4]+et&4294967295}update(H,Y){if(null==H)return;void 0===Y&&(Y=H.length);const $=Y-this.blockSize;let N=0;const B=this.buf_;let ae=this.inbuf_;for(;N<Y;){if(0===ae)for(;N<=$;)this.compress_(H,N),N+=this.blockSize;if("string"==typeof H){for(;N<Y;)if(B[ae]=H.charCodeAt(N),++ae,++N,ae===this.blockSize){this.compress_(B),ae=0;break}}else for(;N<Y;)if(B[ae]=H[N],++ae,++N,ae===this.blockSize){this.compress_(B),ae=0;break}}this.inbuf_=ae,this.total_+=Y}digest(){const H=[];let Y=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let N=this.blockSize-1;N>=56;N--)this.buf_[N]=255&Y,Y/=256;this.compress_(this.buf_);let $=0;for(let N=0;N<5;N++)for(let B=24;B>=0;B-=8)H[$]=this.chain_[N]>>B&255,++$;return H}}function pr(W,H){const Y=new vs(W,H);return Y.subscribe.bind(Y)}class vs{constructor(H,Y){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=Y,this.task.then(()=>{H(this)}).catch($=>{this.error($)})}next(H){this.forEachObserver(Y=>{Y.next(H)})}error(H){this.forEachObserver(Y=>{Y.error(H)}),this.close(H)}complete(){this.forEachObserver(H=>{H.complete()}),this.close()}subscribe(H,Y,$){let N;if(void 0===H&&void 0===Y&&void 0===$)throw new Error("Missing Observer.");N=function gt(W,H){if("object"!=typeof W||null===W)return!1;for(const Y of H)if(Y in W&&"function"==typeof W[Y])return!0;return!1}(H,["next","error","complete"])?H:{next:H,error:Y,complete:$},void 0===N.next&&(N.next=rt),void 0===N.error&&(N.error=rt),void 0===N.complete&&(N.complete=rt);const B=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?N.error(this.finalError):N.complete()}catch(ae){}}),this.observers.push(N),B}unsubscribeOne(H){void 0===this.observers||void 0===this.observers[H]||(delete this.observers[H],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(H){if(!this.finalized)for(let Y=0;Y<this.observers.length;Y++)this.sendOne(Y,H)}sendOne(H,Y){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[H])try{Y(this.observers[H])}catch($){"undefined"!=typeof console&&console.error&&console.error($)}})}close(H){this.finalized||(this.finalized=!0,void 0!==H&&(this.finalError=H),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rt(){}const Ti=function(W,H,Y,$){let N;if($<H?N="at least "+H:$>Y&&(N=0===Y?"none":"no more than "+Y),N)throw new Error(W+" failed: Was called with "+$+(1===$?" argument.":" arguments.")+" Expects "+N+".")};function jr(W,H){return`${W} failed: ${H} argument `}function Fi(W,H,Y,$){if((!$||Y)&&"function"!=typeof Y)throw new Error(jr(W,H)+"must be a valid function.")}function Gn(W,H,Y,$){if((!$||Y)&&("object"!=typeof Y||null===Y))throw new Error(jr(W,H)+"must be a valid context object.")}const pn=function(W){const H=[];let Y=0;for(let $=0;$<W.length;$++){let N=W.charCodeAt($);if(N>=55296&&N<=56319){const B=N-55296;$++,G($<W.length,"Surrogate pair missing trail surrogate."),N=65536+(B<<10)+(W.charCodeAt($)-56320)}N<128?H[Y++]=N:N<2048?(H[Y++]=N>>6|192,H[Y++]=63&N|128):N<65536?(H[Y++]=N>>12|224,H[Y++]=N>>6&63|128,H[Y++]=63&N|128):(H[Y++]=N>>18|240,H[Y++]=N>>12&63|128,H[Y++]=N>>6&63|128,H[Y++]=63&N|128)}return H},_t=function(W){let H=0;for(let Y=0;Y<W.length;Y++){const $=W.charCodeAt(Y);$<128?H++:$<2048?H+=2:$>=55296&&$<=56319?(H+=4,Y++):H+=3}return H};function Ke(W,H=1e3,Y=2){const $=H*Math.pow(Y,W),N=Math.round(.5*$*(Math.random()-.5)*2);return Math.min(144e5,$+N)}function nn(W){return W&&W._delegate?W._delegate:W}},1081:(nt,Ce,F)=>{var _=F(5e3);let G=null;function P(){return G}const ge=new _.OlP("DocumentToken");let le=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return function ve(){return(0,_.LFG)(q)}()},providedIn:"platform"}),n})();const z=new _.OlP("Location Initialized");let q=(()=>{class n extends le{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return P().getBaseHref(this._doc)}onPopState(t){const r=P().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=P().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,i){re()?this._history.pushState(t,r,i):this.location.hash=i}replaceState(t,r,i){re()?this._history.replaceState(t,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ge))},n.\u0275prov=_.Yz7({token:n,factory:function(){return function je(){return new q((0,_.LFG)(ge))}()},providedIn:"platform"}),n})();function re(){return!!window.history.pushState}function Re(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function Ve(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function He(n){return n&&"?"!==n[0]?"?"+n:n}let _e=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return function De(n){const e=(0,_.LFG)(ge).location;return new Ge((0,_.LFG)(le),e&&e.origin||"")}()},providedIn:"root"}),n})();const qe=new _.OlP("appBaseHref");let Ge=(()=>{class n extends _e{constructor(t,r){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Re(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+He(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const l=this.prepareExternalUrl(i+He(a));this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){const l=this.prepareExternalUrl(i+He(a));this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(le),_.LFG(qe,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Pe=(()=>{class n extends _e{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=Re(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let l=this.prepareExternalUrl(i+He(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){let l=this.prepareExternalUrl(i+He(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(le),_.LFG(qe,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Ae=(()=>{class n{constructor(t,r){this._subject=new _.vpe,this._urlChangeListeners=[],this._platformStrategy=t;const i=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=Ve(ne(i)),this._platformStrategy.onPopState(a=>{this._subject.emit({url:this.path(!0),pop:!0,state:a.state,type:a.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+He(r))}normalize(t){return n.stripTrailingSlash(function We(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,ne(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._platformStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+He(r)),i)}replaceState(t,r="",i=null){this._platformStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+He(r)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformStrategy).historyGo)||void 0===i||i.call(r,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=He,n.joinWithSlash=Re,n.stripTrailingSlash=Ve,n.\u0275fac=function(t){return new(t||n)(_.LFG(_e),_.LFG(le))},n.\u0275prov=_.Yz7({token:n,factory:function(){return function Te(){return new Ae((0,_.LFG)(_e),(0,_.LFG)(le))}()},providedIn:"root"}),n})();function ne(n){return n.replace(/\/index.html$/,"")}let Hr=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new gn,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Hc("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Hc("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(_.s_b),_.Y36(_.Rgc))},n.\u0275dir=_.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class gn{constructor(){this.$implicit=null,this.ngIf=null}}function Hc(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,_.AaK)(e)}'.`)}let _o=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})();function Wr(n){return"server"===n}let Tu=(()=>{class n{}return n.\u0275prov=(0,_.Yz7)({token:n,providedIn:"root",factory:()=>new Du((0,_.LFG)(ge),window)}),n})();class Du{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function Ts(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const l=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(l)return l}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Rl(this.window.history)||Rl(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function Rl(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Ks extends class xa extends class ye{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function ce(n){G||(G=n)}(new Ks)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Su(){return mn=mn||document.querySelector("base"),mn?mn.getAttribute("href"):null}();return null==t?null:function yo(n){Ra=Ra||document.createElement("a"),Ra.setAttribute("href",n);const e=Ra.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){mn=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function zo(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}(document.cookie,e)}}let Ra,mn=null;const wr=new _.OlP("TRANSITION_ID"),qn=[{provide:_.ip1,useFactory:function Au(n,e,t){return()=>{t.get(_.CZH).donePromise.then(()=>{const r=P(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<i.length;a++)r.remove(i[a])})}},deps:[wr,ge,_.zs3],multi:!0}];class Ds{static init(){(0,_.VLi)(new Ds)}addToWindow(e){_.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new Error("Could not find testability for element.");return a},_.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),_.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),_.dqk.frameworkStabilizers||(_.dqk.frameworkStabilizers=[]),_.dqk.frameworkStabilizers.push(r=>{const i=_.dqk.getAllAngularTestabilities();let a=i.length,l=!1;const h=function(g){l=l||g,a--,0==a&&r(l)};i.forEach(function(g){g.whenStable(h)})})}findTestabilityInTree(e,t,r){if(null==t)return null;const i=e.getTestability(t);return null!=i?i:r?P().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let Er=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const ea=new _.OlP("EventManagerPlugins");let ss=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let a=0;a<i.length;a++){const l=i[a];if(l.supports(t))return this._eventNameToPlugin.set(t,l),l}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ea),_.LFG(_.R0b))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class kl{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=P().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let ci=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Zs=(()=>{class n extends ci{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(a=>{const l=this._doc.createElement("style");l.textContent=a,i.push(r.appendChild(l))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(Ys),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Ys))}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ge))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();function Ys(n){P().remove(n)}const bt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},vo=/%COMP%/g;function Qs(n,e,t){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?Qs(n,i,t):(i=i.replace(vo,n),t.push(i))}return t}function Ne(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Ru=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Sn(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case _.ifc.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new os(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case _.ifc.ShadowDom:return new Nl(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=Qs(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ss),_.LFG(Zs),_.LFG(_.AFp))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class Sn{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(bt[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,r){e&&e.insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=bt[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=bt[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(_.JOm.DashCase|_.JOm.Important)?e.style.setProperty(t,r,i&_.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&_.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Ne(r)):this.eventManager.addEventListener(e,t,Ne(r))}}class os extends Sn{constructor(e,t,r,i){super(e),this.component=r;const a=Qs(i+"-"+r.id,r.styles,[]);t.addStyles(a),this.contentAttr=function ta(n){return"_ngcontent-%COMP%".replace(vo,n)}(i+"-"+r.id),this.hostAttr=function Gh(n){return"_nghost-%COMP%".replace(vo,n)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class Nl extends Sn{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=Qs(i.id,i.styles,[]);for(let l=0;l<a.length;l++){const h=document.createElement("style");h.textContent=a[l],this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let ka=(()=>{class n extends kl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ge))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const Wh=["alt","control","meta","shift"],id={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},wo={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ir={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let as=(()=>{class n extends kl{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),l=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>P().onAndCancel(t,a.domEventName,l))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let l="";if(Wh.forEach(g=>{const v=r.indexOf(g);v>-1&&(r.splice(v,1),l+=g+".")}),l+=a,0!=r.length||0===a.length)return null;const h={};return h.domEventName=i,h.fullKey=l,h}static getEventFullKey(t){let r="",i=function na(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&wo.hasOwnProperty(e)&&(e=wo[e]))}return id[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),Wh.forEach(a=>{a!=i&&Ir[a](t)&&(r+=a+".")}),r+=i,r}static eventCallback(t,r,i){return a=>{n.getEventFullKey(a)===t&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ge))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const sd=(0,_.eFA)(_._c5,"browser",[{provide:_.Lbi,useValue:"browser"},{provide:_.g9A,useValue:function ra(){Ks.makeCurrent(),Ds.init()},multi:!0},{provide:ge,useFactory:function qh(){return(0,_.RDi)(document),document},deps:[]}]),Na=[{provide:_.zSh,useValue:"root"},{provide:_.qLn,useFactory:function di(){return new _.qLn},deps:[]},{provide:ea,useClass:ka,multi:!0,deps:[ge,_.R0b,_.Lbi]},{provide:ea,useClass:as,multi:!0,deps:[ge]},{provide:Ru,useClass:Ru,deps:[ss,Zs,_.AFp]},{provide:_.FYo,useExisting:Ru},{provide:ci,useExisting:Zs},{provide:Zs,useClass:Zs,deps:[ge]},{provide:_.dDg,useClass:_.dDg,deps:[_.R0b]},{provide:ss,useClass:ss,deps:[ea,_.R0b]},{provide:class En{},useClass:Er,deps:[]}];let Pl=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:_.AFp,useValue:t.appId},{provide:wr,useExisting:_.AFp},qn]}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(n,12))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:Na,imports:[_o,_.hGG]}),n})();"undefined"!=typeof window&&window;var An=F(8996),ku=F(7669);function st(...n){const e=(0,ku.yG)(n);return(0,An.D)(n,e)}var us=F(7579);class Jr extends us.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}var xi=F(8306);const{isArray:Ua}=Array,{getPrototypeOf:aa,prototype:fd,keys:In}=Object;var Rs=F(4671),Ct=F(4004);const{isArray:ng}=Array;var zn=F(5403),Js=F(9672);function bo(...n){const e=(0,ku.yG)(n),t=(0,ku.jO)(n),{args:r,keys:i}=function Yh(n){if(1===n.length){const e=n[0];if(Ua(e))return{args:e,keys:null};if(function ls(n){return n&&"object"==typeof n&&aa(n)===fd}(e)){const t=In(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}(n);if(0===r.length)return(0,An.D)([],e);const a=new xi.y(function eo(n,e,t=Rs.y){return r=>{Va(e,()=>{const{length:i}=n,a=new Array(i);let l=i,h=i;for(let g=0;g<i;g++)Va(e,()=>{const v=(0,An.D)(n[g],e);let T=!1;v.subscribe((0,zn.x)(r,S=>{a[g]=S,T||(T=!0,h--),h||r.next(t(a.slice()))},()=>{--l||r.complete()}))},r)},r)}}(r,e,i?l=>function Bl(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}(i,l):Rs.y));return t?a.pipe(function Vl(n){return(0,Ct.U)(e=>function pd(n,e){return ng(e)?n(...e):n(e)}(n,e))}(t)):a}function Va(n,e,t){n?(0,Js.f)(t,n,e):e()}var cs=F(576);function Ba(n,e){const t=(0,cs.m)(n)?n:()=>n,r=i=>i.error(t());return new xi.y(e?i=>e.schedule(r,0,i):r)}const ja=(0,F(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var Ms=F(8189);function Nu(...n){return function $a(){return(0,Ms.J)(1)}()((0,An.D)(n,(0,ku.yG)(n)))}var Ha=F(8421);function Pu(n){return new xi.y(e=>{(0,Ha.Xf)(n()).subscribe(e)})}var ei=F(515),gd=F(727),er=F(4482);function jl(){return(0,er.e)((n,e)=>{let t=null;n._refCount++;const r=(0,zn.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class Or extends xi.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,er.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new gd.w0;const t=this.getSubject();e.add(this.source.subscribe((0,zn.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=gd.w0.EMPTY)}return e}refCount(){return jl()(this)}}function lr(n,e){return(0,er.e)((t,r)=>{let i=null,a=0,l=!1;const h=()=>l&&!i&&r.complete();t.subscribe((0,zn.x)(r,g=>{null==i||i.unsubscribe();let v=0;const T=a++;(0,Ha.Xf)(n(g,T)).subscribe(i=(0,zn.x)(r,S=>r.next(e?e(g,S,T,v++):S),()=>{i=null,h()}))},()=>{l=!0,h()}))})}function Co(n){return n<=0?()=>ei.E:(0,er.e)((e,t)=>{let r=0;e.subscribe((0,zn.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function ds(...n){const e=(0,ku.yG)(n);return(0,er.e)((t,r)=>{(e?Nu(n,t,e):Nu(n,t)).subscribe(r)})}function To(n,e,t,r,i){return(a,l)=>{let h=t,g=e,v=0;a.subscribe((0,zn.x)(l,T=>{const S=v++;g=h?n(g,T,S):(h=!0,T),r&&l.next(g)},i&&(()=>{h&&l.next(g),l.complete()})))}}function fi(n,e){return(0,er.e)(To(n,e,arguments.length>=2,!0))}function xn(n,e){return(0,er.e)((t,r)=>{let i=0;t.subscribe((0,zn.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}function Bi(n){return(0,er.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,zn.x)(t,void 0,void 0,l=>{a=(0,Ha.Xf)(n(l,Bi(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}var br=F(5577);function hs(n,e){return(0,cs.m)(e)?(0,br.z)(n,e,1):(0,br.z)(n,1)}function Ou(n){return n<=0?()=>ei.E:(0,er.e)((e,t)=>{let r=[];e.subscribe((0,zn.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Qh(n=Un){return(0,er.e)((e,t)=>{let r=!1;e.subscribe((0,zn.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function Un(){return new ja}function md(n){return(0,er.e)((e,t)=>{let r=!1;e.subscribe((0,zn.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Ga(n,e){const t=arguments.length>=2;return r=>r.pipe(n?xn((i,a)=>n(i,a,r)):Rs.y,Co(1),t?md(e):Qh(()=>new ja))}var Ri=F(8505);class Do{constructor(e,t){this.id=e,this.url=t}}class Xh extends Do{constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ji extends Do{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class rg extends Do{constructor(e,t,r){super(e,t),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Vn extends Do{constructor(e,t,r){super(e,t),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Lu extends Do{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class So extends Do{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ig extends Do{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class $l extends Do{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class qr extends Do{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pi{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Hl{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Wa{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qa{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class to{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fu{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yd{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const qt="primary";class vd{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function $i(n){return new vd(n)}const Cr="ngNavigationCancelingError";function Ao(n){const e=Error("NavigationCancelingError: "+n);return e[Cr]=!0,e}function Uu(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const l=r[a],h=n[a];if(l.startsWith(":"))i[l.substring(1)]=h;else if(l!==h.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Hi(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!Jh(n[i],e[i]))return!1;return!0}function Jh(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function Gl(n){return Array.prototype.concat.apply([],n)}function Bu(n){return n.length>0?n[n.length-1]:null}function yn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function gi(n){return(0,_.CqO)(n)?n:(0,_.QGY)(n)?(0,An.D)(Promise.resolve(n)):st(n)}const wd={exact:function Wl(n,e,t){if(!j(n.segments,e.segments)||!Hu(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!Wl(n.children[r],e.children[r],t))return!1;return!0},subset:$u},ti={exact:function fs(n,e){return Hi(n,e)},subset:function ef(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Jh(n[t],e[t]))},ignored:()=>!0};function la(n,e,t){return wd[t.paths](n.root,e.root,t.matrixParams)&&ti[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function $u(n,e,t){return ql(n,e,e.segments,t)}function ql(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!j(i,t)||e.hasChildren()||!Hu(i,t,r))}if(n.segments.length===t.length){if(!j(n.segments,t)||!Hu(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!$u(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(j(n.segments,i)&&Hu(n.segments,i,r)&&n.children[qt])&&ql(n.children[qt],e,a,r)}}function Hu(n,e,t){return e.every((r,i)=>ti[t](n[i].parameters,r.parameters))}class Mi{constructor(e,t,r){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$i(this.queryParams)),this._queryParamMap}toString(){return ze.serialize(this)}}class b{constructor(e,t){this.segments=e,this.children=t,this.parent=null,yn(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return yt(this)}}class D{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=$i(this.parameters)),this._parameterMap}toString(){return ks(this)}}function j(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}class se{}class Me{parse(e){const t=new tf(e);return new Mi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${St(e.root,!0)}`,r=function ca(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${dt(t)}=${dt(i)}`).join("&"):`${dt(t)}=${dt(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function Tr(n){return encodeURI(n)}(e.fragment)}`:""}`}}const ze=new Me;function yt(n){return n.segments.map(e=>ks(e)).join("/")}function St(n,e){if(!n.hasChildren())return yt(n);if(e){const t=n.children[qt]?St(n.children[qt],!1):"",r=[];return yn(n.children,(i,a)=>{a!==qt&&r.push(`${a}:${St(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function X(n,e){let t=[];return yn(n.children,(r,i)=>{i===qt&&(t=t.concat(e(r,i)))}),yn(n.children,(r,i)=>{i!==qt&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===qt?[St(n.children[qt],!1)]:[`${i}:${St(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[qt]?`${yt(n)}/${t[0]}`:`${yt(n)}/(${t.join("//")})`}}function kt(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function dt(n){return kt(n).replace(/%3B/gi,";")}function tr(n){return kt(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ro(n){return decodeURIComponent(n)}function io(n){return ro(n.replace(/\+/g,"%20"))}function ks(n){return`${tr(n.path)}${function za(n){return Object.keys(n).map(e=>`;${tr(e)}=${tr(n[e])}`).join("")}(n.parameters)}`}const Ka=/^[^\/()?;=#]+/;function ps(n){const e=n.match(Ka);return e?e[0]:""}const Gi=/^[^=?&#]+/,F_=/^[^&#]+/;class tf{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new b([],{}):new b([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[qt]=new b(e,t)),r}parseSegment(){const e=ps(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new D(ro(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=ps(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=ps(this.remaining);i&&(r=i,this.capture(r))}e[ro(t)]=ro(r)}parseQueryParam(e){const t=function so(n){const e=n.match(Gi);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const l=function Lw(n){const e=n.match(F_);return e?e[0]:""}(this.remaining);l&&(r=l,this.capture(r))}const i=io(t),a=io(r);if(e.hasOwnProperty(i)){let l=e[i];Array.isArray(l)||(l=[l],e[i]=l),l.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=ps(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let a;r.indexOf(":")>-1?(a=r.substr(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=qt);const l=this.parseChildren();t[a]=1===Object.keys(l).length?l[qt]:new b([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class og{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=zl(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=zl(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=nf(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return nf(e,this._root).map(t=>t.value)}}function zl(n,e){if(n===e.value)return e;for(const t of e.children){const r=zl(n,t);if(r)return r}return null}function nf(n,e){if(n===e.value)return[e];for(const t of e.children){const r=nf(n,t);if(r.length)return r.unshift(e),r}return[]}class xo{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Gu(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class Kl extends og{constructor(e,t){super(e),this.snapshot=t,bd(this,e)}toString(){return this.snapshot.toString()}}function Ed(n,e){const t=function Wu(n,e){const l=new Za([],{},{},"",{},qt,e,null,n.root,-1,{});return new Id("",new xo(l,[]))}(n,e),r=new Jr([new D("",{})]),i=new Jr({}),a=new Jr({}),l=new Jr({}),h=new Jr(""),g=new qu(r,i,l,h,a,qt,e,t.root);return g.snapshot=t.root,new Kl(new xo(g,[]),t)}class qu{constructor(e,t,r,i,a,l,h,g){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this._futureSnapshot=g}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ct.U)(e=>$i(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ct.U)(e=>$i(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ag(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function ug(n){return n.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(r))}class Za{constructor(e,t,r,i,a,l,h,g,v,T,S){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this.routeConfig=g,this._urlSegment=v,this._lastPathIndex=T,this._resolve=S}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=$i(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$i(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Id extends og{constructor(e,t){super(t),this.url=e,bd(this,t)}toString(){return rf(this._root)}}function bd(n,e){e.value._routerState=n,e.children.forEach(t=>bd(n,t))}function rf(n){const e=n.children.length>0?` { ${n.children.map(rf).join(", ")} } `:"";return`${n.value}${e}`}function Cd(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Hi(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Hi(e.params,t.params)||n.params.next(t.params),function Vu(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Hi(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Hi(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Zl(n,e){const t=Hi(n.params,e.params)&&function R(n,e){return j(n,e)&&n.every((t,r)=>Hi(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Zl(n.parent,e.parent))}function Yl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function V_(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Yl(n,r,i);return Yl(n,r)})}(n,e,t);return new xo(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const l=a.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(h=>Yl(n,h)),l}}const r=function B_(n){return new qu(new Jr(n.url),new Jr(n.params),new Jr(n.queryParams),new Jr(n.fragment),new Jr(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>Yl(n,a));return new xo(r,i)}}function Ns(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Ps(n){return"object"==typeof n&&null!=n&&n.outlets}function af(n,e,t,r,i){let a={};if(r&&yn(r,(h,g)=>{a[g]=Array.isArray(h)?h.map(v=>`${v}`):`${h}`}),n===e)return new Mi(t,a,i);const l=lg(n,e,t);return new Mi(l,a,i)}function lg(n,e,t){const r={};return yn(n.children,(i,a)=>{r[a]=i===e?t:lg(i,e,t)}),new b(n.segments,r)}class j_{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Ns(r[0]))throw new Error("Root segment cannot have matrix parameters");const i=r.find(Ps);if(i&&i!==Bu(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class dg{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function hg(n,e,t){if(n||(n=new b([],{})),0===n.segments.length&&n.hasChildren())return Td(n,e,t);const r=function G_(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const l=n.segments[i],h=t[r];if(Ps(h))break;const g=`${h}`,v=r<t.length-1?t[r+1]:null;if(i>0&&void 0===g)break;if(g&&v&&"object"==typeof v&&void 0===v.outlets){if(!gg(g,v,l))return a;r+=2}else{if(!gg(g,{},l))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new b(n.segments.slice(0,r.pathIndex),{});return a.children[qt]=new b(n.segments.slice(r.pathIndex),n.children),Td(a,0,i)}return r.match&&0===i.length?new b(n.segments,{}):r.match&&!n.hasChildren()?fg(n,e,t):r.match?Td(n,0,i):fg(n,e,t)}function Td(n,e,t){if(0===t.length)return new b(n.segments,{});{const r=function H_(n){return Ps(n[0])?n[0].outlets:{[qt]:n}}(t),i={};return yn(r,(a,l)=>{"string"==typeof a&&(a=[a]),null!==a&&(i[l]=hg(n.children[l],e,a))}),yn(n.children,(a,l)=>{void 0===r[l]&&(i[l]=a)}),new b(n.segments,i)}}function fg(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(Ps(a)){const g=pg(a.outlets);return new b(r,g)}if(0===i&&Ns(t[0])){r.push(new D(n.segments[e].path,Ql(t[0]))),i++;continue}const l=Ps(a)?a.outlets[qt]:`${a}`,h=i<t.length-1?t[i+1]:null;l&&h&&Ns(h)?(r.push(new D(l,Ql(h))),i+=2):(r.push(new D(l,{})),i++)}return new b(r,{})}function pg(n){const e={};return yn(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=fg(new b([],{}),0,t))}),e}function Ql(n){const e={};return yn(n,(t,r)=>e[r]=`${t}`),e}function gg(n,e,t){return n==t.path&&Hi(e,t.parameters)}class p{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Cd(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=Gu(t);e.children.forEach(a=>{const l=a.value.outlet;this.deactivateRoutes(a,i[l],r),delete i[l]}),yn(i,(a,l)=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const l=r.getContext(i.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Gu(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);if(r&&r.outlet){const l=r.outlet.detach(),h=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Gu(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=Gu(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new Fu(a.value.snapshot))}),e.children.length&&this.forwardEvent(new qa(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(Cd(i),i===a)if(i.component){const l=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const l=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const h=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),Cd(h.route.value),this.activateChildRoutes(e,null,l.children)}else{const h=function m(n){for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),g=h?h.module.componentFactoryResolver:null;l.attachRef=null,l.route=i,l.resolver=g,l.outlet&&l.outlet.activateWith(i,g),this.activateChildRoutes(e,null,l.children)}}else this.activateChildRoutes(e,null,r)}}class I{constructor(e,t){this.routes=e,this.module=t}}function x(n){return"function"==typeof n}function J(n){return n instanceof Mi}const Rn=Symbol("INITIAL_VALUE");function Wi(){return lr(n=>bo(n.map(e=>e.pipe(Co(1),ds(Rn)))).pipe(fi((e,t)=>{let r=!1;return t.reduce((i,a,l)=>i!==Rn?i:(a===Rn&&(r=!0),r||!1!==a&&l!==t.length-1&&!J(a)?i:a),e)},Rn),xn(e=>e!==Rn),(0,Ct.U)(e=>J(e)?e:!0===e),Co(1)))}class Ro{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new da,this.attachRef=null}}class da{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const r=this.getOrCreateContext(e);r.outlet=t,this.contexts.set(e,r)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new Ro,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let Dd=(()=>{class n{constructor(t,r,i,a,l){this.parentContexts=t,this.location=r,this.resolver=i,this.changeDetector=l,this.activated=null,this._activatedRoute=null,this.activateEvents=new _.vpe,this.deactivateEvents=new _.vpe,this.attachEvents=new _.vpe,this.detachEvents=new _.vpe,this.name=a||qt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const l=(r=r||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),h=this.parentContexts.getOrCreateContext(this.name).children,g=new lf(t,h,this.location.injector);this.activated=this.location.createComponent(l,this.location.length,g),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(da),_.Y36(_.s_b),_.Y36(_._Vd),_.$8M("name"),_.Y36(_.sBO))},n.\u0275dir=_.lG2({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class lf{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===qu?this.route:e===da?this.childContexts:this.parent.get(e,t)}}let cf=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,r){1&t&&_._UZ(0,"router-outlet")},directives:[Dd],encapsulation:2}),n})();function Sd(n,e=""){for(let t=0;t<n.length;t++){const r=n[t];zu(r,mg(e,r))}}function zu(n,e){n.children&&Sd(n.children,e)}function mg(n,e){return e?n||e.path?n&&!e.path?`${n}/`:!n&&e.path?e.path:`${n}/${e.path}`:"":n}function Ku(n){const e=n.children&&n.children.map(Ku),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==qt&&(t.component=cf),t}function ki(n){return n.outlet||qt}function nr(n,e){const t=n.filter(r=>ki(r)===e);return t.push(...n.filter(r=>ki(r)!==e)),t}const _g={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Zu(n,e,t){var r;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},_g):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const a=(e.matcher||Uu)(t,n,e);if(!a)return Object.assign({},_g);const l={};yn(a.posParams,(g,v)=>{l[v]=g.path});const h=a.consumed.length>0?Object.assign(Object.assign({},l),a.consumed[a.consumed.length-1].parameters):l;return{matched:!0,consumedSegments:a.consumed,remainingSegments:t.slice(a.consumed.length),parameters:h,positionalParamSegments:null!==(r=a.posParams)&&void 0!==r?r:{}}}function Yu(n,e,t,r,i="corrected"){if(t.length>0&&function fT(n,e,t){return t.some(r=>yg(n,e,r)&&ki(r)!==qt)}(n,t,r)){const l=new b(e,function hT(n,e,t,r){const i={};i[qt]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const a of t)if(""===a.path&&ki(a)!==qt){const l=new b([],{});l._sourceSegment=n,l._segmentIndexShift=e.length,i[ki(a)]=l}return i}(n,e,r,new b(t,n.children)));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:[]}}if(0===t.length&&function pT(n,e,t){return t.some(r=>yg(n,e,r))}(n,t,r)){const l=new b(n.segments,function Fw(n,e,t,r,i,a){const l={};for(const h of r)if(yg(n,t,h)&&!i[ki(h)]){const g=new b([],{});g._sourceSegment=n,g._segmentIndexShift="legacy"===a?n.segments.length:e.length,l[ki(h)]=g}return Object.assign(Object.assign({},i),l)}(n,e,t,r,n.children,i));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:t}}const a=new b(n.segments,n.children);return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}function yg(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function Uw(n,e,t,r){return!!(ki(n)===r||r!==qt&&yg(e,t,n))&&("**"===n.path||Zu(e,n,t).matched)}function gT(n,e,t){return 0===e.length&&!n.children[t]}class W_{constructor(e){this.segmentGroup=e||null}}class Ad{constructor(e){this.urlTree=e}}function zr(n){return Ba(new W_(n))}function vg(n){return Ba(new Ad(n))}class df{constructor(e,t,r,i,a){this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=e.get(_.h0i)}apply(){const e=Yu(this.urlTree.root,[],[],this.config).segmentGroup,t=new b(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,qt).pipe((0,Ct.U)(a=>this.createUrlTree(z_(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Bi(a=>{if(a instanceof Ad)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof W_?this.noMatchError(a):a}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,qt).pipe((0,Ct.U)(i=>this.createUrlTree(z_(i),e.queryParams,e.fragment))).pipe(Bi(i=>{throw i instanceof W_?this.noMatchError(i):i}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,r){const i=e.segments.length>0?new b([],{[qt]:e}):e;return new Mi(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,Ct.U)(a=>new b([],a))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,An.D)(i).pipe(hs(a=>{const l=r.children[a],h=nr(t,a);return this.expandSegmentGroup(e,h,l,a).pipe((0,Ct.U)(g=>({segment:g,outlet:a})))}),fi((a,l)=>(a[l.outlet]=l.segment,a),{}),function _d(n,e){const t=arguments.length>=2;return r=>r.pipe(n?xn((i,a)=>n(i,a,r)):Rs.y,Ou(1),t?md(e):Qh(()=>new ja))}())}expandSegment(e,t,r,i,a,l){return(0,An.D)(r).pipe(hs(h=>this.expandSegmentAgainstRoute(e,t,r,h,i,a,l).pipe(Bi(v=>{if(v instanceof W_)return st(null);throw v}))),Ga(h=>!!h),Bi((h,g)=>{if(h instanceof ja||"EmptyError"===h.name)return gT(t,i,a)?st(new b([],{})):zr(t);throw h}))}expandSegmentAgainstRoute(e,t,r,i,a,l,h){return Uw(i,t,a,l)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,a,l):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l):zr(t):zr(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,l):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?vg(a):this.lineralizeSegments(r,a).pipe((0,br.z)(l=>{const h=new b(l,{});return this.expandSegment(e,h,t,l,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){const{matched:h,consumedSegments:g,remainingSegments:v,positionalParamSegments:T}=Zu(t,i,a);if(!h)return zr(t);const S=this.applyRedirectCommands(g,i.redirectTo,T);return i.redirectTo.startsWith("/")?vg(S):this.lineralizeSegments(i,S).pipe((0,br.z)(k=>this.expandSegment(e,t,r,k.concat(v),l,!1)))}matchSegmentAgainstRoute(e,t,r,i,a){if("**"===r.path)return r.loadChildren?(r._loadedConfig?st(r._loadedConfig):this.configLoader.load(e.injector,r)).pipe((0,Ct.U)(S=>(r._loadedConfig=S,new b(i,{})))):st(new b(i,{}));const{matched:l,consumedSegments:h,remainingSegments:g}=Zu(t,r,i);return l?this.getChildConfig(e,r,i).pipe((0,br.z)(T=>{const S=T.module,k=T.routes,{segmentGroup:U,slicedSegments:K}=Yu(t,h,g,k),he=new b(U.segments,U.children);if(0===K.length&&he.hasChildren())return this.expandChildren(S,k,he).pipe((0,Ct.U)(ct=>new b(h,ct)));if(0===k.length&&0===K.length)return st(new b(h,{}));const be=ki(r)===a;return this.expandSegment(S,he,k,K,be?qt:a,!0).pipe((0,Ct.U)(ft=>new b(h.concat(ft.segments),ft.children)))})):zr(t)}getChildConfig(e,t,r){return t.children?st(new I(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?st(t._loadedConfig):this.runCanLoadGuards(e.injector,t,r).pipe((0,br.z)(i=>i?this.configLoader.load(e.injector,t).pipe((0,Ct.U)(a=>(t._loadedConfig=a,a))):function Bw(n){return Ba(Ao(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`))}(t))):st(new I([],e))}runCanLoadGuards(e,t,r){const i=t.canLoad;return i&&0!==i.length?st(i.map(l=>{const h=e.get(l);let g;if(function xe(n){return n&&x(n.canLoad)}(h))g=h.canLoad(t,r);else{if(!x(h))throw new Error("Invalid CanLoad guard");g=h(t,r)}return gi(g)})).pipe(Wi(),(0,Ri.b)(l=>{if(!J(l))return;const h=Ao(`Redirecting to "${this.urlSerializer.serialize(l)}"`);throw h.url=l,h}),(0,Ct.U)(l=>!0===l)):st(!0)}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return st(r);if(i.numberOfChildren>1||!i.children[qt])return Ba(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));i=i.children[qt]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreatreUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new Mi(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return yn(e,(i,a)=>{if("string"==typeof i&&i.startsWith(":")){const h=i.substring(1);r[a]=t[h]}else r[a]=i}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let l={};return yn(t.children,(h,g)=>{l[g]=this.createSegmentGroup(e,h,r,i)}),new b(a,l)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}function z_(n){const e={};for(const r of Object.keys(n.children)){const a=z_(n.children[r]);(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function q_(n){if(1===n.numberOfChildren&&n.children[qt]){const e=n.children[qt];return new b(n.segments.concat(e.segments),e.children)}return n}(new b(n.segments,e))}class K_{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class wg{constructor(e,t){this.component=e,this.route=t}}function jw(n,e,t){const r=n._root;return ff(r,e?e._root:null,t,[r.value])}function hf(n,e,t){const r=function yT(n){if(!n)return null;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:t).get(n)}function ff(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=Gu(e);return n.children.forEach(l=>{(function Z_(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,l=e?e.value:null,h=t?t.getContext(n.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){const g=function vT(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!j(n.url,e.url);case"pathParamsOrQueryParamsChange":return!j(n.url,e.url)||!Hi(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Zl(n,e)||!Hi(n.queryParams,e.queryParams);default:return!Zl(n,e)}}(l,a,a.routeConfig.runGuardsAndResolvers);g?i.canActivateChecks.push(new K_(r)):(a.data=l.data,a._resolvedData=l._resolvedData),ff(n,e,a.component?h?h.children:null:t,r,i),g&&h&&h.outlet&&h.outlet.isActivated&&i.canDeactivateChecks.push(new wg(h.outlet.component,l))}else l&&pf(e,h,i),i.canActivateChecks.push(new K_(r)),ff(n,null,a.component?h?h.children:null:t,r,i)})(l,a[l.value.outlet],t,r.concat([l.value]),i),delete a[l.value.outlet]}),yn(a,(l,h)=>pf(l,t.getContext(h),i)),i}function pf(n,e,t){const r=Gu(n),i=n.value;yn(r,(a,l)=>{pf(a,i.component?e?e.children.getContext(l):null:e,t)}),t.canDeactivateChecks.push(new wg(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}class DT{}function Q_(n){return new xi.y(e=>e.error(n))}class AT{constructor(e,t,r,i,a,l){this.rootComponentType=e,this.config=t,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=l}recognize(){const e=Yu(this.urlTree.root,[],[],this.config.filter(l=>void 0===l.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,qt);if(null===t)return null;const r=new Za([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},qt,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new xo(r,t),a=new Id(this.url,i);return this.inheritParamsAndData(a._root),a}inheritParamsAndData(e){const t=e.value,r=ag(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,r)}processChildren(e,t){const r=[];for(const a of Object.keys(t.children)){const l=t.children[a],h=nr(e,a),g=this.processSegmentGroup(h,l,a);if(null===g)return null;r.push(...g)}const i=$w(r);return function xT(n){n.sort((e,t)=>e.value.outlet===qt?-1:t.value.outlet===qt?1:e.value.outlet.localeCompare(t.value.outlet))}(i),i}processSegment(e,t,r,i){for(const a of e){const l=this.processSegmentAgainstRoute(a,t,r,i);if(null!==l)return l}return gT(t,r,i)?[]:null}processSegmentAgainstRoute(e,t,r,i){if(e.redirectTo||!Uw(e,t,r,i))return null;let a,l=[],h=[];if("**"===e.path){const U=r.length>0?Bu(r).parameters:{};a=new Za(r,U,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Mo(e),ki(e),e.component,e,Hw(t),Xl(t)+r.length,kT(e))}else{const U=Zu(t,e,r);if(!U.matched)return null;l=U.consumedSegments,h=U.remainingSegments,a=new Za(l,U.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Mo(e),ki(e),e.component,e,Hw(t),Xl(t)+l.length,kT(e))}const g=function RT(n){return n.children?n.children:n.loadChildren?n._loadedConfig.routes:[]}(e),{segmentGroup:v,slicedSegments:T}=Yu(t,l,h,g.filter(U=>void 0===U.redirectTo),this.relativeLinkResolution);if(0===T.length&&v.hasChildren()){const U=this.processChildren(g,v);return null===U?null:[new xo(a,U)]}if(0===g.length&&0===T.length)return[new xo(a,[])];const S=ki(e)===i,k=this.processSegment(g,v,T,S?qt:i);return null===k?null:[new xo(a,k)]}}function MT(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function $w(n){const e=[],t=new Set;for(const r of n){if(!MT(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=$w(r.children);e.push(new xo(r.value,i))}return e.filter(r=>!t.has(r))}function Hw(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Xl(n){let e=n,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function Mo(n){return n.data||{}}function kT(n){return n.resolve||{}}function Ig(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function J_(n){return lr(e=>{const t=n(e);return t?(0,An.D)(t).pipe((0,Ct.U)(()=>e)):st(e)})}class qw extends class gf{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const bg=new _.OlP("ROUTES");class Cg{constructor(e,t,r,i){this.injector=e,this.compiler=t,this.onLoadStartListener=r,this.onLoadEndListener=i}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const i=this.loadModuleFactory(t.loadChildren).pipe((0,Ct.U)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t);const l=a.create(e);return new I(Gl(l.injector.get(bg,void 0,_.XFs.Self|_.XFs.Optional)).map(Ku),l)}),Bi(a=>{throw t._loader$=void 0,a}));return t._loader$=new Or(i,()=>new us.x).pipe(jl()),t._loader$}loadModuleFactory(e){return gi(e()).pipe((0,br.z)(t=>t instanceof _.YKP?st(t):(0,An.D)(this.compiler.compileModuleAsync(t))))}}class zw{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function oR(n){throw n}function xd(n,e,t){return e.parse("/")}function Tg(n,e){return st(null)}const Kw={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},NT={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let mi=(()=>{class n{constructor(t,r,i,a,l,h,g){this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=i,this.location=a,this.config=g,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new us.x,this.errorHandler=oR,this.malformedUriErrorHandler=xd,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Tg,afterPreactivation:Tg},this.urlHandlingStrategy=new zw,this.routeReuseStrategy=new qw,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=l.get(_.h0i),this.console=l.get(_.c2e);const S=l.get(_.R0b);this.isNgZoneEnabled=S instanceof _.R0b&&_.R0b.isInAngularZone(),this.resetConfig(g),this.currentUrlTree=function ju(){return new Mi(new b([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Cg(l,h,k=>this.triggerEvent(new pi(k)),k=>this.triggerEvent(new Hl(k))),this.routerState=Ed(this.currentUrlTree,this.rootComponentType),this.transitions=new Jr({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const r=this.events;return t.pipe(xn(i=>0!==i.id),(0,Ct.U)(i=>Object.assign(Object.assign({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),lr(i=>{let a=!1,l=!1;return st(i).pipe((0,Ri.b)(h=>{this.currentNavigation={id:h.id,initialUrl:h.currentRawUrl,extractedUrl:h.extractedUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),lr(h=>{const g=this.browserUrlTree.toString(),v=!this.navigated||h.extractedUrl.toString()!==g||g!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||v)&&this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return Zw(h.source)&&(this.browserUrlTree=h.extractedUrl),st(h).pipe(lr(S=>{const k=this.transitions.getValue();return r.next(new Xh(S.id,this.serializeUrl(S.extractedUrl),S.source,S.restoredState)),k!==this.transitions.getValue()?ei.E:Promise.resolve(S)}),function mT(n,e,t,r){return lr(i=>function Ni(n,e,t,r,i){return new df(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,Ct.U)(a=>Object.assign(Object.assign({},i),{urlAfterRedirects:a}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,Ri.b)(S=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:S.urlAfterRedirects})}),function iR(n,e,t,r,i){return(0,br.z)(a=>function ST(n,e,t,r,i="emptyOnly",a="legacy"){try{const l=new AT(n,e,t,r,i,a).recognize();return null===l?Q_(new DT):st(l)}catch(l){return Q_(l)}}(n,e,a.urlAfterRedirects,t(a.urlAfterRedirects),r,i).pipe((0,Ct.U)(l=>Object.assign(Object.assign({},a),{targetSnapshot:l}))))}(this.rootComponentType,this.config,S=>this.serializeUrl(S),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,Ri.b)(S=>{if("eager"===this.urlUpdateStrategy){if(!S.extras.skipLocationChange){const U=this.urlHandlingStrategy.merge(S.urlAfterRedirects,S.rawUrl);this.setBrowserUrl(U,S)}this.browserUrlTree=S.urlAfterRedirects}const k=new Lu(S.id,this.serializeUrl(S.extractedUrl),this.serializeUrl(S.urlAfterRedirects),S.targetSnapshot);r.next(k)}));if(v&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:k,extractedUrl:U,source:K,restoredState:he,extras:be}=h,lt=new Xh(k,this.serializeUrl(U),K,he);r.next(lt);const ft=Ed(U,this.rootComponentType).snapshot;return st(Object.assign(Object.assign({},h),{targetSnapshot:ft,urlAfterRedirects:U,extras:Object.assign(Object.assign({},be),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=h.rawUrl,h.resolve(null),ei.E}),J_(h=>{const{targetSnapshot:g,id:v,extractedUrl:T,rawUrl:S,extras:{skipLocationChange:k,replaceUrl:U}}=h;return this.hooks.beforePreactivation(g,{navigationId:v,appliedUrlTree:T,rawUrlTree:S,skipLocationChange:!!k,replaceUrl:!!U})}),(0,Ri.b)(h=>{const g=new So(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);this.triggerEvent(g)}),(0,Ct.U)(h=>Object.assign(Object.assign({},h),{guards:jw(h.targetSnapshot,h.currentSnapshot,this.rootContexts)})),function Y_(n,e){return(0,br.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:l}}=t;return 0===l.length&&0===a.length?st(Object.assign(Object.assign({},t),{guardsResult:!0})):function wT(n,e,t,r){return(0,An.D)(n).pipe((0,br.z)(i=>function TT(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?st(a.map(h=>{const g=hf(h,e,i);let v;if(function Vt(n){return n&&x(n.canDeactivate)}(g))v=gi(g.canDeactivate(n,e,t,r));else{if(!x(g))throw new Error("Invalid CanDeactivate guard");v=gi(g(n,e,t,r))}return v.pipe(Ga())})).pipe(Wi()):st(!0)}(i.component,i.route,t,e,r)),Ga(i=>!0!==i,!0))}(l,r,i,n).pipe((0,br.z)(h=>h&&function O(n){return"boolean"==typeof n}(h)?function ET(n,e,t,r){return(0,An.D)(e).pipe(hs(i=>Nu(function IT(n,e){return null!==n&&e&&e(new Wa(n)),st(!0)}(i.route.parent,r),function Eg(n,e){return null!==n&&e&&e(new to(n)),st(!0)}(i.route,r),function CT(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(l=>function _T(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(l)).filter(l=>null!==l).map(l=>Pu(()=>st(l.guards.map(g=>{const v=hf(g,l.node,t);let T;if(function vt(n){return n&&x(n.canActivateChild)}(v))T=gi(v.canActivateChild(r,n));else{if(!x(v))throw new Error("Invalid CanActivateChild guard");T=gi(v(r,n))}return T.pipe(Ga())})).pipe(Wi())));return st(a).pipe(Wi())}(n,i.path,t),function bT(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return st(!0);const i=r.map(a=>Pu(()=>{const l=hf(a,e,t);let h;if(function tt(n){return n&&x(n.canActivate)}(l))h=gi(l.canActivate(e,n));else{if(!x(l))throw new Error("Invalid CanActivate guard");h=gi(l(e,n))}return h.pipe(Ga())}));return st(i).pipe(Wi())}(n,i.route,t))),Ga(i=>!0!==i,!0))}(r,a,n,e):st(h)),(0,Ct.U)(h=>Object.assign(Object.assign({},t),{guardsResult:h})))})}(this.ngModule.injector,h=>this.triggerEvent(h)),(0,Ri.b)(h=>{if(J(h.guardsResult)){const v=Ao(`Redirecting to "${this.serializeUrl(h.guardsResult)}"`);throw v.url=h.guardsResult,v}const g=new ig(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.triggerEvent(g)}),xn(h=>!!h.guardsResult||(this.restoreHistory(h),this.cancelNavigationTransition(h,""),!1)),J_(h=>{if(h.guards.canActivateChecks.length)return st(h).pipe((0,Ri.b)(g=>{const v=new $l(g.id,this.serializeUrl(g.extractedUrl),this.serializeUrl(g.urlAfterRedirects),g.targetSnapshot);this.triggerEvent(v)}),lr(g=>{let v=!1;return st(g).pipe(function Gw(n,e){return(0,br.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return st(t);let a=0;return(0,An.D)(i).pipe(hs(l=>function sR(n,e,t,r){return function ha(n,e,t,r){const i=Ig(n);if(0===i.length)return st({});const a={};return(0,An.D)(i).pipe((0,br.z)(l=>function X_(n,e,t,r){const i=hf(n,e,r);return gi(i.resolve?i.resolve(e,t):i(e,t))}(n[l],e,t,r).pipe((0,Ri.b)(h=>{a[l]=h}))),Ou(1),(0,br.z)(()=>Ig(a).length===i.length?st(a):ei.E))}(n._resolve,n,e,r).pipe((0,Ct.U)(a=>(n._resolvedData=a,n.data=Object.assign(Object.assign({},n.data),ag(n,t).resolve),null)))}(l.route,r,n,e)),(0,Ri.b)(()=>a++),Ou(1),(0,br.z)(l=>a===i.length?st(t):ei.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,Ri.b)({next:()=>v=!0,complete:()=>{v||(this.restoreHistory(g),this.cancelNavigationTransition(g,"At least one route resolver didn't emit any value."))}}))}),(0,Ri.b)(g=>{const v=new qr(g.id,this.serializeUrl(g.extractedUrl),this.serializeUrl(g.urlAfterRedirects),g.targetSnapshot);this.triggerEvent(v)}))}),J_(h=>{const{targetSnapshot:g,id:v,extractedUrl:T,rawUrl:S,extras:{skipLocationChange:k,replaceUrl:U}}=h;return this.hooks.afterPreactivation(g,{navigationId:v,appliedUrlTree:T,rawUrlTree:S,skipLocationChange:!!k,replaceUrl:!!U})}),(0,Ct.U)(h=>{const g=function U_(n,e,t){const r=Yl(n,e._root,t?t._root:void 0);return new Kl(r,e)}(this.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return Object.assign(Object.assign({},h),{targetRouterState:g})}),(0,Ri.b)(h=>{this.currentUrlTree=h.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl),this.routerState=h.targetRouterState,"deferred"===this.urlUpdateStrategy&&(h.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,h),this.browserUrlTree=h.urlAfterRedirects)}),((n,e,t)=>(0,Ct.U)(r=>(new p(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,h=>this.triggerEvent(h)),(0,Ri.b)({next(){a=!0},complete(){a=!0}}),function L_(n){return(0,er.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}(()=>{var h;a||l||this.cancelNavigationTransition(i,`Navigation ID ${i.id} is not equal to the current navigation id ${this.navigationId}`),(null===(h=this.currentNavigation)||void 0===h?void 0:h.id)===i.id&&(this.currentNavigation=null)}),Bi(h=>{if(l=!0,function no(n){return n&&n[Cr]}(h)){const g=J(h.url);g||(this.navigated=!0,this.restoreHistory(i,!0));const v=new rg(i.id,this.serializeUrl(i.extractedUrl),h.message);r.next(v),g?setTimeout(()=>{const T=this.urlHandlingStrategy.merge(h.url,this.rawUrlTree),S={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Zw(i.source)};this.scheduleNavigation(T,"imperative",null,S,{resolve:i.resolve,reject:i.reject,promise:i.promise})},0):i.resolve(!1)}else{this.restoreHistory(i,!0);const g=new Vn(i.id,this.serializeUrl(i.extractedUrl),h);r.next(g);try{i.resolve(this.errorHandler(h))}catch(v){i.reject(v)}}return ei.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{var i;const a={replaceUrl:!0},l=(null===(i=t.state)||void 0===i?void 0:i.navigationId)?t.state:null;if(l){const g=Object.assign({},l);delete g.navigationId,delete g.\u0275routerPageId,0!==Object.keys(g).length&&(a.state=g)}const h=this.parseUrl(t.url);this.scheduleNavigation(h,r,l,a)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){Sd(t),this.config=t.map(Ku),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:l,queryParamsHandling:h,preserveFragment:g}=r,v=i||this.routerState.root,T=g?this.currentUrlTree.fragment:l;let S=null;switch(h){case"merge":S=Object.assign(Object.assign({},this.currentUrlTree.queryParams),a);break;case"preserve":S=this.currentUrlTree.queryParams;break;default:S=a||null}return null!==S&&(S=this.removeEmptyProps(S)),function sf(n,e,t,r,i){if(0===t.length)return af(e.root,e.root,e.root,r,i);const a=function cg(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new j_(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,l)=>{if("object"==typeof a&&null!=a){if(a.outlets){const h={};return yn(a.outlets,(g,v)=>{h[v]="string"==typeof g?g.split("/"):g}),[...i,{outlets:h}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===l?(a.split("/").forEach((h,g)=>{0==g&&"."===h||(0==g&&""===h?t=!0:".."===h?e++:""!=h&&i.push(h))}),i):[...i,a]},[]);return new j_(t,e,r)}(t);if(a.toRoot())return af(e.root,e.root,new b([],{}),r,i);const l=function $_(n,e,t){if(n.isAbsolute)return new dg(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const a=t.snapshot._urlSegment;return new dg(a,a===e.root,0)}const r=Ns(n.commands[0])?0:1;return function uf(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new dg(r,!1,i-a)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+r,n.numberOfDoubleDots)}(a,e,n),h=l.processChildren?Td(l.segmentGroup,l.index,a.commands):hg(l.segmentGroup,l.index,a.commands);return af(e.root,l.segmentGroup,h,r,i)}(v,this.currentUrlTree,t,S,null!=T?T:null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=J(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function PT(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?Object.assign({},Kw):!1===r?Object.assign({},NT):r,J(t))return la(this.currentUrlTree,t,i);const a=this.parseUrl(t);return la(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new ji(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,r,i,a,l){var h,g;if(this.disposed)return Promise.resolve(!1);let v,T,S;l?(v=l.resolve,T=l.reject,S=l.promise):S=new Promise((K,he)=>{v=K,T=he});const k=++this.navigationId;let U;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),U=i&&i.\u0275routerPageId?i.\u0275routerPageId:a.replaceUrl||a.skipLocationChange?null!==(h=this.browserPageId)&&void 0!==h?h:0:(null!==(g=this.browserPageId)&&void 0!==g?g:0)+1):U=0,this.setTransition({id:k,targetPageId:U,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:a,resolve:v,reject:T,promise:S,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),S.catch(K=>Promise.reject(K))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),a=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",a):this.location.go(i,"",a)}restoreHistory(t,r=!1){var i,a;if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)||0===l?this.currentUrlTree===(null===(a=this.currentNavigation)||void 0===a?void 0:a.finalUrl)&&0===l&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(l)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,r){const i=new rg(t.id,this.serializeUrl(t.extractedUrl),r);this.triggerEvent(i),t.resolve(!1)}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){_.$Z()},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();function Zw(n){return"imperative"!==n}let Jl=(()=>{class n{constructor(t,r,i,a,l){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=a,this.el=l,this.commands=null,this.onChanges=new us.x,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){if(null!=this.tabIndexAttribute)return;const r=this.renderer,i=this.el.nativeElement;null!==t?r.setAttribute(i,"tabindex",t):r.removeAttribute(i,"tabindex")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const t={skipLocationChange:Rd(this.skipLocationChange),replaceUrl:Rd(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,t),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Rd(this.preserveFragment)})}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(mi),_.Y36(qu),_.$8M("tabindex"),_.Y36(_.Qsj),_.Y36(_.SBq))},n.\u0275dir=_.lG2({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,r){1&t&&_.NdJ("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[_.TTD]}),n})();function Rd(n){return""===n||!!n}class Dg{}class Sg{preload(e,t){return st(null)}}let Xw=(()=>{class n{constructor(t,r,i,a){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new Cg(i,r,g=>t.triggerEvent(new pi(g)),g=>t.triggerEvent(new Hl(g)))}setUpPreloading(){this.subscription=this.router.events.pipe(xn(t=>t instanceof ji),hs(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(_.h0i);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r)if(a.loadChildren&&!a.canLoad&&a._loadedConfig){const l=a._loadedConfig;i.push(this.processRoutes(l.module,l.routes))}else a.loadChildren&&!a.canLoad?i.push(this.preloadConfig(t,a)):a.children&&i.push(this.processRoutes(t,a.children));return(0,An.D)(i).pipe((0,Ms.J)(),(0,Ct.U)(a=>{}))}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?st(r._loadedConfig):this.loader.load(t.injector,r)).pipe((0,br.z)(a=>(r._loadedConfig=a,this.processRoutes(a.module,a.routes)))))}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(mi),_.LFG(_.Sil),_.LFG(_.zs3),_.LFG(Dg))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),ny=(()=>{class n{constructor(t,r,i={}){this.router=t,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Xh?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ji&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof yd&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.router.triggerEvent(new yd(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){_.$Z()},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const Qu=new _.OlP("ROUTER_CONFIGURATION"),Xu=new _.OlP("ROUTER_FORROOT_GUARD"),Jw=[Ae,{provide:se,useClass:Me},{provide:mi,useFactory:function rE(n,e,t,r,i,a,l={},h,g){const v=new mi(null,n,e,t,r,i,Gl(a));return h&&(v.urlHandlingStrategy=h),g&&(v.routeReuseStrategy=g),function iy(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(l,v),l.enableTracing&&v.events.subscribe(T=>{var S,k;null===(S=console.group)||void 0===S||S.call(console,`Router Event: ${T.constructor.name}`),console.log(T.toString()),console.log(T),null===(k=console.groupEnd)||void 0===k||k.call(console)}),v},deps:[se,da,Ae,_.zs3,_.Sil,bg,Qu,[class ey{},new _.FiY],[class Ww{},new _.FiY]]},da,{provide:qu,useFactory:function iE(n){return n.routerState.root},deps:[mi]},Xw,Sg,class Qw{preload(e,t){return t().pipe(Bi(()=>st(null)))}},{provide:Qu,useValue:{enableTracing:!1}}];function eE(){return new _.PXZ("Router",mi)}let tE=(()=>{class n{constructor(t,r){}static forRoot(t,r){return{ngModule:n,providers:[Jw,ry(t),{provide:Xu,useFactory:nE,deps:[[mi,new _.FiY,new _.tp0]]},{provide:Qu,useValue:r||{}},{provide:_e,useFactory:FT,deps:[le,[new _.tBr(qe),new _.FiY],Qu]},{provide:ny,useFactory:Ag,deps:[mi,Tu,Qu]},{provide:Dg,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:Sg},{provide:_.PXZ,multi:!0,useFactory:eE},[Md,{provide:_.ip1,multi:!0,useFactory:xg,deps:[Md]},{provide:Rg,useFactory:sE,deps:[Md]},{provide:_.tb,multi:!0,useExisting:Rg}]]}}static forChild(t){return{ngModule:n,providers:[ry(t)]}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Xu,8),_.LFG(mi,8))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})();function Ag(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new ny(n,e,t)}function FT(n,e,t={}){return t.useHash?new Pe(n,e):new Ge(n,e)}function nE(n){return"guarded"}function ry(n){return[{provide:_.deG,multi:!0,useValue:n},{provide:bg,multi:!0,useValue:n}]}let Md=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new us.x}appInitializer(){return this.injector.get(z,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const i=new Promise(h=>r=h),a=this.injector.get(mi),l=this.injector.get(Qu);return"disabled"===l.initialNavigation?(a.setUpLocationChangeListener(),r(!0)):"enabled"===l.initialNavigation||"enabledBlocking"===l.initialNavigation?(a.hooks.afterPreactivation=()=>this.initNavigation?st(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),a.initialNavigation()):r(!0),i})}bootstrapListener(t){const r=this.injector.get(Qu),i=this.injector.get(Xw),a=this.injector.get(ny),l=this.injector.get(mi),h=this.injector.get(_.z2F);t===h.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&l.initialNavigation(),i.setUpPreloading(),a.init(),l.resetRootComponentType(h.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(_.zs3))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();function xg(n){return n.appInitializer.bind(n)}function sE(n){return n.bootstrapListener.bind(n)}const Rg=new _.OlP("Router Initializer");let mf=(()=>{class n{constructor(){this.title="ng-firebase-auth"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(t,r){1&t&&(_.TgZ(0,"div"),_._UZ(1,"router-outlet"),_.qZA())},directives:[Dd],encapsulation:2}),n})();var sy=F(4986),fn=F(5813);function oy(){return(0,er.e)((n,e)=>{let t,r=!1;n.subscribe((0,zn.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}function uE(n,e=Rs.y){return n=null!=n?n:lE,(0,er.e)((t,r)=>{let i,a=!0;t.subscribe((0,zn.x)(r,l=>{const h=e(l);(a||!n(i,h))&&(a=!1,i=h,r.next(l))}))})}function lE(n,e){return n===e}var mt,Dr=F(2011),cE=(F(5881),F(3942)),me=F(5861),qi=F(9681),oo=F(4859),ko=F(1877),L=F(2090),No="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ya={},ay=ay||{},Ot=No||self;function Mg(){}function kg(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function kd(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var uy="closure_uid_"+(1e9*Math.random()>>>0),BT=0;function Bt(n,e,t){return n.call.apply(n.bind,arguments)}function dE(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function _i(n,e,t){return(_i=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Bt:dE).apply(null,arguments)}function _f(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Lr(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(r,i,a){for(var l=Array(arguments.length-2),h=2;h<arguments.length;h++)l[h-2]=arguments[h];return e.prototype[i].apply(r,l)}}function ni(){this.s=this.s,this.o=this.o}ni.prototype.s=!1,ni.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function VT(n){Object.prototype.hasOwnProperty.call(n,uy)&&n[uy]||(n[uy]=++BT)}(this)},ni.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const fE=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function yf(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function fa(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(kg(r)){const i=n.length||0,a=r.length||0;n.length=i+a;for(let l=0;l<a;l++)n[i+l]=r[l]}else n.push(r)}}function ri(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}ri.prototype.h=function(){this.defaultPrevented=!0};var pE=function(){if(!Ot.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Ot.addEventListener("test",Mg,e),Ot.removeEventListener("test",Mg,e)}catch(t){}return n}();function Nd(n){return/^[\s\xa0]*$/.test(n)}var jT=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function Ng(n,e){return n<e?-1:n>e?1:0}function ly(){var n=Ot.navigator;return n&&(n=n.userAgent)?n:""}function Os(n){return-1!=ly().indexOf(n)}function Pd(n){return Pd[" "](n),n}Pd[" "]=Mg;var vf,n,dy=Os("Opera"),Ju=Os("Trident")||Os("MSIE"),$T=Os("Edge"),hy=$T||Ju,gE=Os("Gecko")&&!(-1!=ly().toLowerCase().indexOf("webkit")&&!Os("Edge"))&&!(Os("Trident")||Os("MSIE"))&&!Os("Edge"),HT=-1!=ly().toLowerCase().indexOf("webkit")&&!Os("Edge");function mE(){var n=Ot.document;return n?n.documentMode:void 0}e:{var _E="",fy=(n=ly(),gE?/rv:([^\);]+)(\)|;)/.exec(n):$T?/Edge\/([\d\.]+)/.exec(n):Ju?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):HT?/WebKit\/(\S+)/.exec(n):dy?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(fy&&(_E=fy?fy[1]:""),Ju){var yE=mE();if(null!=yE&&yE>parseFloat(_E)){vf=String(yE);break e}}vf=_E}var vE={};var aR=Ot.document&&Ju&&(mE()||parseInt(vf,10))||void 0;function Og(n,e){if(ri.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(gE){e:{try{Pd(e.nodeName);var i=!0;break e}catch(a){}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:uR[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Og.X.h.call(this)}}Lr(Og,ri);var uR={2:"touch",3:"pen",4:"mouse"};Og.prototype.h=function(){Og.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Lg="closure_listenable_"+(1e6*Math.random()|0),lR=0;function cR(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ha=i,this.key=++lR,this.ba=this.ea=!1}function gy(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function EE(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function GT(n){const e={};for(const t in n)e[t]=n[t];return e}const WT="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Qa(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<WT.length;a++)t=WT[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Od(n){this.src=n,this.g={},this.h=0}function my(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=fE(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(gy(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Fg(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.ba&&a.listener==e&&a.capture==!!t&&a.ha==r)return i}return-1}Od.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var l=Fg(n,e,r,i);return-1<l?(e=n[l],t||(e.ea=!1)):((e=new cR(e,this.src,a,!!r,i)).ea=t,n.push(e)),e};var wf="closure_lm_"+(1e6*Math.random()|0),Ug={};function Vg(n,e,t,r,i){if(r&&r.once)return _y(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)Vg(n,e[a],t,r,i);return null}return t=ec(t),n&&n[Lg]?n.N(e,t,kd(r)?!!r.capture:!!r,i):IE(n,e,t,!1,r,i)}function IE(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var l=kd(i)?!!i.capture:!!i,h=yy(n);if(h||(n[wf]=h=new Od(n)),(t=h.add(e,t,r,l,a)).proxy)return t;if(r=function el(){const e=TE;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)pE||(i=l),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(CE(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function _y(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)_y(n,e[a],t,r,i);return null}return t=ec(t),n&&n[Lg]?n.O(e,t,kd(r)?!!r.capture:!!r,i):IE(n,e,t,!0,r,i)}function bE(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)bE(n,e[a],t,r,i);else r=kd(r)?!!r.capture:!!r,t=ec(t),n&&n[Lg]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Fg(a=n.g[e],t,r,i))&&(gy(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=yy(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Fg(e,t,r,i)),(t=-1<n?e[n]:null)&&Ef(t))}function Ef(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[Lg])my(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(CE(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=yy(e))?(my(t,n),0==t.h&&(t.src=null,e[wf]=null)):gy(n)}}}function CE(n){return n in Ug?Ug[n]:Ug[n]="on"+n}function TE(n,e){if(n.ba)n=!0;else{e=new Og(e,this);var t=n.listener,r=n.ha||n.src;n.ea&&Ef(n),n=t.call(r,e)}return n}function yy(n){return(n=n[wf])instanceof Od?n:null}var vy="__closure_events_fn_"+(1e9*Math.random()>>>0);function ec(n){return"function"==typeof n?n:(n[vy]||(n[vy]=function(e){return n.handleEvent(e)}),n[vy])}function cr(){ni.call(this),this.i=new Od(this),this.P=this,this.I=null}function Kr(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new ri(e,n);else if(e instanceof ri)e.target=e.target||n;else{var i=e;Qa(e=new ri(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var l=e.g=t[a];i=Xa(l,r,!0,e)&&i}if(i=Xa(l=e.g=n,r,!0,e)&&i,i=Xa(l,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=Xa(l=e.g=t[a],r,!1,e)&&i}function Xa(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var l=e[a];if(l&&!l.ba&&l.capture==t){var h=l.listener,g=l.ha||l.src;l.ea&&my(n.i,l),i=!1!==h.call(g,r)&&i}}return i&&!r.defaultPrevented}Lr(cr,ni),cr.prototype[Lg]=!0,cr.prototype.removeEventListener=function(n,e,t,r){bE(this,n,e,t,r)},cr.prototype.M=function(){if(cr.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)gy(t[r]);delete n.g[e],n.h--}}this.I=null},cr.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},cr.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var tc=Ot.JSON.stringify;function Ld(){var n=by;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var jg,wy=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new DE,n=>n.reset());class DE{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Ey(n){Ot.setTimeout(()=>{throw n},0)}function Bg(n,e){jg||function $g(){var n=Ot.Promise.resolve(void 0);jg=function(){n.then(dR)}}(),Iy||(jg(),Iy=!0),by.add(n,e)}var Iy=!1,by=new class qT{constructor(){this.h=this.g=null}add(e,t){const r=wy.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function dR(){for(var n;n=Ld();){try{n.h.call(n.g)}catch(t){Ey(t)}var e=wy;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Iy=!1}function If(n,e){cr.call(this),this.h=n||1,this.g=e||Ot,this.j=_i(this.lb,this),this.l=Date.now()}function Hg(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function Cy(n,e,t){if("function"==typeof n)t&&(n=_i(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=_i(n.handleEvent,n)}return 2147483647<Number(e)?-1:Ot.setTimeout(n,e||0)}function Ty(n){n.g=Cy(()=>{n.g=null,n.i&&(n.i=!1,Ty(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Lr(If,cr),(mt=If.prototype).ca=!1,mt.R=null,mt.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Kr(this,"tick"),this.ca&&(Hg(this),this.start()))}},mt.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},mt.M=function(){If.X.M.call(this),Hg(this),delete this.g};class zT extends ni{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Ty(this)}M(){super.M(),this.g&&(Ot.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bf(n){ni.call(this),this.h=n,this.g={}}Lr(bf,ni);var gs=[];function SE(n,e,t,r){Array.isArray(t)||(t&&(gs[0]=t.toString()),t=gs);for(var i=0;i<t.length;i++){var a=Vg(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function AE(n){EE(n.g,function(e,t){this.g.hasOwnProperty(t)&&Ef(e)},n),n.g={}}function Dy(){this.g=!0}function Cf(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Sy(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var l=1;l<i.length;l++)i[l]=""}}}return tc(t)}catch(h){return e}}(n,t)+(r?" "+r:"")})}bf.prototype.M=function(){bf.X.M.call(this),AE(this)},bf.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Dy.prototype.Aa=function(){this.g=!1},Dy.prototype.info=function(){};var tl={},RE=null;function Gg(){return RE=RE||new cr}function ME(n){ri.call(this,tl.Pa,n)}function Fd(n){const e=Gg();Kr(e,new ME(e))}function kE(n,e){ri.call(this,tl.STAT_EVENT,n),this.stat=e}function Pi(n){const e=Gg();Kr(e,new kE(e,n))}function NE(n,e){ri.call(this,tl.Qa,n),this.size=e}function Tf(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Ot.setTimeout(function(){n()},e)}tl.Pa="serverreachability",Lr(ME,ri),tl.STAT_EVENT="statevent",Lr(kE,ri),tl.Qa="timingevent",Lr(NE,ri);var Df={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Ay={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function xy(){}function Wg(){}xy.prototype.h=null;var qg,Sf={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function Ry(){ri.call(this,"d")}function PE(){ri.call(this,"c")}function zg(){}function Af(n,e,t,r){this.l=n,this.j=e,this.m=t,this.U=r||1,this.S=new bf(this),this.O=My,this.T=new If(n=hy?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new OE}function OE(){this.i=null,this.g="",this.h=!1}Lr(Ry,ri),Lr(PE,ri),Lr(zg,xy),zg.prototype.g=function(){return new XMLHttpRequest},zg.prototype.i=function(){return{}},qg=new zg;var My=45e3,ky={},Kg={};function Ud(n,e,t){n.K=1,n.v=xf(ao(e)),n.s=t,n.P=!0,Zg(n,null)}function Zg(n,e){n.F=Date.now(),Vd(n),n.A=ao(n.v);var t=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),sc(t.i,"t",r),n.C=0,t=n.l.H,n.h=new OE,n.g=yi(n.l,t?e:null,!n.s),0<n.N&&(n.L=new zT(_i(n.La,n,n.g),n.N)),SE(n.S,n.g,"readystatechange",n.ib),e=n.H?GT(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),Fd(),function hR(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var l="",h=a.split("&"),g=0;g<h.length;g++){var v=h[g].split("=");if(1<v.length){var T=v[0];v=v[1];var S=T.split("_");l=2<=S.length&&"type"==S[1]?l+(T+"=")+v+"&":l+(T+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+l})}(n.j,n.u,n.A,n.m,n.U,n.s)}function LE(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function Yg(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=Ny(n,t),i==Kg){4==e&&(n.o=4,Pi(14),r=!1),Cf(n.j,n.m,null,"[Incomplete Response]");break}if(i==ky){n.o=4,Pi(15),Cf(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Cf(n.j,n.m,i,null),Oy(n,i)}LE(n)&&i!=Kg&&i!=ky&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Pi(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),rl(e),e.K=!0,Pi(11))):(Cf(n.j,n.m,t,"[Invalid Chunked Response]"),Bd(n),nc(n))}function Ny(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Kg:(t=Number(e.substring(t,r)),isNaN(t)?ky:(r+=1)+t>e.length?Kg:(e=e.substr(r,t),n.C=r+t,e))}function Vd(n){n.V=Date.now()+n.O,ZT(n,n.O)}function ZT(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Tf(_i(n.gb,n),e)}function Py(n){n.B&&(Ot.clearTimeout(n.B),n.B=null)}function nc(n){0==n.l.G||n.I||JE(n.l,n)}function Bd(n){Py(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,Hg(n.T),AE(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Oy(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||Vy(t.h,n)))if(!n.J&&Vy(t.h,n)&&3==t.G){try{var r=t.Fa.g.parse(e)}catch(v){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(t.u)t.Ba=i[1],0<t.Ba-t.T&&37500>i[2]&&t.L&&0==t.A&&!t.v&&(t.v=Tf(_i(t.cb,t),6e3));else{if(t.g){if(!(t.g.F+3e3<n.F))break e;il(t),am(t)}$d(t),Pi(18)}if(1>=WE(t.h)&&t.ja){try{t.ja()}catch(v){}t.ja=void 0}}else eu(t,11)}else if((n.J||t.g==n)&&il(t),!Nd(e))for(i=t.Fa.g.parse(e),e=0;e<i.length;e++){let v=i[e];if(t.T=v[0],v=v[1],2==t.G)if("c"==v[0]){t.I=v[1],t.ka=v[2];const T=v[3];null!=T&&(t.ma=T,t.j.info("VER="+t.ma));const S=v[4];null!=S&&(t.Ca=S,t.j.info("SVER="+t.Ca));const k=v[5];null!=k&&"number"==typeof k&&0<k&&(t.J=r=1.5*k,t.j.info("backChannelRequestTimeoutMs_="+r)),r=t;const U=n.g;if(U){const K=U.g?U.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(K){var a=r.h;a.g||-1==K.indexOf("spdy")&&-1==K.indexOf("quic")&&-1==K.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(uo(a,a.h),a.h=null))}if(r.D){const he=U.g?U.g.getResponseHeader("X-HTTP-Session-Id"):null;he&&(r.za=he,Bn(r.F,r.D,he))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var l=n;if((r=t).sa=Hd(r,r.H?r.ka:null,r.V),l.J){em(r.h,l);var h=l,g=r.J;g&&h.setTimeout(g),h.B&&(Py(h),Vd(h)),r.g=l}else QE(r);0<t.i.length&&lm(t)}else"stop"!=v[0]&&"close"!=v[0]||eu(t,7);else 3==t.G&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?eu(t,7):om(t):"noop"!=v[0]&&t.l&&t.l.wa(v),t.A=0)}Fd()}catch(v){}}function Ly(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(kg(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function UE(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if("undefined"!=typeof Map&&n instanceof Map)return Array.from(n.keys());if(!("undefined"!=typeof Set&&n instanceof Set)){if(kg(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function FE(n){if(n.W&&"function"==typeof n.W)return n.W();if("undefined"!=typeof Map&&n instanceof Map||"undefined"!=typeof Set&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(kg(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}(mt=Af.prototype).setTimeout=function(n){this.O=n},mt.ib=function(n){n=n.target;const e=this.L;e&&3==pa(n)?e.l():this.La(n)},mt.La=function(n){try{if(n==this.g)e:{const T=pa(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>T)&&(3!=T||hy||this.g&&(this.h.h||this.g.fa()||Gy(this.g)))){this.I||4!=T||7==e||Fd(),Py(this);var t=this.g.aa();this.Y=t;t:if(LE(this)){var r=Gy(this.g);n="";var i=r.length,a=4==pa(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Bd(this),nc(this);var l="";break t}this.h.i=new Ot.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.fa();if(this.i=200==t,function xE(n,e,t,r,i,a,l){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+l})}(this.j,this.u,this.A,this.m,this.U,T,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var h,g=this.g;if((h=g.g?g.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Nd(h)){var v=h;break t}}v=null}if(!(t=v)){this.i=!1,this.o=3,Pi(12),Bd(this),nc(this);break e}Cf(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Oy(this,t)}this.P?(Yg(this,T,l),hy&&this.i&&3==T&&(SE(this.S,this.T,"tick",this.hb),this.T.start())):(Cf(this.j,this.m,l,null),Oy(this,l)),4==T&&Bd(this),this.i&&!this.I&&(4==T?JE(this.l,this):(this.i=!1,Vd(this)))}else 400==t&&0<l.indexOf("Unknown SID")?(this.o=3,Pi(12)):(this.o=0,Pi(13)),Bd(this),nc(this)}}}catch(T){}},mt.hb=function(){if(this.g){var n=pa(this.g),e=this.g.fa();this.C<e.length&&(Py(this),Yg(this,n,e),this.i&&4!=n&&Vd(this))}},mt.cancel=function(){this.I=!0,Bd(this)},mt.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function KT(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Fd(),Pi(17)),Bd(this),this.o=2,nc(this)):ZT(this,this.V-n)};var Fy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zi(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof zi){this.h=void 0!==e?e:n.h,Qg(this,n.j),this.s=n.s,this.g=n.g,Xg(this,n.m),this.l=n.l,e=n.i;var t=new ic;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),YT(this,t),this.o=n.o}else n&&(t=String(n).match(Fy))?(this.h=!!e,Qg(this,t[1]||"",!0),this.s=rc(t[2]||""),this.g=rc(t[3]||"",!0),Xg(this,t[4]),this.l=rc(t[5]||"",!0),YT(this,t[6]||"",!0),this.o=rc(t[7]||"")):(this.h=!!e,this.i=new ic(null,this.h))}function ao(n){return new zi(n)}function Qg(n,e,t){n.j=t?rc(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Xg(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function YT(n,e,t){e instanceof ic?(n.i=e,function JT(n,e){e&&!n.j&&(nl(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(HE(this,r),sc(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=Ja(e,$E)),n.i=new ic(e,n.h))}function Bn(n,e,t){n.i.set(e,t)}function xf(n){return Bn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function rc(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Ja(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,QT),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function QT(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}zi.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Ja(e,Jg,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Ja(e,Jg,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(Ja(t,"/"==t.charAt(0)?jE:BE,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Ja(t,XT)),n.join("")};var Jg=/[#\/\?@]/g,BE=/[#\?:]/g,jE=/[#\?]/g,$E=/[#\?@]/g,XT=/#/g;function ic(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function nl(n){n.g||(n.g=new Map,n.h=0,n.i&&function VE(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function HE(n,e){nl(n),e=oc(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function Uy(n,e){return nl(n),e=oc(n,e),n.g.has(e)}function sc(n,e,t){HE(n,e),0<t.length&&(n.i=null,n.g.set(oc(n,e),yf(t)),n.h+=t.length)}function oc(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function ac(n){this.l=n||tD,n=Ot.PerformanceNavigationTiming?0<(n=Ot.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Ot.g&&Ot.g.Ga&&Ot.g.Ga()&&Ot.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(mt=ic.prototype).add=function(n,e){nl(this),this.i=null,n=oc(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},mt.forEach=function(n,e){nl(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},mt.oa=function(){nl(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let a=0;a<i.length;a++)t.push(e[r])}return t},mt.W=function(n){nl(this);let e=[];if("string"==typeof n)Uy(this,n)&&(e=e.concat(this.g.get(oc(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},mt.set=function(n,e){return nl(this),this.i=null,Uy(this,n=oc(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},mt.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},mt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const a=encodeURIComponent(String(r)),l=this.W(r);for(r=0;r<l.length;r++){var i=a;""!==l[r]&&(i+="="+encodeURIComponent(String(l[r]))),n.push(i)}}return this.i=n.join("&")};var tD=10;function GE(n){return!!n.h||!!n.g&&n.g.size>=n.j}function WE(n){return n.h?1:n.g?n.g.size:0}function Vy(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function uo(n,e){n.g?n.g.add(e):n.h=e}function em(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function By(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return yf(n.i)}function tm(){}function qE(){this.g=new tm}function zE(n,e,t){const r=t||"";try{Ly(n,function(i,a){let l=i;kd(i)&&(l=tc(i)),e.push(r+a+"="+encodeURIComponent(l))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function nm(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(a){}}function Rf(n){this.l=n.ac||null,this.j=n.jb||!1}function rm(n,e){cr.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=im,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ac.prototype.cancel=function(){if(this.i=By(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},tm.prototype.stringify=function(n){return Ot.JSON.stringify(n,void 0)},tm.prototype.parse=function(n){return Ot.JSON.parse(n,void 0)},Lr(Rf,xy),Rf.prototype.g=function(){return new rm(this.l,this.j)},Rf.prototype.i=function(n){return function(){return n}}({}),Lr(rm,cr);var im=0;function rD(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function jd(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Mf(n)}function Mf(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(mt=rm.prototype).open=function(n,e){if(this.readyState!=im)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Mf(this)},mt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||Ot).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},mt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,jd(this)),this.readyState=im},mt.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Mf(this)),this.g&&(this.readyState=3,Mf(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==Ot.ReadableStream&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;rD(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},mt.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?jd(this):Mf(this),3==this.readyState&&rD(this)}},mt.Va=function(n){this.g&&(this.response=this.responseText=n,jd(this))},mt.Ua=function(n){this.g&&(this.response=n,jd(this))},mt.ga=function(){this.g&&jd(this)},mt.setRequestHeader=function(n,e){this.v.append(n,e)},mt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},mt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(rm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var iD=Ot.JSON.parse;function Sr(n){cr.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=sD,this.K=this.L=!1}Lr(Sr,cr);var sD="",jy=/^https?$/i,oD=["POST","PUT"];function $y(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,aD(n),Hy(n)}function aD(n){n.D||(n.D=!0,Kr(n,"complete"),Kr(n,"error"))}function lo(n){if(n.h&&void 0!==ay&&(!n.C[1]||4!=pa(n)||2!=n.aa()))if(n.v&&4==pa(n))Cy(n.Ha,0,n);else if(Kr(n,"readystatechange"),4==pa(n)){n.h=!1;try{const h=n.aa();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===h){var i=String(n.H).match(Fy)[1]||null;if(!i&&Ot.self&&Ot.self.location){var a=Ot.self.location.protocol;i=a.substr(0,a.length-1)}r=!jy.test(i?i.toLowerCase():"")}t=r}if(t)Kr(n,"complete"),Kr(n,"success");else{n.m=6;try{var l=2<pa(n)?n.g.statusText:""}catch(g){l=""}n.j=l+" ["+n.aa()+"]",aD(n)}}finally{Hy(n)}}}function Hy(n,e){if(n.g){uD(n);const t=n.g,r=n.C[0]?Mg:null;n.g=null,n.C=null,e||Kr(n,"ready");try{t.onreadystatechange=r}catch(i){}}}function uD(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(Ot.clearTimeout(n.A),n.A=null)}function pa(n){return n.g?n.g.readyState:0}function Gy(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case sD:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Wy(n){let e="";return EE(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function qy(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=Wy(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Bn(n,e,t))}function sm(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function zy(n){this.Ca=0,this.i=[],this.j=new Dy,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=sm("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=sm("baseRetryDelayMs",5e3,n),this.bb=sm("retryDelaySeedMs",1e4,n),this.$a=sm("forwardChannelMaxRetries",2,n),this.ta=sm("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new ac(n&&n.concurrentRequestLimit),this.Fa=new qE,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function om(n){if(um(n),3==n.G){var e=n.U++,t=ao(n.F);Bn(t,"SID",n.I),Bn(t,"RID",e),Bn(t,"TYPE","terminate"),kf(n,t),(e=new Af(n,n.j,e,void 0)).K=2,e.v=xf(ao(t)),t=!1,Ot.navigator&&Ot.navigator.sendBeacon&&(t=Ot.navigator.sendBeacon(e.v.toString(),"")),!t&&Ot.Image&&((new Image).src=e.v,t=!0),t||(e.g=yi(e.l,null),e.g.da(e.v)),e.F=Date.now(),Vd(e)}Oo(n)}function am(n){n.g&&(rl(n),n.g.cancel(),n.g=null)}function um(n){am(n),n.u&&(Ot.clearTimeout(n.u),n.u=null),il(n),n.h.cancel(),n.m&&("number"==typeof n.m&&Ot.clearTimeout(n.m),n.m=null)}function lm(n){GE(n.h)||n.m||(n.m=!0,Bg(n.Ja,n),n.C=0)}function ZE(n,e){var t;t=e?e.m:n.U++;const r=ao(n.F);Bn(r,"SID",n.I),Bn(r,"RID",t),Bn(r,"AID",n.T),kf(n,r),n.o&&n.s&&qy(r,n.o,n.s),t=new Af(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=YE(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),uo(n.h,t),Ud(t,r,e)}function kf(n,e){n.ia&&EE(n.ia,function(t,r){Bn(e,r,t)}),n.l&&Ly({},function(t,r){Bn(e,r,t)})}function YE(n,e,t){t=Math.min(n.i.length,t);var r=n.l?_i(n.l.Ra,n.l,n):null;e:{var i=n.i;let a=-1;for(;;){const l=["count="+t];-1==a?0<t?(a=i[0].h,l.push("ofs="+a)):a=0:l.push("ofs="+a);let h=!0;for(let g=0;g<t;g++){let v=i[g].h;const T=i[g].g;if(v-=a,0>v)a=Math.max(0,i[g].h-100),h=!1;else try{zE(T,l,"req"+v+"_")}catch(S){r&&r(T)}}if(h){r=l.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,r}function QE(n){n.g||n.u||(n.Z=1,Bg(n.Ia,n),n.A=0)}function $d(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Tf(_i(n.Ia,n),eI(n,n.A)),n.A++,0))}function rl(n){null!=n.B&&(Ot.clearTimeout(n.B),n.B=null)}function XE(n){n.g=new Af(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=ao(n.sa);Bn(e,"RID","rpc"),Bn(e,"SID",n.I),Bn(e,"CI",n.L?"0":"1"),Bn(e,"AID",n.T),Bn(e,"TYPE","xmlhttp"),kf(n,e),n.o&&n.s&&qy(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=xf(ao(e)),t.s=null,t.P=!0,Zg(t,n)}function il(n){null!=n.v&&(Ot.clearTimeout(n.v),n.v=null)}function JE(n,e){var t=null;if(n.g==e){il(n),rl(n),n.g=null;var r=2}else{if(!Vy(n.h,e))return;t=e.D,em(n.h,e),r=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;Kr(r=Gg(),new NE(r,t)),lm(n)}else QE(n);else if(3==(i=e.o)||0==i&&0<n.pa||!(1==r&&function lD(n,e){return!(WE(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Tf(_i(n.Ja,n,e),eI(n,n.C)),n.C++,0)))}(n,e)||2==r&&$d(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),i){case 1:eu(n,5);break;case 4:eu(n,10);break;case 3:eu(n,6);break;default:eu(n,2)}}function eI(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function eu(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var r=_i(n.kb,n);t||(t=new zi("//www.google.com/images/cleardot.gif"),Ot.location&&"http"==Ot.location.protocol||Qg(t,"https"),xf(t)),function nD(n,e){const t=new Dy;if(Ot.Image){const r=new Image;r.onload=_f(nm,t,r,"TestLoadImage: loaded",!0,e),r.onerror=_f(nm,t,r,"TestLoadImage: error",!1,e),r.onabort=_f(nm,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=_f(nm,t,r,"TestLoadImage: timeout",!1,e),Ot.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else Pi(2);n.G=0,n.l&&n.l.va(e),Oo(n),um(n)}function Oo(n){if(n.G=0,n.la=[],n.l){const e=By(n.h);(0!=e.length||0!=n.i.length)&&(fa(n.la,e),fa(n.la,n.i),n.h.i.length=0,yf(n.i),n.i.length=0),n.l.ua()}}function Hd(n,e,t){var r=t instanceof zi?ao(t):new zi(t,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),Xg(r,r.m);else{var i=Ot.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var a=new zi(null,void 0);r&&Qg(a,r),e&&(a.g=e),i&&Xg(a,i),t&&(a.l=t),r=a}return e=n.za,(t=n.D)&&e&&Bn(r,t,e),Bn(r,"VER",n.ma),kf(n,r),r}function yi(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Sr(t&&n.Da&&!n.ra?new Rf({jb:!0}):n.ra)).Ka(n.H),e}function sl(){}function uc(){if(Ju&&!(10<=Number(aR)))throw Error("Environmental error: no available transport.")}function rr(n,e){cr.call(this),this.g=new zy(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!Nd(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Nd(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Lo(this)}function cm(n){Ry.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function lc(){PE.call(this),this.status=1}function Lo(n){this.g=n}(mt=Sr.prototype).Ka=function(n){this.L=n},mt.da=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():qg.g(),this.C=function Po(n){return n.h||(n.h=n.i())}(this.u?this.u:qg),this.g.onreadystatechange=_i(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void $y(this,a)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const a of r.keys())t.set(a,r.get(a))}r=Array.from(t.keys()).find(a=>"content-type"==a.toLowerCase()),i=Ot.FormData&&n instanceof Ot.FormData,!(0<=fE(oD,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,l]of t)this.g.setRequestHeader(a,l);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{uD(this),0<this.B&&((this.K=function KE(n){return Ju&&function wE(){return function cy(n){var e=vE;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=jT(String(vf)).split("."),t=jT("9").split("."),r=Math.max(e.length,t.length);for(let l=0;0==n&&l<r;l++){var i=e[l]||"",a=t[l]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==i[0].length&&0==a[0].length)break;n=Ng(0==i[1].length?0:parseInt(i[1],10),0==a[1].length?0:parseInt(a[1],10))||Ng(0==i[2].length,0==a[2].length)||Ng(i[2],a[2]),i=i[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_i(this.qa,this)):this.A=Cy(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){$y(this,a)}},mt.qa=function(){void 0!==ay&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Kr(this,"timeout"),this.abort(8))},mt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Kr(this,"complete"),Kr(this,"abort"),Hy(this))},mt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Hy(this,!0)),Sr.X.M.call(this)},mt.Ha=function(){this.s||(this.F||this.v||this.l?lo(this):this.fb())},mt.fb=function(){lo(this)},mt.aa=function(){try{return 2<pa(this)?this.g.status:-1}catch(n){return-1}},mt.fa=function(){try{return this.g?this.g.responseText:""}catch(n){return""}},mt.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),iD(e)}},mt.Ea=function(){return this.m},mt.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(mt=zy.prototype).ma=8,mt.G=1,mt.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const i=new Af(this,this.j,n,void 0);let a=this.s;if(this.S&&(a?(a=GT(a),Qa(a,this.S)):a=this.S),null!==this.o||this.N||(i.H=a,a=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var r=this.i[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=YE(this,i,e),Bn(t=ao(this.F),"RID",n),Bn(t,"CVER",22),this.D&&Bn(t,"X-HTTP-Session-Id",this.D),kf(this,t),a&&(this.N?e="headers="+encodeURIComponent(String(Wy(a)))+"&"+e:this.o&&qy(t,this.o,a)),uo(this.h,i),this.Ya&&Bn(t,"TYPE","init"),this.O?(Bn(t,"$req",e),Bn(t,"SID","null"),i.Z=!0,Ud(i,t,null)):Ud(i,t,e),this.G=2}}else 3==this.G&&(n?ZE(this,n):0==this.i.length||GE(this.h)||ZE(this))},mt.Ia=function(){if(this.u=null,XE(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Tf(_i(this.eb,this),n)}},mt.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Pi(10),am(this),XE(this))},mt.cb=function(){null!=this.v&&(this.v=null,am(this),$d(this),Pi(19))},mt.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Pi(2)):(this.j.info("Failed to ping google.com"),Pi(1))},(mt=sl.prototype).xa=function(){},mt.wa=function(){},mt.va=function(){},mt.ua=function(){},mt.Ra=function(){},uc.prototype.g=function(n,e){return new rr(n,e)},Lr(rr,cr),rr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;Pi(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=Hd(n,null,n.V),lm(n)},rr.prototype.close=function(){om(this.g)},rr.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=tc(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&lm(e)},rr.prototype.M=function(){this.g.l=null,delete this.j,om(this.g),delete this.g,rr.X.M.call(this)},Lr(cm,Ry),Lr(lc,PE),Lr(Lo,sl),Lo.prototype.xa=function(){Kr(this.g,"a")},Lo.prototype.wa=function(n){Kr(this.g,new cm(n))},Lo.prototype.va=function(n){Kr(this.g,new lc)},Lo.prototype.ua=function(){Kr(this.g,"b")},uc.prototype.createWebChannel=uc.prototype.g,rr.prototype.send=rr.prototype.u,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,Df.NO_ERROR=0,Df.TIMEOUT=8,Df.HTTP_ERROR=6,Ay.COMPLETE="complete",Wg.EventType=Sf,Sf.OPEN="a",Sf.CLOSE="b",Sf.ERROR="c",Sf.MESSAGE="d",cr.prototype.listen=cr.prototype.N,Sr.prototype.listenOnce=Sr.prototype.O,Sr.prototype.getLastError=Sr.prototype.Oa,Sr.prototype.getLastErrorCode=Sr.prototype.Ea,Sr.prototype.getStatus=Sr.prototype.aa,Sr.prototype.getResponseJson=Sr.prototype.Sa,Sr.prototype.getResponseText=Sr.prototype.fa,Sr.prototype.send=Sr.prototype.da,Sr.prototype.setWithCredentials=Sr.prototype.Ka;var Gd=Ya.createWebChannelTransport=function(){return new uc},Wd=Ya.getStatEventTarget=function(){return Gg()},ol=Ya.ErrorCode=Df,qd=Ya.EventType=Ay,zd=Ya.Event=tl,cc=Ya.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Kd=Ya.FetchXmlHttpFactory=Rf,Nf=Ya.WebChannel=Wg,tI=Ya.XhrIo=Sr;const Ky="@firebase/firestore";class Zr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zr.UNAUTHENTICATED=new Zr(null),Zr.GOOGLE_CREDENTIALS=new Zr("google-credentials-uid"),Zr.FIRST_PARTY=new Zr("first-party-uid"),Zr.MOCK_USER=new Zr("mock-user");let dc="9.14.0";const tu=new ko.Yd("@firebase/firestore");function dm(){return tu.logLevel}function Ue(n,...e){if(tu.logLevel<=ko.in.DEBUG){const t=e.map(Zy);tu.debug(`Firestore (${dc}): ${n}`,...t)}}function Ar(n,...e){if(tu.logLevel<=ko.in.ERROR){const t=e.map(Zy);tu.error(`Firestore (${dc}): ${n}`,...t)}}function al(n,...e){if(tu.logLevel<=ko.in.WARN){const t=e.map(Zy);tu.warn(`Firestore (${dc}): ${n}`,...t)}}function Zy(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch(t){return n}}function ot(n="Unexpected state"){const e=`FIRESTORE (${dc}) INTERNAL ASSERTION FAILED: `+n;throw Ar(e),new Error(e)}function At(n,e){n||ot()}function Je(n,e){return n}const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Oe extends L.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Fr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class rI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Zr.UNAUTHENTICATED))}shutdown(){}}class fR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class hD{constructor(e){this.t=e,this.currentUser=Zr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=v=>this.i!==i?(i=this.i,t(v)):Promise.resolve();let l=new Fr;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Fr,e.enqueueRetryable(()=>a(this.currentUser))};const h=()=>{const v=l;e.enqueueRetryable((0,me.Z)(function*(){yield v.promise,yield a(r.currentUser)}))},g=v=>{Ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=v,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(v=>g(v)),setTimeout(()=>{if(!this.auth){const v=this.t.getImmediate({optional:!0});v?g(v):(Ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Fr)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(At("string"==typeof r.accessToken),new rI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return At(null===e||"string"==typeof e),new Zr(e)}}class Yy{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i,this.type="FirstParty",this.user=Zr.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(At(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Qy{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i}getToken(){return Promise.resolve(new Yy(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(Zr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class iI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pR{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const r=a=>{null!=a.error&&Ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.A;return this.A=a.token,Ue("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{Ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.T.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.T.getImmediate({optional:!0});a?i(a):Ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(At("string"==typeof t.token),this.A=t.token,new iI(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function gR(n){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class sI{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=gR(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%e.length))}return r}}function Nt(n,e){return n<e?-1:n>e?1:0}function Pf(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function oI(n){return n+"\0"}class Mn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Oe(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Oe(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Oe(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Oe(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Mn.fromMillis(Date.now())}static fromDate(e){return Mn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Mn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Nt(this.nanoseconds,e.nanoseconds):Nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Rt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Rt(e)}static min(){return new Rt(new Mn(0,0))}static max(){return new Rt(new Mn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Zd{constructor(e,t,r){void 0===t?t=0:t>e.length&&ot(),void 0===r?r=e.length-t:r>e.length-t&&ot(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Zd.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Zd?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),l=t.get(i);if(a<l)return-1;if(a>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class an extends Zd{construct(e,t,r){return new an(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Oe(fe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new an(t)}static emptyPath(){return new an([])}}const aI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kn extends Zd{construct(e,t,r){return new Kn(e,t,r)}static isValidIdentifier(e){return aI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Kn(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new Oe(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new Oe(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[i+1];if("\\"!==g&&"."!==g&&"`"!==g)throw new Oe(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=g,i+=2}else"`"===h?(l=!l,i++):"."!==h||l?(r+=h,i++):(a(),i++)}if(a(),l)throw new Oe(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kn(t)}static emptyPath(){return new Kn([])}}class Qe{constructor(e){this.path=e}static fromPath(e){return new Qe(an.fromString(e))}static fromName(e){return new Qe(an.fromString(e).popFirst(5))}static empty(){return new Qe(an.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===an.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return an.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qe(new an(e.slice()))}}class Of{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Xy(n){return n.fields.find(e=>2===e.kind)}function hc(n){return n.fields.filter(e=>2!==e.kind)}Of.UNKNOWN_ID=-1;class hm{constructor(e,t){this.fieldPath=e,this.kind=t}}class Yd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Yd(0,ms.min())}}function uI(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Rt.fromTimestamp(1e9===r?new Mn(t+1,0):new Mn(t,r));return new ms(i,Qe.empty(),e)}function Jy(n){return new ms(n.readTime,n.key,-1)}class ms{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ms(Rt.min(),Qe.empty(),-1)}static max(){return new ms(Rt.max(),Qe.empty(),-1)}}function Lf(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=Qe.comparator(n.documentKey,e.documentKey),0!==t?t:Nt(n.largestBatchId,e.largestBatchId))}const gD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fm{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function ul(n){return lI.apply(this,arguments)}function lI(){return lI=(0,me.Z)(function*(n){if(n.code!==fe.FAILED_PRECONDITION||n.message!==gD)throw n;Ue("LocalStore","Unexpectedly lost primary lease")}),lI.apply(this,arguments)}class ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ot(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ue((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ue?t:ue.resolve(t)}catch(t){return ue.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ue.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ue.reject(t)}static resolve(e){return new ue((t,r)=>{t(e)})}static reject(e){return new ue((t,r)=>{r(e)})}static waitFor(e){return new ue((t,r)=>{let i=0,a=0,l=!1;e.forEach(h=>{++i,h.next(()=>{++a,l&&a===i&&t()},g=>r(g))}),l=!0,a===i&&t()})}static or(e){let t=ue.resolve(!1);for(const r of e)t=t.next(i=>i?ue.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new ue((r,i)=>{const a=e.length,l=new Array(a);let h=0;for(let g=0;g<a;g++){const v=g;t(e[v]).next(T=>{l[v]=T,++h,h===a&&r(l)},T=>i(T))}})}static doWhile(e,t){return new ue((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class Ff{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.P=new Fr,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{t.error?this.P.reject(new Uf(e,t.error)):this.P.resolve()},this.transaction.onerror=r=>{const i=tv(r.target.error);this.P.reject(new Uf(e,i))}}static open(e,t,r,i){try{return new Ff(t,e.transaction(i,r))}catch(a){throw new Uf(t,a)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(Ue("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new pm(t)}}class Ls{constructor(e,t,r){this.name=e,this.version=t,this.S=r,12.2===Ls.D((0,L.z$)())&&Ar("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Ue("SimpleDb","Removing database:",e),nu(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,L.hl)())return!1;if(Ls.N())return!0;const e=(0,L.z$)(),t=Ls.D(e),r=0<t&&t<10,i=Ls.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static N(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.O)}static M(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static k(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}F(e){var t=this;return(0,me.Z)(function*(){return t.db||(Ue("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=l=>{r(l.target.result)},a.onblocked=()=>{i(new Uf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const h=l.target.error;i("VersionError"===h.name?new Oe(fe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new Oe(fe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new Uf(e,h))},a.onupgradeneeded=l=>{Ue("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',l.oldVersion),t.S.$(l.target.result,a.transaction,l.oldVersion,t.version).next(()=>{Ue("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,me.Z)(function*(){const l="readonly"===t;let h=0;for(;;){++h;try{a.db=yield a.F(e);const g=Ff.open(a.db,e,l?"readonly":"readwrite",r),v=i(g).next(T=>(g.V(),T)).catch(T=>(g.abort(T),ue.reject(T))).toPromise();return v.catch(()=>{}),yield g.v,v}catch(g){const v=g,T="FirebaseError"!==v.name&&h<3;if(Ue("SimpleDb","Transaction failed with error:",v.message,"Retrying:",T),a.close(),!T)return Promise.reject(v)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class ev{constructor(e){this.U=e,this.q=!1,this.K=null}get isDone(){return this.q}get G(){return this.K}set cursor(e){this.U=e}done(){this.q=!0}j(e){this.K=e}delete(){return nu(this.U.delete())}}class Uf extends Oe{constructor(e,t){super(fe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Fo(n){return"IndexedDbTransactionError"===n.name}class pm{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(Ue("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ue("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),nu(r)}add(e){return Ue("SimpleDb","ADD",this.store.name,e,e),nu(this.store.add(e))}get(e){return nu(this.store.get(e)).next(t=>(void 0===t&&(t=null),Ue("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Ue("SimpleDb","DELETE",this.store.name,e),nu(this.store.delete(e))}count(){return Ue("SimpleDb","COUNT",this.store.name),nu(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.H(i,(l,h)=>{a.push(h)}).next(()=>a)}{const i=this.store.getAll(r.range);return new ue((a,l)=>{i.onerror=h=>{l(h.target.error)},i.onsuccess=h=>{a(h.target.result)}})}}J(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new ue((i,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}Y(e,t){Ue("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,(a,l,h)=>h.delete())}Z(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}tt(e){const t=this.cursor({});return new ue((r,i)=>{t.onerror=a=>{const l=tv(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next(h=>{h?l.continue():r()}):r()}})}H(e,t){const r=[];return new ue((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const h=l.target.result;if(!h)return void i();const g=new ev(h),v=t(h.primaryKey,h.value,g);if(v instanceof ue){const T=v.catch(S=>(g.done(),ue.reject(S)));r.push(T)}g.isDone?i():null===g.G?h.continue():h.continue(g.G)}}).next(()=>ue.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function nu(n){return new ue((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=tv(r.target.error);t(i)}})}let mD=!1;function tv(n){const e=Ls.D((0,L.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Oe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return mD||(mD=!0,setTimeout(()=>{throw r},0)),r}}return n}class nv{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;Ue("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,me.Z)(function*(){t.task=null;try{Ue("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(r){Fo(r)?Ue("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield ul(r)}yield t.nt(6e4)}))}}class rv{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,me.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.it(r,e))})()}it(e,t){const r=new Set;let i=t,a=!0;return ue.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(null!==l&&!r.has(l))return Ue("IndexBackiller",`Processing collection: ${l}`),this.rt(e,l,i).next(h=>{i-=h,r.add(l)});a=!1})).next(()=>t-i)}rt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.ot(i,a)).next(h=>(Ue("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>l.size)}))}ot(e,t){let r=e;return t.changes.forEach((i,a)=>{const l=Jy(a);Lf(l,r)>0&&(r=l)}),new ms(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ki{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>t.writeSequenceNumber(r))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}function iv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ru(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function sv(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}Ki.at=-1;class dr{constructor(e,t){this.comparator=e,this.root=t||ii.EMPTY}insert(e,t){return new dr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ii.BLACK,null,null))}remove(e){return new dr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ii.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qd(this.root,e,this.comparator,!0)}}class Qd{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ii{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=null!=r?r:ii.RED,this.left=null!=i?i:ii.EMPTY,this.right=null!=a?a:ii.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new ii(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ii.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return ii.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ii.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ii.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ot();const e=this.left.check();if(e!==this.right.check())throw ot();return e+(this.isRed()?0:1)}}ii.EMPTY=null,ii.RED=!0,ii.BLACK=!1,ii.EMPTY=new class{constructor(){this.size=0}get key(){throw ot()}get value(){throw ot()}get color(){throw ot()}get left(){throw ot()}get right(){throw ot()}copy(n,e,t,r,i){return this}insert(n,e,t){return new ii(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Pn{constructor(e){this.comparator=e,this.data=new dr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ov(this.data.getIterator())}getIteratorFrom(e){return new ov(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Pn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Pn(this.comparator);return t.data=e,t}}class ov{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fc(n){return n.hasNext()?n.getNext():void 0}class Zi{constructor(e){this.fields=e,e.sort(Kn.comparator)}static empty(){return new Zi([])}unionWith(e){let t=new Pn(Kn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Zi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Pf(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Yr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Yr(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new Yr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yr.EMPTY_BYTE_STRING=new Yr("");const yD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ll(n){if(At(!!n),"string"==typeof n){let e=0;const t=yD.exec(n);if(At(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ir(n.seconds),nanos:ir(n.nanos)}}function ir(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function iu(n){return"string"==typeof n?Yr.fromBase64String(n):Yr.fromUint8Array(n)}function gm(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function av(n){const e=n.mapValue.fields.__previous_value__;return gm(e)?av(e):e}function Xd(n){const e=ll(n.mapValue.fields.__local_write_time__.timestampValue);return new Mn(e.seconds,e.nanos)}class cI{constructor(e,t,r,i,a,l,h,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.useFetchStreams=g}}class su{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new su("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof su&&e.projectId===this.projectId&&e.database===this.database}}function Jd(n){return null==n}function eh(n){return 0===n&&1/n==-1/0}function uv(n){return"number"==typeof n&&Number.isInteger(n)&&!eh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const pc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},mm={nullValue:"NULL_VALUE"};function gc(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?gm(n)?4:fv(n)?9007199254740991:10:ot()}function Uo(n,e){if(n===e)return!0;const t=gc(n);if(t!==gc(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Xd(n).isEqual(Xd(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=ll(r.timestampValue),l=ll(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,iu(n.bytesValue).isEqual(iu(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return ir(r.geoPointValue.latitude)===ir(i.geoPointValue.latitude)&&ir(r.geoPointValue.longitude)===ir(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return ir(r.integerValue)===ir(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=ir(r.doubleValue),l=ir(i.doubleValue);return a===l?eh(a)===eh(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return Pf(n.arrayValue.values||[],e.arrayValue.values||[],Uo);case 10:return function(r,i){const a=r.mapValue.fields||{},l=i.mapValue.fields||{};if(iv(a)!==iv(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(void 0===l[h]||!Uo(a[h],l[h])))return!1;return!0}(n,e);default:return ot()}var i}function Vf(n,e){return void 0!==(n.values||[]).find(t=>Uo(t,e))}function jn(n,e){if(n===e)return 0;const t=gc(n),r=gc(e);if(t!==r)return Nt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Nt(n.booleanValue,e.booleanValue);case 2:return function(i,a){const l=ir(i.integerValue||i.doubleValue),h=ir(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return lv(n.timestampValue,e.timestampValue);case 4:return lv(Xd(n),Xd(e));case 5:return Nt(n.stringValue,e.stringValue);case 6:return function(i,a){const l=iu(i),h=iu(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),h=a.split("/");for(let g=0;g<l.length&&g<h.length;g++){const v=Nt(l[g],h[g]);if(0!==v)return v}return Nt(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Nt(ir(i.latitude),ir(a.latitude));return 0!==l?l:Nt(ir(i.longitude),ir(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const l=i.values||[],h=a.values||[];for(let g=0;g<l.length&&g<h.length;++g){const v=jn(l[g],h[g]);if(v)return v}return Nt(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===pc.mapValue&&a===pc.mapValue)return 0;if(i===pc.mapValue)return 1;if(a===pc.mapValue)return-1;const l=i.fields||{},h=Object.keys(l),g=a.fields||{},v=Object.keys(g);h.sort(),v.sort();for(let T=0;T<h.length&&T<v.length;++T){const S=Nt(h[T],v[T]);if(0!==S)return S;const k=jn(l[h[T]],g[v[T]]);if(0!==k)return k}return Nt(h.length,v.length)}(n.mapValue,e.mapValue);default:throw ot()}}function lv(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Nt(n,e);const t=ll(n),r=ll(e),i=Nt(t.seconds,r.seconds);return 0!==i?i:Nt(t.nanos,r.nanos)}function th(n){return cv(n)}function cv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=ll(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?iu(n.bytesValue).toBase64():"referenceValue"in n?Qe.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const l of r.values||[])a?a=!1:i+=",",i+=cv(l);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",l=!0;for(const h of i)l?l=!1:a+=",",a+=`${h}:${cv(r.fields[h])}`;return a+"}"}(n.mapValue):ot();var e}function cl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function dv(n){return!!n&&"integerValue"in n}function nh(n){return!!n&&"arrayValue"in n}function hv(n){return!!n&&"nullValue"in n}function mc(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _m(n){return!!n&&"mapValue"in n}function Bf(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ru(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Bf(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Bf(n.arrayValue.values[t]);return e}return Object.assign({},n)}function fv(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function vD(n){return"nullValue"in n?mm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?cl(su.empty(),Qe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:ot()}function dI(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?cl(su.empty(),Qe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?pc:ot()}function wD(n,e){const t=jn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function pv(n,e){const t=jn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class si{constructor(e){this.value=e}static empty(){return new si({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!_m(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bf(t)}setAll(e){let t=Kn.emptyPath(),r={},i=[];e.forEach((l,h)=>{if(!t.isImmediateParentOf(h)){const g=this.getFieldsMap(t);this.applyChanges(g,r,i),r={},i=[],t=h.popLast()}l?r[h.lastSegment()]=Bf(l):i.push(h.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());_m(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Uo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];_m(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ru(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new si(Bf(this.value))}}function Vo(n){const e=[];return ru(n.fields,(t,r)=>{const i=new Kn([t]);if(_m(r)){const a=Vo(r.mapValue).fields;if(0===a.length)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new Zi(e)}class $n{constructor(e,t,r,i,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new $n(e,0,Rt.min(),Rt.min(),si.empty(),0)}static newFoundDocument(e,t,r){return new $n(e,1,t,Rt.min(),r,0)}static newNoDocument(e,t){return new $n(e,2,t,Rt.min(),si.empty(),0)}static newUnknownDocument(e,t){return new $n(e,3,t,Rt.min(),si.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=si.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=si.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof $n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $n(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ED{constructor(e,t=null,r=[],i=[],a=null,l=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=h,this.ht=null}}function Bo(n,e=null,t=[],r=[],i=null,a=null,l=null){return new ED(n,e,t,r,i,a,l)}function vi(n){const e=Je(n);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+th(i.value);var i}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),Jd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>th(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>th(r)).join(",")),e.ht=t}return e.ht}function rh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!mI(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!Uo(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Em(n.startAt,e.startAt)&&Em(n.endAt,e.endAt)}function jf(n){return Qe.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function ym(n,e){return n.filters.filter(t=>t instanceof wi&&t.field.isEqual(e))}function hI(n,e,t){let r=mm,i=!0;for(const a of ym(n,e)){let l=mm,h=!0;switch(a.op){case"<":case"<=":l=vD(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,h=!1;break;case"!=":case"not-in":l=mm}wD({value:r,inclusive:i},{value:l,inclusive:h})<0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];wD({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}function fI(n,e,t){let r=pc,i=!0;for(const a of ym(n,e)){let l=pc,h=!0;switch(a.op){case">=":case">":l=dI(a.value),h=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,h=!1;break;case"!=":case"not-in":l=pc}pv({value:r,inclusive:i},{value:l,inclusive:h})>0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];pv({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}class wi extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,r):new gv(e,t,r):"array-contains"===t?new bD(e,r):"in"===t?new pI(e,r):"not-in"===t?new gI(e,r):"array-contains-any"===t?new vm(e,r):new wi(e,t,r)}static lt(e,t,r){return"in"===t?new $f(e,r):new ID(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(jn(t,this.value)):null!==t&&gc(this.value)===gc(t)&&this.ft(jn(t,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ot()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class gv extends wi{constructor(e,t,r){super(e,t,r),this.key=Qe.fromName(r.referenceValue)}matches(e){const t=Qe.comparator(e.key,this.key);return this.ft(t)}}class $f extends wi{constructor(e,t){super(e,"in",t),this.keys=mv(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ID extends wi{constructor(e,t){super(e,"not-in",t),this.keys=mv(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function mv(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>Qe.fromName(r.referenceValue))}class bD extends wi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return nh(t)&&Vf(t.arrayValue,this.value)}}class pI extends wi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Vf(this.value.arrayValue,t)}}class gI extends wi{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Vf(this.value.arrayValue,t)}}class vm extends wi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!nh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Vf(this.value.arrayValue,r))}}class dl{constructor(e,t){this.position=e,this.inclusive=t}}class _c{constructor(e,t="asc"){this.field=e,this.dir=t}}function mI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function wm(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(r=a.field.isKeyField()?Qe.comparator(Qe.fromName(l.referenceValue),t.key):jn(l,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function Em(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Uo(n.position[t],e.position[t]))return!1;return!0}class ga{constructor(e,t=null,r=[],i=[],a=null,l="F",h=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=h,this.endAt=g,this._t=null,this.wt=null}}function _v(n,e,t,r,i,a,l,h){return new ga(n,e,t,r,i,a,l,h)}function yc(n){return new ga(n)}function yv(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Im(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function bm(n){for(const e of n.filters)if(e.dt())return e.field;return null}function Cm(n){return null!==n.collectionGroup}function vc(n){const e=Je(n);if(null===e._t){e._t=[];const t=bm(e),r=Im(e);if(null!==t&&null===r)t.isKeyField()||e._t.push(new _c(t)),e._t.push(new _c(Kn.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e._t.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new _c(Kn.keyField(),a))}}}return e._t}function Yi(n){const e=Je(n);if(!e.wt)if("F"===e.limitType)e.wt=Bo(e.path,e.collectionGroup,vc(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of vc(e))t.push(new _c(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new dl(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new dl(e.startAt.position,e.startAt.inclusive):null;e.wt=Bo(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.wt}function Tm(n,e,t){return new ga(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Hf(n,e){return rh(Yi(n),Yi(e))&&n.limitType===e.limitType}function _I(n){return`${vi(Yi(n))}|lt:${n.limitType}`}function vv(n){return`Query(target=${function jo(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${th(r.value)}`;var r}).join(", ")}]`),Jd(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>th(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>th(t)).join(",")),`Target(${e})`}(Yi(n))}; limitType=${n.limitType})`}function wv(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Qe.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,l){const h=wm(i,a,l);return i.inclusive?h<=0:h<0}(t.startAt,vc(t),r)||t.endAt&&!function(i,a,l){const h=wm(i,a,l);return i.inclusive?h>=0:h>0}(t.endAt,vc(t),r)));var t,r}function yI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function vI(n){return(e,t)=>{let r=!1;for(const i of vc(n)){const a=CD(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function CD(n,e,t){const r=n.field.isKeyField()?Qe.comparator(e.key,t.key):function(i,a,l){const h=a.data.field(i),g=l.data.field(i);return null!==h&&null!==g?jn(h,g):ot()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ot()}}function wI(n,e){if(n.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:eh(e)?"-0":e}}function EI(n){return{integerValue:""+n}}function II(n,e){return uv(e)?EI(e):wI(n,e)}class Dm{constructor(){this._=void 0}}function TD(n,e,t){return n instanceof ih?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof wc?Ev(n,e):n instanceof hl?Iv(n,e):function(r,i){const a=bI(r,i),l=bv(a)+bv(r.yt);return dv(a)&&dv(r.yt)?EI(l):wI(r.It,l)}(n,e)}function DD(n,e,t){return n instanceof wc?Ev(n,e):n instanceof hl?Iv(n,e):t}function bI(n,e){return n instanceof Ec?dv(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class ih extends Dm{}class wc extends Dm{constructor(e){super(),this.elements=e}}function Ev(n,e){const t=Cv(e);for(const r of n.elements)t.some(i=>Uo(i,r))||t.push(r);return{arrayValue:{values:t}}}class hl extends Dm{constructor(e){super(),this.elements=e}}function Iv(n,e){let t=Cv(e);for(const r of n.elements)t=t.filter(i=>!Uo(i,r));return{arrayValue:{values:t}}}class Ec extends Dm{constructor(e,t){super(),this.It=e,this.yt=t}}function bv(n){return ir(n.integerValue||n.doubleValue)}function Cv(n){return nh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class sh{constructor(e,t){this.field=e,this.transform=t}}class TI{constructor(e,t){this.version=e,this.transformResults=t}}class Zn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Zn}static exists(e){return new Zn(void 0,e)}static updateTime(e){return new Zn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gf(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class ma{}function DI(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new oh(n.key,Zn.none()):new Wf(n.key,n.data,Zn.none());{const t=n.data,r=si.empty();let i=new Pn(Kn.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);null===l&&a.length>1&&(a=a.popLast(),l=t.field(a)),null===l?r.delete(a):r.set(a,l),i=i.add(a)}return new ya(n.key,r,new Zi(i.toArray()),Zn.none())}}function SD(n,e,t){n instanceof Wf?function(r,i,a){const l=r.value.clone(),h=AD(r.fieldTransforms,i,a.transformResults);l.setAll(h),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof ya?function(r,i,a){if(!Gf(r.precondition,i))return void i.convertToUnknownDocument(a.version);const l=AD(r.fieldTransforms,i,a.transformResults),h=i.data;h.setAll(Tv(r)),h.setAll(l),i.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function _a(n,e,t,r){return n instanceof Wf?function(i,a,l,h){if(!Gf(i.precondition,a))return l;const g=i.value.clone(),v=Dt(i.fieldTransforms,h,a);return g.setAll(v),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),null}(n,e,t,r):n instanceof ya?function(i,a,l,h){if(!Gf(i.precondition,a))return l;const g=Dt(i.fieldTransforms,h,a),v=a.data;return v.setAll(Tv(i)),v.setAll(g),a.convertToFoundDocument(a.version,v).setHasLocalMutations(),null===l?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(T=>T.field))}(n,e,t,r):(l=t,Gf(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l);var a,l}function mR(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=bI(r.transform,i||null);null!=a&&(null===t&&(t=si.empty()),t.set(r.field,a))}return t||null}function Sm(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&Pf(t,r,(i,a)=>function CI(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof wc&&r instanceof wc||t instanceof hl&&r instanceof hl?Pf(t.elements,r.elements,Uo):t instanceof Ec&&r instanceof Ec?Uo(t.yt,r.yt):t instanceof ih&&r instanceof ih);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class Wf extends ma{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ya extends ma{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Tv(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function AD(n,e,t){const r=new Map;At(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,h=e.data.field(a.field);r.set(a.field,DD(l,h,t[i]))}return r}function Dt(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,TD(a,l,e))}return r}class oh extends ma{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Dv extends ma{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class xD{constructor(e){this.count=e}}var hr,un;function qf(n){switch(n){default:return ot();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}function zf(n){if(void 0===n)return Ar("GRPC error has no .code"),fe.UNKNOWN;switch(n){case hr.OK:return fe.OK;case hr.CANCELLED:return fe.CANCELLED;case hr.UNKNOWN:return fe.UNKNOWN;case hr.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case hr.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case hr.INTERNAL:return fe.INTERNAL;case hr.UNAVAILABLE:return fe.UNAVAILABLE;case hr.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case hr.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case hr.NOT_FOUND:return fe.NOT_FOUND;case hr.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case hr.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case hr.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case hr.ABORTED:return fe.ABORTED;case hr.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case hr.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case hr.DATA_LOSS:return fe.DATA_LOSS;default:return ot()}}(un=hr||(hr={}))[un.OK=0]="OK",un[un.CANCELLED=1]="CANCELLED",un[un.UNKNOWN=2]="UNKNOWN",un[un.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",un[un.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",un[un.NOT_FOUND=5]="NOT_FOUND",un[un.ALREADY_EXISTS=6]="ALREADY_EXISTS",un[un.PERMISSION_DENIED=7]="PERMISSION_DENIED",un[un.UNAUTHENTICATED=16]="UNAUTHENTICATED",un[un.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",un[un.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",un[un.ABORTED=10]="ABORTED",un[un.OUT_OF_RANGE=11]="OUT_OF_RANGE",un[un.UNIMPLEMENTED=12]="UNIMPLEMENTED",un[un.INTERNAL=13]="INTERNAL",un[un.UNAVAILABLE=14]="UNAVAILABLE",un[un.DATA_LOSS=15]="DATA_LOSS";class kn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ru(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return sv(this.inner)}size(){return this.innerSize}}const _R=new dr(Qe.comparator);function Qi(){return _R}const SI=new dr(Qe.comparator);function Kf(...n){let e=SI;for(const t of n)e=e.insert(t.key,t);return e}function Sv(n){let e=SI;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function $o(){return ah()}function Av(){return ah()}function ah(){return new kn(n=>n.toString(),(n,e)=>n.isEqual(e))}const RD=new dr(Qe.comparator),MD=new Pn(Qe.comparator);function Ht(...n){let e=MD;for(const t of n)e=e.add(t);return e}const Zf=new Pn(Nt);function Am(){return Zf}class Yf{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Qf.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Yf(Rt.min(),i,Am(),Qi(),Ht())}}class Qf{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Qf(r,t,Ht(),Ht(),Ht())}}class Ic{constructor(e,t,r,i){this.Tt=e,this.removedTargetIds=t,this.key=r,this.Et=i}}class xv{constructor(e,t){this.targetId=e,this.At=t}}class Rv{constructor(e,t,r=Yr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Mv{constructor(){this.Rt=0,this.bt=lh(),this.Pt=Yr.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=Ht(),t=Ht(),r=Ht();return this.bt.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ot()}}),new Qf(this.Pt,this.vt,e,t,r)}Nt(){this.Vt=!1,this.bt=lh()}kt(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}Ot(e){this.Vt=!0,this.bt=this.bt.remove(e)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class kD{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=Qi(),this.qt=uh(),this.Kt=new Pn(Nt)}Gt(e){for(const t of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(t,e.Et):this.jt(t,e.key,e.Et);for(const t of e.removedTargetIds)this.jt(t,e.key,e.Et)}Wt(e){this.forEachTarget(e,t=>{const r=this.zt(t);switch(e.state){case 0:this.Ht(t)&&r.Ct(e.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(e.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(t);break;case 3:this.Ht(t)&&(r.$t(),r.Ct(e.resumeToken));break;case 4:this.Ht(t)&&(this.Jt(t),r.Ct(e.resumeToken));break;default:ot()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach((r,i)=>{this.Ht(i)&&t(i)})}Yt(e){const t=e.targetId,r=e.At.count,i=this.Xt(t);if(i){const a=i.target;if(jf(a))if(0===r){const l=new Qe(a.path);this.jt(t,l,$n.newNoDocument(l,Rt.min()))}else At(1===r);else this.Zt(t)!==r&&(this.Jt(t),this.Kt=this.Kt.add(t))}}te(e){const t=new Map;this.Lt.forEach((a,l)=>{const h=this.Xt(l);if(h){if(a.current&&jf(h.target)){const g=new Qe(h.target.path);null!==this.Ut.get(g)||this.ee(l,g)||this.jt(l,g,$n.newNoDocument(g,e))}a.Dt&&(t.set(l,a.xt()),a.Nt())}});let r=Ht();this.qt.forEach((a,l)=>{let h=!0;l.forEachWhile(g=>{const v=this.Xt(g);return!v||2===v.purpose||(h=!1,!1)}),h&&(r=r.add(a))}),this.Ut.forEach((a,l)=>l.setReadTime(e));const i=new Yf(e,t,this.Kt,this.Ut,r);return this.Ut=Qi(),this.qt=uh(),this.Kt=new Pn(Nt),i}Qt(e,t){if(!this.Ht(e))return;const r=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,r),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}jt(e,t,r){if(!this.Ht(e))return;const i=this.zt(e);this.ee(e,t)?i.kt(t,1):i.Ot(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),r&&(this.Ut=this.Ut.insert(t,r))}removeTarget(e){this.Lt.delete(e)}Zt(e){const t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Mt(e){this.zt(e).Mt()}zt(e){let t=this.Lt.get(e);return t||(t=new Mv,this.Lt.set(e,t)),t}ne(e){let t=this.qt.get(e);return t||(t=new Pn(Nt),this.qt=this.qt.insert(e,t)),t}Ht(e){const t=null!==this.Xt(e);return t||Ue("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new Mv),this.Bt.getRemoteKeysForTarget(e).forEach(t=>{this.jt(e,t,null)})}ee(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}function uh(){return new dr(Qe.comparator)}function lh(){return new dr(Qe.comparator)}const ND={asc:"ASCENDING",desc:"DESCENDING"},PD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class OD{constructor(e,t){this.databaseId=e,this.gt=t}}function ch(n,e){return n.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kv(n,e){return n.gt?e.toBase64():e.toUint8Array()}function AI(n,e){return ch(n,e.toTimestamp())}function oi(n){return At(!!n),Rt.fromTimestamp(function(e){const t=ll(e);return new Mn(t.seconds,t.nanos)}(n))}function xm(n,e){return(t=n,new an(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function xI(n){const e=an.fromString(n);return At(Lv(e)),e}function Xf(n,e){return xm(n.databaseId,e.path)}function ou(n,e){const t=xI(e);if(t.get(1)!==n.databaseId.projectId)throw new Oe(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Oe(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Qe(Nv(t))}function RI(n,e){return xm(n.databaseId,e)}function LD(n){const e=xI(n);return 4===e.length?an.emptyPath():Nv(e)}function Rm(n){return new an(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Nv(n){return At(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Jf(n,e,t){return{name:Xf(n,e),fields:t.value.mapValue.fields}}function MI(n,e,t){const r=ou(n,e.name),i=oi(e.updateTime),a=new si({mapValue:{fields:e.fields}}),l=$n.newFoundDocument(r,i,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function au(n,e){let t;if(e instanceof Wf)t={update:Jf(n,e.key,e.value)};else if(e instanceof oh)t={delete:Xf(n,e.key)};else if(e instanceof ya)t={update:Jf(n,e.key,e.data),updateMask:jD(e.fieldMask)};else{if(!(e instanceof Dv))return ot();t={verify:Xf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof ih)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof wc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof hl)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ec)return{fieldPath:a.field.canonicalString(),increment:l.yt};throw ot()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:AI(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:ot()),t;var i}function Pv(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?Zn.updateTime(oi(i.updateTime)):void 0!==i.exists?Zn.exists(i.exists):Zn.none():Zn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;"setToServerValue"in l?(At("REQUEST_TIME"===l.setToServerValue),h=new ih):"appendMissingElements"in l?h=new wc(l.appendMissingElements.values||[]):"removeAllFromArray"in l?h=new hl(l.removeAllFromArray.values||[]):"increment"in l?h=new Ec(a,l.increment):ot();const g=Kn.fromServerFormat(l.fieldPath);return new sh(g,h)}(n,i)):[];var i;if(e.update){const i=ou(n,e.update.name),a=new si({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=new Zi((e.updateMask.fieldPaths||[]).map(v=>Kn.fromServerFormat(v)));return new ya(i,a,l,t,r)}return new Wf(i,a,t,r)}if(e.delete){const i=ou(n,e.delete);return new oh(i,t)}if(e.verify){const i=ou(n,e.verify);return new Dv(i,t)}return ot()}function NI(n,e){return{documents:[RI(n,e.path)]}}function Ov(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=RI(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=RI(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(g){if(0===g.length)return;const v=g.map(T=>function(S){if("=="===S.op){if(mc(S.value))return{unaryFilter:{field:hh(S.field),op:"IS_NAN"}};if(hv(S.value))return{unaryFilter:{field:hh(S.field),op:"IS_NULL"}}}else if("!="===S.op){if(mc(S.value))return{unaryFilter:{field:hh(S.field),op:"IS_NOT_NAN"}};if(hv(S.value))return{unaryFilter:{field:hh(S.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hh(S.field),op:dh(S.op),value:S.value}}}(T));return 1===v.length?v[0]:{compositeFilter:{op:"AND",filters:v}}}(e.filters);i&&(t.structuredQuery.where=i);const a=function(g){if(0!==g.length)return g.map(v=>{return{field:hh((T=v).field),direction:VD(T.dir)};var T})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=(v=e.limit,n.gt||Jd(v)?v:{value:v});var v,h,g;return null!==l&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(g=e.endAt).inclusive,values:g.position}),t}function PI(n){let e=LD(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){At(1===r);const T=t.from[0];T.allDescendants?i=T.collectionId:e=e.child(T.collectionId)}let a=[];t.where&&(a=LI(t.where));let l=[];t.orderBy&&(l=t.orderBy.map(T=>{return new _c(bc((S=T).field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction));var S}));let h=null;t.limit&&(h=function(T){let S;return S="object"==typeof T?T.value:T,Jd(S)?null:S}(t.limit));let g=null;var T;t.startAt&&(g=new dl((T=t.startAt).values||[],!!T.before));let v=null;return t.endAt&&(v=function(T){return new dl(T.values||[],!T.before)}(t.endAt)),_v(e,i,l,a,h,"F",g,v)}function LI(n){return n?void 0!==n.unaryFilter?[FI(n)]:void 0!==n.fieldFilter?[BD(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>LI(e)).reduce((e,t)=>e.concat(t)):ot():[]}function VD(n){return ND[n]}function dh(n){return PD[n]}function hh(n){return{fieldPath:n.canonicalString()}}function bc(n){return Kn.fromServerFormat(n.fieldPath)}function BD(n){return wi.create(bc(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ot()}}(n.fieldFilter.op),n.fieldFilter.value)}function FI(n){switch(n.unaryFilter.op){case"IS_NAN":const e=bc(n.unaryFilter.field);return wi.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=bc(n.unaryFilter.field);return wi.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=bc(n.unaryFilter.field);return wi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=bc(n.unaryFilter.field);return wi.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ot()}}function jD(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Lv(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function Xi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=UI(e)),e=Fv(n.get(t),e);return UI(e)}function Fv(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function UI(n){return n+"\x01\x01"}function Ho(n){const e=n.length;if(At(e>=2),2===e)return At("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),an.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const l=n.indexOf("\x01",a);switch((l<0||l>t)&&ot(),n.charAt(l+1)){case"\x01":const h=n.substring(a,l);let g;0===i.length?g=h:(i+=h,g=i,i=""),r.push(g);break;case"\x10":i+=n.substring(a,l),i+="\0";break;case"\x11":i+=n.substring(a,l+1);break;default:ot()}a=l+2}return new an(r)}const Uv=["userId","batchId"];function Mm(n,e){return[n,Xi(e)]}function VI(n,e,t){return[n,Xi(e),t]}const $D={},Vv=["prefixPath","collectionGroup","readTime","documentId"],HD=["prefixPath","collectionGroup","documentId"],BI=["collectionGroup","readTime","prefixPath","documentId"],GD=["canonicalId","targetId"],WD=["targetId","path"],qD=["path","targetId"],zD=["collectionId","parent"],KD=["indexId","uid"],ZD=["uid","sequenceNumber"],YD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],QD=["indexId","uid","orderedDocumentKey"],jI=["userId","collectionPath","documentId"],$I=["userId","collectionPath","largestBatchId"],XD=["userId","collectionGroup","largestBatchId"],HI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],GI=[...HI,"documentOverlays"],WI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],qI=WI,JD=[...qI,"indexConfiguration","indexState","indexEntries"];class ep extends fm{constructor(e,t){super(),this.ie=e,this.currentSequenceNumber=t}}function Ur(n,e){const t=Je(n);return Ls.M(t.ie,e)}class km{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&SD(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=_a(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=_a(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Av();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let h=this.applyToLocalView(l,a.mutatedFields);h=t.has(i.key)?null:h;const g=DI(l,h);null!==g&&r.set(i.key,g),l.isValidDocument()||l.convertToNoDocument(Rt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ht())}isEqual(e){return this.batchId===e.batchId&&Pf(this.mutations,e.mutations,(t,r)=>Sm(t,r))&&Pf(this.baseMutations,e.baseMutations,(t,r)=>Sm(t,r))}}class tp{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){At(e.mutations.length===r.length);let i=RD;const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new tp(e,t,r,i)}}class Bv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class fl{constructor(e,t,r,i,a=Rt.min(),l=Rt.min(),h=Yr.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h}withSequenceNumber(e){return new fl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new fl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new fl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Nm{constructor(e){this.re=e}}function zI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Pm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Xf(i=n.re,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:ch(i,a.version.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:pl(e.version)};else{if(!e.isUnknownDocument())return ot();r.unknownDocument={path:t.path.toArray(),version:pl(e.version)}}var i,a;return r}function Pm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function pl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Cc(n){const e=new Mn(n.seconds,n.nanoseconds);return Rt.fromTimestamp(e)}function gl(n,e){const t=(e.baseMutations||[]).map(a=>Pv(n.re,a));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(l.updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a)}const r=e.mutations.map(a=>Pv(n.re,a)),i=Mn.fromMillis(e.localWriteTimeMs);return new km(e.batchId,i,t,r)}function Om(n){const e=Cc(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Cc(n.lastLimboFreeSnapshotVersion):Rt.min();let r;var i;return void 0!==n.query.documents?(At(1===(i=n.query).documents.length),r=Yi(yc(LD(i.documents[0])))):r=Yi(PI(n.query)),new fl(r,n.targetId,0,n.lastListenSequenceNumber,e,t,Yr.fromBase64String(n.resumeToken))}function KI(n,e){const t=pl(e.snapshotVersion),r=pl(e.lastLimboFreeSnapshotVersion);let i;i=jf(e.target)?NI(n.re,e.target):Ov(n.re,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:vi(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function fh(n){const e=PI({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Tm(e,e.limit,"L"):e}function jv(n,e){return new Bv(e.largestBatchId,Pv(n.re,e.overlayMutation))}function Tc(n,e){const t=e.path.lastSegment();return[n,Xi(e.path.popLast()),t]}function ph(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:pl(r.readTime),documentKey:Xi(r.documentKey.path),largestBatchId:r.largestBatchId}}class tS{getBundleMetadata(e,t){return nS(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Cc(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return nS(e).put({bundleId:(r=t).id,createTime:pl(oi(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return $v(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:fh(i.bundledQuery),readTime:Cc(i.readTime)};var i})}saveNamedQuery(e,t){return $v(e).put({name:(r=t).name,readTime:pl(oi(r.readTime)),bundledQuery:r.bundledQuery});var r}}function nS(n){return Ur(n,"bundles")}function $v(n){return Ur(n,"namedQueries")}class Lm{constructor(e,t){this.It=e,this.userId=t}static oe(e,t){return new Lm(e,t.uid||"")}getOverlay(e,t){return np(e).get(Tc(this.userId,t)).next(r=>r?jv(this.It,r):null)}getOverlays(e,t){const r=$o();return ue.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,l)=>{const h=new Bv(t,l);i.push(this.ue(e,h))}),ue.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(l=>i.add(Xi(l.getCollectionPath())));const a=[];return i.forEach(l=>{const h=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(np(e).Y("collectionPathOverlayIndex",h))}),ue.waitFor(a)}getOverlaysForCollection(e,t,r){const i=$o(),a=Xi(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return np(e).W("collectionPathOverlayIndex",l).next(h=>{for(const g of h){const v=jv(this.It,g);i.set(v.getKey(),v)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=$o();let l;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return np(e).Z({index:"collectionGroupOverlayIndex",range:h},(g,v,T)=>{const S=jv(this.It,v);a.size()<i||S.largestBatchId===l?(a.set(S.getKey(),S),l=S.largestBatchId):T.done()}).next(()=>a)}ue(e,t){return np(e).put(function(r,i,a){const[l,h,g]=Tc(i,a.mutation.key);return{userId:i,collectionPath:h,documentId:g,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:au(r.re,a.mutation)}}(this.It,this.userId,t))}}function np(n){return Ur(n,"documentOverlays")}class Dc{constructor(){}ce(e,t){this.ae(e,t),t.he()}ae(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(ir(e.integerValue));else if("doubleValue"in e){const r=ir(e.doubleValue);isNaN(r)?this.le(t,13):(this.le(t,15),eh(r)?t.fe(0):t.fe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.le(t,20),"string"==typeof r?t.de(r):(t.de(`${r.seconds||""}`),t.fe(r.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(iu(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.le(t,45),t.fe(r.latitude||0),t.fe(r.longitude||0)}else"mapValue"in e?fv(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):ot()}_e(e,t){this.le(t,25),this.Ie(e,t)}Ie(e,t){t.de(e)}ye(e,t){const r=e.fields||{};this.le(t,55);for(const i of Object.keys(r))this._e(i,t),this.ae(r[i],t)}pe(e,t){const r=e.values||[];this.le(t,50);for(const i of r)this.ae(i,t)}ge(e,t){this.le(t,37),Qe.fromName(e).path.forEach(r=>{this.le(t,60),this.Ie(r,t)})}le(e,t){e.fe(t)}we(e){e.fe(2)}}function rS(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function Hv(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=rS(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}Dc.Te=new Dc;class ZI{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ee(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ae(r.value),r=t.next();this.Re()}be(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Pe(r.value),r=t.next();this.ve()}Ve(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=t.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}Se(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Pe(r);else if(r<2048)this.Pe(960|r>>>6),this.Pe(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Pe(480|r>>>12),this.Pe(128|63&r>>>6),this.Pe(128|63&r);else{const i=t.codePointAt(0);this.Pe(240|i>>>18),this.Pe(128|63&i>>>12),this.Pe(128|63&i>>>6),this.Pe(128|63&i)}}this.ve()}De(e){const t=this.Ce(e),r=Hv(t);this.xe(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Ne(e){const t=this.Ce(e),r=Hv(t);this.xe(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}ke(){this.Oe(255),this.Oe(255)}Me(){this.Fe(255),this.Fe(255)}reset(){this.position=0}seed(e){this.xe(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Ce(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ae(e){const t=255&e;0===t?(this.Oe(0),this.Oe(255)):255===t?(this.Oe(255),this.Oe(0)):this.Oe(t)}Pe(e){const t=255&e;0===t?(this.Fe(0),this.Fe(255)):255===t?(this.Fe(255),this.Fe(0)):this.Fe(e)}Re(){this.Oe(0),this.Oe(1)}ve(){this.Fe(0),this.Fe(1)}Oe(e){this.xe(1),this.buffer[this.position++]=e}Fe(e){this.xe(1),this.buffer[this.position++]=~e}xe(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Gv{constructor(e){this.Be=e}me(e){this.Be.Ee(e)}de(e){this.Be.Ve(e)}fe(e){this.Be.De(e)}he(){this.Be.ke()}}class Fm{constructor(e){this.Be=e}me(e){this.Be.be(e)}de(e){this.Be.Se(e)}fe(e){this.Be.Ne(e)}he(){this.Be.Me()}}class uu{constructor(){this.Be=new ZI,this.Le=new Gv(this.Be),this.Ue=new Fm(this.Be)}seed(e){this.Be.seed(e)}qe(e){return 0===e?this.Le:this.Ue}$e(){return this.Be.$e()}reset(){this.Be.reset()}}class Sc{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ke(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Sc(this.indexId,this.documentKey,this.arrayValue,r)}}function ml(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Wv(n.arrayValue,e.arrayValue),0!==t?t:(t=Wv(n.directionalValue,e.directionalValue),0!==t?t:Qe.comparator(n.documentKey,e.documentKey)))}function Wv(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class iS{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ge=e.orderBy,this.Qe=[];for(const t of e.filters){const r=t;r.dt()?this.je=r:this.Qe.push(r)}}We(e){const t=Xy(e);if(void 0!==t&&!this.ze(t))return!1;const r=hc(e);let i=0,a=0;for(;i<r.length&&this.ze(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.je){const l=r[i];if(!this.He(this.je,l)||!this.Je(this.Ge[a++],l))return!1;++i}for(;i<r.length;++i){const l=r[i];if(a>=this.Ge.length||!this.Je(this.Ge[a++],l))return!1}return!0}ze(e){for(const t of this.Qe)if(this.He(t,e))return!0;return!1}He(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}Je(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class sS{constructor(){this.Ye=new rp}addToCollectionParentIndex(e,t){return this.Ye.add(t),ue.resolve()}getCollectionParents(e,t){return ue.resolve(this.Ye.getEntries(t))}addFieldIndex(e,t){return ue.resolve()}deleteFieldIndex(e,t){return ue.resolve()}getDocumentsMatchingTarget(e,t){return ue.resolve(null)}getIndexType(e,t){return ue.resolve(0)}getFieldIndexes(e,t){return ue.resolve([])}getNextCollectionGroupToUpdate(e){return ue.resolve(null)}getMinOffset(e,t){return ue.resolve(ms.min())}getMinOffsetFromCollectionGroup(e,t){return ue.resolve(ms.min())}updateCollectionGroup(e,t,r){return ue.resolve()}updateIndexEntries(e,t){return ue.resolve()}}class rp{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Pn(an.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Pn(an.comparator)).toArray()}}const Um=new Uint8Array(0);class yR{constructor(e,t){this.user=e,this.databaseId=t,this.Xe=new rp,this.Ze=new kn(r=>vi(r),(r,i)=>rh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Xe.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Xe.add(t)});const a={collectionId:r,parent:Xi(i)};return YI(e).put(a)}return ue.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[oI(t),""],!1,!0);return YI(e).W(i).next(a=>{for(const l of a){if(l.collectionId!==t)break;r.push(Ho(l.parent))}return r})}addFieldIndex(e,t){const r=lu(e),i={indexId:(l=t).indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var l;delete i.indexId;const a=r.add(i);if(t.indexState){const l=gh(e);return a.next(h=>{l.put(ph(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=lu(e),i=gh(e),a=ip(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=ip(e);let i=!0;const a=new Map;return ue.forEach(this.tn(t),l=>this.en(e,l).next(h=>{i&&(i=!!h),a.set(l,h)})).next(()=>{if(i){let l=Ht();const h=[];return ue.forEach(a,(g,v)=>{var T;Ue("IndexedDbIndexManager",`Using index ${T=g,`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(ct=>`${ct.fieldPath}:${ct.kind}`).join(",")}`} to execute ${vi(t)}`);const S=function(ct,ht){const xt=Xy(ht);if(void 0===xt)return null;for(const Lt of ym(ct,xt.fieldPath))switch(Lt.op){case"array-contains-any":return Lt.value.arrayValue.values||[];case"array-contains":return[Lt.value]}return null}(v,g),k=function(ct,ht){const xt=new Map;for(const Lt of hc(ht))for(const Mr of ym(ct,Lt.fieldPath))switch(Mr.op){case"==":case"in":xt.set(Lt.fieldPath.canonicalString(),Mr.value);break;case"not-in":case"!=":return xt.set(Lt.fieldPath.canonicalString(),Mr.value),Array.from(xt.values())}return null}(v,g),U=function(ct,ht){const xt=[];let Lt=!0;for(const Mr of hc(ht)){const Eu=0===Mr.kind?hI(ct,Mr.fieldPath,ct.startAt):fI(ct,Mr.fieldPath,ct.startAt);xt.push(Eu.value),Lt&&(Lt=Eu.inclusive)}return new dl(xt,Lt)}(v,g),K=function(ct,ht){const xt=[];let Lt=!0;for(const Mr of hc(ht)){const Eu=0===Mr.kind?fI(ct,Mr.fieldPath,ct.endAt):hI(ct,Mr.fieldPath,ct.endAt);xt.push(Eu.value),Lt&&(Lt=Eu.inclusive)}return new dl(xt,Lt)}(v,g),he=this.nn(g,v,U),be=this.nn(g,v,K),lt=this.sn(g,v,k),ft=this.rn(g.indexId,S,he,U.inclusive,be,K.inclusive,lt);return ue.forEach(ft,ct=>r.J(ct,t.limit).next(ht=>{ht.forEach(xt=>{const Lt=Qe.fromSegments(xt.documentKey);l.has(Lt)||(l=l.add(Lt),h.push(Lt))})}))}).next(()=>h)}return ue.resolve(null)})}tn(e){let t=this.Ze.get(e);return t||(t=[e],this.Ze.set(e,t),t)}rn(e,t,r,i,a,l,h){const g=(null!=t?t.length:1)*Math.max(r.length,a.length),v=g/(null!=t?t.length:1),T=[];for(let S=0;S<g;++S){const k=t?this.on(t[S/v]):Um,U=this.un(e,k,r[S%v],i),K=this.cn(e,k,a[S%v],l),he=h.map(be=>this.un(e,k,be,!0));T.push(...this.createRange(U,K,he))}return T}un(e,t,r,i){const a=new Sc(e,Qe.empty(),t,r);return i?a:a.Ke()}cn(e,t,r,i){const a=new Sc(e,Qe.empty(),t,r);return i?a.Ke():a}en(e,t){const r=new iS(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let l=null;for(const h of a)r.We(h)&&(!l||h.fields.length>l.fields.length)&&(l=h);return l})}getIndexType(e,t){let r=2;return ue.forEach(this.tn(t),i=>this.en(e,i).next(a=>{a?0!==r&&a.fields.length<function(l){let h=new Pn(Kn.comparator),g=!1;for(const v of l.filters){const T=v;T.field.isKeyField()||("array-contains"===T.op||"array-contains-any"===T.op?g=!0:h=h.add(T.field))}for(const v of l.orderBy)v.field.isKeyField()||(h=h.add(v.field));return h.size+(g?1:0)}(i)&&(r=1):r=0})).next(()=>r)}an(e,t){const r=new uu;for(const i of hc(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const l=r.qe(i.kind);Dc.Te.ce(a,l)}return r.$e()}on(e){const t=new uu;return Dc.Te.ce(e,t.qe(0)),t.$e()}hn(e,t){const r=new uu;return Dc.Te.ce(cl(this.databaseId,t),r.qe(function(i){const a=hc(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.$e()}sn(e,t,r){if(null===r)return[];let i=[];i.push(new uu);let a=0;for(const l of hc(e)){const h=r[a++];for(const g of i)if(this.ln(t,l.fieldPath)&&nh(h))i=this.fn(i,l,h);else{const v=g.qe(l.kind);Dc.Te.ce(h,v)}}return this.dn(i)}nn(e,t,r){return this.sn(e,t,r.position)}dn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].$e();return t}fn(e,t,r){const i=[...e],a=[];for(const l of r.arrayValue.values||[])for(const h of i){const g=new uu;g.seed(h.$e()),Dc.Te.ce(l,g.qe(t.kind)),a.push(g)}return a}ln(e,t){return!!e.filters.find(r=>r instanceof wi&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=lu(e),i=gh(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(a=>{const l=[];return ue.forEach(a,h=>i.get([h.indexId,this.uid]).next(g=>{l.push(function(v,T){const S=T?new Yd(T.sequenceNumber,new ms(Cc(T.readTime),new Qe(Ho(T.documentKey)),T.largestBatchId)):Yd.empty(),k=v.fields.map(([U,K])=>new hm(Kn.fromServerFormat(U),K));return new Of(v.indexId,v.collectionGroup,k,S)}(h,g))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:Nt(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=lu(e),a=gh(e);return this._n(e).next(l=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>ue.forEach(h,g=>a.put(ph(g.indexId,this.user,l,r)))))}updateIndexEntries(e,t){const r=new Map;return ue.forEach(t,(i,a)=>{const l=r.get(i.collectionGroup);return(l?ue.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),ue.forEach(h,g=>this.wn(e,i,g).next(v=>{const T=this.mn(a,g);return v.isEqual(T)?ue.resolve():this.gn(e,a,g,v,T)}))))})}yn(e,t,r,i){return ip(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.hn(r,t.key),documentKey:t.key.path.toArray()})}pn(e,t,r,i){return ip(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.hn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=ip(e);let a=new Pn(ml);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.hn(r,t)])},(l,h)=>{a=a.add(new Sc(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>a)}mn(e,t){let r=new Pn(ml);const i=this.an(t,e);if(null==i)return r;const a=Xy(t);if(null!=a){const l=e.data.field(a.fieldPath);if(nh(l))for(const h of l.arrayValue.values||[])r=r.add(new Sc(t.indexId,e.key,this.on(h),i))}else r=r.add(new Sc(t.indexId,e.key,Um,i));return r}gn(e,t,r,i,a){Ue("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const l=[];return function(h,g,v,T,S){const k=h.getIterator(),U=g.getIterator();let K=fc(k),he=fc(U);for(;K||he;){let be=!1,lt=!1;if(K&&he){const ft=v(K,he);ft<0?lt=!0:ft>0&&(be=!0)}else null!=K?lt=!0:be=!0;be?(T(he),he=fc(U)):lt?(S(K),K=fc(k)):(K=fc(k),he=fc(U))}}(i,a,ml,h=>{l.push(this.yn(e,t,r,h))},h=>{l.push(this.pn(e,t,r,h))}),ue.waitFor(l)}_n(e){let t=1;return gh(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((l,h)=>ml(l,h)).filter((l,h,g)=>!h||0!==ml(l,g[h-1]));const i=[];i.push(e);for(const l of r){const h=ml(l,e),g=ml(l,t);if(0===h)i[0]=e.Ke();else if(h>0&&g<0)i.push(l),i.push(l.Ke());else if(g>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2)a.push(IDBKeyRange.bound([i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,Um,[]],[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,Um,[]]));return a}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ac)}getMinOffset(e,t){return ue.mapArray(this.tn(t),r=>this.en(e,r).next(i=>i||ot())).next(Ac)}}function YI(n){return Ur(n,"collectionParents")}function ip(n){return Ur(n,"indexEntries")}function lu(n){return Ur(n,"indexConfiguration")}function gh(n){return Ur(n,"indexState")}function Ac(n){At(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Lf(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ms(e.readTime,e.documentKey,t)}const oS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ji{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ji(e,Ji.DEFAULT_COLLECTION_PERCENTILE,Ji.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function QI(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],l=IDBKeyRange.only(t.batchId);let h=0;const g=r.Z({range:l},(T,S,k)=>(h++,k.delete()));a.push(g.next(()=>{At(1===h)}));const v=[];for(const T of t.mutations){const S=VI(e,T.key.path,t.batchId);a.push(i.delete(S)),v.push(T.key)}return ue.waitFor(a).next(()=>v)}function qv(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ot();e=n.noDocument}return JSON.stringify(e).length}Ji.DEFAULT_COLLECTION_PERCENTILE=10,Ji.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ji.DEFAULT=new Ji(41943040,Ji.DEFAULT_COLLECTION_PERCENTILE,Ji.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ji.DISABLED=new Ji(-1,0,0);class sp{constructor(e,t,r,i){this.userId=e,this.It=t,this.indexManager=r,this.referenceDelegate=i,this.In={}}static oe(e,t,r,i){At(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new sp(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cu(e).Z({index:"userMutationsIndex",range:r},(i,a,l)=>{t=!1,l.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=_l(e),l=cu(e);return l.add({}).next(h=>{At("number"==typeof h);const g=new km(h,t,r,i),v=function(k,U,K){const he=K.baseMutations.map(lt=>au(k.re,lt)),be=K.mutations.map(lt=>au(k.re,lt));return{userId:U,batchId:K.batchId,localWriteTimeMs:K.localWriteTime.toMillis(),baseMutations:he,mutations:be}}(this.It,this.userId,g),T=[];let S=new Pn((k,U)=>Nt(k.canonicalString(),U.canonicalString()));for(const k of i){const U=VI(this.userId,k.key.path,h);S=S.add(k.key.path.popLast()),T.push(l.put(v)),T.push(a.put(U,$D))}return S.forEach(k=>{T.push(this.indexManager.addToCollectionParentIndex(e,k))}),e.addOnCommittedListener(()=>{this.In[h]=g.keys()}),ue.waitFor(T).next(()=>g)})}lookupMutationBatch(e,t){return cu(e).get(t).next(r=>r?(At(r.userId===this.userId),gl(this.It,r)):null)}Tn(e,t){return this.In[t]?ue.resolve(this.In[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.In[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return cu(e).Z({index:"userMutationsIndex",range:i},(l,h,g)=>{h.userId===this.userId&&(At(h.batchId>=r),a=gl(this.It,h)),g.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return cu(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(i,a,l)=>{r=a.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return cu(e).W("userMutationsIndex",t).next(r=>r.map(i=>gl(this.It,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Mm(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return _l(e).Z({range:i},(l,h,g)=>{const[v,T,S]=l,k=Ho(T);if(v===this.userId&&t.path.isEqual(k))return cu(e).get(S).next(U=>{if(!U)throw ot();At(U.userId===this.userId),a.push(gl(this.It,U))});g.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Pn(Nt);const i=[];return t.forEach(a=>{const l=Mm(this.userId,a.path),h=IDBKeyRange.lowerBound(l),g=_l(e).Z({range:h},(v,T,S)=>{const[k,U,K]=v,he=Ho(U);k===this.userId&&a.path.isEqual(he)?r=r.add(K):S.done()});i.push(g)}),ue.waitFor(i).next(()=>this.En(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=Mm(this.userId,r),l=IDBKeyRange.lowerBound(a);let h=new Pn(Nt);return _l(e).Z({range:l},(g,v,T)=>{const[S,k,U]=g,K=Ho(k);S===this.userId&&r.isPrefixOf(K)?K.length===i&&(h=h.add(U)):T.done()}).next(()=>this.En(e,h))}En(e,t){const r=[],i=[];return t.forEach(a=>{i.push(cu(e).get(a).next(l=>{if(null===l)throw ot();At(l.userId===this.userId),r.push(gl(this.It,l))}))}),ue.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return QI(e.ie,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.An(t.batchId)}),ue.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ue.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return _l(e).Z({range:r},(a,l,h)=>{if(a[0]===this.userId){const g=Ho(a[1]);i.push(g)}else h.done()}).next(()=>{At(0===i.length)})})}containsKey(e,t){return aS(e,this.userId,t)}Rn(e){return XI(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function aS(n,e,t){const r=Mm(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return _l(n).Z({range:a,X:!0},(h,g,v)=>{const[T,S,k]=h;T===e&&S===i&&(l=!0),v.done()}).next(()=>l)}function cu(n){return Ur(n,"mutations")}function _l(n){return Ur(n,"documentMutations")}function XI(n){return Ur(n,"mutationQueues")}class xc{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new xc(0)}static vn(){return new xc(-1)}}class uS{constructor(e,t){this.referenceDelegate=e,this.It=t}allocateTargetId(e){return this.Vn(e).next(t=>{const r=new xc(t.highestTargetId);return t.highestTargetId=r.next(),this.Sn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(t=>Rt.fromTimestamp(new Mn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Vn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Sn(e,i)))}addTargetData(e,t){return this.Dn(e,t).next(()=>this.Vn(e).next(r=>(r.targetCount+=1,this.Cn(t,r),this.Sn(e,r))))}updateTargetData(e,t){return this.Dn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>mh(e).delete(t.targetId)).next(()=>this.Vn(e)).next(r=>(At(r.targetCount>0),r.targetCount-=1,this.Sn(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return mh(e).Z((l,h)=>{const g=Om(h);g.sequenceNumber<=t&&null===r.get(g.targetId)&&(i++,a.push(this.removeTargetData(e,g)))}).next(()=>ue.waitFor(a)).next(()=>i)}forEachTarget(e,t){return mh(e).Z((r,i)=>{const a=Om(i);t(a)})}Vn(e){return JI(e).get("targetGlobalKey").next(t=>(At(null!==t),t))}Sn(e,t){return JI(e).put("targetGlobalKey",t)}Dn(e,t){return mh(e).put(KI(this.It,t))}Cn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Vn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=vi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return mh(e).Z({range:i,index:"queryTargetsIndex"},(l,h,g)=>{const v=Om(h);rh(t,v.target)&&(a=v,g.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=yl(e);return t.forEach(l=>{const h=Xi(l.path);i.push(a.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,l))}),ue.waitFor(i)}removeMatchingKeys(e,t,r){const i=yl(e);return ue.forEach(t,a=>{const l=Xi(a.path);return ue.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=yl(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=yl(e);let a=Ht();return i.Z({range:r,X:!0},(l,h,g)=>{const v=Ho(l[1]),T=new Qe(v);a=a.add(T)}).next(()=>a)}containsKey(e,t){const r=Xi(t.path),i=IDBKeyRange.bound([r],[oI(r)],!1,!0);let a=0;return yl(e).Z({index:"documentTargetsIndex",X:!0,range:i},([l,h],g,v)=>{0!==l&&(a++,v.done())}).next(()=>a>0)}se(e,t){return mh(e).get(t).next(r=>r?Om(r):null)}}function mh(n){return Ur(n,"targets")}function JI(n){return Ur(n,"targetGlobal")}function yl(n){return Ur(n,"targetDocuments")}function eb([n,e],[t,r]){const i=Nt(n,t);return 0===i?Nt(e,r):i}class lS{constructor(e){this.xn=e,this.buffer=new Pn(eb),this.Nn=0}kn(){return++this.Nn}On(e){const t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();eb(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class cS{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Mn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}stop(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}get started(){return null!==this.Mn}Fn(e){var t=this;Ue("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,me.Z)(function*(){t.Mn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Fo(r)?Ue("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield ul(r)}yield t.Fn(3e5)}))}}class dS{constructor(e,t){this.$n=e,this.params=t}calculateTargetCount(e,t){return this.$n.Bn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return ue.resolve(Ki.at);const r=new lS(t);return this.$n.forEachTarget(e,i=>r.On(i.sequenceNumber)).next(()=>this.$n.Ln(e,i=>r.On(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.$n.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.$n.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Ue("LruGarbageCollector","Garbage collection skipped; disabled"),ue.resolve(oS)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oS):this.Un(e,t))}getCacheSize(e){return this.$n.getCacheSize(e)}Un(e,t){let r,i,a,l,h,g,v;const T=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(S=>(S>this.params.maximumSequenceNumbersToCollect?(Ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),i=this.params.maximumSequenceNumbersToCollect):i=S,l=Date.now(),this.nthSequenceNumber(e,i))).next(S=>(r=S,h=Date.now(),this.removeTargets(e,r,t))).next(S=>(a=S,g=Date.now(),this.removeOrphanedDocuments(e,r))).next(S=>(v=Date.now(),dm()<=ko.in.DEBUG&&Ue("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-T}ms\n\tDetermined least recently used ${i} in `+(h-l)+`ms\n\tRemoved ${a} targets in `+(g-h)+`ms\n\tRemoved ${S} documents in `+(v-g)+`ms\nTotal Duration: ${v-T}ms`),ue.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:S})))}}class op{constructor(e,t){this.db=e,this.garbageCollector=new dS(this,t)}Bn(e){const t=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}qn(e){let t=0;return this.Ln(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ln(e,t){return this.Kn(e,(r,i)=>t(i))}addReference(e,t,r){return ap(e,r)}removeReference(e,t,r){return ap(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return ap(e,t)}Gn(e,t){return function(r,i){let a=!1;return XI(r).tt(l=>aS(r,l,i).next(h=>(h&&(a=!0),ue.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Kn(e,(l,h)=>{if(h<=t){const g=this.Gn(e,l).next(v=>{if(!v)return a++,r.getEntry(e,l).next(()=>(r.removeEntry(l,Rt.min()),yl(e).delete([0,Xi(l.path)])))});i.push(g)}}).next(()=>ue.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return ap(e,t)}Kn(e,t){const r=yl(e);let i,a=Ki.at;return r.Z({index:"documentTargetsIndex"},([l,h],{path:g,sequenceNumber:v})=>{0===l?(a!==Ki.at&&t(new Qe(Ho(i)),a),a=v,i=g):a=Ki.at}).next(()=>{a!==Ki.at&&t(new Qe(Ho(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ap(n,e){return yl(n).put((r=n.currentSequenceNumber,{targetId:0,path:Xi(e.path),sequenceNumber:r}));var r}class zv{constructor(){this.changes=new kn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$n.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?ue.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class tb{constructor(e){this.It=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Rc(e).put(r)}removeEntry(e,t,r){return Rc(e).delete(function(i,a){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Pm(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Qn(e,r)))}getEntry(e,t){let r=$n.newInvalidDocument(t);return Rc(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(up(t))},(i,a)=>{r=this.jn(t,a)}).next(()=>r)}Wn(e,t){let r={size:0,document:$n.newInvalidDocument(t)};return Rc(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(up(t))},(i,a)=>{r={document:this.jn(t,a),size:qv(a)}}).next(()=>r)}getEntries(e,t){let r=Qi();return this.zn(e,t,(i,a)=>{const l=this.jn(i,a);r=r.insert(i,l)}).next(()=>r)}Hn(e,t){let r=Qi(),i=new dr(Qe.comparator);return this.zn(e,t,(a,l)=>{const h=this.jn(a,l);r=r.insert(a,h),i=i.insert(a,qv(l))}).next(()=>({documents:r,Jn:i}))}zn(e,t,r){if(t.isEmpty())return ue.resolve();let i=new Pn(sb);t.forEach(g=>i=i.add(g));const a=IDBKeyRange.bound(up(i.first()),up(i.last())),l=i.getIterator();let h=l.getNext();return Rc(e).Z({index:"documentKeyIndex",range:a},(g,v,T)=>{const S=Qe.fromSegments([...v.prefixPath,v.collectionGroup,v.documentId]);for(;h&&sb(h,S)<0;)r(h,null),h=l.getNext();h&&h.isEqual(S)&&(r(h,v),h=l.hasNext()?l.getNext():null),h?T.j(up(h)):T.done()}).next(()=>{for(;h;)r(h,null),h=l.hasNext()?l.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),Pm(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Rc(e).W(IDBKeyRange.bound(i,a,!0)).next(l=>{let h=Qi();for(const g of l){const v=this.jn(Qe.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);h=h.insert(v.key,v)}return h})}getAllFromCollectionGroup(e,t,r,i){let a=Qi();const l=ib(t,r),h=ib(t,ms.max());return Rc(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,h,!0)},(g,v,T)=>{const S=this.jn(Qe.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);a=a.insert(S.key,S),a.size===i&&T.done()}).next(()=>a)}newChangeBuffer(e){return new nb(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return rb(e).get("remoteDocumentGlobalKey").next(t=>(At(!!t),t))}Qn(e,t){return rb(e).put("remoteDocumentGlobalKey",t)}jn(e,t){if(t){const r=function eS(n,e){let t;if(e.document)t=MI(n.re,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Qe.fromSegments(e.noDocument.path),i=Cc(e.noDocument.readTime);t=$n.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ot();{const r=Qe.fromSegments(e.unknownDocument.path),i=Cc(e.unknownDocument.version);t=$n.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new Mn(r[0],r[1]);return Rt.fromTimestamp(i)}(e.readTime)),t}(this.It,t);if(!r.isNoDocument()||!r.version.isEqual(Rt.min()))return r}return $n.newInvalidDocument(e)}}function Kv(n){return new tb(n)}class nb extends zv{constructor(e,t){super(),this.Yn=e,this.trackRemovals=t,this.Xn=new kn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Pn((a,l)=>Nt(a.canonicalString(),l.canonicalString()));return this.changes.forEach((a,l)=>{const h=this.Xn.get(a);if(t.push(this.Yn.removeEntry(e,a,h.readTime)),l.isValidDocument()){const g=zI(this.Yn.It,l);i=i.add(a.path.popLast()),r+=qv(g)-h.size,t.push(this.Yn.addEntry(e,a,g))}else if(r-=h.size,this.trackRemovals){const g=zI(this.Yn.It,l.convertToNoDocument(Rt.min()));t.push(this.Yn.addEntry(e,a,g))}}),i.forEach(a=>{t.push(this.Yn.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Yn.updateMetadata(e,r)),ue.waitFor(t)}getFromCache(e,t){return this.Yn.Wn(e,t).next(r=>(this.Xn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Yn.Hn(e,t).next(({documents:r,Jn:i})=>(i.forEach((a,l)=>{this.Xn.set(a,{size:l,readTime:r.get(a).readTime})}),r))}}function rb(n){return Ur(n,"remoteDocumentGlobal")}function Rc(n){return Ur(n,"remoteDocumentsV14")}function up(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ib(n,e){const t=e.documentKey.path.toArray();return[n,Pm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function sb(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=Nt(t[a],r[a]),i)return i;return i=Nt(t.length,r.length),i||(i=Nt(t[t.length-2],r[r.length-2]),i||Nt(t[t.length-1],r[r.length-1]))}class hS{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ob{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.getBaseDocument(e,t,r))).next(i=>(null!==r&&_a(r.mutation,i,Zi.empty(),Mn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ht()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ht()){const i=$o();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let l=Kf();return a.forEach((h,g)=>{l=l.insert(h,g.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const r=$o();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ht()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,h)=>{t.set(l,h)})})}computeViews(e,t,r,i){let a=Qi();const l=ah(),h=ah();return t.forEach((g,v)=>{const T=r.get(v.key);i.has(v.key)&&(void 0===T||T.mutation instanceof ya)?a=a.insert(v.key,v):void 0!==T&&(l.set(v.key,T.mutation.getFieldMask()),_a(T.mutation,v,T.mutation.getFieldMask(),Mn.now()))}),this.recalculateAndSaveOverlays(e,a).next(g=>(g.forEach((v,T)=>l.set(v,T)),t.forEach((v,T)=>{var S;return h.set(v,new hS(T,null!==(S=l.get(v))&&void 0!==S?S:null))}),h))}recalculateAndSaveOverlays(e,t){const r=ah();let i=new dr((l,h)=>l-h),a=Ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const h of l)h.keys().forEach(g=>{const v=t.get(g);if(null===v)return;let T=r.get(g)||Zi.empty();T=h.applyToLocalView(v,T),r.set(g,T);const S=(i.get(h.batchId)||Ht()).add(g);i=i.insert(h.batchId,S)})}).next(()=>{const l=[],h=i.getReverseIterator();for(;h.hasNext();){const g=h.getNext(),v=g.key,T=g.value,S=Av();T.forEach(k=>{if(!a.has(k)){const U=DI(t.get(k),r.get(k));null!==U&&S.set(k,U),a=a.add(k)}}),l.push(this.documentOverlayCache.saveOverlays(e,v,S))}return ue.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return Qe.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Cm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):ue.resolve($o());let h=-1,g=a;return l.next(v=>ue.forEach(v,(T,S)=>(h<S.largestBatchId&&(h=S.largestBatchId),a.get(T)?ue.resolve():this.getBaseDocument(e,T,S).next(k=>{g=g.insert(T,k)}))).next(()=>this.populateOverlays(e,v,a)).next(()=>this.computeViews(e,g,v,Ht())).next(T=>({batchId:h,changes:Sv(T)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Qe(t)).next(r=>{let i=Kf();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=Kf();return this.indexManager.getCollectionParents(e,i).next(l=>ue.forEach(l,h=>{const g=(v=t,T=h.child(i),new ga(T,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt));var v,T;return this.getDocumentsMatchingCollectionQuery(e,g,r).next(v=>{v.forEach((T,S)=>{a=a.insert(T,S)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(a=>(i=a,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(a=>{a.forEach((h,g)=>{const v=g.getKey();null===i.get(v)&&(i=i.insert(v,$n.newInvalidDocument(v)))});let l=Kf();return i.forEach((h,g)=>{const v=a.get(h);void 0!==v&&_a(v.mutation,g,Zi.empty(),Mn.now()),wv(t,g)&&(l=l.insert(h,g))}),l})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):ue.resolve($n.newInvalidDocument(t))}}class lp{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return ue.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var r;return this.Zn.set(t.id,{id:(r=t).id,version:r.version,createTime:oi(r.createTime)}),ue.resolve()}getNamedQuery(e,t){return ue.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(r=t).name,query:fh(r.bundledQuery),readTime:oi(r.readTime)}),ue.resolve();var r}}class fS{constructor(){this.overlays=new dr(Qe.comparator),this.es=new Map}getOverlay(e,t){return ue.resolve(this.overlays.get(t))}getOverlays(e,t){const r=$o();return ue.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.ue(e,t,a)}),ue.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.es.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.es.delete(r)),ue.resolve()}getOverlaysForCollection(e,t,r){const i=$o(),a=t.length+1,l=new Qe(t.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const g=h.getNext().value,v=g.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===a&&g.largestBatchId>r&&i.set(g.getKey(),g)}return ue.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new dr((v,T)=>v-T);const l=this.overlays.getIterator();for(;l.hasNext();){const v=l.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>r){let T=a.get(v.largestBatchId);null===T&&(T=$o(),a=a.insert(v.largestBatchId,T)),T.set(v.getKey(),v)}}const h=$o(),g=a.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach((v,T)=>h.set(v,T)),!(h.size()>=i)););return ue.resolve(h)}ue(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const l=this.es.get(i.largestBatchId).delete(r.key);this.es.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new Bv(t,r));let a=this.es.get(t);void 0===a&&(a=Ht(),this.es.set(t,a)),this.es.set(t,a.add(r.key))}}class cp{constructor(){this.ns=new Pn(Ln.ss),this.rs=new Pn(Ln.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const r=new Ln(e,t);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.cs(new Ln(e,t))}hs(e,t){e.forEach(r=>this.removeReference(r,t))}ls(e){const t=new Qe(new an([])),r=new Ln(t,e),i=new Ln(t,e+1),a=[];return this.rs.forEachInRange([r,i],l=>{this.cs(l),a.push(l.key)}),a}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new Qe(new an([])),r=new Ln(t,e),i=new Ln(t,e+1);let a=Ht();return this.rs.forEachInRange([r,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new Ln(e,0),r=this.ns.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Ln{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return Qe.comparator(e.key,t.key)||Nt(e._s,t._s)}static os(e,t){return Nt(e._s,t._s)||Qe.comparator(e.key,t.key)}}class pS{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new Pn(Ln.ss)}checkEmpty(e){return ue.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.ws;this.ws++;const l=new km(a,t,r,i);this.mutationQueue.push(l);for(const h of i)this.gs=this.gs.add(new Ln(h.key,a)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return ue.resolve(l)}lookupMutationBatch(e,t){return ue.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ps(t+1),a=i<0?0:i;return ue.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ue.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ln(t,0),i=new Ln(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],l=>{const h=this.ys(l._s);a.push(h)}),ue.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Pn(Nt);return t.forEach(i=>{const a=new Ln(i,0),l=new Ln(i,Number.POSITIVE_INFINITY);this.gs.forEachInRange([a,l],h=>{r=r.add(h._s)})}),ue.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;Qe.isDocumentKey(a)||(a=a.child(""));const l=new Ln(new Qe(a),0);let h=new Pn(Nt);return this.gs.forEachWhile(g=>{const v=g.key.path;return!!r.isPrefixOf(v)&&(v.length===i&&(h=h.add(g._s)),!0)},l),ue.resolve(this.Is(h))}Is(e){const t=[];return e.forEach(r=>{const i=this.ys(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){At(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return ue.forEach(t.mutations,i=>{const a=new Ln(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.gs=r})}An(e){}containsKey(e,t){const r=new Ln(t,0),i=this.gs.firstAfterOrEqual(r);return ue.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ue.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Zv{constructor(e){this.Es=e,this.docs=new dr(Qe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.Es(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ue.resolve(r?r.document.mutableCopy():$n.newInvalidDocument(t))}getEntries(e,t){let r=Qi();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():$n.newInvalidDocument(i))}),ue.resolve(r)}getAllFromCollection(e,t,r){let i=Qi();const a=new Qe(t.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:g}}=l.getNext();if(!t.isPrefixOf(h.path))break;h.path.length>t.length+1||Lf(Jy(g),r)<=0||(i=i.insert(g.key,g.mutableCopy()))}return ue.resolve(i)}getAllFromCollectionGroup(e,t,r,i){ot()}As(e,t){return ue.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new dp(this)}getSize(e){return ue.resolve(this.size)}}class dp extends zv{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Yn.addEntry(e,i)):this.Yn.removeEntry(r)}),ue.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class gS{constructor(e){this.persistence=e,this.Rs=new kn(t=>vi(t),rh),this.lastRemoteSnapshotVersion=Rt.min(),this.highestTargetId=0,this.bs=0,this.Ps=new cp,this.targetCount=0,this.vs=xc.Pn()}forEachTarget(e,t){return this.Rs.forEach((r,i)=>t(i)),ue.resolve()}getLastRemoteSnapshotVersion(e){return ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ue.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),ue.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.bs&&(this.bs=t),ue.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new xc(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,ue.resolve()}updateTargetData(e,t){return this.Dn(t),ue.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,ue.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.Rs.forEach((l,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Rs.delete(l),a.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),ue.waitFor(a).next(()=>i)}getTargetCount(e){return ue.resolve(this.targetCount)}getTargetData(e,t){const r=this.Rs.get(t)||null;return ue.resolve(r)}addMatchingKeys(e,t,r){return this.Ps.us(t,r),ue.resolve()}removeMatchingKeys(e,t,r){this.Ps.hs(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),ue.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),ue.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Ps.ds(t);return ue.resolve(r)}containsKey(e,t){return ue.resolve(this.Ps.containsKey(t))}}class ab{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new Ki(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new gS(this),this.indexManager=new sS,this.remoteDocumentCache=new Zv(r=>this.referenceDelegate.xs(r)),this.It=new Nm(t),this.Ns=new lp(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new fS,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Vs[e.toKey()];return r||(r=new pS(t,this.referenceDelegate),this.Vs[e.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,r){Ue("MemoryPersistence","Starting transaction:",e);const i=new mS(this.Ss.next());return this.referenceDelegate.ks(),r(i).next(a=>this.referenceDelegate.Os(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ms(e,t){return ue.or(Object.values(this.Vs).map(r=>()=>r.containsKey(e,t)))}}class mS extends fm{constructor(e){super(),this.currentSequenceNumber=e}}class Mc{constructor(e){this.persistence=e,this.Fs=new cp,this.$s=null}static Bs(e){return new Mc(e)}get Ls(){if(this.$s)return this.$s;throw ot()}addReference(e,t,r){return this.Fs.addReference(r,t),this.Ls.delete(r.toString()),ue.resolve()}removeReference(e,t,r){return this.Fs.removeReference(r,t),this.Ls.add(r.toString()),ue.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),ue.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(i=>this.Ls.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Ls.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ue.forEach(this.Ls,r=>{const i=Qe.fromPath(r);return this.Us(e,i).next(a=>{a||t.removeEntry(i,Rt.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.Us(e,t).next(r=>{r?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}Us(e,t){return ue.or([()=>ue.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class Vm{constructor(e){this.It=e}$(e,t,r,i){const a=new Ff("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Uv,{unique:!0}),h.createObjectStore("documentMutations"),ub(e),function(h){h.createObjectStore("remoteDocuments")}(e));let l=ue.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),ub(e)),l=l.next(()=>function(h){const g=h.store("targetGlobal"),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Rt.min().toTimestamp(),targetCount:0};return g.put("targetGlobalKey",v)}(a))),r<4&&i>=4&&(0!==r&&(l=l.next(()=>function(h,g){return g.store("mutations").W().next(v=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Uv,{unique:!0});const T=g.store("mutations"),S=v.map(k=>T.put(k));return ue.waitFor(S)})}(e,a))),l=l.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(l=l.next(()=>this.qs(a))),r<6&&i>=6&&(l=l.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(a)))),r<7&&i>=7&&(l=l.next(()=>this.Gs(a))),r<8&&i>=8&&(l=l.next(()=>this.Qs(e,a))),r<9&&i>=9&&(l=l.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(l=l.next(()=>this.js(a))),r<11&&i>=11&&(l=l.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{!function(h){const g=h.createObjectStore("documentOverlays",{keyPath:jI});g.createIndex("collectionPathOverlayIndex",$I,{unique:!1}),g.createIndex("collectionGroupOverlayIndex",XD,{unique:!1})}(e)})),r<13&&i>=13&&(l=l.next(()=>function(h){const g=h.createObjectStore("remoteDocumentsV14",{keyPath:Vv});g.createIndex("documentKeyIndex",HD),g.createIndex("collectionGroupIndex",BI)}(e)).next(()=>this.Ws(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.zs(e,a))),r<15&&i>=15&&(l=l.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:KD}).createIndex("sequenceNumberIndex",ZD,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:YD}).createIndex("documentKeyIndex",QD,{unique:!1})}(e))),l}Ks(e){let t=0;return e.store("remoteDocuments").Z((r,i)=>{t+=qv(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}qs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>ue.forEach(i,a=>{const l=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",l).next(h=>ue.forEach(h,g=>{At(g.userId===a.userId);const v=gl(this.It,g);return QI(e,a.userId,v).next(()=>{})}))}))}Gs(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.Z((l,h)=>{const g=new an(l),v=[0,Xi(g)];a.push(t.get(v).next(T=>T?ue.resolve():t.put({targetId:0,path:Xi(g),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>ue.waitFor(a))})}Qs(e,t){e.createObjectStore("collectionParents",{keyPath:zD});const r=t.store("collectionParents"),i=new rp,a=l=>{if(i.add(l)){const h=l.lastSegment(),g=l.popLast();return r.put({collectionId:h,parent:Xi(g)})}};return t.store("remoteDocuments").Z({X:!0},(l,h)=>{const g=new an(l);return a(g.popLast())}).next(()=>t.store("documentMutations").Z({X:!0},([l,h,g],v)=>{const T=Ho(h);return a(T.popLast())}))}js(e){const t=e.store("targets");return t.Z((r,i)=>{const a=Om(i),l=KI(this.It,a);return t.put(l)})}Ws(e,t){const r=t.store("remoteDocuments"),i=[];return r.Z((a,l)=>{const h=t.store("remoteDocumentsV14"),g=(v=l,v.document?new Qe(an.fromString(v.document.name).popFirst(5)):v.noDocument?Qe.fromSegments(v.noDocument.path):v.unknownDocument?Qe.fromSegments(v.unknownDocument.path):ot()).path.toArray();var v;const T={prefixPath:g.slice(0,g.length-2),collectionGroup:g[g.length-2],documentId:g[g.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(h.put(T))}).next(()=>ue.waitFor(i))}zs(e,t){const r=t.store("mutations"),i=Kv(this.It),a=new ab(Mc.Bs,this.It.re);return r.W().next(l=>{const h=new Map;return l.forEach(g=>{var v;let T=null!==(v=h.get(g.userId))&&void 0!==v?v:Ht();gl(this.It,g).keys().forEach(S=>T=T.add(S)),h.set(g.userId,T)}),ue.forEach(h,(g,v)=>{const T=new Zr(v),S=Lm.oe(this.It,T),k=a.getIndexManager(T),U=sp.oe(T,this.It,k,a.referenceDelegate);return new ob(i,U,S,k).recalculateAndSaveOverlaysForDocumentKeys(new ep(t,Ki.at),g).next()})})}}function ub(n){n.createObjectStore("targetDocuments",{keyPath:WD}).createIndex("documentTargetsIndex",qD,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",GD,{unique:!0}),n.createObjectStore("targetGlobal")}const Yv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Bm{constructor(e,t,r,i,a,l,h,g,v,T,S=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Hs=a,this.window=l,this.document=h,this.Js=v,this.Ys=T,this.Xs=S,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=k=>Promise.resolve(),!Bm.C())throw new Oe(fe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new op(this,i),this.ii=t+"main",this.It=new Nm(g),this.ri=new Ls(this.ii,this.Xs,new Vm(this.It)),this.Cs=new uS(this.referenceDelegate,this.It),this.remoteDocumentCache=Kv(this.It),this.Ns=new tS,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===T&&Ar("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Oe(fe.FAILED_PRECONDITION,Yv);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new Ki(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){var t=this;return this.si=function(){var r=(0,me.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(function(){var t=(0,me.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget((0,me.Z)(function*(){t.started&&(yield t.ui())})))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>yh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(t=>this.isPrimary&&!t?this._i(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Fo(e))return Ue("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ue("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return _h(e).get("owner").next(t=>ue.resolve(this.mi(t)))}gi(e){return yh(e).delete(this.clientId)}yi(){var e=this;return(0,me.Z)(function*(){if(e.isPrimary&&!e.pi(e.ni,18e5)){e.ni=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Ur(r,"clientMetadata");return i.W().next(a=>{const l=e.Ii(a,18e5),h=a.filter(g=>-1===l.indexOf(g));return ue.forEach(h,g=>i.delete(g.clientId)).next(()=>h)})}).catch(()=>[]);if(e.oi)for(const r of t)e.oi.removeItem(e.Ti(r.clientId))}})()}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?ue.resolve(!0):_h(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)){if(this.mi(t)&&this.networkEnabled)return!0;if(!this.mi(t)){if(!t.allowTabSynchronization)throw new Oe(fe.FAILED_PRECONDITION,Yv);return!1}}return!(!this.networkEnabled||!this.inForeground)||yh(e).W().next(r=>void 0===this.Ii(r,5e3).find(i=>{if(this.clientId!==i.clientId){const l=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||l&&h)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&Ue("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,me.Z)(function*(){e.Ds=!1,e.Ai(),e.ei&&(e.ei.cancel(),e.ei=null),e.Ri(),e.bi(),yield e.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new ep(t,Ki.at);return e._i(r).next(()=>e.gi(r))}),e.ri.close(),e.Pi()})()}Ii(e,t){return e.filter(r=>this.pi(r.updateTimeMs,t)&&!this.Ei(r.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>yh(e).W().next(t=>this.Ii(t,18e5).map(r=>r.clientId)))}get started(){return this.Ds}getMutationQueue(e,t){return sp.oe(e,this.It,t,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new yR(e,this.It.re.databaseId)}getDocumentOverlayCache(e){return Lm.oe(this.It,e)}getBundleCache(){return this.Ns}runTransaction(e,t,r){Ue("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(l=this.Xs)?JD:14===l?qI:13===l?WI:12===l?GI:11===l?HI:void ot();var l;let h;return this.ri.runTransaction(e,i,a,g=>(h=new ep(g,this.Ss?this.Ss.next():Ki.at),"readwrite-primary"===t?this.fi(h).next(v=>!!v||this.di(h)).next(v=>{if(!v)throw Ar(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new Oe(fe.FAILED_PRECONDITION,gD);return r(h)}).next(v=>this.wi(h).next(()=>v)):this.Vi(h).next(()=>r(h)))).then(g=>(h.raiseOnCommittedEvent(),g))}Vi(e){return _h(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)&&!this.mi(t)&&!(this.Ys||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Oe(fe.FAILED_PRECONDITION,Yv)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return _h(e).put("owner",t)}static C(){return Ls.C()}_i(e){const t=_h(e);return t.get("owner").next(r=>this.mi(r)?(Ue("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):ue.resolve())}pi(e,t){const r=Date.now();return!(e<r-t||e>r&&(Ar(`Detected an update time that is in the future: ${e} > ${r}`),1))}ci(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ai(),(0,L.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var t;try{const r=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return Ue("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ar("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){Ar("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(e){}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function _h(n){return Ur(n,"owner")}function yh(n){return Ur(n,"clientMetadata")}function jm(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Qv{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Si=r,this.Di=i}static Ci(e,t){let r=Ht(),i=Ht();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Qv(e,t.fromCache,r,i)}}class lb{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.ki(e,t).next(a=>a||this.Oi(e,t,i,r)).next(a=>a||this.Mi(e,t))}ki(e,t){if(yv(t))return ue.resolve(null);let r=Yi(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Tm(t,null,"F"),r=Yi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const l=Ht(...a);return this.Ni.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,r).next(g=>{const v=this.Fi(t,h);return this.$i(t,v,l,g.readTime)?this.ki(e,Tm(t,null,"F")):this.Bi(e,v,t,g)}))})))}Oi(e,t,r,i){return yv(t)||i.isEqual(Rt.min())?this.Mi(e,t):this.Ni.getDocuments(e,r).next(a=>{const l=this.Fi(t,a);return this.$i(t,l,r,i)?this.Mi(e,t):(dm()<=ko.in.DEBUG&&Ue("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),vv(t)),this.Bi(e,l,t,uI(i,-1)))})}Fi(e,t){let r=new Pn(vI(e));return t.forEach((i,a)=>{wv(e,a)&&(r=r.add(a))}),r}$i(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Mi(e,t){return dm()<=ko.in.DEBUG&&Ue("QueryEngine","Using full collection scan to execute query:",vv(t)),this.Ni.getDocumentsMatchingQuery(e,t,ms.min())}Bi(e,t,r,i){return this.Ni.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}class vR{constructor(e,t,r,i){this.persistence=e,this.Li=t,this.It=i,this.Ui=new dr(Nt),this.qi=new kn(a=>vi(a),rh),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(r)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ob(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ui))}}function $m(n,e,t,r){return new vR(n,e,t,r)}function Hm(n,e){return Gm.apply(this,arguments)}function Gm(){return Gm=(0,me.Z)(function*(n,e){const t=Je(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.Qi(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const l=[],h=[];let g=Ht();for(const v of i){l.push(v.batchId);for(const T of v.mutations)g=g.add(T.key)}for(const v of a){h.push(v.batchId);for(const T of v.mutations)g=g.add(T.key)}return t.localDocuments.getDocuments(r,g).next(v=>({ji:v,removedBatchIds:l,addedBatchIds:h}))})})}),Gm.apply(this,arguments)}function Xv(n,e){const t=Je(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Gi.newChangeBuffer({trackRemovals:!0});return function(l,h,g,v){const T=g.batch,S=T.keys();let k=ue.resolve();return S.forEach(U=>{k=k.next(()=>v.getEntry(h,U)).next(K=>{const he=g.docVersions.get(U);At(null!==he),K.version.compareTo(he)<0&&(T.applyToRemoteDocument(K,g),K.isValidDocument()&&(K.setReadTime(g.commitVersion),v.addEntry(K)))})}),k.next(()=>l.mutationQueue.removeMutationBatch(h,T))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=Ht();for(let g=0;g<l.mutationResults.length;++g)l.mutationResults[g].transformResults.length>0&&(h=h.add(l.batch.mutations[g].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Wm(n){const e=Je(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function _S(n,e){const t=Je(n),r=e.snapshotVersion;let i=t.Ui;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Gi.newChangeBuffer({trackRemovals:!0});i=t.Ui;const h=[];e.targetChanges.forEach((T,S)=>{const k=i.get(S);if(!k)return;h.push(t.Cs.removeMatchingKeys(a,T.removedDocuments,S).next(()=>t.Cs.addMatchingKeys(a,T.addedDocuments,S)));let U=k.withSequenceNumber(a.currentSequenceNumber);var K,he,be;e.targetMismatches.has(S)?U=U.withResumeToken(Yr.EMPTY_BYTE_STRING,Rt.min()).withLastLimboFreeSnapshotVersion(Rt.min()):T.resumeToken.approximateByteSize()>0&&(U=U.withResumeToken(T.resumeToken,r)),i=i.insert(S,U),he=U,be=T,(0===(K=k).resumeToken.approximateByteSize()||he.snapshotVersion.toMicroseconds()-K.snapshotVersion.toMicroseconds()>=3e8||be.addedDocuments.size+be.modifiedDocuments.size+be.removedDocuments.size>0)&&h.push(t.Cs.updateTargetData(a,U))});let g=Qi(),v=Ht();if(e.documentUpdates.forEach(T=>{e.resolvedLimboDocuments.has(T)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(a,T))}),h.push(cb(a,l,e.documentUpdates).next(T=>{g=T.Wi,v=T.zi})),!r.isEqual(Rt.min())){const T=t.Cs.getLastRemoteSnapshotVersion(a).next(S=>t.Cs.setTargetsMetadata(a,a.currentSequenceNumber,r));h.push(T)}return ue.waitFor(h).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,g,v)).next(()=>g)}).then(a=>(t.Ui=i,a))}function cb(n,e,t){let r=Ht(),i=Ht();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let l=Qi();return t.forEach((h,g)=>{const v=a.get(h);g.isFoundDocument()!==v.isFoundDocument()&&(i=i.add(h)),g.isNoDocument()&&g.version.isEqual(Rt.min())?(e.removeEntry(h,g.readTime),l=l.insert(h,g)):!v.isValidDocument()||g.version.compareTo(v.version)>0||0===g.version.compareTo(v.version)&&v.hasPendingWrites?(e.addEntry(g),l=l.insert(h,g)):Ue("LocalStore","Ignoring outdated watch update for ",h,". Current version:",v.version," Watch version:",g.version)}),{Wi:l,zi:i}})}function yS(n,e){const t=Je(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function vh(n,e){const t=Je(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Cs.getTargetData(r,e).next(a=>a?(i=a,ue.resolve(i)):t.Cs.allocateTargetId(r).next(l=>(i=new fl(e,l,0,r.currentSequenceNumber),t.Cs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ui.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ui=t.Ui.insert(r.targetId,r),t.qi.set(e,r.targetId)),r})}function kc(n,e,t){return hp.apply(this,arguments)}function hp(){return hp=(0,me.Z)(function*(n,e,t){const r=Je(n),i=r.Ui.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Fo(l))throw l;Ue("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ui=r.Ui.remove(e),r.qi.delete(i.target)}),hp.apply(this,arguments)}function fp(n,e,t){const r=Je(n);let i=Rt.min(),a=Ht();return r.persistence.runTransaction("Execute query","readonly",l=>function(h,g,v){const T=Je(h),S=T.qi.get(v);return void 0!==S?ue.resolve(T.Ui.get(S)):T.Cs.getTargetData(g,v)}(r,l,Yi(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(l,h.targetId).next(g=>{a=g})}).next(()=>r.Li.getDocumentsMatchingQuery(l,e,t?i:Rt.min(),t?a:Ht())).next(h=>(e0(r,yI(e),h),{documents:h,Hi:a})))}function db(n,e){const t=Je(n),r=Je(t.Cs),i=t.Ui.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.se(a,e).next(l=>l?l.target:null))}function Jv(n,e){const t=Je(n),r=t.Ki.get(e)||Rt.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Gi.getAllFromCollectionGroup(i,e,uI(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(e0(t,e,i),i))}function e0(n,e,t){let r=n.Ki.get(e)||Rt.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Ki.set(e,r)}function qm(){return qm=(0,me.Z)(function*(n,e,t,r){const i=Je(n);let a=Ht(),l=Qi();for(const v of t){const T=e.Ji(v.metadata.name);v.document&&(a=a.add(T));const S=e.Yi(v);S.setReadTime(e.Xi(v.metadata.readTime)),l=l.insert(T,S)}const h=i.Gi.newChangeBuffer({trackRemovals:!0}),g=yield vh(i,(v=r,Yi(yc(an.fromString(`__bundle__/docs/${v}`)))));var v;return i.persistence.runTransaction("Apply bundle documents","readwrite",v=>cb(v,h,l).next(T=>(h.apply(v),T)).next(T=>i.Cs.removeMatchingKeysForTargetId(v,g.targetId).next(()=>i.Cs.addMatchingKeys(v,a,g.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(v,T.Wi,T.zi)).next(()=>T.Wi)))}),qm.apply(this,arguments)}function hb(n,e){return t0.apply(this,arguments)}function t0(){return t0=(0,me.Z)(function*(n,e,t=Ht()){const r=yield vh(n,Yi(fh(e.bundledQuery))),i=Je(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const l=oi(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Ns.saveNamedQuery(a,e);const h=r.withResumeToken(Yr.EMPTY_BYTE_STRING,l);return i.Ui=i.Ui.insert(h.targetId,h),i.Cs.updateTargetData(a,h).next(()=>i.Cs.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Cs.addMatchingKeys(a,t,r.targetId)).next(()=>i.Ns.saveNamedQuery(a,e))})}),t0.apply(this,arguments)}function n0(n,e){return`firestore_clients_${n}_${e}`}function fb(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Ei(n,e){return`firestore_targets_${n}_${e}`}class du{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Zi(e,t,r){const i=JSON.parse(r);let a,l="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return l&&i.error&&(l="string"==typeof i.error.message&&"string"==typeof i.error.code,l&&(a=new Oe(i.error.code,i.error.message))),l?new du(e,t,i.state,a):(Ar("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pp{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Zi(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new Oe(r.error.code,r.error.message))),a?new pp(e,r.state,i):(Ar("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Zi(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=Am();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=uv(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return i?new zm(e,a):(Ar("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class pb{constructor(e,t){this.clientId=e,this.onlineState=t}static Zi(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new pb(t.clientId,t.onlineState):(Ar("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Nc{constructor(){this.activeTargetIds=Am()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class r0{constructor(e,t,r,i,a){this.window=e,this.Hs=t,this.persistenceKey=r,this.sr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new dr(Nt),this.started=!1,this.cr=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ar=n0(this.persistenceKey,this.sr),this.hr=`firestore_sequence_number_${this.persistenceKey}`,this.ur=this.ur.insert(this.sr,new Nc),this.lr=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this.mr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,me.Z)(function*(){const t=yield e.syncEngine.vi();for(const i of t){if(i===e.sr)continue;const a=e.getItem(n0(e.persistenceKey,i));if(a){const l=zm.Zi(i,a);l&&(e.ur=e.ur.insert(l.clientId,l))}}e.gr();const r=e.storage.getItem(e.wr);if(r){const i=e.yr(r);i&&e.pr(i)}for(const i of e.cr)e.rr(i);e.cr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.hr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(e){let t=!1;return this.ur.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Tr(e,"pending")}updateMutationState(e,t,r){this.Tr(e,t,r),this.Er(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Ei(this.persistenceKey,e));if(r){const i=pp.Zi(e,r);i&&(t=i.state)}}return this.Ar.er(e),this.gr(),t}removeLocalQueryTarget(e){this.Ar.nr(e),this.gr()}isLocalQueryTarget(e){return this.Ar.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ei(this.persistenceKey,e))}updateQueryState(e,t,r){this.Rr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Er(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.br(e)}notifyBundleLoaded(e){this.Pr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ue("SharedClientState","READ",e,t),t}setItem(e,t){Ue("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ue("SharedClientState","REMOVE",e),this.storage.removeItem(e)}rr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(Ue("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ar)return void Ar("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,me.Z)(function*(){if(t.started){if(null!==r.key)if(t.lr.test(r.key)){if(null==r.newValue){const i=t.vr(r.key);return t.Vr(i,null)}{const i=t.Sr(r.key,r.newValue);if(i)return t.Vr(i.clientId,i)}}else if(t.dr.test(r.key)){if(null!==r.newValue){const i=t.Dr(r.key,r.newValue);if(i)return t.Cr(i)}}else if(t._r.test(r.key)){if(null!==r.newValue){const i=t.Nr(r.key,r.newValue);if(i)return t.kr(i)}}else if(r.key===t.wr){if(null!==r.newValue){const i=t.yr(r.newValue);if(i)return t.pr(i)}}else if(r.key===t.hr){const i=function(a){let l=Ki.at;if(null!=a)try{const h=JSON.parse(a);At("number"==typeof h),l=h}catch(h){Ar("SharedClientState","Failed to read sequence number from WebStorage",h)}return l}(r.newValue);i!==Ki.at&&t.sequenceNumberHandler(i)}else if(r.key===t.mr){const i=t.Or(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Mr(a)))}}else t.cr.push(r)}))}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(e,t,r){const i=new du(this.currentUser,e,t,r),a=fb(this.persistenceKey,this.currentUser,e);this.setItem(a,i.tr())}Er(e){const t=fb(this.persistenceKey,this.currentUser,e);this.removeItem(t)}br(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.sr,onlineState:e}))}Rr(e,t,r){const i=Ei(this.persistenceKey,e),a=new pp(e,t,r);this.setItem(i,a.tr())}Pr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}vr(e){const t=this.lr.exec(e);return t?t[1]:null}Sr(e,t){const r=this.vr(e);return zm.Zi(r,t)}Dr(e,t){const r=this.dr.exec(e),i=Number(r[1]);return du.Zi(new Zr(void 0!==r[2]?r[2]:null),i,t)}Nr(e,t){const r=this._r.exec(e),i=Number(r[1]);return pp.Zi(i,t)}yr(e){return pb.Zi(e)}Or(e){return JSON.parse(e)}Cr(e){var t=this;return(0,me.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Fr(e.batchId,e.state,e.error);Ue("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}kr(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}Vr(e,t){const r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),l=[],h=[];return a.forEach(g=>{i.has(g)||l.push(g)}),i.forEach(g=>{a.has(g)||h.push(g)}),this.syncEngine.Br(l,h).then(()=>{this.ur=r})}pr(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ir(e){let t=Am();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class Km{constructor(){this.Lr=new Nc,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,t,r){this.Ur[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new Nc,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class wS{qr(e){}shutdown(){}}class s0{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){Ue("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){Ue("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const ES={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class IS{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class o0 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.oo=(e.ssl?"https":"http")+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,r,i,a){const l=this.ho(e,t);Ue("RestConnection","Sending: ",l,r);const h={};return this.lo(h,i,a),this.fo(e,l,h,r).then(g=>(Ue("RestConnection","Received: ",g),g),g=>{throw al("RestConnection",`${e} failed with error: `,g,"url: ",l,"request:",r),g})}_o(e,t,r,i,a,l){return this.ao(e,t,r,i,a)}lo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+dc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}ho(e,t){return`${this.oo}/v1/${t}:${ES[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,r,i){return new Promise((a,l)=>{const h=new tI;h.setWithCredentials(!0),h.listenOnce(qd.COMPLETE,()=>{var v;try{switch(h.getLastErrorCode()){case ol.NO_ERROR:const T=h.getResponseJson();Ue("Connection","XHR received:",JSON.stringify(T)),a(T);break;case ol.TIMEOUT:Ue("Connection",'RPC "'+e+'" timed out'),l(new Oe(fe.DEADLINE_EXCEEDED,"Request time out"));break;case ol.HTTP_ERROR:const S=h.getStatus();if(Ue("Connection",'RPC "'+e+'" failed with status:',S,"response text:",h.getResponseText()),S>0){let k=h.getResponseJson();Array.isArray(k)&&(k=k[0]);const U=null===(v=k)||void 0===v?void 0:v.error;if(U&&U.status&&U.message){const K=function(he){const be=he.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(be)>=0?be:fe.UNKNOWN}(U.status);l(new Oe(K,U.message))}else l(new Oe(fe.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new Oe(fe.UNAVAILABLE,"Connection failed."));break;default:ot()}}finally{Ue("Connection",'RPC "'+e+'" completed.')}});const g=JSON.stringify(i);h.send(t,"POST",g,r,15)})}wo(e,t,r){const i=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Gd(),l=Wd(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new Kd({})),this.lo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const g=i.join("");Ue("Connection","Creating WebChannel: "+g,h);const v=a.createWebChannel(g,h);let T=!1,S=!1;const k=new IS({Hr:K=>{S?Ue("Connection","Not sending because WebChannel is closed:",K):(T||(Ue("Connection","Opening WebChannel transport."),v.open(),T=!0),Ue("Connection","WebChannel sending:",K),v.send(K))},Jr:()=>v.close()}),U=(K,he,be)=>{K.listen(he,lt=>{try{be(lt)}catch(ft){setTimeout(()=>{throw ft},0)}})};return U(v,Nf.EventType.OPEN,()=>{S||Ue("Connection","WebChannel transport opened.")}),U(v,Nf.EventType.CLOSE,()=>{S||(S=!0,Ue("Connection","WebChannel transport closed"),k.io())}),U(v,Nf.EventType.ERROR,K=>{S||(S=!0,al("Connection","WebChannel transport errored:",K),k.io(new Oe(fe.UNAVAILABLE,"The operation could not be completed")))}),U(v,Nf.EventType.MESSAGE,K=>{var he;if(!S){const be=K.data[0];At(!!be);const lt=be,ft=lt.error||(null===(he=lt[0])||void 0===he?void 0:he.error);if(ft){Ue("Connection","WebChannel received error:",ft);const ct=ft.status;let ht=function(Lt){const Mr=hr[Lt];if(void 0!==Mr)return zf(Mr)}(ct),xt=ft.message;void 0===ht&&(ht=fe.INTERNAL,xt="Unknown error status: "+ct+" with message "+ft.message),S=!0,k.io(new Oe(ht,xt)),v.close()}else Ue("Connection","WebChannel received:",be),k.ro(be)}}),U(l,zd.STAT_EVENT,K=>{K.stat===cc.PROXY?Ue("Connection","Detected buffering proxy"):K.stat===cc.NOPROXY&&Ue("Connection","Detected no buffering proxy")}),setTimeout(()=>{k.so()},0),k}}function a0(){return"undefined"!=typeof window?window:null}function gp(){return"undefined"!=typeof document?document:null}function vl(n){return new OD(n,!0)}class mp{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Hs=e,this.timerId=t,this.mo=r,this.yo=i,this.po=a,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,t-r);i>0&&Ue("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class bS{constructor(e,t,r,i,a,l,h,g){this.Hs=e,this.vo=r,this.Vo=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=g,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new mp(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var e=this;return(0,me.Z)(function*(){e.No()&&(yield e.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}$o(){var e=this;return(0,me.Z)(function*(){if(e.ko())return e.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(e,t){var r=this;return(0,me.Z)(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==e?r.xo.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(Ar(t.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):t&&t.code===fe.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Zr(t)})()}qo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.So===t&&this.Go(r,i)},r=>{e(()=>{const i=new Oe(fe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(i)})})}Go(e,t){const r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(i=>{r(()=>this.Qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Oo(){var e=this;this.state=5,this.xo.Ro((0,me.Z)(function*(){e.state=0,e.start()}))}Qo(e){return Ue("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget(()=>this.So===e?t():(Ue("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gb extends bS{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.It=a}jo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.xo.reset();const t=function kI(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(g=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===g?1:"REMOVE"===g?2:"CURRENT"===g?3:"RESET"===g?4:ot(),i=e.targetChange.targetIds||[],a=function(g,v){return g.gt?(At(void 0===v||"string"==typeof v),Yr.fromBase64String(v||"")):(At(void 0===v||v instanceof Uint8Array),Yr.fromUint8Array(v||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(g){const v=void 0===g.code?fe.UNKNOWN:zf(g.code);return new Oe(v,g.message||"")}(l);t=new Rv(r,i,a,h||null)}else if("documentChange"in e){const r=e.documentChange,i=ou(n,r.document.name),a=oi(r.document.updateTime),l=new si({mapValue:{fields:r.document.fields}}),h=$n.newFoundDocument(i,a,l);t=new Ic(r.targetIds||[],r.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){const r=e.documentDelete,i=ou(n,r.document),a=r.readTime?oi(r.readTime):Rt.min(),l=$n.newNoDocument(i,a);t=new Ic([],r.removedTargetIds||[],l.key,l)}else if("documentRemove"in e){const r=e.documentRemove,i=ou(n,r.document);t=new Ic([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return ot();{const r=e.filter,a=new xD(r.count||0);t=new xv(r.targetId,a)}}var g;return t}(this.It,e),r=function(i){if(!("targetChange"in i))return Rt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Rt.min():a.readTime?oi(a.readTime):Rt.min()}(e);return this.listener.Wo(t,r)}zo(e){const t={};t.database=Rm(this.It),t.addTarget=function(i,a){let l;const h=a.target;return l=jf(h)?{documents:NI(i,h)}:{query:Ov(i,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?l.resumeToken=kv(i,a.resumeToken):a.snapshotVersion.compareTo(Rt.min())>0&&(l.readTime=ch(i,a.snapshotVersion.toTimestamp())),l}(this.It,e);const r=function OI(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ot()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Bo(t)}Ho(e){const t={};t.database=Rm(this.It),t.removeTarget=e,this.Bo(t)}}class CS extends bS{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.It=a,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(At(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function UD(n,e){return n&&n.length>0?(At(void 0!==e),n.map(t=>function(r,i){let a=oi(r.updateTime?r.updateTime:i);return a.isEqual(Rt.min())&&(a=oi(i)),new TI(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=oi(e.commitTime);return this.listener.Zo(r,t)}return At(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=Rm(this.It),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>au(this.It,r))};this.Bo(t)}}class mb extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.It=i,this.nu=!1}su(){if(this.nu)throw new Oe(fe.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.ao(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Oe(fe.UNKNOWN,i.toString())})}_o(e,t,r,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection._o(e,t,r,a,l,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Oe(fe.UNKNOWN,a.toString())})}terminate(){this.nu=!0}}class TS{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Ar(t),this.ou=!1):Ue("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class u0{constructor(e,t,r,i,a){var l=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=a,this.mu.qr(h=>{r.enqueueAndForget((0,me.Z)(function*(){var g;hu(l)&&(Ue("RemoteStore","Restarting streams for network reachability change."),yield(g=(0,me.Z)(function*(v){const T=Je(v);T._u.add(4),yield wh(T),T.gu.set("Unknown"),T._u.delete(4),yield Pc(T)}),function(v){return g.apply(this,arguments)})(l))}))}),this.gu=new TS(r,i)}}function Pc(n){return _b.apply(this,arguments)}function _b(){return _b=(0,me.Z)(function*(n){if(hu(n))for(const e of n.wu)yield e(!0)}),_b.apply(this,arguments)}function wh(n){return l0.apply(this,arguments)}function l0(){return l0=(0,me.Z)(function*(n){for(const e of n.wu)yield e(!1)}),l0.apply(this,arguments)}function _p(n,e){const t=Je(n);t.du.has(e.targetId)||(t.du.set(e.targetId,e),h0(t)?Qm(t):Oc(t).ko()&&c0(t,e))}function Eh(n,e){const t=Je(n),r=Oc(t);t.du.delete(e),r.ko()&&d0(t,e),0===t.du.size&&(r.ko()?r.Fo():hu(t)&&t.gu.set("Unknown"))}function c0(n,e){n.yu.Mt(e.targetId),Oc(n).zo(e)}function d0(n,e){n.yu.Mt(e),Oc(n).Ho(e)}function Qm(n){n.yu=new kD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),se:e=>n.du.get(e)||null}),Oc(n).start(),n.gu.uu()}function h0(n){return hu(n)&&!Oc(n).No()&&n.du.size>0}function hu(n){return 0===Je(n)._u.size}function f0(n){n.yu=void 0}function DS(n){return Xm.apply(this,arguments)}function Xm(){return Xm=(0,me.Z)(function*(n){n.du.forEach((e,t)=>{c0(n,e)})}),Xm.apply(this,arguments)}function yb(n,e){return Jm.apply(this,arguments)}function Jm(){return Jm=(0,me.Z)(function*(n,e){f0(n),h0(n)?(n.gu.hu(e),Qm(n)):n.gu.set("Unknown")}),Jm.apply(this,arguments)}function vb(n,e,t){return p0.apply(this,arguments)}function p0(){return p0=(0,me.Z)(function*(n,e,t){if(n.gu.set("Online"),e instanceof Rv&&2===e.state&&e.cause)try{yield(r=(0,me.Z)(function*(i,a){const l=a.cause;for(const h of a.targetIds)i.du.has(h)&&(yield i.remoteSyncer.rejectListen(h,l),i.du.delete(h),i.yu.removeTarget(h))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){Ue("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield e_(n,r)}else if(e instanceof Ic?n.yu.Gt(e):e instanceof xv?n.yu.Yt(e):n.yu.Wt(e),!t.isEqual(Rt.min()))try{const r=yield Wm(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const l=i.yu.te(a);return l.targetChanges.forEach((h,g)=>{if(h.resumeToken.approximateByteSize()>0){const v=i.du.get(g);v&&i.du.set(g,v.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach(h=>{const g=i.du.get(h);if(!g)return;i.du.set(h,g.withResumeToken(Yr.EMPTY_BYTE_STRING,g.snapshotVersion)),d0(i,h);const v=new fl(g.target,h,1,g.sequenceNumber);c0(i,v)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){Ue("RemoteStore","Failed to raise snapshot:",r),yield e_(n,r)}var r}),p0.apply(this,arguments)}function e_(n,e,t){return wb.apply(this,arguments)}function wb(){return wb=(0,me.Z)(function*(n,e,t){if(!Fo(e))throw e;n._u.add(1),yield wh(n),n.gu.set("Offline"),t||(t=()=>Wm(n.localStore)),n.asyncQueue.enqueueRetryable((0,me.Z)(function*(){Ue("RemoteStore","Retrying IndexedDB access"),yield t(),n._u.delete(1),yield Pc(n)}))}),wb.apply(this,arguments)}function g0(n,e){return e().catch(t=>e_(n,t,e))}function yp(n){return Eb.apply(this,arguments)}function Eb(){return Eb=(0,me.Z)(function*(n){const e=Je(n),t=Lc(e);let r=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;wR(e);)try{const i=yield yS(e.localStore,r);if(null===i){0===e.fu.length&&t.Fo();break}r=i.batchId,ER(e,i)}catch(i){yield e_(e,i)}SS(e)&&AS(e)}),Eb.apply(this,arguments)}function wR(n){return hu(n)&&n.fu.length<10}function ER(n,e){n.fu.push(e);const t=Lc(n);t.ko()&&t.Yo&&t.Xo(e.mutations)}function SS(n){return hu(n)&&!Lc(n).No()&&n.fu.length>0}function AS(n){Lc(n).start()}function IR(n){return Ib.apply(this,arguments)}function Ib(){return Ib=(0,me.Z)(function*(n){Lc(n).eu()}),Ib.apply(this,arguments)}function t_(n){return bb.apply(this,arguments)}function bb(){return bb=(0,me.Z)(function*(n){const e=Lc(n);for(const t of n.fu)e.Xo(t.mutations)}),bb.apply(this,arguments)}function Cb(n,e,t){return vp.apply(this,arguments)}function vp(){return vp=(0,me.Z)(function*(n,e,t){const r=n.fu.shift(),i=tp.from(r,e,t);yield g0(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield yp(n)}),vp.apply(this,arguments)}function Tb(n,e){return n_.apply(this,arguments)}function n_(){return n_=(0,me.Z)(function*(n,e){var t;e&&Lc(n).Yo&&(yield(t=(0,me.Z)(function*(r,i){if(qf(a=i.code)&&a!==fe.ABORTED){const l=r.fu.shift();Lc(r).Mo(),yield g0(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,i)),yield yp(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),SS(n)&&AS(n)}),n_.apply(this,arguments)}function xS(n,e){return wp.apply(this,arguments)}function wp(){return wp=(0,me.Z)(function*(n,e){const t=Je(n);t.asyncQueue.verifyOperationInProgress(),Ue("RemoteStore","RemoteStore received new credentials");const r=hu(t);t._u.add(3),yield wh(t),r&&t.gu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t._u.delete(3),yield Pc(t)}),wp.apply(this,arguments)}function r_(n,e){return m0.apply(this,arguments)}function m0(){return m0=(0,me.Z)(function*(n,e){const t=Je(n);e?(t._u.delete(2),yield Pc(t)):e||(t._u.add(2),yield wh(t),t.gu.set("Unknown"))}),m0.apply(this,arguments)}function Oc(n){return n.pu||(n.pu=function(e,t,r){const i=Je(e);return i.su(),new gb(t,i.connection,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:DS.bind(null,n),Zr:yb.bind(null,n),Wo:vb.bind(null,n)}),n.wu.push(function(){var e=(0,me.Z)(function*(t){t?(n.pu.Mo(),h0(n)?Qm(n):n.gu.set("Unknown")):(yield n.pu.stop(),f0(n))});return function(t){return e.apply(this,arguments)}}())),n.pu}function Lc(n){return n.Iu||(n.Iu=function(e,t,r){const i=Je(e);return i.su(),new CS(t,i.connection,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:IR.bind(null,n),Zr:Tb.bind(null,n),tu:t_.bind(null,n),Zo:Cb.bind(null,n)}),n.wu.push(function(){var e=(0,me.Z)(function*(t){t?(n.Iu.Mo(),yield yp(n)):(yield n.Iu.stop(),n.fu.length>0&&(Ue("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Iu}class _0{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Fr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,h=new _0(e,t,l,i,a);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Oe(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ih(n,e){if(Ar("AsyncQueue",`${e}: ${n}`),Fo(n))return new Oe(fe.UNAVAILABLE,`${e}: ${n}`);throw n}class wl{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Qe.comparator(t.key,r.key):(t,r)=>Qe.comparator(t.key,r.key),this.keyedMap=Kf(),this.sortedSet=new dr(this.comparator)}static emptySet(e){return new wl(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof wl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new wl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Db{constructor(){this.Tu=new dr(Qe.comparator)}track(e){const t=e.doc.key,r=this.Tu.get(t);r?0!==e.type&&3===r.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==r.type?this.Tu=this.Tu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Tu=this.Tu.remove(t):1===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):ot():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ep{constructor(e,t,r,i,a,l,h,g,v){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=g,this.hasCachedResults=v}static fromInitialDocuments(e,t,r,i,a){const l=[];return t.forEach(h=>{l.push({type:0,doc:h})}),new Ep(e,t,wl.emptySet(t),l,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class bR{constructor(){this.Au=void 0,this.listeners=[]}}class CR{constructor(){this.queries=new kn(e=>_I(e),Hf),this.onlineState="Unknown",this.Ru=new Set}}function y0(n,e){return v0.apply(this,arguments)}function v0(){return v0=(0,me.Z)(function*(n,e){const t=Je(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new bR),i)try{a.Au=yield t.onListen(r)}catch(l){const h=Ih(l,`Initialization of query '${vv(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,a),a.listeners.push(e),e.bu(t.onlineState),a.Au&&e.Pu(a.Au)&&I0(t)}),v0.apply(this,arguments)}function w0(n,e){return Sb.apply(this,arguments)}function Sb(){return Sb=(0,me.Z)(function*(n,e){const t=Je(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const l=a.listeners.indexOf(e);l>=0&&(a.listeners.splice(l,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),Sb.apply(this,arguments)}function RS(n,e){const t=Je(n);let r=!1;for(const i of e){const l=t.queries.get(i.query);if(l){for(const h of l.listeners)h.Pu(i)&&(r=!0);l.Au=i}}r&&I0(t)}function E0(n,e,t){const r=Je(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function I0(n){n.Ru.forEach(e=>{e.next()})}class Fs{constructor(e,t,r){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Ep(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){return!e.fromCache||(!this.options.Nu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Du(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(e){e=Ep.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}class MS{constructor(e,t){this.ku=e,this.byteLength=t}Ou(){return"metadata"in this.ku}}class i_{constructor(e){this.It=e}Ji(e){return ou(this.It,e)}Yi(e){return e.metadata.exists?MI(this.It,e.document,!1):$n.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}Xi(e){return oi(e)}}class kS{constructor(e,t,r){this.Mu=e,this.localStore=t,this.It=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Ab(e)}Fu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ku.namedQuery)this.queries.push(e.ku.namedQuery);else if(e.ku.documentMetadata){this.documents.push({metadata:e.ku.documentMetadata}),e.ku.documentMetadata.exists||++t;const r=an.fromString(e.ku.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ku.document&&(this.documents[this.documents.length-1].document=e.ku.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}$u(e){const t=new Map,r=new i_(this.It);for(const i of e)if(i.metadata.queries){const a=r.Ji(i.metadata.name);for(const l of i.metadata.queries){const h=(t.get(l)||Ht()).add(a);t.set(l,h)}}return t}complete(){var e=this;return(0,me.Z)(function*(){const t=yield function vS(n,e,t,r){return qm.apply(this,arguments)}(e.localStore,new i_(e.It),e.documents,e.Mu.id),r=e.$u(e.documents);for(const i of e.queries)yield hb(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Bu:e.collectionGroups,Lu:t}})()}}function Ab(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class s_{constructor(e){this.key=e}}class b0{constructor(e){this.key=e}}class C0{constructor(e,t){this.query=e,this.Uu=t,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Ht(),this.mutatedKeys=Ht(),this.Gu=vI(e),this.Qu=new wl(this.Gu)}get ju(){return this.Uu}Wu(e,t){const r=t?t.zu:new Db,i=t?t.Qu:this.Qu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,h=!1;const g="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,v="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((T,S)=>{const k=i.get(T),U=wv(this.query,S)?S:null,K=!!k&&this.mutatedKeys.has(k.key),he=!!U&&(U.hasLocalMutations||this.mutatedKeys.has(U.key)&&U.hasCommittedMutations);let be=!1;k&&U?k.data.isEqual(U.data)?K!==he&&(r.track({type:3,doc:U}),be=!0):this.Hu(k,U)||(r.track({type:2,doc:U}),be=!0,(g&&this.Gu(U,g)>0||v&&this.Gu(U,v)<0)&&(h=!0)):!k&&U?(r.track({type:0,doc:U}),be=!0):k&&!U&&(r.track({type:1,doc:k}),be=!0,(g||v)&&(h=!0)),be&&(U?(l=l.add(U),a=he?a.add(T):a.delete(T)):(l=l.delete(T),a=a.delete(T)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const T="F"===this.query.limitType?l.last():l.first();l=l.delete(T.key),a=a.delete(T.key),r.track({type:1,doc:T})}return{Qu:l,zu:r,$i:h,mutatedKeys:a}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const a=e.zu.Eu();a.sort((v,T)=>function(S,k){const U=K=>{switch(K){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ot()}};return U(S)-U(k)}(v.type,T.type)||this.Gu(v.doc,T.doc)),this.Ju(r);const l=t?this.Yu():[],h=0===this.Ku.size&&this.current?1:0,g=h!==this.qu;return this.qu=h,0!==a.length||g?{snapshot:new Ep(this.query,e.Qu,i,a,e.mutatedKeys,0===h,g,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:l}:{Xu:l}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Db,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(t=>this.Uu=this.Uu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Uu=this.Uu.delete(t)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=Ht(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const t=[];return e.forEach(r=>{this.Ku.has(r)||t.push(new b0(r))}),this.Ku.forEach(r=>{e.has(r)||t.push(new s_(r))}),t}tc(e){this.Uu=e.Hi,this.Ku=Ht();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return Ep.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class NS{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class xb{constructor(e){this.key=e,this.nc=!1}}class PS{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.sc={},this.ic=new kn(h=>_I(h),Hf),this.rc=new Map,this.oc=new Set,this.uc=new dr(Qe.comparator),this.cc=new Map,this.ac=new cp,this.hc={},this.lc=new Map,this.fc=xc.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function OS(n,e){return T0.apply(this,arguments)}function T0(){return T0=(0,me.Z)(function*(n,e){const t=Tp(n);let r,i;const a=t.ic.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.ec();else{const l=yield vh(t.localStore,Yi(e));t.isPrimaryClient&&_p(t.remoteStore,l);const h=t.sharedClientState.addLocalQueryTarget(l.targetId);r=l.targetId,i=yield Ip(t,e,r,"current"===h,l.resumeToken)}return i}),T0.apply(this,arguments)}function Ip(n,e,t,r,i){return fu.apply(this,arguments)}function fu(){return fu=(0,me.Z)(function*(n,e,t,r,i){n._c=(S,k,U)=>{return(K=(0,me.Z)(function*(he,be,lt,ft){let ct=be.view.Wu(lt);ct.$i&&(ct=yield fp(he.localStore,be.query,!1).then(({documents:Lt})=>be.view.Wu(Lt,ct)));const ht=ft&&ft.targetChanges.get(be.targetId),xt=be.view.applyChanges(ct,he.isPrimaryClient,ht);return M0(he,be.targetId,xt.Xu),xt.snapshot}),function(he,be,lt,ft){return K.apply(this,arguments)})(n,S,k,U);var K};const a=yield fp(n.localStore,e,!0),l=new C0(e,a.Hi),h=l.Wu(a.documents),g=Qf.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),v=l.applyChanges(h,n.isPrimaryClient,g);M0(n,t,v.Xu);const T=new NS(e,t,l);return n.ic.set(e,T),n.rc.has(t)?n.rc.get(t).push(e):n.rc.set(t,[e]),v.snapshot}),fu.apply(this,arguments)}function Rb(n,e){return o_.apply(this,arguments)}function o_(){return o_=(0,me.Z)(function*(n,e){const t=Je(n),r=t.ic.get(e),i=t.rc.get(r.targetId);if(i.length>1)return t.rc.set(r.targetId,i.filter(a=>!Hf(a,e))),void t.ic.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield kc(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Eh(t.remoteStore,r.targetId),El(t,r.targetId)}).catch(ul))):(El(t,r.targetId),yield kc(t.localStore,r.targetId,!0))}),o_.apply(this,arguments)}function Mb(){return Mb=(0,me.Z)(function*(n,e,t){const r=P0(n);try{const i=yield function(a,l){const h=Je(a),g=Mn.now(),v=l.reduce((k,U)=>k.add(U.key),Ht());let T,S;return h.persistence.runTransaction("Locally write mutations","readwrite",k=>{let U=Qi(),K=Ht();return h.Gi.getEntries(k,v).next(he=>{U=he,U.forEach((be,lt)=>{lt.isValidDocument()||(K=K.add(be))})}).next(()=>h.localDocuments.getOverlayedDocuments(k,U)).next(he=>{T=he;const be=[];for(const lt of l){const ft=mR(lt,T.get(lt.key).overlayedDocument);null!=ft&&be.push(new ya(lt.key,ft,Vo(ft.value.mapValue),Zn.exists(!0)))}return h.mutationQueue.addMutationBatch(k,g,be,l)}).next(he=>{S=he;const be=he.applyToLocalDocumentSet(T,K);return h.documentOverlayCache.saveOverlays(k,he.batchId,be)})}).then(()=>({batchId:S.batchId,changes:Sv(T)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let g=a.hc[a.currentUser.toKey()];g||(g=new dr(Nt)),g=g.insert(l,h),a.hc[a.currentUser.toKey()]=g}(r,i.batchId,t),yield pu(r,i.changes),yield yp(r.remoteStore)}catch(i){const a=Ih(i,"Failed to persist write");t.reject(a)}}),Mb.apply(this,arguments)}function kb(n,e){return D0.apply(this,arguments)}function D0(){return D0=(0,me.Z)(function*(n,e){const t=Je(n);try{const r=yield _S(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.cc.get(a);l&&(At(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.nc=!0:i.modifiedDocuments.size>0?At(l.nc):i.removedDocuments.size>0&&(At(l.nc),l.nc=!1))}),yield pu(t,r,e)}catch(r){yield ul(r)}}),D0.apply(this,arguments)}function Nb(n,e,t){const r=Je(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.ic.forEach((a,l)=>{const h=l.view.bu(e);h.snapshot&&i.push(h.snapshot)}),function(a,l){const h=Je(a);h.onlineState=l;let g=!1;h.queries.forEach((v,T)=>{for(const S of T.listeners)S.bu(l)&&(g=!0)}),g&&I0(h)}(r.eventManager,e),i.length&&r.sc.Wo(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Pb(n,e,t){return S0.apply(this,arguments)}function S0(){return S0=(0,me.Z)(function*(n,e,t){const r=Je(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.cc.get(e),a=i&&i.key;if(a){let l=new dr(Qe.comparator);l=l.insert(a,$n.newNoDocument(a,Rt.min()));const h=Ht().add(a),g=new Yf(Rt.min(),new Map,new Pn(Nt),l,h);yield kb(r,g),r.uc=r.uc.remove(a),r.cc.delete(e),l_(r)}else yield kc(r.localStore,e,!1).then(()=>El(r,e,t)).catch(ul)}),S0.apply(this,arguments)}function FS(n,e){return Ob.apply(this,arguments)}function Ob(){return Ob=(0,me.Z)(function*(n,e){const t=Je(n),r=e.batch.batchId;try{const i=yield Xv(t.localStore,e);bp(t,r,null),u_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield pu(t,i)}catch(i){yield ul(i)}}),Ob.apply(this,arguments)}function A0(n,e,t){return a_.apply(this,arguments)}function a_(){return a_=(0,me.Z)(function*(n,e,t){const r=Je(n);try{const i=yield function(a,l){const h=Je(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let v;return h.mutationQueue.lookupMutationBatch(g,l).next(T=>(At(null!==T),v=T.keys(),h.mutationQueue.removeMutationBatch(g,T))).next(()=>h.mutationQueue.performConsistencyCheck(g)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(g,v,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,v)).next(()=>h.localDocuments.getDocuments(g,v))})}(r.localStore,e);bp(r,e,t),u_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield pu(r,i)}catch(i){yield ul(i)}}),a_.apply(this,arguments)}function x0(){return x0=(0,me.Z)(function*(n,e){const t=Je(n);hu(t.remoteStore)||Ue("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const l=Je(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.lc.get(r)||[];i.push(e),t.lc.set(r,i)}catch(r){const i=Ih(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),x0.apply(this,arguments)}function u_(n,e){(n.lc.get(e)||[]).forEach(t=>{t.resolve()}),n.lc.delete(e)}function bp(n,e,t){const r=Je(n);let i=r.hc[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.hc[r.currentUser.toKey()]=i}}function El(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.rc.get(e))n.ic.delete(r),t&&n.sc.wc(r,t);n.rc.delete(e),n.isPrimaryClient&&n.ac.ls(e).forEach(r=>{n.ac.containsKey(r)||R0(n,r)})}function R0(n,e){n.oc.delete(e.path.canonicalString());const t=n.uc.get(e);null!==t&&(Eh(n.remoteStore,t),n.uc=n.uc.remove(e),n.cc.delete(t),l_(n))}function M0(n,e,t){for(const r of t)r instanceof s_?(n.ac.addReference(r.key,e),Lb(n,r)):r instanceof b0?(Ue("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,e),n.ac.containsKey(r.key)||R0(n,r.key)):ot()}function Lb(n,e){const t=e.key,r=t.path.canonicalString();n.uc.get(t)||n.oc.has(r)||(Ue("SyncEngine","New document in limbo: "+t),n.oc.add(r),l_(n))}function l_(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const e=n.oc.values().next().value;n.oc.delete(e);const t=new Qe(an.fromString(e)),r=n.fc.next();n.cc.set(r,new xb(t)),n.uc=n.uc.insert(t,r),_p(n.remoteStore,new fl(Yi(yc(t.path)),r,2,Ki.at))}}function pu(n,e,t){return k0.apply(this,arguments)}function k0(){return k0=(0,me.Z)(function*(n,e,t){const r=Je(n),i=[],a=[],l=[];var h;r.ic.isEmpty()||(r.ic.forEach((h,g)=>{l.push(r._c(g,e,t).then(v=>{if((v||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(g.targetId,(null==v?void 0:v.fromCache)?"not-current":"current"),v){i.push(v);const T=Qv.Ci(g.targetId,v);a.push(T)}}))}),yield Promise.all(l),r.sc.Wo(i),yield(h=(0,me.Z)(function*(g,v){const T=Je(g);try{yield T.persistence.runTransaction("notifyLocalViewChanges","readwrite",S=>ue.forEach(v,k=>ue.forEach(k.Si,U=>T.persistence.referenceDelegate.addReference(S,k.targetId,U)).next(()=>ue.forEach(k.Di,U=>T.persistence.referenceDelegate.removeReference(S,k.targetId,U)))))}catch(S){if(!Fo(S))throw S;Ue("LocalStore","Failed to update sequence numbers: "+S)}for(const S of v){const k=S.targetId;if(!S.fromCache){const U=T.Ui.get(k),he=U.withLastLimboFreeSnapshotVersion(U.snapshotVersion);T.Ui=T.Ui.insert(k,he)}}}),function(g,v){return h.apply(this,arguments)})(r.localStore,a))}),k0.apply(this,arguments)}function TR(n,e){return Fb.apply(this,arguments)}function Fb(){return Fb=(0,me.Z)(function*(n,e){const t=Je(n);if(!t.currentUser.isEqual(e)){Ue("SyncEngine","User change. New user:",e.toKey());const r=yield Hm(t.localStore,e);t.currentUser=e,(i=t).lc.forEach(l=>{l.forEach(h=>{h.reject(new Oe(fe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.lc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield pu(t,r.ji)}var i}),Fb.apply(this,arguments)}function Ub(n,e){const t=Je(n),r=t.cc.get(e);if(r&&r.nc)return Ht().add(r.key);{let i=Ht();const a=t.rc.get(e);if(!a)return i;for(const l of a){const h=t.ic.get(l);i=i.unionWith(h.view.ju)}return i}}function VS(n,e){return N0.apply(this,arguments)}function N0(){return N0=(0,me.Z)(function*(n,e){const t=Je(n),r=yield fp(t.localStore,e.query,!0),i=e.view.tc(r);return t.isPrimaryClient&&M0(t,e.targetId,i.Xu),i}),N0.apply(this,arguments)}function BS(n,e){return Vb.apply(this,arguments)}function Vb(){return Vb=(0,me.Z)(function*(n,e){const t=Je(n);return Jv(t.localStore,e).then(r=>pu(t,r))}),Vb.apply(this,arguments)}function DR(n,e,t,r){return Bb.apply(this,arguments)}function Bb(){return Bb=(0,me.Z)(function*(n,e,t,r){const i=Je(n),a=yield function(l,h){const g=Je(l),v=Je(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",T=>v.Tn(T,h).next(S=>S?g.localDocuments.getDocuments(T,S):ue.resolve(null)))}(i.localStore,e);var h;null!==a?("pending"===t?yield yp(i.remoteStore):"acknowledged"===t||"rejected"===t?(bp(i,e,r||null),u_(i,e),h=e,Je(Je(i.localStore).mutationQueue).An(h)):ot(),yield pu(i,a)):Ue("SyncEngine","Cannot apply mutation batch with id: "+e)}),Bb.apply(this,arguments)}function jb(){return jb=(0,me.Z)(function*(n,e){const t=Je(n);if(Tp(t),P0(t),!0===e&&!0!==t.dc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield $b(t,r.toArray());t.dc=!0,yield r_(t.remoteStore,!0);for(const a of i)_p(t.remoteStore,a)}else if(!1===e&&!1!==t.dc){const r=[];let i=Promise.resolve();t.rc.forEach((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(El(t,l),kc(t.localStore,l,!0))),Eh(t.remoteStore,l)}),yield i,yield $b(t,r),function(a){const l=Je(a);l.cc.forEach((h,g)=>{Eh(l.remoteStore,g)}),l.ac.fs(),l.cc=new Map,l.uc=new dr(Qe.comparator)}(t),t.dc=!1,yield r_(t.remoteStore,!1)}}),jb.apply(this,arguments)}function $b(n,e,t){return bh.apply(this,arguments)}function bh(){return bh=(0,me.Z)(function*(n,e,t){const r=Je(n),i=[],a=[];for(const l of e){let h;const g=r.rc.get(l);if(g&&0!==g.length){h=yield vh(r.localStore,Yi(g[0]));for(const v of g){const T=r.ic.get(v),S=yield VS(r,T);S.snapshot&&a.push(S.snapshot)}}else{const v=yield db(r.localStore,l);h=yield vh(r.localStore,v),yield Ip(r,Hb(v),l,!1,h.resumeToken)}i.push(h)}return r.sc.Wo(a),i}),bh.apply(this,arguments)}function Hb(n){return _v(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function jS(n){const e=Je(n);return Je(Je(e.localStore).persistence).vi()}function Gb(n,e,t,r){return gu.apply(this,arguments)}function gu(){return gu=(0,me.Z)(function*(n,e,t,r){const i=Je(n);if(i.dc)return void Ue("SyncEngine","Ignoring unexpected query state notification.");const a=i.rc.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=yield Jv(i.localStore,yI(a[0])),h=Yf.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Yr.EMPTY_BYTE_STRING);yield pu(i,l,h);break}case"rejected":yield kc(i.localStore,e,!0),El(i,e,r);break;default:ot()}}),gu.apply(this,arguments)}function Wb(n,e,t){return Cp.apply(this,arguments)}function Cp(){return Cp=(0,me.Z)(function*(n,e,t){const r=Tp(n);if(r.dc){for(const i of e){if(r.rc.has(i)){Ue("SyncEngine","Adding an already active target "+i);continue}const a=yield db(r.localStore,i),l=yield vh(r.localStore,a);yield Ip(r,Hb(a),l.targetId,!1,l.resumeToken),_p(r.remoteStore,l)}for(const i of t)r.rc.has(i)&&(yield kc(r.localStore,i,!1).then(()=>{Eh(r.remoteStore,i),El(r,i)}).catch(ul))}}),Cp.apply(this,arguments)}function Tp(n){const e=Je(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=kb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ub.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Pb.bind(null,e),e.sc.Wo=RS.bind(null,e.eventManager),e.sc.wc=E0.bind(null,e.eventManager),e}function P0(n){const e=Je(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=FS.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=A0.bind(null,e),e}class c_{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,me.Z)(function*(){t.It=vl(e.databaseInfo.databaseId),t.sharedClientState=t.gc(e),t.persistence=t.yc(e),yield t.persistence.start(),t.localStore=t.Ic(e),t.gcScheduler=t.Tc(e,t.localStore),t.indexBackfillerScheduler=t.Ec(e,t.localStore)})()}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return $m(this.persistence,new lb,e.initialUser,this.It)}yc(e){return new ab(Mc.Bs,this.It)}gc(e){return new Km}terminate(){var e=this;return(0,me.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Dp extends c_{constructor(e,t,r){super(),this.Ac=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,me.Z)(function*(){yield t().call(r,e),yield r.Ac.initialize(r,e),yield P0(r.Ac.syncEngine),yield yp(r.Ac.remoteStore),yield r.persistence.li(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ic(e){return $m(this.persistence,new lb,e.initialUser,this.It)}Tc(e,t){return new cS(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Ec(e,t){const r=new rv(t,this.persistence);return new nv(e.asyncQueue,r)}yc(e){const t=jm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Ji.withCacheSize(this.cacheSizeBytes):Ji.DEFAULT;return new Bm(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,a0(),gp(),this.It,this.sharedClientState,!!this.forceOwnership)}gc(e){return new Km}}class AR extends Dp{constructor(e,t){super(e,t,!1),this.Ac=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,me.Z)(function*(){yield t().call(r,e);const i=r.Ac.syncEngine;r.sharedClientState instanceof r0&&(r.sharedClientState.syncEngine={Fr:DR.bind(null,i),$r:Gb.bind(null,i),Br:Wb.bind(null,i),vi:jS.bind(null,i),Mr:BS.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.li(function(){var a=(0,me.Z)(function*(l){yield function SR(n,e){return jb.apply(this,arguments)}(r.Ac.syncEngine,l),r.gcScheduler&&(l&&!r.gcScheduler.started?r.gcScheduler.start():l||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(l&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():l||r.indexBackfillerScheduler.stop())});return function(l){return a.apply(this,arguments)}}())})()}gc(e){const t=a0();if(!r0.C(t))throw new Oe(fe.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=jm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new r0(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class qb{initialize(e,t){var r=this;return(0,me.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>Nb(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=TR.bind(null,r.syncEngine),yield r_(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new CR}createDatastore(e){const t=vl(e.databaseInfo.databaseId),r=new o0(e.databaseInfo);return new mb(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=h=>Nb(this.syncEngine,h,0),l=s0.C()?new s0:new wS,new u0(t,r,i,a,l);var t,r,i,a,l}createSyncEngine(e,t){return function(r,i,a,l,h,g,v){const T=new PS(r,i,a,l,h,g);return v&&(T.dc=!0),T}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,me.Z)(function*(t){const r=Je(t);Ue("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield wh(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function zb(n,e,t){if(!t)throw new Oe(fe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $S(n,e,t,r){if(!0===e&&!0===r)throw new Oe(fe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function L0(n){if(!Qe.isDocumentKey(n))throw new Oe(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Kb(n){if(Qe.isDocumentKey(n))throw new Oe(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function d_(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":ot()}function rn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Oe(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=d_(n);throw new Oe(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Zb(n,e){if(e<=0)throw new Oe(fe.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}const F0=new Map;class U0{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Oe(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Oe(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,$S("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ch{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new U0({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Oe(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Oe(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new U0(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new dD;switch(t.type){case"gapi":return new Qy(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Oe(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=F0.get(e);t&&(Ue("ComponentProvider","Removing Datastore"),F0.delete(e),t.terminate())}(this),Promise.resolve()}}class Yn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new co(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yn(this.firestore,e,this._key)}}class Ii{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ii(this.firestore,e,this._query)}}class co extends Ii{constructor(e,t,r){super(e,t,yc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yn(this.firestore,null,new Qe(e))}withConverter(e){return new co(this.firestore,e,this._path)}}function HS(n,e,...t){if(n=(0,L.m9)(n),zb("collection","path",e),n instanceof Ch){const r=an.fromString(e,...t);return Kb(r),new co(n,null,r)}{if(!(n instanceof Yn||n instanceof co))throw new Oe(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(an.fromString(e,...t));return Kb(r),new co(n.firestore,null,r)}}function Th(n,e,...t){if(n=(0,L.m9)(n),1===arguments.length&&(e=sI.R()),zb("doc","path",e),n instanceof Ch){const r=an.fromString(e,...t);return L0(r),new Yn(n,null,new Qe(r))}{if(!(n instanceof Yn||n instanceof co))throw new Oe(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(an.fromString(e,...t));return L0(r),new Yn(n.firestore,n instanceof co?n.converter:null,new Qe(r))}}function Xb(n,e){return n=(0,L.m9)(n),e=(0,L.m9)(e),(n instanceof Yn||n instanceof co)&&(e instanceof Yn||e instanceof co)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function V0(n,e){return n=(0,L.m9)(n),e=(0,L.m9)(e),n instanceof Ii&&e instanceof Ii&&n.firestore===e.firestore&&Hf(n._query,e._query)&&n.converter===e.converter}function GS(n,e=10240){let t=0;return{read:()=>(0,me.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,me.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class B0{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):Ar("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class WS{constructor(e,t){this.Pc=e,this.It=t,this.metadata=new Fr,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then(r=>{r&&r.Ou()?this.metadata.resolve(r.ku.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==r?void 0:r.ku)}`))},r=>this.metadata.reject(r))}close(){return this.Pc.cancel()}getMetadata(){var e=this;return(0,me.Z)(function*(){return e.metadata.promise})()}mc(){var e=this;return(0,me.Z)(function*(){return yield e.getMetadata(),e.Vc()})()}Vc(){var e=this;return(0,me.Z)(function*(){const t=yield e.Sc();if(null===t)return null;const r=e.vc.decode(t),i=Number(r);isNaN(i)&&e.Dc(`length string (${r}) is not valid number`);const a=yield e.Cc(i);return new MS(JSON.parse(a),t.length+i)})()}xc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Sc(){var e=this;return(0,me.Z)(function*(){for(;e.xc()<0&&!(yield e.Nc()););if(0===e.buffer.length)return null;const t=e.xc();t<0&&e.Dc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Cc(e){var t=this;return(0,me.Z)(function*(){for(;t.buffer.length<e;)(yield t.Nc())&&t.Dc("Reached the end of bundle when more is expected.");const r=t.vc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Dc(e){throw this.Pc.cancel(),new Error(`Invalid bundle format: ${e}`)}Nc(){var e=this;return(0,me.Z)(function*(){const t=yield e.Pc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class kR{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,me.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Oe(fe.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,me.Z)(function*(a,l){const h=Je(a),g=Rm(h.It)+"/documents",v={documents:l.map(U=>Xf(h.It,U))},T=yield h._o("BatchGetDocuments",g,v,l.length),S=new Map;T.forEach(U=>{const K=function FD(n,e){return"found"in e?function(t,r){At(!!r.found);const i=ou(t,r.found.name),a=oi(r.found.updateTime),l=new si({mapValue:{fields:r.found.fields}});return $n.newFoundDocument(i,a,l)}(n,e):"missing"in e?function(t,r){At(!!r.missing),At(!!r.readTime);const i=ou(t,r.missing),a=oi(r.readTime);return $n.newNoDocument(i,a)}(n,e):ot()}(h.It,U);S.set(K.key.toString(),K)});const k=[];return l.forEach(U=>{const K=S.get(U.toString());At(!!K),k.push(K)}),k}),function(a,l){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new oh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,me.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=Qe.fromPath(i);e.mutations.push(new Dv(a,e.precondition(a)))}),yield(r=(0,me.Z)(function*(i,a){const l=Je(i),h=Rm(l.It)+"/documents",g={writes:a.map(v=>au(l.It,v))};yield l.ao("Commit",h,g)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ot();t=Rt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Oe(fe.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Rt.min())?Zn.exists(!1):Zn.updateTime(t):Zn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Rt.min()))throw new Oe(fe.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Zn.updateTime(t)}return Zn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class NR{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.kc=r.maxAttempts,this.xo=new mp(this.asyncQueue,"transaction_retry")}run(){this.kc-=1,this.Oc()}Oc(){var e=this;this.xo.Ro((0,me.Z)(function*(){const t=new kR(e.datastore),r=e.Mc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Fc(a)}))}).catch(i=>{e.Fc(i)})}))}Mc(e){try{const t=this.updateFunction(e);return!Jd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Fc(e){this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Oc(),Promise.resolve()))):this.deferred.reject(e)}$c(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!qf(t)}return!1}}class PR{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Zr.UNAUTHENTICATED,this.clientId=sI.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var l=(0,me.Z)(function*(h){Ue("FirestoreClient","Received user=",h.uid),yield a.authCredentialListener(h),a.user=h});return function(h){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(r,l=>(Ue("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var e=this;return(0,me.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Oe(fe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Fr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,me.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Ih(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Jb(n,e){return eC.apply(this,arguments)}function eC(){return eC=(0,me.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),Ue("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,me.Z)(function*(a){r.isEqual(a)||(yield Hm(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),eC.apply(this,arguments)}function qS(n,e){return tC.apply(this,arguments)}function tC(){return tC=(0,me.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield nC(n);Ue("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>xS(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>xS(e.remoteStore,a)),n.onlineComponents=e}),tC.apply(this,arguments)}function nC(n){return s.apply(this,arguments)}function s(){return s=(0,me.Z)(function*(n){return n.offlineComponents||(Ue("FirestoreClient","Using default OfflineComponentProvider"),yield Jb(n,new c_)),n.offlineComponents}),s.apply(this,arguments)}function o(n){return u.apply(this,arguments)}function u(){return u=(0,me.Z)(function*(n){return n.onlineComponents||(Ue("FirestoreClient","Using default OnlineComponentProvider"),yield qS(n,new qb)),n.onlineComponents}),u.apply(this,arguments)}function c(n){return nC(n).then(e=>e.persistence)}function d(n){return nC(n).then(e=>e.localStore)}function f(n){return o(n).then(e=>e.remoteStore)}function y(n){return o(n).then(e=>e.syncEngine)}function C(n){return A.apply(this,arguments)}function A(){return A=(0,me.Z)(function*(n){const e=yield o(n),t=e.eventManager;return t.onListen=OS.bind(null,e.syncEngine),t.onUnlisten=Rb.bind(null,e.syncEngine),t}),A.apply(this,arguments)}function ee(n,e,t={}){const r=new Fr;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function(i,a,l,h,g){const v=new B0({next:S=>{a.enqueueAndForget(()=>w0(i,T));const k=S.docs.has(l);!k&&S.fromCache?g.reject(new Oe(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&S.fromCache&&h&&"server"===h.source?g.reject(new Oe(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(S)},error:S=>g.reject(S)}),T=new Fs(yc(l.path),v,{includeMetadataChanges:!0,Nu:!0});return y0(i,T)}(yield C(n),n.asyncQueue,e,t,r)})),r.promise}function Be(n,e,t={}){const r=new Fr;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function(i,a,l,h,g){const v=new B0({next:S=>{a.enqueueAndForget(()=>w0(i,T)),S.fromCache&&"server"===h.source?g.reject(new Oe(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(S)},error:S=>g.reject(S)}),T=new Fs(l,v,{includeMetadataChanges:!0,Nu:!0});return y0(i,T)}(yield C(n),n.asyncQueue,e,t,r)})),r.promise}class Tt{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new mp(this,"async_queue_retry"),this.Wc=()=>{const t=gp();t&&Ue("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const e=gp();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.Uc){this.Uc=!0,this.Qc=e||!1;const t=gp();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.Uc)return new Promise(()=>{});const t=new Fr;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}Jc(){var e=this;return(0,me.Z)(function*(){if(0!==e.Lc.length){try{yield e.Lc[0](),e.Lc.shift(),e.xo.reset()}catch(t){if(!Fo(t))throw t;Ue("AsyncQueue","Operation failed with retryable error: "+t)}e.Lc.length>0&&e.xo.Ro(()=>e.Jc())}})()}Hc(e){const t=this.Bc.then(()=>(this.Gc=!0,e().catch(r=>{throw this.Kc=r,this.Gc=!1,Ar("INTERNAL UNHANDLED ERROR: ",function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),l}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=t,t}enqueueAfterDelay(e,t,r){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const i=_0.createAndSchedule(this,e,t,r,a=>this.Yc(a));return this.qc.push(i),i}zc(){this.Kc&&ot()}verifyOperationInProgress(){}Xc(){var e=this;return(0,me.Z)(function*(){let t;do{t=e.Bc,yield t}while(t!==e.Bc)})()}Zc(e){for(const t of this.qc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.qc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.qc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const t=this.qc.indexOf(e);this.qc.splice(t,1)}}function Qt(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class bn{constructor(){this._progressObserver={},this._taskCompletionResolver=new Fr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class vn extends Ch{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Tt,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||h_(this),this._firestoreClient.terminate()}}function fr(n){return n._firestoreClient||h_(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function h_(n){var e;const t=n._freezeSettings(),r=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new cI(n._databaseId,a,n._persistenceKey,(h=t).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams));var a,h;n._firestoreClient=new PR(n._authCredentials,n._appCheckCredentials,n._queue,r)}function f_(n,e,t){const r=new Fr;return n.asyncQueue.enqueue((0,me.Z)(function*(){try{yield Jb(n,t),yield qS(n,e),r.resolve()}catch(i){const a=i;if(!("FirebaseError"===(l=a).name?l.code===fe.FAILED_PRECONDITION||l.code===fe.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&l instanceof DOMException)||22===l.code||20===l.code||11===l.code))throw a;al("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a)}var l})).then(()=>r.promise)}function OR(n){if(n._initialized||n._terminated)throw new Oe(fe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Il{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Il(Yr.fromBase64String(e))}catch(t){throw new Oe(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Il(Yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Fc{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Oe(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Sp{constructor(e){this._methodName=e}}class sC{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Oe(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Oe(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Nt(this._lat,e._lat)||Nt(this._long,e._long)}}const uO=/^__.*__$/;class lO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new ya(e,this.data,this.fieldMask,t,this.fieldTransforms):new Wf(e,this.data,t,this.fieldTransforms)}}class LR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ya(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function FR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ot()}}class oC{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.It=r,this.ignoreUndefinedProperties=i,void 0===a&&this.na(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new oC(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ia({path:r,oa:!1});return i.ua(e),i}ca(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ia({path:r,oa:!1});return i.na(),i}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return lC(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(FR(this.sa)&&uO.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class cO{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.It=r||vl(e)}da(e,t,r,i=!1){return new oC({sa:e,methodName:t,fa:r,path:Kn.emptyPath(),oa:!1,la:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Ap(n){const e=n._freezeSettings(),t=vl(n._databaseId);return new cO(n._databaseId,!!e.ignoreUndefinedProperties,t)}function aC(n,e,t,r,i,a={}){const l=n.da(a.merge||a.mergeFields?2:0,e,t,i);YS("Data must be an object, but it was:",l,r);const h=BR(r,l);let g,v;if(a.merge)g=new Zi(l.fieldMask),v=l.fieldTransforms;else if(a.mergeFields){const T=[];for(const S of a.mergeFields){const k=QS(e,S,t);if(!l.contains(k))throw new Oe(fe.INVALID_ARGUMENT,`Field '${k}' is specified in your field mask but missing from your input data.`);$R(T,k)||T.push(k)}g=new Zi(T),v=l.fieldTransforms.filter(S=>g.covers(S.field))}else g=null,v=l.fieldTransforms;return new lO(new si(h),g,v)}class W0 extends Sp{_toFieldTransform(e){if(2!==e.sa)throw e.ha(1===e.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof W0}}function UR(n,e,t){return new oC({sa:3,fa:e.settings.fa,methodName:n._methodName,oa:t},e.databaseId,e.It,e.ignoreUndefinedProperties)}class zS extends Sp{_toFieldTransform(e){return new sh(e.path,new ih)}isEqual(e){return e instanceof zS}}class dO extends Sp{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=UR(this,e,!0),r=this._a.map(a=>xp(a,t)),i=new wc(r);return new sh(e.path,i)}isEqual(e){return this===e}}class hO extends Sp{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=UR(this,e,!0),r=this._a.map(a=>xp(a,t)),i=new hl(r);return new sh(e.path,i)}isEqual(e){return this===e}}class fO extends Sp{constructor(e,t){super(e),this.wa=t}_toFieldTransform(e){const t=new Ec(e.It,II(e.It,this.wa));return new sh(e.path,t)}isEqual(e){return this===e}}function KS(n,e,t,r){const i=n.da(1,e,t);YS("Data must be an object, but it was:",i,r);const a=[],l=si.empty();ru(r,(g,v)=>{const T=uC(e,g,t);v=(0,L.m9)(v);const S=i.ca(T);if(v instanceof W0)a.push(T);else{const k=xp(v,S);null!=k&&(a.push(T),l.set(T,k))}});const h=new Zi(a);return new LR(l,h,i.fieldTransforms)}function ZS(n,e,t,r,i,a){const l=n.da(1,e,t),h=[QS(e,r,t)],g=[i];if(a.length%2!=0)throw new Oe(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let k=0;k<a.length;k+=2)h.push(QS(e,a[k])),g.push(a[k+1]);const v=[],T=si.empty();for(let k=h.length-1;k>=0;--k)if(!$R(v,h[k])){const U=h[k];let K=g[k];K=(0,L.m9)(K);const he=l.ca(U);if(K instanceof W0)v.push(U);else{const be=xp(K,he);null!=be&&(v.push(U),T.set(U,be))}}const S=new Zi(v);return new LR(T,S,l.fieldTransforms)}function VR(n,e,t,r=!1){return xp(t,n.da(r?4:3,e))}function xp(n,e){if(jR(n=(0,L.m9)(n)))return YS("Unsupported field value:",e,n),BR(n,e);if(n instanceof Sp)return function(t,r){if(!FR(r.sa))throw r.ha(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const l of t){let h=xp(l,r.aa(a));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,L.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return II(r.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=Mn.fromDate(t);return{timestampValue:ch(r.It,i)}}if(t instanceof Mn){const i=new Mn(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ch(r.It,i)}}if(t instanceof sC)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Il)return{bytesValue:kv(r.It,t._byteString)};if(t instanceof Yn){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r.ha(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:xm(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.ha(`Unsupported field value: ${d_(t)}`)}(n,e)}function BR(n,e){const t={};return sv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ru(n,(r,i)=>{const a=xp(i,e.ra(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function jR(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Mn||n instanceof sC||n instanceof Il||n instanceof Yn||n instanceof Sp)}function YS(n,e,t){if(!jR(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=d_(t);throw e.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function QS(n,e,t){if((e=(0,L.m9)(e))instanceof Fc)return e._internalPath;if("string"==typeof e)return uC(n,e);throw lC("Field path arguments must be of type string or ",n,!1,void 0,t)}const pO=new RegExp("[~\\*/\\[\\]]");function uC(n,e,t){if(e.search(pO)>=0)throw lC(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fc(...e.split("."))._internalPath}catch(r){throw lC(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lC(n,e,t,r,i){const a=r&&!r.isEmpty(),l=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let g="";return(a||l)&&(g+=" (found",a&&(g+=` in field ${r}`),l&&(g+=` in document ${i}`),g+=")"),new Oe(fe.INVALID_ARGUMENT,h+n+g)}function $R(n,e){return n.some(t=>t.isEqual(e))}class q0{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Yn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new gO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(cC("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class gO extends q0{data(){return super.data()}}function cC(n,e){return"string"==typeof e?uC(n,e):e instanceof Fc?e._internalPath:e._delegate._internalPath}function HR(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Oe(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class z0{}function Dh(n,...e){for(const t of e)n=t._apply(n);return n}class mO extends z0{constructor(e,t,r){super(),this.ma=e,this.ga=t,this.ya=r,this.type="where"}_apply(e){const t=Ap(e.firestore),r=function(i,a,l,h,g,v,T){let S;if(g.isKeyField()){if("array-contains"===v||"array-contains-any"===v)throw new Oe(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if("in"===v||"not-in"===v){ZR(T,v);const U=[];for(const K of T)U.push(KR(h,i,K));S={arrayValue:{values:U}}}else S=KR(h,i,T)}else"in"!==v&&"not-in"!==v&&"array-contains-any"!==v||ZR(T,v),S=VR(l,"where",T,"in"===v||"not-in"===v);const k=wi.create(g,v,S);return function(U,K){if(K.dt()){const be=bm(U);if(null!==be&&!be.isEqual(K.field))throw new Oe(fe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${be.toString()}' and '${K.field.toString()}'`);const lt=Im(U);null!==lt&&YR(0,K.field,lt)}const he=function(be,lt){for(const ft of be.filters)if(lt.indexOf(ft.op)>=0)return ft.op;return null}(U,function(be){switch(be){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(K.op));if(null!==he)throw new Oe(fe.INVALID_ARGUMENT,he===K.op?`Invalid query. You cannot use more than one '${K.op.toString()}' filter.`:`Invalid query. You cannot use '${K.op.toString()}' filters with '${he.toString()}' filters.`)}(i,k),k}(e._query,0,t,e.firestore._databaseId,this.ma,this.ga,this.ya);return new Ii(e.firestore,e.converter,function(i,a){const l=i.filters.concat([a]);return new ga(i.path,i.collectionGroup,i.explicitOrderBy.slice(),l,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class yO extends z0{constructor(e,t){super(),this.ma=e,this.pa=t,this.type="orderBy"}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new Oe(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Oe(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new _c(i,a);return function(h,g){if(null===Im(h)){const v=bm(h);null!==v&&YR(0,v,g.field)}}(r,l),l}(e._query,this.ma,this.pa);return new Ii(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new ga(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class GR extends z0{constructor(e,t,r){super(),this.type=e,this.Ia=t,this.Ta=r}_apply(e){return new Ii(e.firestore,e.converter,Tm(e._query,this.Ia,this.Ta))}}class WR extends z0{constructor(e,t,r){super(),this.type=e,this.Ea=t,this.Aa=r}_apply(e){const t=zR(e,this.type,this.Ea,this.Aa);return new Ii(e.firestore,e.converter,(i=t,new ga((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class qR extends z0{constructor(e,t,r){super(),this.type=e,this.Ea=t,this.Aa=r}_apply(e){const t=zR(e,this.type,this.Ea,this.Aa);return new Ii(e.firestore,e.converter,(i=t,new ga((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function zR(n,e,t,r){if(t[0]=(0,L.m9)(t[0]),t[0]instanceof q0)return function(i,a,l,h,g){if(!h)throw new Oe(fe.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const v=[];for(const T of vc(i))if(T.field.isKeyField())v.push(cl(a,h.key));else{const S=h.data.field(T.field);if(gm(S))throw new Oe(fe.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+T.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===S){const k=T.field.canonicalString();throw new Oe(fe.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${k}' (used as the orderBy) does not exist.`)}v.push(S)}return new dl(v,g)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Ap(n.firestore);return function(a,l,h,g,v,T){const S=a.explicitOrderBy;if(v.length>S.length)throw new Oe(fe.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const k=[];for(let U=0;U<v.length;U++){const K=v[U];if(S[U].field.isKeyField()){if("string"!=typeof K)throw new Oe(fe.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof K}`);if(!Cm(a)&&-1!==K.indexOf("/"))throw new Oe(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${K}' contains a slash.`);const he=a.path.child(an.fromString(K));if(!Qe.isDocumentKey(he))throw new Oe(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${he}' is not because it contains an odd number of segments.`);const be=new Qe(he);k.push(cl(l,be))}else{const he=VR(h,g,K);k.push(he)}}return new dl(k,T)}(n._query,n.firestore._databaseId,i,e,t,r)}}function KR(n,e,t){if("string"==typeof(t=(0,L.m9)(t))){if(""===t)throw new Oe(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Cm(e)&&-1!==t.indexOf("/"))throw new Oe(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(an.fromString(t));if(!Qe.isDocumentKey(r))throw new Oe(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return cl(n,new Qe(r))}if(t instanceof Yn)return cl(n,t._key);throw new Oe(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${d_(t)}.`)}function ZR(n,e){if(!Array.isArray(n)||0===n.length)throw new Oe(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Oe(fe.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function YR(n,e,t){if(!t.isEqual(e))throw new Oe(fe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class XS{convertValue(e,t="none"){switch(gc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ir(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(iu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ot()}}convertObject(e,t){const r={};return ru(e.fields,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new sC(ir(e.latitude),ir(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=av(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Xd(e));default:return null}}convertTimestamp(e){const t=ll(e);return new Mn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=an.fromString(e);At(Lv(r));const i=new su(r.get(1),r.get(3)),a=new Qe(r.popFirst(5));return i.isEqual(t)||Ar(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function dC(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class DO extends XS{constructor(e){super(),this.firestore=e}convertBytes(e){return new Il(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yn(this.firestore,null,t)}}class Rp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uc extends q0{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new K0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(cC("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class K0 extends Uc{data(e={}){return super.data(e)}}class Sh{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Rp(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new K0(this._firestore,this._userDataWriter,r.key,r,new Rp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Oe(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>({type:"added",doc:new K0(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Rp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||3!==l.type).map(l=>{const h=new K0(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Rp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let g=-1,v=-1;return 0!==l.type&&(g=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),1!==l.type&&(a=a.add(l.doc),v=a.indexOf(l.doc.key)),{type:SO(l.type),doc:h,oldIndex:g,newIndex:v}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function SO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ot()}}function QR(n,e){return n instanceof Uc&&e instanceof Uc?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Sh&&e instanceof Sh&&n._firestore===e._firestore&&V0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Ah extends XS{constructor(e){super(),this.firestore=e}convertBytes(e){return new Il(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yn(this.firestore,null,t)}}function XR(n,e,t){n=rn(n,Yn);const r=rn(n.firestore,vn),i=dC(n.converter,e,t);return p_(r,[aC(Ap(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Zn.none())])}function JR(n,e,t,...r){n=rn(n,Yn);const i=rn(n.firestore,vn),a=Ap(i);let l;return l="string"==typeof(e=(0,L.m9)(e))||e instanceof Fc?ZS(a,"updateDoc",n._key,e,t,r):KS(a,"updateDoc",n._key,e),p_(i,[l.toMutation(n._key,Zn.exists(!0))])}function eM(n,...e){var t,r,i;n=(0,L.m9)(n);let a={includeMetadataChanges:!1},l=0;"object"!=typeof e[l]||Qt(e[l])||(a=e[l],l++);const h={includeMetadataChanges:a.includeMetadataChanges};if(Qt(e[l])){const S=e[l];e[l]=null===(t=S.next)||void 0===t?void 0:t.bind(S),e[l+1]=null===(r=S.error)||void 0===r?void 0:r.bind(S),e[l+2]=null===(i=S.complete)||void 0===i?void 0:i.bind(S)}let g,v,T;if(n instanceof Yn)v=rn(n.firestore,vn),T=yc(n._key.path),g={next:S=>{e[l]&&e[l](JS(v,n,S))},error:e[l+1],complete:e[l+2]};else{const S=rn(n,Ii);v=rn(S.firestore,vn),T=S._query;const k=new Ah(v);g={next:U=>{e[l]&&e[l](new Sh(v,k,S,U))},error:e[l+1],complete:e[l+2]},HR(n._query)}return function(S,k,U,K){const he=new B0(K),be=new Fs(k,he,U);return S.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return y0(yield C(S),be)})),()=>{he.bc(),S.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return w0(yield C(S),be)}))}}(fr(v),T,h,g)}function p_(n,e){return function(t,r){const i=new Fr;return t.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function LS(n,e,t){return Mb.apply(this,arguments)}(yield y(t),r,i)})),i.promise}(fr(n),e)}function JS(n,e,t){const r=t.docs.get(e._key),i=new Ah(n);return new Uc(n,i,e._key,r,new Rp(t.hasPendingWrites,t.fromCache),e.converter)}const FO={maxAttempts:5};class tM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ap(e)}set(e,t,r){this._verifyNotCommitted();const i=xh(e,this._firestore),a=dC(i.converter,t,r),l=aC(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(l.toMutation(i._key,Zn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=xh(e,this._firestore);let l;return l="string"==typeof(t=(0,L.m9)(t))||t instanceof Fc?ZS(this._dataReader,"WriteBatch.update",a._key,t,r,i):KS(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,Zn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=xh(e,this._firestore);return this._mutations=this._mutations.concat(new oh(t._key,Zn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Oe(fe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function xh(n,e){if((n=(0,L.m9)(n)).firestore!==e)throw new Oe(fe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class UO extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ap(e)}get(e){const t=xh(e,this._firestore),r=new DO(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return ot();const a=i[0];if(a.isFoundDocument())return new q0(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new q0(this._firestore,r,t._key,null,t.converter);throw ot()})}set(e,t,r){const i=xh(e,this._firestore),a=dC(i.converter,t,r),l=aC(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const a=xh(e,this._firestore);let l;return l="string"==typeof(t=(0,L.m9)(t))||t instanceof Fc?ZS(this._dataReader,"Transaction.update",a._key,t,r,i):KS(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=xh(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=xh(e,this._firestore),r=new Ah(this._firestore);return super.get(e).then(i=>new Uc(this._firestore,r,t._key,i._document,new Rp(!1,!1),t.converter))}}function eA(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Oe("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function rM(){if("undefined"==typeof Uint8Array)throw new Oe("unimplemented","Uint8Arrays are not available in this environment.")}function iM(){if(!function _D(){return"undefined"!=typeof atob}())throw new Oe("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){dc=qi.SDK_VERSION,(0,qi._registerComponent)(new oo.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const a=t.getProvider("app").getImmediate(),l=new vn(new hD(t.getProvider("auth-internal")),new pR(t.getProvider("app-check-internal")),function(h,g){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Oe(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new su(h.options.projectId,g)}(a,r),a);return i=Object.assign({useFetchStreams:e},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),(0,qi.registerVersion)(Ky,"3.7.3",n),(0,qi.registerVersion)(Ky,"3.7.3","esm2017")}();class Z0{constructor(e){this._delegate=e}static fromBase64String(e){return iM(),new Z0(Il.fromBase64String(e))}static fromUint8Array(e){return rM(),new Z0(Il.fromUint8Array(e))}toBase64(){return iM(),this._delegate.toBase64()}toUint8Array(){return rM(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function tA(n){return function zO(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class KO{enableIndexedDbPersistence(e,t){return function j0(n,e){OR(n=rn(n,vn));const t=fr(n),r=n._freezeSettings(),i=new qb;return f_(t,i,new Dp(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function $0(n){OR(n=rn(n,vn));const e=fr(n),t=n._freezeSettings(),r=new qb;return f_(e,r,new AR(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function H0(n){if(n._initialized&&!n._terminated)throw new Oe(fe.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Fr;return n._queue.enqueueAndForgetEvenWhileRestricted((0,me.Z)(function*(){try{yield(t=(0,me.Z)(function*(r){if(!Ls.C())return Promise.resolve();const i=r+"main";yield Ls.delete(i)}),function(r){return t.apply(this,arguments)})(jm(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class sM{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof su||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&al("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function Yb(n,e,t,r={}){var i;const a=(n=rn(n,Ch))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&al("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let l,h;if("string"==typeof r.mockUserToken)l=r.mockUserToken,h=Zr.MOCK_USER;else{l=(0,L.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Oe(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Zr(g)}n._authCredentials=new fR(new rI(l,h))}}(this._delegate,e,t,r)}enableNetwork(){return function iO(n){return function M(n){return n.asyncQueue.enqueue((0,me.Z)(function*(){const e=yield c(n),t=yield f(n);return e.setNetworkEnabled(!0),function(r){const i=Je(r);return i._u.delete(0),Pc(i)}(t)}))}(fr(n=rn(n,vn)))}(this._delegate)}disableNetwork(){return function sO(n){return function V(n){return n.asyncQueue.enqueue((0,me.Z)(function*(){const e=yield c(n),t=yield f(n);return e.setNetworkEnabled(!1),(r=(0,me.Z)(function*(i){const a=Je(i);a._u.add(0),yield wh(a),a.gu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(fr(n=rn(n,vn)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,$S("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function G0(n){return function(e){const t=new Fr;return e.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return function US(n,e){return x0.apply(this,arguments)}(yield y(e),t)})),t.promise}(fr(n=rn(n,vn)))}(this._delegate)}onSnapshotsInSync(e){return function LO(n,e){return function Ye(n,e){const t=new B0(e);return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return r=yield C(n),i=t,Je(r).Ru.add(i),void i.next();var r,i})),()=>{t.bc(),n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return r=yield C(n),i=t,void Je(r).Ru.delete(i);var r,i}))}}(fr(n=rn(n,vn)),Qt(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Oe("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new g_(this,HS(this._delegate,e))}catch(t){throw Vs(t,"collection()","Firestore.collection()")}}doc(e){try{return new va(this,Th(this._delegate,e))}catch(t){throw Vs(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Bs(this,function Qb(n,e){if(n=rn(n,Ch),zb("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Oe(fe.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ii(n,null,(t=e,new ga(an.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Vs(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function VO(n,e,t){n=rn(n,vn);const r=Object.assign(Object.assign({},FO),t);return function(i){if(i.maxAttempts<1)throw new Oe(fe.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,a,l){const h=new Fr;return i.asyncQueue.enqueueAndForget((0,me.Z)(function*(){const g=yield function E(n){return o(n).then(e=>e.datastore)}(i);new NR(i.asyncQueue,g,l,a,h).run()})),h.promise}(fr(n),i=>e(new UO(n,i)),r)}(this._delegate,t=>e(new oM(this,t)))}batch(){return fr(this._delegate),new aM(new tM(this._delegate,e=>p_(this._delegate,e)))}loadBundle(e){return function oO(n,e){const t=fr(n=rn(n,vn)),r=new bn;return function at(n,e,t,r){const i=function(a,l){let h;return h="string"==typeof a?(new TextEncoder).encode(a):a,g=function(g,v){if(g instanceof Uint8Array)return GS(g,v);if(g instanceof ArrayBuffer)return GS(new Uint8Array(g),v);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new WS(g,l);var g}(t,vl(e));n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){!function O0(n,e,t){const r=Je(n);var i;(i=(0,me.Z)(function*(a,l,h){try{const g=yield l.getMetadata();if(yield function(k,U){const K=Je(k),he=oi(U.createTime);return K.persistence.runTransaction("hasNewerBundle","readonly",be=>K.Ns.getBundleMetadata(be,U.id)).then(be=>!!be&&be.createTime.compareTo(he)>=0)}(a.localStore,g))return yield l.close(),h._completeWith({taskState:"Success",documentsLoaded:(k=g).totalDocuments,bytesLoaded:k.totalBytes,totalDocuments:k.totalDocuments,totalBytes:k.totalBytes}),Promise.resolve(new Set);h._updateProgress(Ab(g));const v=new kS(g,a.localStore,l.It);let T=yield l.mc();for(;T;){const k=yield v.Fu(T);k&&h._updateProgress(k),T=yield l.mc()}const S=yield v.complete();return yield pu(a,S.Lu,void 0),yield function(k,U){const K=Je(k);return K.persistence.runTransaction("Save bundle","readwrite",he=>K.Ns.saveBundleMetadata(he,U))}(a.localStore,g),h._completeWith(S.progress),Promise.resolve(S.Bu)}catch(g){return al("SyncEngine",`Loading bundle failed with ${g}`),h._failWith(g),Promise.resolve(new Set)}var k}),function(a,l,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield y(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function aO(n,e){return function ke(n,e){return n.asyncQueue.enqueue((0,me.Z)(function*(){return function(t,r){const i=Je(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.Ns.getNamedQuery(a,r))}(yield d(n),e)}))}(fr(n=rn(n,vn)),e).then(t=>t?new Ii(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Bs(this,t):null)}}class hC extends XS{constructor(e){super(),this.firestore=e}convertBytes(e){return new Z0(new Il(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return va.forKey(t,this.firestore,null)}}class oM{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new hC(e)}get(e){const t=kp(e);return this._delegate.get(t).then(r=>new Y0(this._firestore,new Uc(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=kp(e);return r?(eA("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=kp(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=kp(e);return this._delegate.delete(t),this}}class aM{constructor(e){this._delegate=e}set(e,t,r){const i=kp(e);return r?(eA("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=kp(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=kp(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Mp{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new K0(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Q0(this._firestore,r),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Mp.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new Mp(e,new hC(e),t),i.set(t,a)),a}}Mp.INSTANCES=new WeakMap;class va{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new hC(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Oe("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new va(t,new Yn(t._delegate,r,new Qe(e)))}static forKey(e,t,r){return new va(t,new Yn(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new g_(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new g_(this.firestore,HS(this._delegate,e))}catch(t){throw Vs(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,L.m9)(e))instanceof Yn&&Xb(this._delegate,e)}set(e,t){t=eA("DocumentReference.set",t);try{return t?XR(this._delegate,e,t):XR(this._delegate,e)}catch(r){throw Vs(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?JR(this._delegate,e):JR(this._delegate,e,t,...r)}catch(i){throw Vs(i,"updateDoc()","DocumentReference.update()")}}delete(){return function PO(n){return p_(rn(n.firestore,vn),[new oh(n._key,Zn.none())])}(this._delegate)}onSnapshot(...e){const t=uM(e),r=lM(e,i=>new Y0(this.firestore,new Uc(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return eM(this._delegate,t,r)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function xO(n){n=rn(n,Yn);const e=rn(n.firestore,vn),t=fr(e),r=new Ah(e);return function Z(n,e){const t=new Fr;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return(r=(0,me.Z)(function*(i,a,l){try{const h=yield function(g,v){const T=Je(g);return T.persistence.runTransaction("read document","readonly",S=>T.localDocuments.getDocument(S,v))}(i,a);h.isFoundDocument()?l.resolve(h):h.isNoDocument()?l.resolve(null):l.reject(new Oe(fe.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const g=Ih(h,`Failed to get document '${a} from cache`);l.reject(g)}}),function(i,a,l){return r.apply(this,arguments)})(yield d(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Uc(e,r,n._key,i,new Rp(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function RO(n){n=rn(n,Yn);const e=rn(n.firestore,vn);return ee(fr(e),n._key,{source:"server"}).then(t=>JS(e,n,t))}(this._delegate):function AO(n){n=rn(n,Yn);const e=rn(n.firestore,vn);return ee(fr(e),n._key).then(t=>JS(e,n,t))}(this._delegate),t.then(r=>new Y0(this.firestore,new Uc(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new va(this.firestore,this._delegate.withConverter(e?Mp.getInstance(this.firestore,e):null))}}function Vs(n,e,t){return n.message=n.message.replace(e,t),n}function uM(n){for(const e of n)if("object"==typeof e&&!tA(e))return e;return{}}function lM(n,e){var t,r;let i;return i=tA(n[0])?n[0]:tA(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Y0{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new va(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return QR(this._delegate,e._delegate)}}class Q0 extends Y0{data(e){const t=this._delegate.data(e);return function cD(n,e){n||ot()}(void 0!==t),t}}class Bs{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new hC(e)}where(e,t,r){try{return new Bs(this.firestore,Dh(this._delegate,function _O(n,e,t){const r=e,i=cC("where",n);return new mO(i,r,t)}(e,t,r)))}catch(i){throw Vs(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Bs(this.firestore,Dh(this._delegate,function vO(n,e="asc"){const t=e,r=cC("orderBy",n);return new yO(r,t)}(e,t)))}catch(r){throw Vs(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Bs(this.firestore,Dh(this._delegate,function wO(n){return Zb("limit",n),new GR("limit",n,"F")}(e)))}catch(t){throw Vs(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Bs(this.firestore,Dh(this._delegate,function EO(n){return Zb("limitToLast",n),new GR("limitToLast",n,"L")}(e)))}catch(t){throw Vs(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Bs(this.firestore,Dh(this._delegate,function IO(...n){return new WR("startAt",n,!0)}(...e)))}catch(t){throw Vs(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Bs(this.firestore,Dh(this._delegate,function bO(...n){return new WR("startAfter",n,!1)}(...e)))}catch(t){throw Vs(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Bs(this.firestore,Dh(this._delegate,function CO(...n){return new qR("endBefore",n,!1)}(...e)))}catch(t){throw Vs(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Bs(this.firestore,Dh(this._delegate,function TO(...n){return new qR("endAt",n,!0)}(...e)))}catch(t){throw Vs(t,"endAt()","Query.endAt()")}}isEqual(e){return V0(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function kO(n){n=rn(n,Ii);const e=rn(n.firestore,vn),t=fr(e),r=new Ah(e);return function Ie(n,e){const t=new Fr;return n.asyncQueue.enqueueAndForget((0,me.Z)(function*(){return(r=(0,me.Z)(function*(i,a,l){try{const h=yield fp(i,a,!0),g=new C0(a,h.Hi),v=g.Wu(h.documents),T=g.applyChanges(v,!1);l.resolve(T.snapshot)}catch(h){const g=Ih(h,`Failed to execute query '${a} against cache`);l.reject(g)}}),function(i,a,l){return r.apply(this,arguments)})(yield d(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Sh(e,r,n,i))}(this._delegate):"server"===(null==e?void 0:e.source)?function NO(n){n=rn(n,Ii);const e=rn(n.firestore,vn),t=fr(e),r=new Ah(e);return Be(t,n._query,{source:"server"}).then(i=>new Sh(e,r,n,i))}(this._delegate):function MO(n){n=rn(n,Ii);const e=rn(n.firestore,vn),t=fr(e),r=new Ah(e);return HR(n._query),Be(t,n._query).then(i=>new Sh(e,r,n,i))}(this._delegate),t.then(r=>new nA(this.firestore,new Sh(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=uM(e),r=lM(e,i=>new nA(this.firestore,new Sh(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return eM(this._delegate,t,r)}withConverter(e){return new Bs(this.firestore,this._delegate.withConverter(e?Mp.getInstance(this.firestore,e):null))}}class YO{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Q0(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class nA{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Bs(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Q0(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new YO(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Q0(this._firestore,r))})}isEqual(e){return QR(this._delegate,e._delegate)}}class g_ extends Bs{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new va(this.firestore,e):null}doc(e){try{return new va(this.firestore,void 0===e?Th(this._delegate):Th(this._delegate,e))}catch(t){throw Vs(t,"doc()","CollectionReference.doc()")}}add(e){return function OO(n,e){const t=rn(n.firestore,vn),r=Th(n),i=dC(n.converter,e);return p_(t,[aC(Ap(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Zn.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new va(this.firestore,t))}isEqual(e){return Xb(this._delegate,e._delegate)}withConverter(e){return new g_(this.firestore,this._delegate.withConverter(e?Mp.getInstance(this.firestore,e):null))}}function kp(n){return rn(n,Yn)}class rA{constructor(...e){this._delegate=new Fc(...e)}static documentId(){return new rA(Kn.keyField().canonicalString())}isEqual(e){return(e=(0,L.m9)(e))instanceof Fc&&this._delegate._internalPath.isEqual(e._internalPath)}}class Np{constructor(e){this._delegate=e}static serverTimestamp(){const e=function jO(){return new zS("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Np(e)}static delete(){const e=function BO(){return new W0("deleteField")}();return e._methodName="FieldValue.delete",new Np(e)}static arrayUnion(...e){const t=function $O(...n){return new dO("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Np(t)}static arrayRemove(...e){const t=function HO(...n){return new hO("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Np(t)}static increment(e){const t=function GO(n){return new fO("increment",n)}(e);return t._methodName="FieldValue.increment",new Np(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const QO={Firestore:sM,GeoPoint:sC,Timestamp:Mn,Blob:Z0,Transaction:oM,WriteBatch:aM,DocumentReference:va,DocumentSnapshot:Y0,Query:Bs,QueryDocumentSnapshot:Q0,QuerySnapshot:nA,CollectionReference:g_,FieldPath:rA,FieldValue:Np,setLogLevel:function ZO(n){!function nI(n){tu.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function JO(n){(function XO(n,e){n.INTERNAL.registerComponent(new oo.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},QO)))})(n,(e,t)=>new sM(e,t,new KO)),n.registerVersion("@firebase/firestore-compat","0.2.3")}(cE.Z);var iA=F(6451),fC=F(5363),e1=F(6063);class t1 extends us.x{constructor(e=1/0,t=1/0,r=e1.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:l}=this;t||(r.push(e),!i&&r.push(a.now()+l)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let l=0;l<a.length&&!e.closed;l+=r?1:2)e.next(a[l]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const l=t.now();let h=0;for(let g=1;g<r.length&&r[g]<=l;g+=2)h=g;h&&r.splice(0,h+1)}}}var cM=F(3099);function dM(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=null!=n?n:1/0,(0,cM.B)({connector:()=>new t1(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function hM(n,e){return(0,cs.m)(e)?lr(()=>n,e):lr(()=>n)}var sA=F(9468);F(5867);const aA=new Map,pM={activated:!1,tokenObservers:[]},o1={initialized:!1,enabled:!1};function es(n){return aA.get(n)||Object.assign({},pM)}function gC(){return o1}class h1{constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,me.Z)(function*(){t.stop();try{t.pending=new L.BH,yield function f1(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new L.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const js=new L.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function mM(n){if(!es(n).activated)throw js.create("use-before-activation",{appName:n.name})}function cA(n,e){return dA.apply(this,arguments)}function dA(){return dA=(0,me.Z)(function*({url:n,body:e},t){var r,i;const a={"Content-Type":"application/json"},l=t.getImmediate({optional:!0});if(l){const U=yield l.getHeartbeatsHeader();U&&(a["X-Firebase-Client"]=U)}const h={method:"POST",body:JSON.stringify(e),headers:a};let g,v;try{g=yield fetch(n,h)}catch(U){throw js.create("fetch-network-error",{originalErrorMessage:null===(r=U)||void 0===r?void 0:r.message})}if(200!==g.status)throw js.create("fetch-status-error",{httpStatus:g.status});try{v=yield g.json()}catch(U){throw js.create("fetch-parse-error",{originalErrorMessage:null===(i=U)||void 0===i?void 0:i.message})}const T=v.ttl.match(/^([\d.]+)(s)$/);if(!T||!T[2]||isNaN(Number(T[1])))throw js.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${v.ttl}`});const S=1e3*Number(T[1]),k=Date.now();return{token:v.token,expireTimeMillis:k+S,issuedAtTimeMillis:k}}),dA.apply(this,arguments)}function _1(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const X0="firebase-app-check-store";let yC=null;function yM(){return yC||(yC=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=i=>{n(i.target.result)},r.onerror=i=>{var a;e(js.create("storage-open",{originalErrorMessage:null===(a=i.target.error)||void 0===a?void 0:a.message}))},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(X0,{keyPath:"compositeKey"})}}catch(r){e(js.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),yC)}function hA(){return hA=(0,me.Z)(function*(n,e){const r=(yield yM()).transaction(X0,"readwrite"),a=r.objectStore(X0).put({compositeKey:n,value:e});return new Promise((l,h)=>{a.onsuccess=g=>{l()},r.onerror=g=>{var v;h(js.create("storage-set",{originalErrorMessage:null===(v=g.target.error)||void 0===v?void 0:v.message}))}})}),hA.apply(this,arguments)}const J0=new ko.Yd("@firebase/app-check");function gA(n,e){return(0,L.hl)()?function E1(n,e){return function vM(n,e){return hA.apply(this,arguments)}(function EM(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{J0.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function IM(){return gC().enabled}function bM(){return _A.apply(this,arguments)}function _A(){return _A=(0,me.Z)(function*(){const n=gC();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),_A.apply(this,arguments)}const S1={error:"UNKNOWN_ERROR"};function A1(n){return L.US.encodeString(JSON.stringify(n),!1)}function vC(n){return yA.apply(this,arguments)}function yA(){return yA=(0,me.Z)(function*(n,e=!1){const t=n.app;mM(t);const r=es(t);let a,i=r.token;if(i&&!m_(i)&&(r.token=void 0,i=void 0),!i){const g=yield r.cachedTokenPromise;g&&(m_(g)?i=g:yield gA(t,void 0))}if(!e&&i&&m_(i))return{token:i.token};let h,l=!1;if(IM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=cA(_1(t,yield bM()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),l=!0);const g=yield r.exchangeTokenPromise;return yield gA(t,g),r.token=g,{token:g.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),l=!0),i=yield es(t).exchangeTokenPromise}catch(g){"appCheck/throttled"===g.code?J0.warn(g.message):J0.error(g),a=g}return i?a?h=m_(i)?{token:i.token,internalError:a}:DM(a):(h={token:i.token},r.token=i,yield gA(t,i)):h=DM(a),l&&TM(t,h),h}),yA.apply(this,arguments)}function wA(n,e){const t=es(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function CM(n){const{app:e}=n,t=es(e);let r=t.tokenRefresher;r||(r=function x1(n){const{app:e}=n;return new h1((0,me.Z)(function*(){let r;if(r=es(e).token?yield vC(n,!0):yield vC(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const t=es(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function TM(n,e){const t=es(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch(i){}}function m_(n){return n.expireTimeMillis-Date.now()>0}function DM(n){return{token:A1(S1),error:n}}class R1{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=es(this.app);for(const t of e)wA(this.app,t.next);return Promise.resolve()}}const PM="app-check-internal";!function G1(){(0,qi._registerComponent)(new oo.wA("app-check",n=>function M1(n,e){return new R1(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(PM).initialize()})),(0,qi._registerComponent)(new oo.wA(PM,n=>function k1(n){return{getToken:e=>vC(n,e),addTokenListener:e=>function vA(n,e,t,r){const{app:i}=n,a=es(i);if(a.tokenObservers=[...a.tokenObservers,{next:t,error:r,type:e}],a.token&&m_(a.token)){const h=a.token;Promise.resolve().then(()=>{t({token:h.token}),CM(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>CM(n))}(n,"INTERNAL",e),removeTokenListener:e=>wA(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,qi.registerVersion)("@firebase/app-check","0.5.17")}();class ew{constructor(){return(0,fn.vb)("app-check")}}"undefined"!=typeof window&&window;var EC=F(127);const TA=new _.OlP("angularfire2.auth.use-emulator"),DA=new _.OlP("angularfire2.auth.settings"),SA=new _.OlP("angularfire2.auth.tenant-id"),AA=new _.OlP("angularfire2.auth.langugage-code"),xA=new _.OlP("angularfire2.auth.use-device-language"),RA=new _.OlP("angularfire.auth.persistence"),MA=(n,e,t,r,i,a,l,h)=>(0,Dr.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const g=e.runOutsideAngular(()=>n.auth());if(t&&g.useEmulator(...t),r&&(g.tenantId=r),g.languageCode=i,a&&g.useDeviceLanguage(),l)for(const[v,T]of Object.entries(l))g.settings[v]=T;return h&&g.setPersistence(h),g},[t,r,i,a,l,h]);let tw=(()=>{class n{constructor(t,r,i,a,l,h,g,v,T,S,k,U){const K=new us.x,he=st(void 0).pipe((0,fC.Q)(l.outsideAngular),lr(()=>a.runOutsideAngular(()=>Promise.resolve().then(F.bind(F,5881)))),(0,Ct.U)(()=>(0,Dr.on)(t,a,r)),(0,Ct.U)(be=>MA(be,a,h,v,T,S,g,k)),dM({bufferSize:1,refCount:!1}));if(Wr(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=st(null);else{he.pipe(Ga()).subscribe();const lt=he.pipe(lr(ht=>ht.getRedirectResult().then(xt=>xt,()=>null)),fn.iC,dM({bufferSize:1,refCount:!1})),ft=he.pipe(lr(ht=>new xi.y(xt=>({unsubscribe:a.runOutsideAngular(()=>ht.onAuthStateChanged(Lt=>xt.next(Lt),Lt=>xt.error(Lt),()=>xt.complete()))})))),ct=he.pipe(lr(ht=>new xi.y(xt=>({unsubscribe:a.runOutsideAngular(()=>ht.onIdTokenChanged(Lt=>xt.next(Lt),Lt=>xt.error(Lt),()=>xt.complete()))}))));this.authState=lt.pipe(hM(ft),(0,sA.R)(l.outsideAngular),(0,fC.Q)(l.insideAngular)),this.user=lt.pipe(hM(ct),(0,sA.R)(l.outsideAngular),(0,fC.Q)(l.insideAngular)),this.idToken=this.user.pipe(lr(ht=>ht?(0,An.D)(ht.getIdToken()):st(null))),this.idTokenResult=this.user.pipe(lr(ht=>ht?(0,An.D)(ht.getIdTokenResult()):st(null))),this.credential=(0,iA.T)(lt,K,this.authState.pipe(xn(ht=>!ht))).pipe((0,Ct.U)(ht=>(null==ht?void 0:ht.user)?ht:null),(0,sA.R)(l.outsideAngular),(0,fC.Q)(l.insideAngular))}return(0,Dr.pX)(this,he,a,{spy:{apply:(be,lt,ft)=>{(be.startsWith("signIn")||be.startsWith("createUser"))&&ft.then(ct=>K.next(ct))}}})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Dr.Dh),_.LFG(Dr.xv,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(fn.HU),_.LFG(TA,8),_.LFG(DA,8),_.LFG(SA,8),_.LFG(AA,8),_.LFG(xA,8),_.LFG(RA,8),_.LFG(ew,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),Y1=(()=>{class n{constructor(){EC.Z.registerVersion("angularfire",fn.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[tw]}),n})();function LM(n,e){return function Q1(n,e=sy.z){return new xi.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=r&&r()}})}(n,e)}function kA(n,e){return LM(n,e).pipe((0,Ct.U)(t=>({payload:t,type:"query"})))}function IC(n,e){return kA(n,e).pipe(ds(void 0),oy(),(0,Ct.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(l=>({type:l.type,payload:l}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,h)=>{const g=i.find(T=>T.doc.ref.isEqual(l.ref)),v=null==t?void 0:t.payload.docs.find(T=>T.ref.isEqual(l.ref));g&&JSON.stringify(g.doc.metadata)===JSON.stringify(l.metadata)||!g&&v&&JSON.stringify(v.metadata)===JSON.stringify(l.metadata)||a.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:l}})}),a}))}function FM(n,e,t){return IC(n,t).pipe(fi((r,i)=>function J1(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function eL(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return NA(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return NA(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return NA(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),uE(),(0,Ct.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function NA(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function UM(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class VM{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=IC(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Ct.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(ds(void 0),oy(),xn(([r,i])=>i.length>0||!r),(0,Ct.U)(([r,i])=>i),fn.iC)}auditTrail(e){return this.stateChanges(e).pipe(fi((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=UM(e);return FM(this.query,t,this.afs.schedulers.outsideAngular).pipe(fn.iC)}valueChanges(e={}){return kA(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ct.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),fn.iC)}get(e){return(0,An.D)(this.query.get(e)).pipe(fn.iC)}add(e){return this.ref.add(e)}doc(e){return new BM(this.ref.doc(e),this.afs)}}class BM{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=HM(r,t);return new VM(i,a,this.afs)}snapshotChanges(){return function X1(n,e){return LM(n,e).pipe(ds(void 0),oy(),(0,Ct.U)(([t,r])=>r.exists?(null==t?void 0:t.exists)?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(fn.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Ct.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,An.D)(this.ref.get(e)).pipe(fn.iC)}}class tL{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?IC(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ct.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),xn(t=>t.length>0),fn.iC):IC(this.query,this.afs.schedulers.outsideAngular).pipe(fn.iC)}auditTrail(e){return this.stateChanges(e).pipe(fi((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=UM(e);return FM(this.query,t,this.afs.schedulers.outsideAngular).pipe(fn.iC)}valueChanges(e={}){return kA(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ct.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),fn.iC)}get(e){return(0,An.D)(this.query.get(e)).pipe(fn.iC)}}const jM=new _.OlP("angularfire2.enableFirestorePersistence"),$M=new _.OlP("angularfire2.firestore.persistenceSettings"),nL=new _.OlP("angularfire2.firestore.settings"),rL=new _.OlP("angularfire2.firestore.use-emulator");function HM(n,e=(t=>t)){return{query:e(n),ref:n}}let GM=(()=>{class n{constructor(t,r,i,a,l,h,g,v,T,S,k,U,K,he,be,lt,ft){this.schedulers=g;const ct=(0,Dr.on)(t,h,r),ht=T;S&&MA(ct,h,k,K,he,be,U,lt),[this.firestore,this.persistenceEnabled$]=(0,Dr.cc)(`${ct.name}.firestore`,"AngularFirestore",ct.name,()=>{const xt=h.runOutsideAngular(()=>ct.firestore());if(a&&xt.settings(a),ht&&xt.useEmulator(...ht),i&&!Wr(l)){const Lt=()=>{try{return(0,An.D)(xt.enablePersistence(v||void 0).then(()=>!0,()=>!1))}catch(Mr){return"undefined"!=typeof console&&console.warn(Mr),st(!1)}};return[xt,h.runOutsideAngular(Lt)]}return[xt,st(!1)]},[a,ht,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:l}=HM(i,r),h=this.schedulers.ngZone.run(()=>a);return new VM(h,l,this)}collectionGroup(t,r){const i=r||(l=>l),a=this.firestore.collectionGroup(t);return new tL(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new BM(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Dr.Dh),_.LFG(Dr.xv,8),_.LFG(jM,8),_.LFG(nL,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(fn.HU),_.LFG($M,8),_.LFG(rL,8),_.LFG(tw,8),_.LFG(TA,8),_.LFG(DA,8),_.LFG(SA,8),_.LFG(AA,8),_.LFG(xA,8),_.LFG(RA,8),_.LFG(ew,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),iL=(()=>{class n{constructor(){EC.Z.registerVersion("angularfire",fn.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:jM,useValue:!0},{provide:$M,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[GM]}),n})();const WM_firebase={apiKey:"AIzaSyC-JQck5pPPM_Jnch2lnt-dg19rG-JbFHE",authDomain:"ng-firebase-auth-86f36.firebaseapp.com",projectId:"ng-firebase-auth-86f36",storageBucket:"ng-firebase-auth-86f36.appspot.com",messagingSenderId:"507189884388",appId:"1:507189884388:web:92d4d36a923f86778c83f1",measurementId:"G-CV7XLCLF6N"},qM="firebasestorage.googleapis.com",zM="storageBucket";class xr extends L.ZR{constructor(e,t,r=0){super(PA(e),`Firebase Storage: ${t} (${PA(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return PA(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function PA(n){return"storage/"+n}function OA(){return new xr("unknown","An unknown error occurred, please check the error payload for server response.")}function KM(){return new xr("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function ZM(){return new xr("canceled","User canceled the upload/download.")}function YM(){return new xr("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function __(n){return new xr("invalid-argument",n)}function QM(){return new xr("app-deleted","The Firebase app was deleted.")}function XM(n){return new xr("invalid-root-operation","The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function nw(n,e){return new xr("invalid-format","String does not match format '"+n+"': "+e)}function rw(n){throw new xr("internal-error","Internal error: "+n)}class _s{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=_s.makeFromUrl(e,t)}catch(i){return new _s(e,"")}if(""===r.path)return r;throw function gL(n){return new xr("invalid-default-bucket","Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",h=new RegExp("^gs://"+i+"(/(.*))?$","i");function v(ht){ht.path_=decodeURIComponent(ht.path)}const S=t.replace(/[.]/g,"\\."),ct=[{regex:h,indices:{bucket:1,path:3},postModify:function a(ht){"/"===ht.path.charAt(ht.path.length-1)&&(ht.path_=ht.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${S}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:v},{regex:new RegExp(`^https?://${t===qM?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:v}];for(let ht=0;ht<ct.length;ht++){const xt=ct[ht],Lt=xt.regex.exec(e);if(Lt){let Eu=Lt[xt.indices.path];Eu||(Eu=""),r=new _s(Lt[xt.indices.bucket],Eu),xt.postModify(r);break}}if(null==r)throw function pL(n){return new xr("invalid-url","Invalid URL '"+n+"'.")}(e);return r}}class wL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function bC(n){return"string"==typeof n||n instanceof String}function JM(n){return LA()&&n instanceof Blob}function LA(){return"undefined"!=typeof Blob&&!(0,L.UG)()}function FA(n,e,t,r){if(r<e)throw __(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw __(`Invalid value for '${n}'. Expected ${t} or less.`)}function Vc(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function ek(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var Rh=(()=>(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"}(Rh||(Rh={})),Rh))();function tk(n,e){const t=n>=500&&n<600,i=-1!==[408,429].indexOf(n),a=-1!==e.indexOf(n);return t||i||a}class DL{constructor(e,t,r,i,a,l,h,g,v,T,S,k=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=g,this.timeout_=v,this.progressCallback_=T,this.connectionFactory_=S,this.retry=k,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((U,K)=>{this.resolve_=U,this.reject_=K,this.start_()})}start_(){const t=(r,i)=>{const a=this.resolve_,l=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const g=this.callback_(h,h.getResponse());!function bL(n){return void 0!==n}(g)?a():a(g)}catch(g){l(g)}else if(null!==h){const g=OA();g.serverResponse=h.getErrorText(),l(this.errorCallback_?this.errorCallback_(h,g):g)}else l(i.canceled?this.appDelete_?QM():ZM():KM())};this.canceled_?t(0,new CC(!1,null,!0)):this.backoffId_=function EL(n,e,t){let r=1,i=null,a=null,l=!1,h=0;function g(){return 2===h}let v=!1;function T(...be){v||(v=!0,e.apply(null,be))}function S(be){i=setTimeout(()=>{i=null,n(U,g())},be)}function k(){a&&clearTimeout(a)}function U(be,...lt){if(v)return void k();if(be)return k(),void T.call(null,be,...lt);if(g()||l)return k(),void T.call(null,be,...lt);let ct;r<64&&(r*=2),1===h?(h=2,ct=0):ct=1e3*(r+Math.random()),S(ct)}let K=!1;function he(be){K||(K=!0,k(),!v&&(null!==i?(be||(h=2),clearTimeout(i),S(0)):be||(h=1)))}return S(0),a=setTimeout(()=>{l=!0,he(!0)},t),he}((r,i)=>{if(i)return void r(!1,new CC(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const l=h=>{null!==this.progressCallback_&&this.progressCallback_(h.loaded,h.lengthComputable?h.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const h=a.getErrorCode()===Rh.NO_ERROR,g=a.getStatus();if((!h||tk(g,this.additionalRetryCodes_))&&this.retry){const T=a.getErrorCode()===Rh.ABORT;return void r(!1,new CC(!1,null,T))}const v=-1!==this.successCodes_.indexOf(g);r(!0,new CC(v,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function IL(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class CC{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function NL(...n){const e=function kL(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(LA())return new Blob(n);throw new xr("unsupported-environment","This browser doesn't seem to support creating Blobs")}const Go={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class UA{constructor(e,t){this.data=e,this.contentType=t||null}}function VA(n,e){switch(n){case Go.RAW:return new UA(nk(e));case Go.BASE64:case Go.BASE64URL:return new UA(rk(n,e));case Go.DATA_URL:return new UA(function FL(n){const e=new ik(n);return e.base64?rk(Go.BASE64,e.rest):function LL(n){let e;try{e=decodeURIComponent(n)}catch(t){throw nw(Go.DATA_URL,"Malformed data URL.")}return nk(e)}(e.rest)}(e),function UL(n){return new ik(n).contentType}(e))}throw OA()}function nk(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function rk(n,e){switch(n){case Go.BASE64:{const i=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(i||a)throw nw(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Go.BASE64URL:{const i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a)throw nw(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function OL(n){if("undefined"==typeof atob)throw function vL(n){return new xr("unsupported-environment",`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(e)}catch(i){throw i.message.includes("polyfill")?i:nw(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class ik{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw nw(Go.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function VL(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class bl{constructor(e,t){let r=0,i="";JM(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(JM(this.data_)){const i=function PL(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new bl(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new bl(r,!0)}}static getBlob(...e){if(LA()){const t=e.map(r=>r instanceof bl?r.data_:r);return new bl(NL.apply(null,t))}{const t=e.map(l=>bC(l)?VA(Go.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(l=>{for(let h=0;h<l.length;h++)i[a++]=l[h]}),new bl(i,!0)}}uploadData(){return this.data_}}function BA(n){let e;try{e=JSON.parse(n)}catch(t){return null}return function TL(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function sk(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function $L(n,e){return e}class $s{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||$L}}let TC=null;function iw(){if(TC)return TC;const n=[];n.push(new $s("bucket")),n.push(new $s("generation")),n.push(new $s("metageneration")),n.push(new $s("name","fullPath",!0));const t=new $s("name");t.xform=function e(a,l){return function HL(n){return!bC(n)||n.length<2?n:sk(n)}(l)},n.push(t);const i=new $s("size");return i.xform=function r(a,l){return void 0!==l?Number(l):l},n.push(i),n.push(new $s("timeCreated")),n.push(new $s("updated")),n.push(new $s("md5Hash",null,!0)),n.push(new $s("cacheControl",null,!0)),n.push(new $s("contentDisposition",null,!0)),n.push(new $s("contentEncoding",null,!0)),n.push(new $s("contentLanguage",null,!0)),n.push(new $s("contentType",null,!0)),n.push(new $s("metadata","customMetadata",!0)),TC=n,TC}function ok(n,e,t){const r=BA(e);return null===r?null:function WL(n,e,t){const r={type:"file"},i=t.length;for(let a=0;a<i;a++){const l=t[a];r[l.local]=l.xform(r,e[l.server])}return function GL(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new _s(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(r,n),r}(n,r,t)}function jA(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const ak="prefixes";class Cl{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Tl(n){if(!n)throw OA()}function DC(n,e){return function t(r,i){const a=ok(n,i,e);return Tl(null!==a),a}}function y_(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function hL(){return new xr("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function dL(){return new xr("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function cL(n){return new xr("quota-exceeded","Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function fL(n){return new xr("unauthorized","User does not have permission to access '"+n+"'.")}(n.path):r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}}function sw(n){const e=y_(n);return function t(r,i){let a=e(r,i);return 404===r.getStatus()&&(a=function lL(n){return new xr("object-not-found","Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=i.serverResponse,a}}function lk(n,e,t){const i=Vc(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Cl(i,"GET",DC(n,t),l);return h.errorHandler=sw(e),h}function QL(n,e,t,r,i){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),r&&(a.pageToken=r),i&&(a.maxResults=i);const h=Vc(e.bucketOnlyServerUrl(),n.host,n._protocol),v=n.maxOperationRetryTime,T=new Cl(h,"GET",function ZL(n,e){return function t(r,i){const a=function KL(n,e,t){const r=BA(t);return null===r?null:function zL(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[ak])for(const i of t[ak]){const a=i.replace(/\/$/,""),l=n._makeStorageReference(new _s(e,a));r.prefixes.push(l)}if(t.items)for(const i of t.items){const a=n._makeStorageReference(new _s(e,i.name));r.items.push(a)}return r}(n,e,r)}(n,e,i);return Tl(null!==a),a}}(n,e.bucket),v);return T.urlParams=a,T.errorHandler=y_(e),T}function dk(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function tF(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class SC{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function $A(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch(i){Tl(!1)}return Tl(!!t&&-1!==(e||["active"]).indexOf(t)),t}const sF={STATE_CHANGED:"state_changed"},Hs={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function HA(n){switch(n){case"running":case"pausing":case"canceling":return Hs.RUNNING;case"paused":return Hs.PAUSED;case"success":return Hs.SUCCESS;case"canceled":return Hs.CANCELED;default:return Hs.ERROR}}class oF{constructor(e,t,r){if(function CL(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=r?r:void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function v_(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class uF extends class aF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Rh.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Rh.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Rh.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw rw("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw rw("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw rw("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw rw("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw rw("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function mu(){return new uF}class gk{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=iw(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled"))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(tk(i.status,[])){if(!a)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=KM()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function nF(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l=dk(e,r,i),h={name:l.fullPath},g=Vc(a,n.host,n._protocol),T={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":l.contentType,"Content-Type":"application/json; charset=utf-8"},S=jA(l,t),K=new Cl(g,"POST",function U(he){let be;$A(he);try{be=he.getResponseHeader("X-Goog-Upload-URL")}catch(lt){Tl(!1)}return Tl(bC(be)),be},n.maxUploadRetryTime);return K.urlParams=h,K.headers=T,K.body=S,K.errorHandler=y_(e),K}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,mu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function rF(n,e,t,r){const g=new Cl(t,"POST",function a(v){const T=$A(v,["active","final"]);let S=null;try{S=v.getResponseHeader("X-Goog-Upload-Size-Received")}catch(U){Tl(!1)}S||Tl(!1);const k=Number(S);return Tl(!isNaN(k)),new SC(k,r.size(),"final"===T)},n.maxUploadRetryTime);return g.headers={"X-Goog-Upload-Command":"query"},g.errorHandler=y_(e),g}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,mu,t,r);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._updateProgress(l.current),this._needToFetchStatus=!1,l.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new SC(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let l;try{l=function iF(n,e,t,r,i,a,l,h){const g=new SC(0,0);if(l?(g.current=l.current,g.total=l.total):(g.current=0,g.total=r.size()),r.size()!==g.total)throw function _L(){return new xr("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const v=g.total-g.current;let T=v;i>0&&(T=Math.min(T,i));const S=g.current;let U="";U=0===T?"finalize":v===T?"upload, finalize":"upload";const K={"X-Goog-Upload-Command":U,"X-Goog-Upload-Offset":`${g.current}`},he=r.slice(S,S+T);if(null===he)throw YM();const ct=new Cl(t,"POST",function be(ht,xt){const Lt=$A(ht,["active","final"]),Mr=g.current+T,Eu=r.size();let nR;return nR="final"===Lt?DC(e,a)(ht,xt):null,new SC(Mr,Eu,"final"===Lt,nR)},e.maxUploadRetryTime);return ct.headers=K,ct.body=he.uploadData(),ct.progressCallback=h||null,ct.errorHandler=y_(n),ct}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(g){return this._error=g,void this._transition("error")}const h=this._ref.storage._makeRequest(l,mu,i,a,!1);this._request=h,h.getPromise().then(g=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(g.current),g.finalized?(this._metadata=g.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=lk(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,mu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function hk(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"},g=function h(){let ct="";for(let ht=0;ht<2;ht++)ct+=Math.random().toString().slice(2);return ct}();l["Content-Type"]="multipart/related; boundary="+g;const v=dk(e,r,i),T=jA(v,t),U=bl.getBlob("--"+g+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+T+"\r\n--"+g+"\r\nContent-Type: "+v.contentType+"\r\n\r\n",r,"\r\n--"+g+"--");if(null===U)throw YM();const K={name:v.fullPath},he=Vc(a,n.host,n._protocol),lt=n.maxUploadRetryTime,ft=new Cl(he,"POST",DC(n,t),lt);return ft.urlParams=K,ft.headers=l,ft.body=U.uploadData(),ft.errorHandler=y_(e),ft}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,mu,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=ZM(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=HA(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const a=new oF(t||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(HA(this._state)){case Hs.SUCCESS:v_(this._resolve.bind(null,this.snapshot))();break;case Hs.CANCELED:case Hs.ERROR:v_(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(HA(this._state)){case Hs.RUNNING:case Hs.PAUSED:e.next&&v_(e.next.bind(e,this.snapshot))();break;case Hs.SUCCESS:e.complete&&v_(e.complete.bind(e))();break;default:e.error&&v_(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Pp{constructor(e,t){this._service=e,this._location=t instanceof _s?t:_s.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Pp(e,t)}get root(){const e=new _s(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sk(this._location.path)}get storage(){return this._service}get parent(){const e=function BL(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new _s(this._location.bucket,e);return new Pp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw XM(e)}}function _k(n,e,t){return GA.apply(this,arguments)}function GA(){return GA=(0,me.Z)(function*(n,e,t){const i=yield yk(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield _k(n,e,i.nextPageToken))}),GA.apply(this,arguments)}function yk(n,e){null!=e&&"number"==typeof e.maxResults&&FA("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=QL(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,mu)}function wF(n){n._throwIfRoot("getDownloadURL");const e=function XL(n,e,t){const i=Vc(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Cl(i,"GET",function YL(n,e){return function t(r,i){const a=ok(n,i,e);return Tl(null!==a),function qL(n,e,t,r){const i=BA(e);if(null===i||!bC(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const l=encodeURIComponent;return a.split(",").map(v=>{const S=n.fullPath;return Vc("/b/"+l(n.bucket)+"/o/"+l(S),t,r)+ek({alt:"media",token:v})})[0]}(a,i,n.host,n._protocol)}}(n,t),l);return h.errorHandler=sw(e),h}(n.storage,n._location,iw());return n.storage.makeRequestWithTokens(e,mu).then(t=>{if(null===t)throw function yL(){return new xr("no-download-url","The given file does not have any download URLs.")}();return t})}function vk(n,e){const t=function jL(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new _s(n._location.bucket,t);return new Pp(n.storage,r)}function wk(n,e){if(n instanceof WA){const t=n;if(null==t._bucket)throw function mL(){return new xr("no-default-bucket","No default bucket found. Did you set the '"+zM+"' property when initializing the app?")}();const r=new Pp(t,t._bucket);return null!=e?wk(r,e):r}return void 0!==e?vk(n,e):n}function CF(n,e){if(e&&function IF(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof WA)return function bF(n,e){return new Pp(n,e)}(n,e);throw __("To use ref(service, url), the first argument must be a Storage instance.")}return wk(n,e)}function Ek(n,e){const t=null==e?void 0:e[zM];return null==t?null:_s.makeFromBucketSpec(t,n)}class WA{constructor(e,t,r,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=qM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?_s.makeFromBucketSpec(i,this._host):Ek(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?_s.makeFromBucketSpec(this._url,e):Ek(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){FA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){FA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,me.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,me.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Pp(this,e)}_makeRequest(e,t,r,i,a=!0){if(this._deleted)return new wL(QM());{const l=function ML(n,e,t,r,i,a,l=!0){const h=ek(n.urlParams),g=n.url+h,v=Object.assign({},n.headers);return function xL(n,e){e&&(n["X-Firebase-GMPID"]=e)}(v,e),function SL(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(v,t),function AL(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(v,a),function RL(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(v,r),new DL(g,n.method,v,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,l)}(e,this._appId,r,i,t,this._firebaseVersion,a);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}makeRequestWithTokens(e,t){var r=this;return(0,me.Z)(function*(){const[i,a]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,a).getPromise()})()}}const Ik="@firebase/storage";function Tk(n,e){return CF(n=(0,L.m9)(n),e)}function PF(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new WA(t,r,i,e,qi.SDK_VERSION)}!function OF(){(0,qi._registerComponent)(new oo.wA("storage",PF,"PUBLIC").setMultipleInstances(!0)),(0,qi.registerVersion)(Ik,"0.9.14",""),(0,qi.registerVersion)(Ik,"0.9.14","esm2017")}();class AC{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class Sk{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new AC(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new AC(r,this,this._ref))},t)}on(e,t,r,i){let a;return t&&(a="function"==typeof t?l=>t(new AC(l,this,this._ref)):{next:t.next?l=>t.next(new AC(l,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,r||void 0,i||void 0)}}class Ak{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Bc(e,this._service))}get items(){return this._delegate.items.map(e=>new Bc(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Bc{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function NF(n,e){return vk(n,e)}(this._delegate,e);return new Bc(t,this.storage)}get root(){return new Bc(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Bc(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new Sk(function DF(n,e,t){return function gF(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new gk(n,new bl(e),t)}(n=(0,L.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=Go.RAW,r){this._throwIfRoot("putString");const i=VA(t,e),a=Object.assign({},r);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new Sk(new gk(this._delegate,new bl(i.data,!0),a),this)}listAll(){return function RF(n){return function _F(n){const e={prefixes:[],items:[]};return _k(n,e).then(()=>e)}(n=(0,L.m9)(n))}(this._delegate).then(e=>new Ak(e,this.storage))}list(e){return function xF(n,e){return yk(n=(0,L.m9)(n),e)}(this._delegate,e||void 0).then(t=>new Ak(t,this.storage))}getMetadata(){return function SF(n){return function yF(n){n._throwIfRoot("getMetadata");const e=lk(n.storage,n._location,iw());return n.storage.makeRequestWithTokens(e,mu)}(n=(0,L.m9)(n))}(this._delegate)}updateMetadata(e){return function AF(n,e){return function vF(n,e){n._throwIfRoot("updateMetadata");const t=function JL(n,e,t,r){const a=Vc(e.fullServerUrl(),n.host,n._protocol),h=jA(t,r),v=n.maxOperationRetryTime,T=new Cl(a,"PATCH",DC(n,r),v);return T.headers={"Content-Type":"application/json; charset=utf-8"},T.body=h,T.errorHandler=sw(e),T}(n.storage,n._location,e,iw());return n.storage.makeRequestWithTokens(t,mu)}(n=(0,L.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function MF(n){return wF(n=(0,L.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function kF(n){return function EF(n){n._throwIfRoot("deleteObject");const e=function eF(n,e){const r=Vc(e.fullServerUrl(),n.host,n._protocol),h=new Cl(r,"DELETE",function l(g,v){},n.maxOperationRetryTime);return h.successCodes=[200,204],h.errorHandler=sw(e),h}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,mu)}(n=(0,L.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw XM(e)}}class xk{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(Rk(e))throw __("ref() expected a child path but got a URL, use refFromURL instead.");return new Bc(Tk(this._delegate,e),this)}refFromURL(e){if(!Rk(e))throw __("refFromURL() expected a full URL but got a child path, use ref() instead.");try{_s.makeFromUrl(e,this._delegate.host)}catch(t){throw __("refFromUrl() expected a valid full URL but got an invalid one.")}return new Bc(Tk(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function Dk(n,e,t,r={}){!function TF(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,L.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function Rk(n){return/^[A-Za-z]+:\/\//.test(n)}function VF(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new xk(t,r)}function Mk(n){const e=function jF(n){return new xi.y(e=>{const t=l=>e.next(l);t(n.snapshot);const a=n.on("state_changed",t);return n.then(l=>{t(l),e.complete()},l=>{t(n.snapshot),(l=>{e.error(l)})(l)}),function(){a()}}).pipe(function sL(n,e=sy.z){return(0,er.e)((t,r)=>{let i=null,a=null,l=null;const h=()=>{if(i){i.unsubscribe(),i=null;const v=a;a=null,r.next(v)}};function g(){const v=l+n,T=e.now();if(T<v)return i=this.schedule(void 0,v-T),void r.add(i);h()}t.subscribe((0,zn.x)(r,v=>{a=v,l=e.now(),i||(i=e.schedule(g,n),r.add(i))},()=>{h(),r.complete()},void 0,()=>{a=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,Ct.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function xC(n){return{getDownloadURL:()=>st(void 0).pipe(fn.fc,lr(()=>n.getDownloadURL()),fn.iC),getMetadata:()=>st(void 0).pipe(fn.fc,lr(()=>n.getMetadata()),fn.iC),delete:()=>(0,An.D)(n.delete()),child:e=>xC(n.child(e)),updateMetadata:e=>(0,An.D)(n.updateMetadata(e)),put:(e,t)=>Mk(n.put(e,t)),putString:(e,t,r)=>Mk(n.putString(e,t,r)),list:e=>(0,An.D)(n.list(e)),listAll:()=>(0,An.D)(n.listAll())}}!function BF(n){const e={TaskState:Hs,TaskEvent:sF,StringFormat:Go,Storage:xk,Reference:Bc};n.INTERNAL.registerComponent(new oo.wA("storage-compat",VF,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.1.22")}(cE.Z);const $F=new _.OlP("angularfire2.storageBucket"),HF=new _.OlP("angularfire2.storage.maxUploadRetryTime"),GF=new _.OlP("angularfire2.storage.maxOperationRetryTime"),WF=new _.OlP("angularfire2.storage.use-emulator");let qF=(()=>{class n{constructor(t,r,i,a,l,h,g,v,T,S){const k=(0,Dr.on)(t,l,r);this.storage=(0,Dr.cc)(`${k.name}.storage.${i}`,"AngularFireStorage",k.name,()=>{const U=l.runOutsideAngular(()=>k.storage(i||void 0)),K=T;return K&&U.useEmulator(...K),g&&U.setMaxUploadRetryTime(g),v&&U.setMaxOperationRetryTime(v),U},[g,v])}ref(t){return xC(this.storage.ref(t))}refFromURL(t){return xC(this.storage.refFromURL(t))}upload(t,r,i){return xC(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Dr.Dh),_.LFG(Dr.xv,8),_.LFG($F,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(fn.HU),_.LFG(HF,8),_.LFG(GF,8),_.LFG(WF,8),_.LFG(ew,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),zF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})(),KF=(()=>{class n{constructor(){EC.Z.registerVersion("angularfire",fn.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[qF],imports:[zF]}),n})();var ZF=F(5032);const kk="@firebase/database",Nk="0.13.10";let qA="";function Pk(n){qA=n}class XF{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,L.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,L.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class JF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,L.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const Ok=function(n){try{if("undefined"!=typeof window&&void 0!==window[n]){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new XF(e)}}catch(e){}return new JF},Op=Ok("localStorage"),zA=Ok("sessionStorage"),w_=new ko.Yd("@firebase/database"),Lk=function(){let n=1;return function(){return n++}}(),Fk=function(n){const e=(0,L.dS)(n),t=new L.gQ;t.update(e);const r=t.digest();return L.US.encodeByteArray(r)},ow=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=ow.apply(null,r):e+="object"==typeof r?(0,L.Wl)(r):r,e+=" "}return e};let Lp=null,Uk=!0;const Vk=function(n,e){(0,L.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(w_.logLevel=ko.in.VERBOSE,Lp=w_.log.bind(w_),e&&zA.set("logging_enabled",!0)):"function"==typeof n?Lp=n:(Lp=null,zA.remove("logging_enabled"))},Oi=function(...n){if(!0===Uk&&(Uk=!1,null===Lp&&!0===zA.get("logging_enabled")&&Vk(!0)),Lp){const e=ow.apply(null,n);Lp(e)}},aw=function(n){return function(...e){Oi(n,...e)}},KA=function(...n){const e="FIREBASE INTERNAL ERROR: "+ow(...n);w_.error(e)},Dl=function(...n){const e=`FIREBASE FATAL ERROR: ${ow(...n)}`;throw w_.error(e),new Error(e)},ys=function(...n){const e="FIREBASE WARNING: "+ow(...n);w_.warn(e)},RC=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},jc="[MIN_NAME]",Sl="[MAX_NAME]",Fp=function(n,e){if(n===e)return 0;if(n===jc||e===Sl)return-1;if(e===jc||n===Sl)return 1;{const t=MC(n),r=MC(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},nU=function(n,e){return n===e?0:n<e?-1:1},uw=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,L.Wl)(e))},ZA=function(n){if("object"!=typeof n||null===n)return(0,L.Wl)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,L.Wl)(e[r]),t+=":",t+=ZA(n[e[r]]);return t+="}",t},Bk=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Li(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const jk=function(n){(0,L.hu)(!RC(n),"Invalid JSON number");const r=1023;let i,a,l,h,g;0===n?(a=0,l=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=h+r,l=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(a=0,l=Math.round(n/Math.pow(2,-1074))));const v=[];for(g=52;g;g-=1)v.push(l%2?1:0),l=Math.floor(l/2);for(g=11;g;g-=1)v.push(a%2?1:0),a=Math.floor(a/2);v.push(i?1:0),v.reverse();const T=v.join("");let S="";for(g=0;g<64;g+=8){let k=parseInt(T.substr(g,8),2).toString(16);1===k.length&&(k="0"+k),S+=k}return S.toLowerCase()},oU=new RegExp("^-?(0*)\\d{1,10}$"),$k=-2147483648,YA=2147483647,MC=function(n){if(oU.test(n)){const e=Number(n);if(e>=$k&&e<=YA)return e}return null},E_=function(n){try{n()}catch(e){setTimeout(()=>{throw ys("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},lw=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class uU{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){ys(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class lU{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Oi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ys(e)}}let cw=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const zk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Yk="websocket",Qk="long_polling";class XA{constructor(e,t,r,i,a=!1,l="",h=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=l,this.includeNamespaceInQueryParams=h,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Op.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Op.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function Xk(n,e,t){let r;if((0,L.hu)("string"==typeof e,"typeof type must == string"),(0,L.hu)("object"==typeof t,"typeof params must == object"),e===Yk)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==Qk)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function cU(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Li(t,(a,l)=>{i.push(a+"="+l)}),r+i.join("&")}class dU{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,L.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,L.p$)(this.counters_)}}const JA={},ex={};function tx(n){const e=n.toString();return JA[e]||(JA[e]=new dU),JA[e]}class fU{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&E_(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Mh{constructor(e,t,r,i,a,l,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=l,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=aw(e),this.stats_=tx(t),this.urlFn=g=>(this.appCheckToken&&(g.ac=this.appCheckToken),Xk(t,Qk,g))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new fU(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,L.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new nx((...a)=>{const[l,h,g,v,T]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===l)this.id=h,this.password=g;else{if("close"!==l)throw new Error("Unrecognized command received: "+l);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[l,h]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(l,h)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&zk.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Mh.forceAllow_=!0}static forceDisallow(){Mh.forceDisallow_=!0}static isAvailable(){return!((0,L.Yr)()||!Mh.forceAllow_&&(Mh.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,L.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,L.h$)(t),i=Bk(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,L.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,L.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class nx{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,L.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Lk(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=nx.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(h){Oi("frame writing exception"),h.stack&&Oi(h.stack),Oi(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Oi("No IE domain setting required")}catch(t){const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const l=this.pendingSegs.shift();r=r+"&seg"+i+"="+l.seg+"&ts"+i+"="+l.ts+"&d"+i+"="+l.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,L.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Oi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch(r){}},Math.floor(1))}}let NC=null;"undefined"!=typeof MozWebSocket?NC=MozWebSocket:"undefined"!=typeof WebSocket&&(NC=WebSocket);let I_=(()=>{class n{constructor(t,r,i,a,l,h,g){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=aw(this.connId),this.stats_=tx(r),this.connURL=n.connectionURL_(r,h,g,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,l){const h={v:"5"};return!(0,L.Yr)()&&"undefined"!=typeof location&&location.hostname&&zk.test(location.hostname)&&(h.r="f"),r&&(h.s=r),i&&(h.ls=i),a&&(h.ac=a),l&&(h.p=l),Xk(t,Yk,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Op.set("previous_websocket_failure",!0);try{let i;if((0,L.Yr)()){i={headers:{"User-Agent":`Firebase/5/${qA}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const l=process.env,h=0===this.connURL.indexOf("wss://")?l.HTTPS_PROXY||l.https_proxy:l.HTTP_PROXY||l.http_proxy;h&&(i.proxy={origin:h})}this.mySock=new NC(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==NC&&!n.forceDisallow_}static previouslyFailed(){return Op.isInMemoryStorage||!0===Op.get("previous_websocket_failure")}markConnectionHealthy(){Op.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,L.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,L.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,L.Wl)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=Bk(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),sN=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Mh,I_]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=I_&&I_.isAvailable();let i=r&&!I_.previouslyFailed();if(t.webSocketOnly&&(r||ys("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[I_];else{const a=this.transports_=[];for(const l of n.ALL_TRANSPORTS)l&&l.isAvailable()&&a.push(l);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class hN{constructor(e,t,r,i,a,l,h,g,v,T){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=l,this.onReady_=h,this.onDisconnect_=g,this.onKill_=v,this.lastSessionId=T,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=aw("c:"+this.id+":"),this.transportManager_=new sN(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=lw(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=uw("t",e),r=uw("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=uw("t",e),r=uw("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=uw("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?KA("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):KA("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&ys("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),lw(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):lw(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Op.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class fN{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class pN{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,L.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,L.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class PC extends pN{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!(0,L.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new PC}getInitialEvent(e){return(0,L.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class On{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Cn(){return new On("")}function Xt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function kh(n){return n.pieces_.length-n.pieceNum_}function Qn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new On(n.pieces_,e)}function ix(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function dw(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function _N(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new On(e,0)}function yr(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof On)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new On(t,0)}function Jt(n){return n.pieceNum_>=n.pieces_.length}function Gs(n,e){const t=Xt(n),r=Xt(e);if(null===t)return e;if(t===r)return Gs(Qn(n),Qn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function OU(n,e){const t=dw(n,0),r=dw(e,0);for(let i=0;i<t.length&&i<r.length;i++){const a=Fp(t[i],r[i]);if(0!==a)return a}return t.length===r.length?0:t.length<r.length?-1:1}function sx(n,e){if(kh(n)!==kh(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function wa(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(kh(n)>kh(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class LU{constructor(e,t){this.errorPrefix_=t,this.parts_=dw(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,L.ug)(this.parts_[r]);yN(this)}}function yN(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Up(n))}function Up(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class ox extends pN{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new ox}getInitialEvent(e){return(0,L.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const hw=1e3;let LC,Vp=(()=>{class n extends fN{constructor(t,r,i,a,l,h,g,v){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=l,this.authTokenProvider_=h,this.appCheckTokenProvider_=g,this.authOverride_=v,this.id=n.nextPersistentConnectionId_++,this.log_=aw("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=hw,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,v&&!(0,L.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ox.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&PC.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,l={r:a,a:t,b:r};this.log_((0,L.Wl)(l)),(0,L.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new L.BH,i={p:t._path.toString(),q:t._queryObject};return this.outstandingGets_.push({action:"g",request:i,onComplete:h=>{const g=h.d;"ok"===h.s?r.resolve(g):r.reject(g)}}),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const l=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+l),this.listens.has(h)||this.listens.set(h,new Map),(0,L.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,L.hu)(!this.listens.get(h).has(l),"listen() called twice for same path/queryId.");const g={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(h).set(l,g),this.connected_&&this.sendListen_(g)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const l={p:i};t.tag&&(l.q=r._queryObject,l.t=t.tag),l.h=t.hashFn(),this.sendRequest("q",l,g=>{const v=g.d,T=g.s;n.warnOnListenWarnings_(v,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",g),"ok"!==T&&this.removeListen_(i,a),t.onComplete&&t.onComplete(T,v))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,L.r3)(t,"w")){const i=(0,L.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();ys(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,L.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,L.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const l=a.s,h=a.d||"error";this.authToken_===t&&("ok"===l?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,L.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const l={p:t};a&&(l.q=i,l.t=a),this.sendRequest("n",l)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const l={p:r,d:i};this.log_("onDisconnect "+t,l),this.sendRequest(t,l,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,l){this.initConnection_();const h={p:r,d:i};void 0!==l&&(h.h=l),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(l.s,l.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,L.Wl)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):KA("Unrecognized action received from server: "+(0,L.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,L.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=hw,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=hw,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=hw),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,me.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),l=t.id+":"+n.nextConnectionId_++,h=t.lastSessionId;let g=!1,v=null;const T=function(){v?v.close():(g=!0,a())};t.realtime_={close:T,sendRequest:function(U){(0,L.hu)(v,"sendRequest call when we're not connected not allowed."),v.sendRequest(U)}};const k=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[U,K]=yield Promise.all([t.authTokenProvider_.getToken(k),t.appCheckTokenProvider_.getToken(k)]);g?Oi("getToken() completed but was canceled"):(Oi("getToken() completed. Creating connection."),t.authToken_=U&&U.accessToken,t.appCheckToken_=K&&K.token,v=new hN(l,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,he=>{ys(he+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},h))}catch(U){t.log_("Failed to get token: "+U),g||(t.repoInfo_.nodeAdmin&&ys(U),T())}}})()}interrupt(t){Oi("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Oi("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,L.xb)(this.interruptReasons_)&&(this.reconnectDelay_=hw,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(l=>ZA(l)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new On(t).toString();let a;if(this.listens.has(i)){const l=this.listens.get(i);a=l.get(r),l.delete(r),0===l.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){Oi("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Oi("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,L.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+qA.replace(/\./g,"-")]=1,(0,L.uI)()?t["framework.cordova"]=1:(0,L.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=PC.getInstance().currentlyOnline();return(0,L.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class sn{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new sn(e,t)}}class OC{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new sn(jc,e),i=new sn(jc,t);return 0!==this.compare(r,i)}minPost(){return sn.MIN}}class EN extends OC{static get __EMPTY_NODE(){return LC}static set __EMPTY_NODE(e){LC=e}compare(e,t){return Fp(e.name,t.name)}isDefinedOn(e){throw(0,L.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return sn.MIN}maxPost(){return new sn(Sl,LC)}makePost(e,t){return(0,L.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new sn(e,LC)}toString(){return".key"}}const Al=new EN;class FC{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,i&&(l*=-1),l<0)e=this.isReverse_?e.left:e.right;else{if(0===l){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let ux,_u=(()=>{class n{constructor(t,r,i,a,l){this.key=t,this.value=r,this.color=null!=i?i:n.RED,this.left=null!=a?a:ho.EMPTY_NODE,this.right=null!=l?l:ho.EMPTY_NODE}copy(t,r,i,a,l){return new n(null!=t?t:this.key,null!=r?r:this.value,null!=i?i:this.color,null!=a?a:this.left,null!=l?l:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const l=i(t,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===l?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return ho.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return ho.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class ho{constructor(e,t=ho.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new ho(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,_u.BLACK,null,null))}remove(e){return new ho(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,_u.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new FC(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new FC(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new FC(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new FC(this.root_,null,this.comparator_,!0,e)}}function GU(n,e){return Fp(n.name,e.name)}function ax(n,e){return Fp(n,e)}ho.EMPTY_NODE=new class HU{copy(e,t,r,i,a){return this}insert(e,t,r){return new _u(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const IN=function(n){return"number"==typeof n?"number:"+jk(n):"string:"+n},bN=function(n){if(n.isLeafNode()){const e=n.val();(0,L.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,L.r3)(e,".sv"),"Priority must be a string or number.")}else(0,L.hu)(n===ux||n.isEmpty(),"priority of unexpected type.");(0,L.hu)(n===ux||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let CN,TN,DN,b_=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,L.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),bN(this.priorityNode_)}static set __childrenNodeConstructor(t){CN=t}static get __childrenNodeConstructor(){return CN}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Jt(t)?this:".priority"===Xt(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=Xt(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,L.hu)(".priority"!==i||1===kh(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Qn(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+IN(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?jk(this.value_):this.value_,this.lazyHash_=Fk(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,L.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),l=n.VALUE_TYPE_ORDER.indexOf(i);return(0,L.hu)(a>=0,"Unknown leaf type: "+r),(0,L.hu)(l>=0,"Unknown leaf type: "+i),a===l?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:l-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const sr=new class KU extends OC{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?Fp(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return sn.MIN}maxPost(){return new sn(Sl,new b_("[PRIORITY-POST]",DN))}makePost(e,t){const r=TN(e);return new sn(t,new b_("[PRIORITY-POST]",r))}toString(){return".priority"}},ZU=Math.log(2);class YU{constructor(e){this.count=parseInt(Math.log(e+1)/ZU,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const UC=function(n,e,t,r){n.sort(e);const i=function(g,v){const T=v-g;let S,k;if(0===T)return null;if(1===T)return S=n[g],k=t?t(S):S,new _u(k,S.node,_u.BLACK,null,null);{const U=parseInt(T/2,10)+g,K=i(g,U),he=i(U+1,v);return S=n[U],k=t?t(S):S,new _u(k,S.node,_u.BLACK,K,he)}},h=function(g){let v=null,T=null,S=n.length;const k=function(K,he){const be=S-K,lt=S;S-=K;const ft=i(be+1,lt),ct=n[be],ht=t?t(ct):ct;U(new _u(ht,ct.node,he,null,ft))},U=function(K){v?(v.left=K,v=K):(T=K,v=K)};for(let K=0;K<g.count;++K){const he=g.nextBitIsOne(),be=Math.pow(2,g.count-(K+1));he?k(be,_u.BLACK):(k(be,_u.BLACK),k(be,_u.RED))}return T}(new YU(n.length));return new ho(r||e,h)};let lx;const C_={};class $c{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,L.hu)(C_&&sr,"ChildrenNode.ts has not been loaded"),lx=lx||new $c({".priority":C_},{".priority":sr}),lx}get(e){const t=(0,L.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ho?t:null}hasIndex(e){return(0,L.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,L.hu)(e!==Al,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(sn.Wrap);let h,l=a.getNext();for(;l;)i=i||e.isDefinedOn(l.node),r.push(l),l=a.getNext();h=i?UC(r,e.getCompare()):C_;const g=e.toString(),v=Object.assign({},this.indexSet_);v[g]=e;const T=Object.assign({},this.indexes_);return T[g]=h,new $c(T,v)}addToIndexes(e,t){const r=(0,L.UI)(this.indexes_,(i,a)=>{const l=(0,L.DV)(this.indexSet_,a);if((0,L.hu)(l,"Missing index implementation for "+a),i===C_){if(l.isDefinedOn(e.node)){const h=[],g=t.getIterator(sn.Wrap);let v=g.getNext();for(;v;)v.name!==e.name&&h.push(v),v=g.getNext();return h.push(e),UC(h,l.getCompare())}return C_}{const h=t.get(e.name);let g=i;return h&&(g=g.remove(new sn(e.name,h))),g.insert(e,e.node)}});return new $c(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,L.UI)(this.indexes_,i=>{if(i===C_)return i;{const a=t.get(e.name);return a?i.remove(new sn(e.name,a)):i}});return new $c(r,this.indexSet_)}}let fw,zt=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&bN(this.priorityNode_),this.children_.isEmpty()&&(0,L.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return fw||(fw=new n(new ho(ax),null,$c.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||fw}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?fw:r}}getChild(t){const r=Xt(t);return null===r?this:this.getImmediateChild(r).getChild(Qn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,L.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new sn(t,r);let a,l;r.isEmpty()?(a=this.children_.remove(t),l=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),l=this.indexMap_.addToIndexes(i,this.children_));const h=a.isEmpty()?fw:this.priorityNode_;return new n(a,h,l)}}updateChild(t,r){const i=Xt(t);if(null===i)return r;{(0,L.hu)(".priority"!==Xt(t)||1===kh(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild(Qn(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,l=!0;if(this.forEachChild(sr,(h,g)=>{r[h]=g.val(t),i++,l&&n.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):l=!1}),!t&&l&&a<2*i){const h=[];for(const g in r)h[g]=r[g];return h}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+IN(this.getPriority().val())+":"),this.forEachChild(sr,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":Fk(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const l=a.getPredecessorKey(new sn(t,r));return l?l.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new sn(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new sn(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,sn.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)<0;)a.getNext(),l=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,sn.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)>0;)a.getNext(),l=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===pw?-1:0}withIndex(t){if(t===Al||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Al||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(sr),a=r.getIterator(sr);let l=i.getNext(),h=a.getNext();for(;l&&h;){if(l.name!==h.name||!l.node.equals(h.node))return!1;l=i.getNext(),h=a.getNext()}return null===l&&null===h}return!1}return!1}}resolveIndex_(t){return t===Al?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const pw=new class QU extends zt{constructor(){super(new ho(ax),zt.EMPTY_NODE,$c.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return zt.EMPTY_NODE}isEmpty(){return!1}};function Rr(n,e=null){if(null===n)return zt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,L.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new b_(n,Rr(e));if(n instanceof Array){let t=zt.EMPTY_NODE;return Li(n,(r,i)=>{if((0,L.r3)(n,r)&&"."!==r.substring(0,1)){const a=Rr(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(Rr(e))}{const t=[];let r=!1;if(Li(n,(l,h)=>{if("."!==l.substring(0,1)){const g=Rr(h);g.isEmpty()||(r=r||!g.getPriority().isEmpty(),t.push(new sn(l,g)))}}),0===t.length)return zt.EMPTY_NODE;const a=UC(t,GU,l=>l.name,ax);if(r){const l=UC(t,sr.getCompare());return new zt(a,Rr(e),new $c({".priority":l},{".priority":sr}))}return new zt(a,Rr(e),$c.Default)}}Object.defineProperties(sn,{MIN:{value:new sn(jc,zt.EMPTY_NODE)},MAX:{value:new sn(Sl,pw)}}),EN.__EMPTY_NODE=zt.EMPTY_NODE,b_.__childrenNodeConstructor=zt,function WU(n){ux=n}(pw),function zU(n){DN=n}(pw),function qU(n){TN=n}(Rr);class cx extends OC{constructor(e){super(),this.indexPath_=e,(0,L.hu)(!Jt(e)&&".priority"!==Xt(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?Fp(e.name,t.name):a}makePost(e,t){const r=Rr(e),i=zt.EMPTY_NODE.updateChild(this.indexPath_,r);return new sn(t,i)}maxPost(){const e=zt.EMPTY_NODE.updateChild(this.indexPath_,pw);return new sn(Sl,e)}toString(){return dw(this.indexPath_,0).join("/")}}const dx=new class JU extends OC{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?Fp(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return sn.MIN}maxPost(){return sn.MAX}makePost(e,t){const r=Rr(e);return new sn(t,r)}toString(){return".value"}},T_="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",eV=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const a=new Array(8);for(i=7;i>=0;i--)a[i]=T_.charAt(t%64),t=Math.floor(t/64);(0,L.hu)(0===t,"Cannot push at time == 0");let l=a.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)l+=T_.charAt(e[i]);return(0,L.hu)(20===l.length,"nextPushId: Length should be 20."),l}}(),xN=function(n){if(n===""+YA)return"-";const e=MC(n);if(null!=e)return""+(e+1);const t=new Array(n.length);for(let l=0;l<t.length;l++)t[l]=n.charAt(l);if(t.length<786)return t.push("-"),t.join("");let r=t.length-1;for(;r>=0&&"z"===t[r];)r--;if(-1===r)return Sl;const a=T_.charAt(T_.indexOf(t[r])+1);return t[r]=a,t.slice(0,r+1).join("")},RN=function(n){if(n===""+$k)return jc;const e=MC(n);if(null!=e)return""+(e-1);const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=n.charAt(r);return"-"===t[t.length-1]?1===t.length?""+YA:(delete t[t.length-1],t.join("")):(t[t.length-1]=T_.charAt(T_.indexOf(t[t.length-1])-1),t.join("")+"z".repeat(786-t.length))};function MN(n){return{type:"value",snapshotNode:n}}function D_(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function gw(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function mw(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class fx{constructor(e){this.index_=e}updateChild(e,t,r,i,a,l){(0,L.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(i).equals(r.getChild(i))&&h.isEmpty()===r.isEmpty()||(null!=l&&(r.isEmpty()?e.hasChild(t)?l.trackChildChange(gw(t,h)):(0,L.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?l.trackChildChange(D_(t,r)):l.trackChildChange(mw(t,r,h))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(sr,(i,a)=>{t.hasChild(i)||r.trackChildChange(gw(i,a))}),t.isLeafNode()||t.forEachChild(sr,(i,a)=>{if(e.hasChild(i)){const l=e.getImmediateChild(i);l.equals(a)||r.trackChildChange(mw(i,a,l))}else r.trackChildChange(D_(i,a))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?zt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class _w{constructor(e){this.indexedFilter_=new fx(e.getIndex()),this.index_=e.getIndex(),this.startPost_=_w.getStartPost_(e),this.endPost_=_w.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,r,i,a,l){return this.matches(new sn(t,r))||(r=zt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,a,l)}updateFullNode(e,t,r){t.isLeafNode()&&(t=zt.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(zt.EMPTY_NODE);const a=this;return t.forEachChild(sr,(l,h)=>{a.matches(new sn(l,h))||(i=i.updateImmediateChild(l,zt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class nV{constructor(e){this.rangedFilter_=new _w(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,r,i,a,l){return this.rangedFilter_.matches(new sn(t,r))||(r=zt.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,a,l):this.fullLimitUpdateChild_(e,t,r,a,l)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=zt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let a;i=zt.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;a.hasNext()&&l<this.limit_;){const h=a.getNext();let g;if(g=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),h)<=0:this.index_.compare(h,this.rangedFilter_.getEndPost())<=0,!g)break;i=i.updateImmediateChild(h.name,h.node),l++}}else{let a,l,h,g;if(i=t.withIndex(this.index_),i=i.updatePriority(zt.EMPTY_NODE),this.reverse_){g=i.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost();const S=this.index_.getCompare();h=(k,U)=>S(U,k)}else g=i.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),h=this.index_.getCompare();let v=0,T=!1;for(;g.hasNext();){const S=g.getNext();!T&&h(a,S)<=0&&(T=!0),T&&v<this.limit_&&h(S,l)<=0?v++:i=i.updateImmediateChild(S.name,zt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,a){let l;if(this.reverse_){const S=this.index_.getCompare();l=(k,U)=>S(U,k)}else l=this.index_.getCompare();const h=e;(0,L.hu)(h.numChildren()===this.limit_,"");const g=new sn(t,r),v=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),T=this.rangedFilter_.matches(g);if(h.hasChild(t)){const S=h.getImmediateChild(t);let k=i.getChildAfterChild(this.index_,v,this.reverse_);for(;null!=k&&(k.name===t||h.hasChild(k.name));)k=i.getChildAfterChild(this.index_,k,this.reverse_);const U=null==k?1:l(k,g);if(T&&!r.isEmpty()&&U>=0)return null!=a&&a.trackChildChange(mw(t,r,S)),h.updateImmediateChild(t,r);{null!=a&&a.trackChildChange(gw(t,S));const he=h.updateImmediateChild(t,zt.EMPTY_NODE);return null!=k&&this.rangedFilter_.matches(k)?(null!=a&&a.trackChildChange(D_(k.name,k.node)),he.updateImmediateChild(k.name,k.node)):he}}return r.isEmpty()?e:T&&l(v,g)>=0?(null!=a&&(a.trackChildChange(gw(v.name,v.node)),a.trackChildChange(D_(t,r))),h.updateImmediateChild(t,r).updateImmediateChild(v.name,zt.EMPTY_NODE)):e}}class VC{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=sr}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,L.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,L.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:jc}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,L.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,L.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Sl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,L.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===sr}copy(){const e=new VC;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function px(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function gx(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function BC(n,e){const t=n.copy();return t.index_=e,t}function kN(n){const e={};if(n.isDefault())return e;let t;return n.index_===sr?t="$priority":n.index_===dx?t="$value":n.index_===Al?t="$key":((0,L.hu)(n.index_ instanceof cx,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,L.Wl)(t),n.startSet_&&(e.startAt=(0,L.Wl)(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+(0,L.Wl)(n.indexStartName_))),n.endSet_&&(e.endAt=(0,L.Wl)(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+(0,L.Wl)(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function NN(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==sr&&(e.i=n.index_.toString()),e}class jC extends fN{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=aw("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,L.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const l=jC.getListenId_(e,r),h={};this.listens_[l]=h;const g=kN(e._queryParams);this.restRequest_(a+".json",g,(v,T)=>{let S=T;if(404===v&&(S=null,v=null),null===v&&this.onDataUpdate_(a,S,!1,r),(0,L.DV)(this.listens_,l)===h){let k;k=v?401===v?"permission_denied":"rest_error:"+v:"ok",i(k,null)}})}unlisten(e,t){const r=jC.getListenId_(e,t);delete this.listens_[r]}get(e){const t=kN(e._queryParams),r=e._path.toString(),i=new L.BH;return this.restRequest_(r+".json",t,(a,l)=>{let h=l;404===a&&(h=null,a=null),null===a?(this.onDataUpdate_(r,h,!1,null),i.resolve(h)):i.reject(new Error(h))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,L.xO)(t);this.log_("Sending REST request for "+l);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&4===h.readyState){this.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);let g=null;if(h.status>=200&&h.status<300){try{g=(0,L.cI)(h.responseText)}catch(v){ys("Failed to parse JSON response for "+l+": "+h.responseText)}r(null,g)}else 401!==h.status&&404!==h.status&&ys("Got unsuccessful REST response for "+l+" Status: "+h.status),r(h.status);r=null}},h.open("GET",l,!0),h.send()})}}class uV{constructor(){this.rootNode_=zt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function $C(){return{value:null,children:new Map}}function S_(n,e,t){if(Jt(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=Xt(e);n.children.has(r)||n.children.set(r,$C()),S_(n.children.get(r),e=Qn(e),t)}}function mx(n,e){if(Jt(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(sr,(r,i)=>{S_(n,new On(r),i)}),mx(n,e)}}if(n.children.size>0){const t=Xt(e);return e=Qn(e),n.children.has(t)&&mx(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function _x(n,e,t){null!==n.value?t(e,n.value):function lV(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{_x(i,new On(e.toString()+"/"+r),t)})}class cV{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Li(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class fV{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new cV(e);const r=1e4+2e4*Math.random();lw(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Li(e,(i,a)=>{a>0&&(0,L.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),lw(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ea=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ea||(Ea={})),Ea))();function wx(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class HC{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ea.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Jt(this.path)){if(null!=this.affectedTree.value)return(0,L.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new On(e));return new HC(Cn(),t,this.revert)}}return(0,L.hu)(Xt(this.path)===e,"operationForChild called for unrelated child."),new HC(Qn(this.path),this.affectedTree,this.revert)}}class yw{constructor(e,t){this.source=e,this.path=t,this.type=Ea.LISTEN_COMPLETE}operationForChild(e){return Jt(this.path)?new yw(this.source,Cn()):new yw(this.source,Qn(this.path))}}class Bp{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ea.OVERWRITE}operationForChild(e){return Jt(this.path)?new Bp(this.source,Cn(),this.snap.getImmediateChild(e)):new Bp(this.source,Qn(this.path),this.snap)}}class A_{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ea.MERGE}operationForChild(e){if(Jt(this.path)){const t=this.children.subtree(new On(e));return t.isEmpty()?null:t.value?new Bp(this.source,Cn(),t.value):new A_(this.source,Cn(),t)}return(0,L.hu)(Xt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new A_(this.source,Qn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Nh{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Jt(e))return this.isFullyInitialized()&&!this.filtered_;const t=Xt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class pV{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function vw(n,e,t,r,i,a){const l=r.filter(h=>h.type===t);l.sort((h,g)=>function _V(n,e,t){if(null==e.childName||null==t.childName)throw(0,L.g5)("Should only compare child_ events.");const r=new sn(e.childName,e.snapshotNode),i=new sn(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,h,g)),l.forEach(h=>{const g=function mV(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,h,a);i.forEach(v=>{v.respondsTo(h.type)&&e.push(v.createEvent(g,n.query_))})})}function GC(n,e){return{eventCache:n,serverCache:e}}function ww(n,e,t,r){return GC(new Nh(e,t,r),n.serverCache)}function ON(n,e,t,r){return GC(n.eventCache,new Nh(e,t,r))}function WC(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function jp(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let Ex;class or{constructor(e,t=(()=>(Ex||(Ex=new ho(nU)),Ex))()){this.value=e,this.children=t}static fromObject(e){let t=new or(null);return Li(e,(r,i)=>{t=t.set(new On(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Cn(),value:this.value};if(Jt(e))return null;{const r=Xt(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue(Qn(e),t);return null!=a?{path:yr(new On(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Jt(e))return this;{const t=Xt(e),r=this.children.get(t);return null!==r?r.subtree(Qn(e)):new or(null)}}set(e,t){if(Jt(e))return new or(t,this.children);{const r=Xt(e),a=(this.children.get(r)||new or(null)).set(Qn(e),t),l=this.children.insert(r,a);return new or(this.value,l)}}remove(e){if(Jt(e))return this.children.isEmpty()?new or(null):new or(null,this.children);{const t=Xt(e),r=this.children.get(t);if(r){const i=r.remove(Qn(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new or(null):new or(this.value,a)}return this}}get(e){if(Jt(e))return this.value;{const t=Xt(e),r=this.children.get(t);return r?r.get(Qn(e)):null}}setTree(e,t){if(Jt(e))return t;{const r=Xt(e),a=(this.children.get(r)||new or(null)).setTree(Qn(e),t);let l;return l=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new or(this.value,l)}}fold(e){return this.fold_(Cn(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(yr(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Cn(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(Jt(e))return null;{const a=Xt(e),l=this.children.get(a);return l?l.findOnPath_(Qn(e),yr(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Cn(),t)}foreachOnPath_(e,t,r){if(Jt(e))return this;{this.value&&r(t,this.value);const i=Xt(e),a=this.children.get(i);return a?a.foreachOnPath_(Qn(e),yr(t,i),r):new or(null)}}foreach(e){this.foreach_(Cn(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(yr(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class yu{constructor(e){this.writeTree_=e}static empty(){return new yu(new or(null))}}function Ew(n,e,t){if(Jt(e))return new yu(new or(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const l=Gs(i,e);return a=a.updateChild(l,t),new yu(n.writeTree_.set(i,a))}{const i=new or(t),a=n.writeTree_.setTree(e,i);return new yu(a)}}}function Ix(n,e,t){let r=n;return Li(t,(i,a)=>{r=Ew(r,yr(e,i),a)}),r}function LN(n,e){if(Jt(e))return yu.empty();{const t=n.writeTree_.setTree(e,new or(null));return new yu(t)}}function bx(n,e){return null!=$p(n,e)}function $p(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Gs(t.path,e)):null}function FN(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(sr,(r,i)=>{e.push(new sn(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new sn(r,i.value))}),e}function Ph(n,e){if(Jt(e))return n;{const t=$p(n,e);return new yu(null!=t?new or(t):n.writeTree_.subtree(e))}}function Cx(n){return n.writeTree_.isEmpty()}function x_(n,e){return UN(Cn(),n.writeTree_,e)}function UN(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,L.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=UN(yr(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(yr(n,".priority"),r)),t}}function qC(n,e){return HN(e,n)}function bV(n,e){if(n.snap)return wa(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&wa(yr(n.path,t),e))return!0;return!1}function TV(n){return n.visible}function VN(n,e,t){let r=yu.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const l=a.path;let h;if(a.snap)wa(t,l)?(h=Gs(t,l),r=Ew(r,h,a.snap)):wa(l,t)&&(h=Gs(l,t),r=Ew(r,Cn(),a.snap.getChild(h)));else{if(!a.children)throw(0,L.g5)("WriteRecord should have .snap or .children");if(wa(t,l))h=Gs(t,l),r=Ix(r,h,a.children);else if(wa(l,t))if(h=Gs(l,t),Jt(h))r=Ix(r,Cn(),a.children);else{const g=(0,L.DV)(a.children,Xt(h));if(g){const v=g.getChild(Qn(h));r=Ew(r,Cn(),v)}}}}}return r}function BN(n,e,t,r,i){if(r||i){const a=Ph(n.visibleWrites,e);return!i&&Cx(a)?t:i||null!=t||bx(a,Cn())?x_(VN(n.allWrites,function(v){return(v.visible||i)&&(!r||!~r.indexOf(v.writeId))&&(wa(v.path,e)||wa(e,v.path))},e),t||zt.EMPTY_NODE):null}{const a=$p(n.visibleWrites,e);if(null!=a)return a;{const l=Ph(n.visibleWrites,e);return Cx(l)?t:null!=t||bx(l,Cn())?x_(l,t||zt.EMPTY_NODE):null}}}function zC(n,e,t,r){return BN(n.writeTree,n.treePath,e,t,r)}function Tx(n,e){return function DV(n,e,t){let r=zt.EMPTY_NODE;const i=$p(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(sr,(a,l)=>{r=r.updateImmediateChild(a,l)}),r;if(t){const a=Ph(n.visibleWrites,e);return t.forEachChild(sr,(l,h)=>{const g=x_(Ph(a,new On(l)),h);r=r.updateImmediateChild(l,g)}),FN(a).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}return FN(Ph(n.visibleWrites,e)).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}(n.writeTree,n.treePath,e)}function jN(n,e,t,r){return function SV(n,e,t,r,i){(0,L.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=yr(e,t);if(bx(n.visibleWrites,a))return null;{const l=Ph(n.visibleWrites,a);return Cx(l)?i.getChild(t):x_(l,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function KC(n,e){return function xV(n,e){return $p(n.visibleWrites,e)}(n.writeTree,yr(n.treePath,e))}function Dx(n,e,t){return function AV(n,e,t,r){const i=yr(e,t),a=$p(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?x_(Ph(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function $N(n,e){return HN(yr(n.treePath,e),n.writeTree)}function HN(n,e){return{treePath:n,writeTree:e}}class NV{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,L.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,L.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,mw(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,gw(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,D_(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,L.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,mw(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const GN=new class PV{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class Sx{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Nh(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Dx(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:jp(this.viewCache_),a=function kV(n,e,t,r,i,a){return function RV(n,e,t,r,i,a,l){let h;const g=Ph(n.visibleWrites,e),v=$p(g,Cn());if(null!=v)h=v;else{if(null==t)return[];h=x_(g,t)}if(h=h.withIndex(l),h.isEmpty()||h.isLeafNode())return[];{const T=[],S=l.getCompare(),k=a?h.getReverseIteratorFrom(r,l):h.getIteratorFrom(r,l);let U=k.getNext();for(;U&&T.length<i;)0!==S(U,r)&&T.push(U),U=k.getNext();return T}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function WN(n,e,t,r,i,a){const l=e.eventCache;if(null!=KC(r,t))return e;{let h,g;if(Jt(t))if((0,L.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const v=jp(e),S=Tx(r,v instanceof zt?v:zt.EMPTY_NODE);h=n.filter.updateFullNode(e.eventCache.getNode(),S,a)}else{const v=zC(r,jp(e));h=n.filter.updateFullNode(e.eventCache.getNode(),v,a)}else{const v=Xt(t);if(".priority"===v){(0,L.hu)(1===kh(t),"Can't have a priority with additional path components");const T=l.getNode();g=e.serverCache.getNode();const S=jN(r,t,T,g);h=null!=S?n.filter.updatePriority(T,S):l.getNode()}else{const T=Qn(t);let S;if(l.isCompleteForChild(v)){g=e.serverCache.getNode();const k=jN(r,t,l.getNode(),g);S=null!=k?l.getNode().getImmediateChild(v).updateChild(T,k):l.getNode().getImmediateChild(v)}else S=Dx(r,v,e.serverCache);h=null!=S?n.filter.updateChild(l.getNode(),v,S,T,i,a):l.getNode()}}return ww(e,h,l.isFullyInitialized()||Jt(t),n.filter.filtersNodes())}}function ZC(n,e,t,r,i,a,l,h){const g=e.serverCache;let v;const T=l?n.filter:n.filter.getIndexedFilter();if(Jt(t))v=T.updateFullNode(g.getNode(),r,null);else if(T.filtersNodes()&&!g.isFiltered()){const U=g.getNode().updateChild(t,r);v=T.updateFullNode(g.getNode(),U,null)}else{const U=Xt(t);if(!g.isCompleteForPath(t)&&kh(t)>1)return e;const K=Qn(t),be=g.getNode().getImmediateChild(U).updateChild(K,r);v=".priority"===U?T.updatePriority(g.getNode(),be):T.updateChild(g.getNode(),U,be,K,GN,null)}const S=ON(e,v,g.isFullyInitialized()||Jt(t),T.filtersNodes());return WN(n,S,t,i,new Sx(i,S,a),h)}function Ax(n,e,t,r,i,a,l){const h=e.eventCache;let g,v;const T=new Sx(i,e,a);if(Jt(t))v=n.filter.updateFullNode(e.eventCache.getNode(),r,l),g=ww(e,v,!0,n.filter.filtersNodes());else{const S=Xt(t);if(".priority"===S)v=n.filter.updatePriority(e.eventCache.getNode(),r),g=ww(e,v,h.isFullyInitialized(),h.isFiltered());else{const k=Qn(t),U=h.getNode().getImmediateChild(S);let K;if(Jt(k))K=r;else{const he=T.getCompleteChild(S);K=null!=he?".priority"===ix(k)&&he.getChild(_N(k)).isEmpty()?he:he.updateChild(k,r):zt.EMPTY_NODE}g=U.equals(K)?e:ww(e,n.filter.updateChild(h.getNode(),S,K,k,T,l),h.isFullyInitialized(),n.filter.filtersNodes())}}return g}function qN(n,e){return n.eventCache.isCompleteForChild(e)}function zN(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function xx(n,e,t,r,i,a,l,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let v,g=e;v=Jt(t)?r:new or(null).setTree(t,r);const T=e.serverCache.getNode();return v.children.inorderTraversal((S,k)=>{if(T.hasChild(S)){const K=zN(0,e.serverCache.getNode().getImmediateChild(S),k);g=ZC(n,g,new On(S),K,i,a,l,h)}}),v.children.inorderTraversal((S,k)=>{const U=!e.serverCache.isCompleteForChild(S)&&null===k.value;if(!T.hasChild(S)&&!U){const he=zN(0,e.serverCache.getNode().getImmediateChild(S),k);g=ZC(n,g,new On(S),he,i,a,l,h)}}),g}class HV{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new fx(r.getIndex()),a=function rV(n){return n.loadsAllData()?new fx(n.getIndex()):n.hasLimit()?new nV(n):new _w(n)}(r);this.processor_=function OV(n){return{filter:n}}(a);const l=t.serverCache,h=t.eventCache,g=i.updateFullNode(zt.EMPTY_NODE,l.getNode(),null),v=a.updateFullNode(zt.EMPTY_NODE,h.getNode(),null),T=new Nh(g,l.isFullyInitialized(),i.filtersNodes()),S=new Nh(v,h.isFullyInitialized(),a.filtersNodes());this.viewCache_=GC(S,T),this.eventGenerator_=new pV(this.query_)}get query(){return this.query_}}function qV(n,e){const t=jp(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Jt(e)&&!t.getImmediateChild(Xt(e)).isEmpty())?t.getChild(e):null}function KN(n){return 0===n.eventRegistrations_.length}function ZN(n,e,t){const r=[];if(t){(0,L.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(a=>{const l=a.createCancelEvent(t,i);l&&r.push(l)})}if(e){let i=[];for(let a=0;a<n.eventRegistrations_.length;++a){const l=n.eventRegistrations_[a];if(l.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(a+1));break}}else i.push(l)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function YN(n,e,t,r){e.type===Ea.MERGE&&null!==e.source.queryId&&((0,L.hu)(jp(n.viewCache_),"We should always have a full cache before handling merges"),(0,L.hu)(WC(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function FV(n,e,t,r,i){const a=new NV;let l,h;if(t.type===Ea.OVERWRITE){const v=t;v.source.fromUser?l=Ax(n,e,v.path,v.snap,r,i,a):((0,L.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered()&&!Jt(v.path),l=ZC(n,e,v.path,v.snap,r,i,h,a))}else if(t.type===Ea.MERGE){const v=t;v.source.fromUser?l=function VV(n,e,t,r,i,a,l){let h=e;return r.foreach((g,v)=>{const T=yr(t,g);qN(e,Xt(T))&&(h=Ax(n,h,T,v,i,a,l))}),r.foreach((g,v)=>{const T=yr(t,g);qN(e,Xt(T))||(h=Ax(n,h,T,v,i,a,l))}),h}(n,e,v.path,v.children,r,i,a):((0,L.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered(),l=xx(n,e,v.path,v.children,r,i,h,a))}else if(t.type===Ea.ACK_USER_WRITE){const v=t;l=v.revert?function $V(n,e,t,r,i,a){let l;if(null!=KC(r,t))return e;{const h=new Sx(r,e,i),g=e.eventCache.getNode();let v;if(Jt(t)||".priority"===Xt(t)){let T;if(e.serverCache.isFullyInitialized())T=zC(r,jp(e));else{const S=e.serverCache.getNode();(0,L.hu)(S instanceof zt,"serverChildren would be complete if leaf node"),T=Tx(r,S)}v=n.filter.updateFullNode(g,T,a)}else{const T=Xt(t);let S=Dx(r,T,e.serverCache);null==S&&e.serverCache.isCompleteForChild(T)&&(S=g.getImmediateChild(T)),v=null!=S?n.filter.updateChild(g,T,S,Qn(t),h,a):e.eventCache.getNode().hasChild(T)?n.filter.updateChild(g,T,zt.EMPTY_NODE,Qn(t),h,a):g,v.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=zC(r,jp(e)),l.isLeafNode()&&(v=n.filter.updateFullNode(v,l,a)))}return l=e.serverCache.isFullyInitialized()||null!=KC(r,Cn()),ww(e,v,l,n.filter.filtersNodes())}}(n,e,v.path,r,i,a):function BV(n,e,t,r,i,a,l){if(null!=KC(i,t))return e;const h=e.serverCache.isFiltered(),g=e.serverCache;if(null!=r.value){if(Jt(t)&&g.isFullyInitialized()||g.isCompleteForPath(t))return ZC(n,e,t,g.getNode().getChild(t),i,a,h,l);if(Jt(t)){let v=new or(null);return g.getNode().forEachChild(Al,(T,S)=>{v=v.set(new On(T),S)}),xx(n,e,t,v,i,a,h,l)}return e}{let v=new or(null);return r.foreach((T,S)=>{const k=yr(t,T);g.isCompleteForPath(k)&&(v=v.set(T,g.getNode().getChild(k)))}),xx(n,e,t,v,i,a,h,l)}}(n,e,v.path,v.affectedTree,r,i,a)}else{if(t.type!==Ea.LISTEN_COMPLETE)throw(0,L.g5)("Unknown operation type: "+t.type);l=function jV(n,e,t,r,i){const a=e.serverCache;return WN(n,ON(e,a.getNode(),a.isFullyInitialized()||Jt(t),a.isFiltered()),t,r,GN,i)}(n,e,t.path,r,a)}const g=a.getChanges();return function UV(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=WC(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(MN(WC(e)))}}(e,l,g),{viewCache:l,changes:g}}(n.processor_,i,e,t,r);return function LV(n,e){(0,L.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,L.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,L.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,QN(n,a.changes,a.viewCache.eventCache.getNode(),null)}function QN(n,e,t,r){return function gV(n,e,t,r){const i=[],a=[];return e.forEach(l=>{"child_changed"===l.type&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&a.push(function tV(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(l.childName,l.snapshotNode))}),vw(n,i,"child_removed",e,r,t),vw(n,i,"child_added",e,r,t),vw(n,i,"child_moved",a,r,t),vw(n,i,"child_changed",e,r,t),vw(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let YC,XC;class XN{constructor(){this.views=new Map}}function Rx(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,L.hu)(null!=a,"SyncTree gave us an op for an invalid query."),YN(a,e,t,r)}{let a=[];for(const l of n.views.values())a=a.concat(YN(l,e,t,r));return a}}function JN(n,e,t,r,i){const l=n.views.get(e._queryIdentifier);if(!l){let h=zC(t,i?r:null),g=!1;h?g=!0:r instanceof zt?(h=Tx(t,r),g=!1):(h=zt.EMPTY_NODE,g=!1);const v=GC(new Nh(h,g,!1),new Nh(r,i,!1));return new HV(e,v)}return l}function eP(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Oh(n,e){let t=null;for(const r of n.views.values())t=t||qV(r,e);return t}function tP(n,e){return e._queryParams.loadsAllData()?QC(n):n.views.get(e._queryIdentifier)}function nP(n,e){return null!=tP(n,e)}function Lh(n){return null!=QC(n)}function QC(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let nB=1;class rP{constructor(e){this.listenProvider_=e,this.syncPointTree_=new or(null),this.pendingWriteTree_=function MV(){return{visibleWrites:yu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Mx(n,e,t,r,i){return function vV(n,e,t,r,i){(0,L.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Ew(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?R_(n,new Bp({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Fh(n,e,t=!1){const r=function EV(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function IV(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);(0,L.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,l=n.allWrites.length-1;for(;i&&l>=0;){const h=n.allWrites[l];h.visible&&(l>=t&&bV(h,r.path)?i=!1:wa(r.path,h.path)&&(a=!0)),l--}return!!i&&(a?(function CV(n){n.visibleWrites=VN(n.allWrites,TV,Cn()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=LN(n.visibleWrites,r.path):Li(r.children,g=>{n.visibleWrites=LN(n.visibleWrites,yr(r.path,g))}),!0))}(n.pendingWriteTree_,e)){let a=new or(null);return null!=r.snap?a=a.set(Cn(),!0):Li(r.children,l=>{a=a.set(new On(l),!0)}),R_(n,new HC(r.path,a,t))}return[]}function Iw(n,e,t){return R_(n,new Bp({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function JC(n,e,t,r,i=!1){const a=e._path,l=n.syncPointTree_.get(a);let h=[];if(l&&("default"===e._queryIdentifier||nP(l,e))){const g=function JV(n,e,t,r){const i=e._queryIdentifier,a=[];let l=[];const h=Lh(n);if("default"===i)for(const[g,v]of n.views.entries())l=l.concat(ZN(v,t,r)),KN(v)&&(n.views.delete(g),v.query._queryParams.loadsAllData()||a.push(v.query));else{const g=n.views.get(i);g&&(l=l.concat(ZN(g,t,r)),KN(g)&&(n.views.delete(i),g.query._queryParams.loadsAllData()||a.push(g.query)))}return h&&!Lh(n)&&a.push(new(function YV(){return(0,L.hu)(YC,"Reference.ts has not been loaded"),YC}())(e._repo,e._path)),{removed:a,events:l}}(l,e,t,r);(function QV(n){return 0===n.views.size})(l)&&(n.syncPointTree_=n.syncPointTree_.remove(a));const v=g.removed;if(h=g.events,!i){const T=-1!==v.findIndex(k=>k._queryParams.loadsAllData()),S=n.syncPointTree_.findOnPath(a,(k,U)=>Lh(U));if(T&&!S){const k=n.syncPointTree_.subtree(a);if(!k.isEmpty()){const U=function lB(n){return n.fold((e,t,r)=>{if(t&&Lh(t))return[QC(t)];{let i=[];return t&&(i=eP(t)),Li(r,(a,l)=>{i=i.concat(l)}),i}})}(k);for(let K=0;K<U.length;++K){const he=U[K],be=he.query,lt=aP(n,he);n.listenProvider_.startListening(Cw(be),bw(n,be),lt.hashFn,lt.onComplete)}}}!S&&v.length>0&&!r&&(T?n.listenProvider_.stopListening(Cw(e),null):v.forEach(k=>{const U=n.queryToTagMap.get(tT(k));n.listenProvider_.stopListening(Cw(k),U)}))}!function cB(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=tT(r),a=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(a)}}}(n,v)}return h}function iP(n,e,t,r){const i=Nx(n,r);if(null!=i){const a=Px(i),l=a.path,h=a.queryId,g=Gs(l,e);return Ox(n,l,new Bp(wx(h),g,t))}return[]}function kx(n,e,t,r=!1){const i=e._path;let a=null,l=!1;n.syncPointTree_.foreachOnPath(i,(k,U)=>{const K=Gs(k,i);a=a||Oh(U,K),l=l||Lh(U)});let g,h=n.syncPointTree_.get(i);h?(l=l||Lh(h),a=a||Oh(h,Cn())):(h=new XN,n.syncPointTree_=n.syncPointTree_.set(i,h)),null!=a?g=!0:(g=!1,a=zt.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((U,K)=>{const he=Oh(K,Cn());he&&(a=a.updateImmediateChild(U,he))}));const v=nP(h,e);if(!v&&!e._queryParams.loadsAllData()){const k=tT(e);(0,L.hu)(!n.queryToTagMap.has(k),"View does not exist, but we have a tag");const U=function dB(){return nB++}();n.queryToTagMap.set(k,U),n.tagToQueryMap.set(U,k)}let S=function XV(n,e,t,r,i,a){const l=JN(n,e,r,i,a);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),function zV(n,e){n.eventRegistrations_.push(e)}(l,t),function KV(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(sr,(a,l)=>{r.push(D_(a,l))}),t.isFullyInitialized()&&r.push(MN(t.getNode())),QN(n,r,t.getNode(),e)}(l,t)}(h,e,t,qC(n.pendingWriteTree_,i),a,g);if(!v&&!l&&!r){const k=tP(h,e);S=S.concat(function hB(n,e,t){const r=e._path,i=bw(n,e),a=aP(n,t),l=n.listenProvider_.startListening(Cw(e),i,a.hashFn,a.onComplete),h=n.syncPointTree_.subtree(r);if(i)(0,L.hu)(!Lh(h.value),"If we're adding a query, it shouldn't be shadowed");else{const g=h.fold((v,T,S)=>{if(!Jt(v)&&T&&Lh(T))return[QC(T).query];{let k=[];return T&&(k=k.concat(eP(T).map(U=>U.query))),Li(S,(U,K)=>{k=k.concat(K)}),k}});for(let v=0;v<g.length;++v){const T=g[v];n.listenProvider_.stopListening(Cw(T),bw(n,T))}}return l}(n,e,k))}return S}function eT(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(l,h)=>{const v=Oh(h,Gs(l,e));if(v)return v});return BN(i,e,a,t,!0)}function R_(n,e){return sP(e,n.syncPointTree_,null,qC(n.pendingWriteTree_,Cn()))}function sP(n,e,t,r){if(Jt(n.path))return oP(n,e,t,r);{const i=e.get(Cn());null==t&&null!=i&&(t=Oh(i,Cn()));let a=[];const l=Xt(n.path),h=n.operationForChild(l),g=e.children.get(l);if(g&&h){const v=t?t.getImmediateChild(l):null,T=$N(r,l);a=a.concat(sP(h,g,v,T))}return i&&(a=a.concat(Rx(i,n,r,t))),a}}function oP(n,e,t,r){const i=e.get(Cn());null==t&&null!=i&&(t=Oh(i,Cn()));let a=[];return e.children.inorderTraversal((l,h)=>{const g=t?t.getImmediateChild(l):null,v=$N(r,l),T=n.operationForChild(l);T&&(a=a.concat(oP(T,h,g,v)))}),i&&(a=a.concat(Rx(i,n,r,t))),a}function aP(n,e){const t=e.query,r=bw(n,t);return{hashFn:()=>(function GV(n){return n.viewCache_.serverCache.getNode()}(e)||zt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function oB(n,e,t){const r=Nx(n,t);if(r){const i=Px(r),a=i.path,l=i.queryId,h=Gs(a,e);return Ox(n,a,new yw(wx(l),h))}return[]}(n,t._path,r):function sB(n,e){return R_(n,new yw({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const a=function sU(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return JC(n,t,null,a)}}}}function bw(n,e){const t=tT(e);return n.queryToTagMap.get(t)}function tT(n){return n._path.toString()+"$"+n._queryIdentifier}function Nx(n,e){return n.tagToQueryMap.get(e)}function Px(n){const e=n.indexOf("$");return(0,L.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new On(n.substr(0,e))}}function Ox(n,e,t){const r=n.syncPointTree_.get(e);return(0,L.hu)(r,"Missing sync point for query tag that we're tracking"),Rx(r,t,qC(n.pendingWriteTree_,e),null)}function Cw(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function tB(){return(0,L.hu)(XC,"Reference.ts has not been loaded"),XC}())(n._repo,n._path):n}class Lx{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Lx(t)}node(){return this.node_}}class Fx{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=yr(this.path_,e);return new Fx(this.syncTree_,t)}node(){return eT(this.syncTree_,this.path_)}}const uP=function(n,e,t){return n&&"object"==typeof n?((0,L.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?pB(n[".sv"],e,t):"object"==typeof n[".sv"]?gB(n[".sv"],e):void(0,L.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},pB=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,L.hu)(!1,"Unexpected server value: "+n)},gB=function(n,e,t){n.hasOwnProperty("increment")||(0,L.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,L.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,L.hu)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const l=i.getValue();return"number"!=typeof l?r:l+r},lP=function(n,e,t,r){return Vx(e,new Fx(t,n),r)},Ux=function(n,e,t){return Vx(n,new Lx(e),t)};function Vx(n,e,t){const r=n.getPriority().val(),i=uP(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const l=n,h=uP(l.getValue(),e,t);return h!==l.getValue()||i!==l.getPriority().val()?new b_(h,Rr(i)):n}{const l=n;return a=l,i!==l.getPriority().val()&&(a=a.updatePriority(new b_(i))),l.forEachChild(sr,(h,g)=>{const v=Vx(g,e.getImmediateChild(h),t);v!==g&&(a=a.updateImmediateChild(h,v))}),a}}class Bx{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function nT(n,e){let t=e instanceof On?e:new On(e),r=n,i=Xt(t);for(;null!==i;){const a=(0,L.DV)(r.node.children,i)||{children:{},childCount:0};r=new Bx(i,r,a),t=Qn(t),i=Xt(t)}return r}function Hp(n){return n.node.value}function jx(n,e){n.node.value=e,$x(n)}function cP(n){return n.node.childCount>0}function rT(n,e){Li(n.node.children,(t,r)=>{e(new Bx(t,n,r))})}function dP(n,e,t,r){t&&!r&&e(n),rT(n,i=>{dP(i,e,!0,r)}),t&&r&&e(n)}function Tw(n){return new On(null===n.parent?n.name:Tw(n.parent)+"/"+n.name)}function $x(n){null!==n.parent&&function yB(n,e,t){const r=function mB(n){return void 0===Hp(n)&&!cP(n)}(t),i=(0,L.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,$x(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,$x(n))}(n.parent,n.name,n)}const vB=/[\[\].#$\/\u0000-\u001F\u007F]/,wB=/[\[\].#$\u0000-\u001F\u007F]/,Hx=10485760,iT=function(n){return"string"==typeof n&&0!==n.length&&!vB.test(n)},hP=function(n){return"string"==typeof n&&0!==n.length&&!wB.test(n)},Dw=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!RC(n)||n&&"object"==typeof n&&(0,L.r3)(n,".sv")},xl=function(n,e,t,r){r&&void 0===e||Sw((0,L.gK)(n,"value"),e,t)},Sw=function(n,e,t){const r=t instanceof On?new LU(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+Up(r));if("function"==typeof e)throw new Error(n+"contains a function "+Up(r)+" with contents = "+e.toString());if(RC(e))throw new Error(n+"contains "+e.toString()+" "+Up(r));if("string"==typeof e&&e.length>Hx/3&&(0,L.ug)(e)>Hx)throw new Error(n+"contains a string greater than "+Hx+" utf8 bytes "+Up(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(Li(e,(l,h)=>{if(".value"===l)i=!0;else if(".priority"!==l&&".sv"!==l&&(a=!0,!iT(l)))throw new Error(n+" contains an invalid key ("+l+") "+Up(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function FU(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,L.ug)(e),yN(n)})(r,l),Sw(n,h,r),function UU(n){const e=n.parts_.pop();n.byteLength_-=(0,L.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+Up(r)+" in addition to actual children.")}},fP=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,L.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];Li(e,(l,h)=>{const g=new On(l);if(Sw(i,h,yr(t,g)),".priority"===ix(g)&&!Dw(h))throw new Error(i+"contains an invalid value for '"+g.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(g)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=dw(r);for(let l=0;l<a.length;l++)if((".priority"!==a[l]||l!==a.length-1)&&!iT(a[l]))throw new Error(n+"contains an invalid key ("+a[l]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(OU);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&wa(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,a)},Gx=function(n,e,t){if(!t||void 0!==e){if(RC(e))throw new Error((0,L.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Dw(e))throw new Error((0,L.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Aw=function(n,e,t,r){if(!(r&&void 0===t||iT(t)))throw new Error((0,L.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},xw=function(n,e,t,r){if(!(r&&void 0===t||hP(t)))throw new Error((0,L.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ia=function(n,e){if(".info"===Xt(e))throw new Error(n+" failed = Can't modify data under /.info/")},pP=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!iT(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),hP(n)}(t))throw new Error((0,L.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class CB{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function sT(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!sx(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)}function gP(n,e,t){sT(n,t),mP(n,r=>sx(r,e))}function Wo(n,e,t){sT(n,t),mP(n,r=>wa(r,e)||wa(e,r))}function mP(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(TB(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function TB(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();Lp&&Oi("event: "+t.toString()),E_(r)}}}const _P="repo_interrupt";class SB{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new CB,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=$C(),this.transactionQueueTree_=new Bx,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function yP(n){const t=n.infoData_.getNode(new On(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Rw(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:yP(n)})}function vP(n,e,t,r,i){n.dataUpdateCount++;const a=new On(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(i)if(r){const g=(0,L.UI)(t,v=>Rr(v));l=function aB(n,e,t,r){const i=Nx(n,r);if(i){const a=Px(i),l=a.path,h=a.queryId,g=Gs(l,e),v=or.fromObject(t);return Ox(n,l,new A_(wx(h),g,v))}return[]}(n.serverSyncTree_,a,g,i)}else{const g=Rr(t);l=iP(n.serverSyncTree_,a,g,i)}else if(r){const g=(0,L.UI)(t,v=>Rr(v));l=function iB(n,e,t){const r=or.fromObject(t);return R_(n,new A_({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,g)}else{const g=Rr(t);l=Iw(n.serverSyncTree_,a,g)}let h=a;l.length>0&&(h=k_(n,a)),Wo(n.eventQueue_,h,l)}function wP(n,e){Wx(n,"connected",e),!1===e&&function kB(n){M_(n,"onDisconnectEvents");const e=Rw(n),t=$C();_x(n.onDisconnect_,Cn(),(i,a)=>{const l=lP(i,a,n.serverSyncTree_,e);S_(t,i,l)});let r=[];_x(t,Cn(),(i,a)=>{r=r.concat(Iw(n.serverSyncTree_,i,a));const l=Zx(n,i);k_(n,l)}),n.onDisconnect_=$C(),Wo(n.eventQueue_,Cn(),r)}(n)}function Wx(n,e,t){const r=new On("/.info/"+e),i=Rr(t);n.infoData_.updateSnapshot(r,i);const a=Iw(n.infoSyncTree_,r,i);Wo(n.eventQueue_,r,a)}function oT(n){return n.nextWriteId_++}function qx(n,e,t,r,i){M_(n,"set",{path:e.toString(),value:t,priority:r});const a=Rw(n),l=Rr(t,r),h=eT(n.serverSyncTree_,e),g=Ux(l,h,a),v=oT(n),T=Mx(n.serverSyncTree_,e,g,v,!0);sT(n.eventQueue_,T),n.server_.put(e.toString(),l.val(!0),(k,U)=>{const K="ok"===k;K||ys("set at "+e+" failed: "+k);const he=Fh(n.serverSyncTree_,v,!K);Wo(n.eventQueue_,e,he),Uh(0,i,k,U)});const S=Zx(n,e);k_(n,S),Wo(n.eventQueue_,S,[])}function NB(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&mx(n.onDisconnect_,e),Uh(0,t,r,i)})}function EP(n,e,t,r){const i=Rr(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,l)=>{"ok"===a&&S_(n.onDisconnect_,e,i),Uh(0,r,a,l)})}function zx(n,e,t){let r;r=".info"===Xt(e._path)?JC(n.infoSyncTree_,e,t):JC(n.serverSyncTree_,e,t),gP(n.eventQueue_,e._path,r)}function IP(n){n.persistentConnection_&&n.persistentConnection_.interrupt(_P)}function M_(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Oi(t,...e)}function Uh(n,e,t,r){e&&E_(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let a=i;r&&(a+=": "+r);const l=new Error(a);l.code=i,e(l)}})}function Kx(n,e,t){return eT(n.serverSyncTree_,e,t)||zt.EMPTY_NODE}function aT(n,e=n.transactionQueueTree_){if(e||uT(n,e),Hp(e)){const t=CP(n,e);(0,L.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function VB(n,e,t){const r=t.map(v=>v.currentWriteId),i=Kx(n,e,r);let a=i;const l=i.hash();for(let v=0;v<t.length;v++){const T=t[v];(0,L.hu)(0===T.status,"tryToSendTransactionQueue_: items in queue should all be run."),T.status=1,T.retryCount++;const S=Gs(e,T.path);a=a.updateChild(S,T.currentOutputSnapshotRaw)}const h=a.val(!0),g=e;n.server_.put(g.toString(),h,v=>{M_(n,"transaction put response",{path:g.toString(),status:v});let T=[];if("ok"===v){const S=[];for(let k=0;k<t.length;k++)t[k].status=2,T=T.concat(Fh(n.serverSyncTree_,t[k].currentWriteId)),t[k].onComplete&&S.push(()=>t[k].onComplete(null,!0,t[k].currentOutputSnapshotResolved)),t[k].unwatcher();uT(n,nT(n.transactionQueueTree_,e)),aT(n,n.transactionQueueTree_),Wo(n.eventQueue_,e,T);for(let k=0;k<S.length;k++)E_(S[k])}else{if("datastale"===v)for(let S=0;S<t.length;S++)t[S].status=3===t[S].status?4:0;else{ys("transaction at "+g.toString()+" failed: "+v);for(let S=0;S<t.length;S++)t[S].status=4,t[S].abortReason=v}k_(n,e)}},l)}(n,Tw(e),t)}else cP(e)&&rT(e,t=>{aT(n,t)})}function k_(n,e){const t=bP(n,e),r=Tw(t);return function BB(n,e,t){if(0===e.length)return;const r=[];let i=[];const l=e.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const g=e[h],v=Gs(t,g.path);let S,T=!1;if((0,L.hu)(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),4===g.status)T=!0,S=g.abortReason,i=i.concat(Fh(n.serverSyncTree_,g.currentWriteId,!0));else if(0===g.status)if(g.retryCount>=25)T=!0,S="maxretry",i=i.concat(Fh(n.serverSyncTree_,g.currentWriteId,!0));else{const k=Kx(n,g.path,l);g.currentInputSnapshot=k;const U=e[h].update(k.val());if(void 0!==U){Sw("transaction failed: Data returned ",U,g.path);let K=Rr(U);"object"==typeof U&&null!=U&&(0,L.r3)(U,".priority")||(K=K.updatePriority(k.getPriority()));const be=g.currentWriteId,lt=Rw(n),ft=Ux(K,k,lt);g.currentOutputSnapshotRaw=K,g.currentOutputSnapshotResolved=ft,g.currentWriteId=oT(n),l.splice(l.indexOf(be),1),i=i.concat(Mx(n.serverSyncTree_,g.path,ft,g.currentWriteId,g.applyLocally)),i=i.concat(Fh(n.serverSyncTree_,be,!0))}else T=!0,S="nodata",i=i.concat(Fh(n.serverSyncTree_,g.currentWriteId,!0))}Wo(n.eventQueue_,t,i),i=[],T&&(e[h].status=2,setTimeout(e[h].unwatcher,Math.floor(0)),e[h].onComplete&&r.push("nodata"===S?()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot):()=>e[h].onComplete(new Error(S),!1,null)))}uT(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)E_(r[h]);aT(n,n.transactionQueueTree_)}(n,CP(n,t),r),r}function bP(n,e){let t,r=n.transactionQueueTree_;for(t=Xt(e);null!==t&&void 0===Hp(r);)r=nT(r,t),t=Xt(e=Qn(e));return r}function CP(n,e){const t=[];return TP(n,e,t),t.sort((r,i)=>r.order-i.order),t}function TP(n,e,t){const r=Hp(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);rT(e,i=>{TP(n,i,t)})}function uT(n,e){const t=Hp(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,jx(e,t.length>0?t:void 0)}rT(e,r=>{uT(n,r)})}function Zx(n,e){const t=Tw(bP(n,e)),r=nT(n.transactionQueueTree_,e);return function _B(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{Yx(n,i)}),Yx(n,r),dP(r,i=>{Yx(n,i)}),t}function Yx(n,e){const t=Hp(e);if(t){const r=[];let i=[],a=-1;for(let l=0;l<t.length;l++)3===t[l].status||(1===t[l].status?((0,L.hu)(a===l-1,"All SENT items should be at beginning of queue."),a=l,t[l].status=3,t[l].abortReason="set"):((0,L.hu)(0===t[l].status,"Unexpected transaction status in abort"),t[l].unwatcher(),i=i.concat(Fh(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&r.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));-1===a?jx(e,void 0):t.length=a+1,Wo(n.eventQueue_,Tw(e),i);for(let l=0;l<r.length;l++)E_(r[l])}}const Qx=function(n,e){const t=HB(n),r=t.namespace;return"firebase.com"===t.domain&&Dl(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&Dl("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ys("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new XA(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new On(t.pathString)}},HB=function(n){let e="",t="",r="",i="",a="",l=!0,h="https",g=443;if("string"==typeof n){let v=n.indexOf("//");v>=0&&(h=n.substring(0,v-1),n=n.substring(v+2));let T=n.indexOf("/");-1===T&&(T=n.length);let S=n.indexOf("?");-1===S&&(S=n.length),e=n.substring(0,Math.min(T,S)),T<S&&(i=function jB(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}e+="/"+i}return e}(n.substring(T,S)));const k=function $B(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ys(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,S)));v=e.indexOf(":"),v>=0?(l="https"===h||"wss"===h,g=parseInt(e.substring(v+1),10)):v=e.length;const U=e.slice(0,v);if("localhost"===U.toLowerCase())t="localhost";else if(U.split(".").length<=2)t=U;else{const K=e.indexOf(".");r=e.substring(0,K).toLowerCase(),t=e.substring(K+1),a=r}"ns"in k&&(a=k.ns)}return{host:e,port:g,domain:t,subdomain:r,secure:l,scheme:h,pathString:i,namespace:a}};class DP{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,L.Wl)(this.snapshot.exportVal())}}class SP{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Xx{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,L.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class AP{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new L.BH;return NB(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Ia("OnDisconnect.remove",this._path);const e=new L.BH;return EP(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Ia("OnDisconnect.set",this._path),xl("OnDisconnect.set",e,this._path,!1);const t=new L.BH;return EP(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Ia("OnDisconnect.setWithPriority",this._path),xl("OnDisconnect.setWithPriority",e,this._path,!1),Gx("OnDisconnect.setWithPriority",t,!1);const r=new L.BH;return function PB(n,e,t,r,i){const a=Rr(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(l,h)=>{"ok"===l&&S_(n.onDisconnect_,e,a),Uh(0,i,l,h)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Ia("OnDisconnect.update",this._path),fP("OnDisconnect.update",e,this._path,!1);const t=new L.BH;return function OB(n,e,t,r){if((0,L.xb)(t))return Oi("onDisconnect().update() called with empty data.  Don't do anything."),void Uh(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,a)=>{"ok"===i&&Li(t,(l,h)=>{const g=Rr(h);S_(n.onDisconnect_,yr(e,l),g)}),Uh(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class fo{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Jt(this._path)?null:ix(this._path)}get ref(){return new ba(this._repo,this._path)}get _queryIdentifier(){const e=NN(this._queryParams),t=ZA(e);return"{}"===t?"default":t}get _queryObject(){return NN(this._queryParams)}isEqual(e){if(!((e=(0,L.m9)(e))instanceof fo))return!1;const t=this._repo===e._repo,r=sx(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function PU(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function lT(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Vh(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Al){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==jc)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Sl)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===sr){if(null!=e&&!Dw(e)||null!=t&&!Dw(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,L.hu)(n.getIndex()instanceof cx||n.getIndex()===dx,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function cT(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ba extends fo{constructor(e,t){super(e,t,new VC,!1)}get parent(){const e=_N(this._path);return null===e?null:new ba(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Gp{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new On(e),r=Wp(this.ref,e);return new Gp(this._node.getChild(t),r,sr)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new Gp(i,Wp(this.ref,r),sr)))}hasChild(e){const t=new On(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function xP(n,e){return(n=(0,L.m9)(n))._checkNotDeleted("ref"),void 0!==e?Wp(n._root,e):n._root}function RP(n,e){(n=(0,L.m9)(n))._checkNotDeleted("refFromURL");const t=Qx(e,n._repo.repoInfo_.nodeAdmin);pP("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Dl("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),xP(n,t.path.toString())}function Wp(n,e){return null===Xt((n=(0,L.m9)(n))._path)?(t=e,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),xw("child","path",t,!1)):xw("child","path",e,!1),new ba(n._repo,yr(n._path,e));var t}function Jx(n,e){n=(0,L.m9)(n),Ia("set",n._path),xl("set",e,n._path,!1);const t=new L.BH;return qx(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function KB(n,e){fP("update",e,n._path,!1);const t=new L.BH;return function MB(n,e,t,r){M_(n,"update",{path:e.toString(),value:t});let i=!0;const a=Rw(n),l={};if(Li(t,(h,g)=>{i=!1,l[h]=lP(yr(e,h),Rr(g),n.serverSyncTree_,a)}),i)Oi("update() called with empty data.  Don't do anything."),Uh(0,r,"ok",void 0);else{const h=oT(n),g=function rB(n,e,t,r){!function wV(n,e,t,r){(0,L.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=Ix(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=or.fromObject(t);return R_(n,new A_({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,l,h);sT(n.eventQueue_,g),n.server_.merge(e.toString(),t,(v,T)=>{const S="ok"===v;S||ys("update at "+e+" failed: "+v);const k=Fh(n.serverSyncTree_,h,!S),U=k.length>0?k_(n,e):e;Wo(n.eventQueue_,U,k),Uh(0,r,v,T)}),Li(t,v=>{const T=Zx(n,yr(e,v));k_(n,T)}),Wo(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function ZB(n){n=(0,L.m9)(n);const e=new Xx(()=>{}),t=new Mw(e);return function RB(n,e,t){const r=function uB(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(v,T)=>{const S=Gs(v,t);r=r||Oh(T,S)});let i=n.syncPointTree_.get(t);i?r=r||Oh(i,Cn()):(i=new XN,n.syncPointTree_=n.syncPointTree_.set(t,i));const a=null!=r,l=a?new Nh(r,!0,!1):null;return function WV(n){return WC(n.viewCache_)}(JN(i,e,qC(n.pendingWriteTree_,e._path),a?l.getNode():zt.EMPTY_NODE,a))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const a=Rr(i).withIndex(e._queryParams.getIndex());let l;if(kx(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())l=Iw(n.serverSyncTree_,e._path,a);else{const h=bw(n.serverSyncTree_,e);l=iP(n.serverSyncTree_,e._path,a,h)}return Wo(n.eventQueue_,e._path,l),JC(n.serverSyncTree_,e,t,null,!0),a},i=>(M_(n,"get for query "+(0,L.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new Gp(r,new ba(n._repo,n._path),n._queryParams.getIndex()))}class Mw{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new DP("value",this,new Gp(e.snapshotNode,new ba(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new SP(this,e,t):null}matches(e){return e instanceof Mw&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class dT{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new SP(this,e,t):null}createEvent(e,t){(0,L.hu)(null!=e.childName,"Child events should have a childName.");const r=Wp(new ba(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new DP(e.type,this,new Gp(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof dT&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function kw(n,e,t,r,i){let a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){const g=t,v=(T,S)=>{zx(n._repo,n,h),g(T,S)};v.userCallback=t.userCallback,v.context=t.context,t=v}const l=new Xx(t,a||void 0),h="value"===e?new Mw(l):new dT(e,l);return function LB(n,e,t){let r;r=".info"===Xt(e._path)?kx(n.infoSyncTree_,e,t):kx(n.serverSyncTree_,e,t),gP(n.eventQueue_,e._path,r)}(n._repo,n,h),()=>zx(n._repo,n,h)}function eR(n,e,t,r){return kw(n,"value",e,t,r)}function MP(n,e,t,r){return kw(n,"child_added",e,t,r)}function kP(n,e,t,r){return kw(n,"child_changed",e,t,r)}function NP(n,e,t,r){return kw(n,"child_moved",e,t,r)}function PP(n,e,t,r){return kw(n,"child_removed",e,t,r)}function OP(n,e,t){let r=null;const i=t?new Xx(t):null;"value"===e?r=new Mw(i):e&&(r=new dT(e,i)),zx(n._repo,n,r)}class vu{}class LP extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){xl("endAt",this._value,e._path,!0);const t=gx(e._queryParams,this._value,this._key);if(cT(t),Vh(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new fo(e._repo,e._path,t,e._orderByCalled)}}class QB extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){xl("endBefore",this._value,e._path,!1);const t=function aV(n,e,t){let r,i;return n.index_===Al?("string"==typeof e&&(e=RN(e)),i=gx(n,e,t)):(r=null==t?jc:RN(t),i=gx(n,e,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(cT(t),Vh(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new fo(e._repo,e._path,t,e._orderByCalled)}}class FP extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){xl("startAt",this._value,e._path,!0);const t=px(e._queryParams,this._value,this._key);if(cT(t),Vh(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new fo(e._repo,e._path,t,e._orderByCalled)}}class e2 extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){xl("startAfter",this._value,e._path,!1);const t=function oV(n,e,t){let r;if(n.index_===Al)"string"==typeof e&&(e=xN(e)),r=px(n,e,t);else{let i;i=null==t?Sl:xN(t),r=px(n,e,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(cT(t),Vh(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new fo(e._repo,e._path,t,e._orderByCalled)}}class n2 extends vu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new fo(e._repo,e._path,function iV(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class i2 extends vu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new fo(e._repo,e._path,function sV(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class o2 extends vu{constructor(e){super(),this._path=e}_apply(e){lT(e,"orderByChild");const t=new On(this._path);if(Jt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new cx(t),i=BC(e._queryParams,r);return Vh(i),new fo(e._repo,e._path,i,!0)}}class u2 extends vu{_apply(e){lT(e,"orderByKey");const t=BC(e._queryParams,Al);return Vh(t),new fo(e._repo,e._path,t,!0)}}class c2 extends vu{_apply(e){lT(e,"orderByPriority");const t=BC(e._queryParams,sr);return Vh(t),new fo(e._repo,e._path,t,!0)}}class h2 extends vu{_apply(e){lT(e,"orderByValue");const t=BC(e._queryParams,dx);return Vh(t),new fo(e._repo,e._path,t,!0)}}class p2 extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(xl("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new LP(this._value,this._key)._apply(new FP(this._value,this._key)._apply(e))}}function wu(n,...e){let t=(0,L.m9)(n);for(const r of e)t=r._apply(t);return t}(function ZV(n){(0,L.hu)(!YC,"__referenceConstructor has already been defined"),YC=n})(ba),function eB(n){(0,L.hu)(!XC,"__referenceConstructor has already been defined"),XC=n}(ba);const tR={};function VP(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||Dl("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Oi("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let g,v,l=Qx(a,i),h=l.repoInfo;"undefined"!=typeof process&&process.env&&(v=process.env.FIREBASE_DATABASE_EMULATOR_HOST),v?(g=!0,a=`http://${v}?ns=${h.namespace}`,l=Qx(a,i),h=l.repoInfo):g=!l.repoInfo.secure;const T=i&&g?new cw(cw.OWNER):new lU(n.name,n.options,e);pP("Invalid Firebase Database URL",l),Jt(l.path)||Dl("Database URL must point to the root of a Firebase Database (not including a child path).");const S=function v2(n,e,t,r){let i=tR[e.name];i||(i={},tR[e.name]=i);let a=i[n.toURLString()];return a&&Dl("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new SB(n,false,t,r),i[n.toURLString()]=a,a}(h,n,T,new uU(n.name,t));return new E2(S,n)}class E2{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function AB(n,e,t){if(n.stats_=tx(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new jC(n.repoInfo_,(r,i,a,l)=>{vP(n,r,i,a,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>wP(n,!0),0);else{if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,L.Wl)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Vp(n.repoInfo_,e,(r,i,a,l)=>{vP(n,r,i,a,l)},r=>{wP(n,r)},r=>{!function xB(n,e){Li(e,(t,r)=>{Wx(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function hU(n,e){const t=n.toString();return ex[t]||(ex[t]=e()),ex[t]}(n.repoInfo_,()=>new fV(n.stats_,n.server_)),n.infoData_=new uV,n.infoSyncTree_=new rP({startListening:(r,i,a,l)=>{let h=[];const g=n.infoData_.getNode(r._path);return g.isEmpty()||(h=Iw(n.infoSyncTree_,r._path,g),setTimeout(()=>{l("ok")},0)),h},stopListening:()=>{}}),Wx(n,"connected",!1),n.serverSyncTree_=new rP({startListening:(r,i,a,l)=>(n.server_.listen(r,a,i,(h,g)=>{const v=l(h,g);Wo(n.eventQueue_,r._path,v)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ba(this._repo,Cn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function y2(n,e){const t=tR[e];(!t||t[n.key]!==n)&&Dl(`Database ${e}(${n.repoInfo_}) has already been deleted.`),IP(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Dl("Cannot call "+e+" on a deleted database.")}}function BP(){sN.IS_TRANSPORT_INITIALIZED&&ys("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function I2(){BP(),Mh.forceDisallow()}function b2(){BP(),I_.forceDisallow(),Mh.forceAllow()}function D2(n,e){Vk(n,e)}const A2={".sv":"timestamp"};class M2{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}Vp.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},Vp.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function S2(n){Pk(qi.SDK_VERSION),(0,qi._registerComponent)(new oo.wA("database",(e,{instanceIdentifier:t})=>VP(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,qi.registerVersion)(kk,Nk,n),(0,qi.registerVersion)(kk,Nk,"esm2017")}();const O2=new ko.Yd("@firebase/database-compat"),$P=function(n){O2.warn("FIREBASE WARNING: "+n)};class U2{constructor(e){this._delegate=e}cancel(e){(0,L.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,L.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,L.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,L.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,L.Dv)("OnDisconnect.set",1,2,arguments.length),(0,L.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,L.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,L.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),a=>r(a)),i}update(e,t){if((0,L.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,$P("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,L.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class V2{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,L.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Bh{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,L.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,L.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,L.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,L.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,L.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),xw("DataSnapshot.child","path",e,!1),new Bh(this._database,this._delegate.child(e))}hasChild(e){return(0,L.Dv)("DataSnapshot.hasChild",1,1,arguments.length),xw("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,L.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,L.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,L.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new Bh(this._database,t)))}hasChildren(){return(0,L.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,L.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,L.Dv)("DataSnapshot.ref",0,0,arguments.length),new qo(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class ts{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var a;(0,L.Dv)("Query.on",2,4,arguments.length),(0,L.Wj)("Query.on","callback",t,!1);const l=ts.getCancelAndContextArgs_("Query.on",r,i),h=(v,T)=>{t.call(l.context,new Bh(this.database,v),T)};h.userCallback=t,h.context=l.context;const g=null===(a=l.cancel)||void 0===a?void 0:a.bind(l.context);switch(e){case"value":return eR(this._delegate,h,g),t;case"child_added":return MP(this._delegate,h,g),t;case"child_removed":return PP(this._delegate,h,g),t;case"child_changed":return kP(this._delegate,h,g),t;case"child_moved":return NP(this._delegate,h,g),t;default:throw new Error((0,L.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,L.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,L.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,L.Wj)("Query.off","callback",t,!0),(0,L.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,OP(this._delegate,e,i)}else OP(this._delegate,e)}get(){return ZB(this._delegate).then(e=>new Bh(this.database,e))}once(e,t,r,i){(0,L.Dv)("Query.once",1,4,arguments.length),(0,L.Wj)("Query.once","callback",t,!0);const a=ts.getCancelAndContextArgs_("Query.once",r,i),l=new L.BH,h=(v,T)=>{const S=new Bh(this.database,v);t&&t.call(a.context,S,T),l.resolve(S)};h.userCallback=t,h.context=a.context;const g=v=>{a.cancel&&a.cancel.call(a.context,v),l.reject(v)};switch(e){case"value":eR(this._delegate,h,g,{onlyOnce:!0});break;case"child_added":MP(this._delegate,h,g,{onlyOnce:!0});break;case"child_removed":PP(this._delegate,h,g,{onlyOnce:!0});break;case"child_changed":kP(this._delegate,h,g,{onlyOnce:!0});break;case"child_moved":NP(this._delegate,h,g,{onlyOnce:!0});break;default:throw new Error((0,L.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise}limitToFirst(e){return(0,L.Dv)("Query.limitToFirst",1,1,arguments.length),new ts(this.database,wu(this._delegate,function r2(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new n2(n)}(e)))}limitToLast(e){return(0,L.Dv)("Query.limitToLast",1,1,arguments.length),new ts(this.database,wu(this._delegate,function s2(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new i2(n)}(e)))}orderByChild(e){return(0,L.Dv)("Query.orderByChild",1,1,arguments.length),new ts(this.database,wu(this._delegate,function a2(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return xw("orderByChild","path",n,!1),new o2(n)}(e)))}orderByKey(){return(0,L.Dv)("Query.orderByKey",0,0,arguments.length),new ts(this.database,wu(this._delegate,function l2(){return new u2}()))}orderByPriority(){return(0,L.Dv)("Query.orderByPriority",0,0,arguments.length),new ts(this.database,wu(this._delegate,function d2(){return new c2}()))}orderByValue(){return(0,L.Dv)("Query.orderByValue",0,0,arguments.length),new ts(this.database,wu(this._delegate,function f2(){return new h2}()))}startAt(e=null,t){return(0,L.Dv)("Query.startAt",0,2,arguments.length),new ts(this.database,wu(this._delegate,function JB(n=null,e){return Aw("startAt","key",e,!0),new FP(n,e)}(e,t)))}startAfter(e=null,t){return(0,L.Dv)("Query.startAfter",0,2,arguments.length),new ts(this.database,wu(this._delegate,function t2(n,e){return Aw("startAfter","key",e,!0),new e2(n,e)}(e,t)))}endAt(e=null,t){return(0,L.Dv)("Query.endAt",0,2,arguments.length),new ts(this.database,wu(this._delegate,function YB(n,e){return Aw("endAt","key",e,!0),new LP(n,e)}(e,t)))}endBefore(e=null,t){return(0,L.Dv)("Query.endBefore",0,2,arguments.length),new ts(this.database,wu(this._delegate,function XB(n,e){return Aw("endBefore","key",e,!0),new QB(n,e)}(e,t)))}equalTo(e,t){return(0,L.Dv)("Query.equalTo",1,2,arguments.length),new ts(this.database,wu(this._delegate,function g2(n,e){return Aw("equalTo","key",e,!0),new p2(n,e)}(e,t)))}toString(){return(0,L.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,L.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,L.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof ts))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,L.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,L.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,L.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new qo(this.database,new ba(this._delegate._repo,this._delegate._path))}}class qo extends ts{constructor(e,t){super(e,new fo(t._repo,t._path,new VC,!1)),this.database=e,this._delegate=t}getKey(){return(0,L.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,L.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new qo(this.database,Wp(this._delegate,e))}getParent(){(0,L.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new qo(this.database,e):null}getRoot(){return(0,L.Dv)("Reference.root",0,0,arguments.length),new qo(this.database,this._delegate.root)}set(e,t){(0,L.Dv)("Reference.set",1,2,arguments.length),(0,L.Wj)("Reference.set","onComplete",t,!0);const r=Jx(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,L.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,$P("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ia("Reference.update",this._delegate._path),(0,L.Wj)("Reference.update","onComplete",t,!0);const r=KB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,L.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,L.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function zB(n,e,t){if(Ia("setWithPriority",n._path),xl("setWithPriority",e,n._path,!1),Gx("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new L.BH;return qx(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),a=>r(a)),i}remove(e){(0,L.Dv)("Reference.remove",0,1,arguments.length),(0,L.Wj)("Reference.remove","onComplete",e,!0);const t=function WB(n){return Ia("remove",n._path),Jx(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,L.Dv)("Reference.transaction",1,3,arguments.length),(0,L.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,L.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,L.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function k2(n,e,t){var r;if(n=(0,L.m9)(n),Ia("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=null==t?void 0:t.applyLocally)||void 0===r||r,a=new L.BH,h=eR(n,()=>{});return function UB(n,e,t,r,i,a){M_(n,"transaction on "+e);const l={path:e,update:t,onComplete:r,status:null,order:Lk(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=Kx(n,e,void 0);l.currentInputSnapshot=h;const g=l.update(h.val());if(void 0===g)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{Sw("transaction failed: Data returned ",g,l.path),l.status=0;const v=nT(n.transactionQueueTree_,e),T=Hp(v)||[];let S;T.push(l),jx(v,T),"object"==typeof g&&null!==g&&(0,L.r3)(g,".priority")?(S=(0,L.DV)(g,".priority"),(0,L.hu)(Dw(S),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):S=(eT(n.serverSyncTree_,e)||zt.EMPTY_NODE).getPriority().val();const k=Rw(n),U=Rr(g,S),K=Ux(U,h,k);l.currentOutputSnapshotRaw=U,l.currentOutputSnapshotResolved=K,l.currentWriteId=oT(n);const he=Mx(n.serverSyncTree_,e,K,l.currentWriteId,l.applyLocally);Wo(n.eventQueue_,e,he),aT(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(g,v,T)=>{let S=null;g?a.reject(g):(S=new Gp(T,new ba(n._repo,n._path),sr),a.resolve(new M2(v,S)))},h,i),a.promise}(this._delegate,e,{applyLocally:r}).then(a=>new V2(a.committed,new Bh(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(e,t){(0,L.Dv)("Reference.setPriority",1,2,arguments.length),(0,L.Wj)("Reference.setPriority","onComplete",t,!0);const r=function qB(n,e){n=(0,L.m9)(n),Ia("setPriority",n._path),Gx("setPriority",e,!1);const t=new L.BH;return qx(n._repo,yr(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,L.Dv)("Reference.push",0,2,arguments.length),(0,L.Wj)("Reference.push","onComplete",t,!0);const r=function GB(n,e){n=(0,L.m9)(n),Ia("push",n._path),xl("push",e,n._path,!0);const t=yP(n._repo),r=eV(t),i=Wp(n,r),a=Wp(n,r);let l;return l=null!=e?Jx(a,e).then(()=>a):Promise.resolve(a),i.then=l.then.bind(l),i.catch=l.then.bind(l,void 0),i}(this._delegate,e),i=r.then(l=>new qo(this.database,l));t&&i.then(()=>t(null),l=>t(l));const a=new qo(this.database,r);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return Ia("Reference.onDisconnect",this._delegate._path),new U2(new AP(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Nw{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:I2,forceLongPolling:b2}}useEmulator(e,t,r={}){!function jP(n,e,t,r={}){(n=(0,L.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Dl("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Dl('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new cw(cw.OWNER);else if(r.mockUserToken){const l="string"==typeof r.mockUserToken?r.mockUserToken:(0,L.Sg)(r.mockUserToken,n.app.options.projectId);a=new cw(l)}!function _2(n,e,t,r){n.repoInfo_=new XA(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(this._delegate,e,t,r)}ref(e){if((0,L.Dv)("database.ref",0,1,arguments.length),e instanceof qo){const t=RP(this._delegate,e.toString());return new qo(this,t)}{const t=xP(this._delegate,e);return new qo(this,t)}}refFromURL(e){(0,L.Dv)("database.refFromURL",1,1,arguments.length);const r=RP(this._delegate,e);return new qo(this,r)}goOffline(){return(0,L.Dv)("database.goOffline",0,0,arguments.length),function C2(n){(n=(0,L.m9)(n))._checkNotDeleted("goOffline"),IP(n._repo)}(this._delegate)}goOnline(){return(0,L.Dv)("database.goOnline",0,0,arguments.length),function T2(n){(n=(0,L.m9)(n))._checkNotDeleted("goOnline"),function FB(n){n.persistentConnection_&&n.persistentConnection_.resume(_P)}(n._repo)}(this._delegate)}}Nw.ServerValue={TIMESTAMP:function x2(){return A2}(),increment:n=>function R2(n){return{".sv":{increment:n}}}(n)};var j2=Object.freeze({__proto__:null,initStandalone:function B2({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:a=!1}){Pk(t);const l=new oo.zt("auth-internal",new oo.H0("database-standalone"));return l.setComponent(new oo.wA("auth-internal",()=>r,"PRIVATE")),{instance:new Nw(VP(n,l,void 0,e,a),n),namespace:i}}});const $2=Nw.ServerValue;function HP(n){return null==n}function GP(n){return"function"==typeof n.set}function WP(n,e){return GP(e)?e:n.ref(e)}function qP(n,e){if(function G2(n){return"string"==typeof n}(n))return e.stringCase();if(GP(n))return e.firebaseCase();if(function W2(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function Pw(n,e,t="on",r=sy.z){return new xi.y(i=>{let a=null;return a=n[t](e,(l,h)=>{r.schedule(()=>{i.next({snapshot:l,prevKey:h})}),"once"===t&&r.schedule(()=>i.complete())},l=>{r.schedule(()=>i.error(l))}),"on"===t?{unsubscribe(){null!=a&&n.off(e,a)}}:{unsubscribe(){}}}).pipe((0,Ct.U)(i=>{const{snapshot:a,prevKey:l}=i;let h=null;return a.exists()&&(h=a.key),{type:e,payload:a,prevKey:l,key:h}}),(0,cM.B)())}function zP(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function K2(n,e){const{payload:t,prevKey:r,key:i}=e,a=zP(n,i),l=function z2(n,e){if(HP(e))return 0;{const t=zP(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let h=null;e.payload.forEach(g=>{const v={payload:g,type:"value",prevKey:h,key:g.key};return h=g.key,n=[...n,v],!1})}return n;case"child_added":if(a>-1){const h=n[a-1];(h&&h.key||null)!==r&&(n=n.filter(g=>g.payload.key!==t.key)).splice(l,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(l,0,e)}return n;case"child_removed":return n.filter(h=>h.payload.key!==t.key);case"child_changed":return n.map(h=>h.payload.key===i?e:h);case"child_moved":if(a>-1){const h=n.splice(a,1)[0];return(n=n.slice()).splice(l,0,h),n}return n;default:return n}}function KP(n){return(HP(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function ZP(n,e,t){return function q2(n,e,t){return Pw(n,"value","once",t).pipe(lr(r=>{const i=[st(r)];return e.forEach(a=>i.push(Pw(n,a,"on",t))),(0,iA.T)(...i).pipe(fi(K2,[]))}),uE())}(n,e=KP(e),t)}function YP(n,e,t){const r=(e=KP(e)).map(i=>Pw(n,i,"on",t));return(0,iA.T)(...r)}function QP(n,e){return function(r,i){return qP(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function X2(n){return function(t){return t?qP(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function XP(n,e){return function(){return Pw(n,"value","on",e)}}!function H2(n){n.INTERNAL.registerComponent(new oo.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Nw(i,r)},"PUBLIC").setServiceProps({Reference:qo,Query:ts,Database:Nw,DataSnapshot:Bh,enableLogging:D2,INTERNAL:j2,ServerValue:$2}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.2.10")}(cE.Z);const tj=new _.OlP("angularfire2.realtimeDatabaseURL"),nj=new _.OlP("angularfire2.database.use-emulator");let rj=(()=>{class n{constructor(t,r,i,a,l,h,g,v,T,S,k,U,K,he,be){this.schedulers=h;const lt=g,ft=(0,Dr.on)(t,l,r);v&&MA(ft,l,T,k,U,K,S,he),this.database=(0,Dr.cc)(`${ft.name}.database.${i}`,"AngularFireDatabase",ft.name,()=>{const ct=l.runOutsideAngular(()=>ft.database(i||void 0));return lt&&ct.useEmulator(...lt),ct},[lt])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>WP(this.database,t));let a=i;return r&&(a=r(i)),function J2(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:QP(r,"update"),set:QP(r,"set"),push:i=>r.push(i),remove:X2(r),snapshotChanges:i=>ZP(n,i,t).pipe(fn.iC),stateChanges:i=>YP(n,i,t).pipe(fn.iC),auditTrail:i=>function Z2(n,e,t){return function Q2(n,e,t){return function Y2(n,e){return Pw(n,"value","on",e).pipe((0,Ct.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function YF(...n){const e=(0,ku.jO)(n);return(0,er.e)((t,r)=>{const i=n.length,a=new Array(i);let l=n.map(()=>!1),h=!1;for(let g=0;g<i;g++)(0,Ha.Xf)(n[g]).subscribe((0,zn.x)(r,v=>{a[g]=v,!h&&!l[g]&&(l[g]=!0,(h=l.every(Rs.y))&&(l=null))},ZF.Z));t.subscribe((0,zn.x)(r,g=>{if(h){const v=[g,...a];r.next(e?e(...v):v)}}))})}(e),(0,Ct.U)(([i,a])=>{const l=i.lastKeyToLoad,h=a.map(g=>g.key);return{actions:a,lastKeyToLoad:l,loadedKeys:h}}),function QF(n){return(0,er.e)((e,t)=>{let r=!1,i=0;e.subscribe((0,zn.x)(t,a=>(r||(r=!n(a,i++)))&&t.next(a)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,Ct.U)(i=>i.actions))}(n,YP(n,e).pipe(fi((i,a)=>[...i,a],[])),t)}(n,i,t).pipe(fn.iC),valueChanges:(i,a)=>ZP(n,i,t).pipe((0,Ct.U)(h=>h.map(g=>a&&a.idField?Object.assign(Object.assign({},g.payload.val()),{[a.idField]:g.key}):g.payload.val())),fn.iC)}}(a,this)}object(t){return function ej(n,e){return{query:n,snapshotChanges:()=>XP(n,e.schedulers.outsideAngular)().pipe(fn.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>XP(n,e.schedulers.outsideAngular)().pipe(fn.iC,(0,Ct.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>WP(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Dr.Dh),_.LFG(Dr.xv,8),_.LFG(tj,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(fn.HU),_.LFG(nj,8),_.LFG(tw,8),_.LFG(TA,8),_.LFG(DA,8),_.LFG(SA,8),_.LFG(AA,8),_.LFG(xA,8),_.LFG(RA,8),_.LFG(ew,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),ij=(()=>{class n{constructor(){EC.Z.registerVersion("angularfire",fn.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[rj]}),n})();var sj=F(8247);let N_=(()=>{class n{constructor(t,r,i){this.afs=t,this.afAuth=r,this.router=i,this.afAuth.authState.subscribe(a=>{a?(this.userData=a,localStorage.setItem("user",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem("user")),"/verification"!==this.router.url&&this.router.navigate(["dashboard"])):(localStorage.setItem("user","null"),JSON.parse(localStorage.getItem("user")))})}login(t,r){var i=this;return(0,me.Z)(function*(){try{const a=yield i.afAuth.signInWithEmailAndPassword(t,r);i.setUserData(a.user)}catch(a){alert(a.message)}})()}register(t,r){var i=this;return(0,me.Z)(function*(){try{const a=yield i.afAuth.createUserWithEmailAndPassword(t.value,r.value);i.sendVerificationMail(),i.setUserData(a.user)}catch(a){alert(a.message),t.value="",r.value=""}})()}sendVerificationMail(){var t=this;return(0,me.Z)(function*(){(yield t.afAuth.currentUser).sendEmailVerification(),t.router.navigate(["verification"])})()}forgotPassword(t){var r=this;return(0,me.Z)(function*(){try{yield r.afAuth.sendPasswordResetEmail(t),alert("Password reset email sent, check your inbox."),r.router.navigate(["login"])}catch(i){alert(i)}})()}get isLoggedIn(){return null!==JSON.parse(localStorage.getItem("user"))}googleAuth(){var t=this;return(0,me.Z)(function*(){yield t.authLogin(new sj.Q),t.router.navigate(["dashboard"])})()}authLogin(t){var r=this;return(0,me.Z)(function*(){try{const i=yield r.afAuth.signInWithPopup(t);r.setUserData(i.user),r.router.navigate(["dashboard"])}catch(i){alert(i)}})()}setUserData(t){return this.afs.doc(`users/${t.uid}`).set({uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,emailVerified:t.emailVerified},{merge:!0})}logout(){var t=this;return(0,me.Z)(function*(){yield t.afAuth.signOut(),localStorage.removeItem("user"),yield t.router.navigate(["login"])})()}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(GM),_.LFG(tw),_.LFG(mi))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),oj=(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(N_))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-login"]],decls:25,vars:0,consts:[[1,"col-sm-9","col-md-6","col-lg-3","container-fluid","pt-5","text-center"],[1,"row"],[1,"d-flex","flex-column","gap-3"],["type","email","placeholder","Username","required","",1,"form-control"],["userName",""],["type","password","placeholder","Password","required","",1,"form-control"],["userPassword",""],[1,"d-flex","justify-content-center","gap-3","align-items-center"],["type","button","value","Log in",1,"btn","btn-primary",3,"click"],[1,"or"],[1,"orInner"],["type","button",1,"btn","btn-success",3,"click"],[1,"fab","fa-google-plus-g"],[1,"w-50","mx-auto","btn","btn-outline-info"],["routerLink","/forgot-pass"],[1,"mt-3","d-flex","align-items-center","justify-content-center"],["routerLink","/register",1,"btn","btn-link"]],template:function(t,r){if(1&t){const i=_.EpF();_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),_._uU(4,"Login"),_.qZA(),_._UZ(5,"input",3,4)(7,"input",5,6),_.TgZ(9,"div",7)(10,"input",8),_.NdJ("click",function(){_.CHM(i);const l=_.MAs(6),h=_.MAs(8);return r.authService.login(l.value,h.value)}),_.qZA(),_.TgZ(11,"span",9)(12,"span",10),_._uU(13,"Or"),_.qZA()(),_.TgZ(14,"button",11),_.NdJ("click",function(){return r.authService.googleAuth()}),_._UZ(15,"i",12),_._uU(16," Log in with Google "),_.qZA()(),_.TgZ(17,"div",13)(18,"span",14),_._uU(19,"Forgot Password?"),_.qZA()()(),_.TgZ(20,"div",15)(21,"span"),_._uU(22,"Don't have an account?"),_.qZA(),_.TgZ(23,"span",16),_._uU(24," Register"),_.qZA()()()()}},directives:[Jl],encapsulation:2}),n})(),aj=(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(N_))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-register"]],decls:22,vars:0,consts:[[1,"col-sm-9","col-md-6","col-lg-3","container-fluid","pt-5","text-center"],[1,"row"],[1,"d-flex","flex-column","gap-3"],["type","email","placeholder","Email","required","",1,"form-control"],["userEmail",""],["type","password","placeholder","Password","required","",1,"form-control"],["userPassword",""],[1,"d-flex","justify-content-center","gap-3","align-items-center"],["type","button","value","Register",1,"btn","btn-warning",3,"click"],[1,"or"],[1,"orInner"],["type","button",1,"btn","btn-success",3,"click"],[1,"fab","fa-google-plus-g"],[1,"mt-3","d-flex","align-items-center","justify-content-center"],["routerLink","/login",1,"btn","btn-link"]],template:function(t,r){if(1&t){const i=_.EpF();_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),_._uU(4,"Register"),_.qZA(),_._UZ(5,"input",3,4)(7,"input",5,6),_.TgZ(9,"div",7)(10,"input",8),_.NdJ("click",function(){_.CHM(i);const l=_.MAs(6),h=_.MAs(8);return r.authService.register(l,h)}),_.qZA(),_.TgZ(11,"span",9)(12,"span",10),_._uU(13,"Or"),_.qZA()(),_.TgZ(14,"button",11),_.NdJ("click",function(){return r.authService.googleAuth()}),_._UZ(15,"i",12),_._uU(16," Continue with Google "),_.qZA()()(),_.TgZ(17,"div",13)(18,"span"),_._uU(19,"Already have an account?"),_.qZA(),_.TgZ(20,"span",14),_._uU(21,"Login"),_.qZA()()()()}},directives:[Jl],encapsulation:2}),n})();function uj(n,e){if(1&n&&(_.TgZ(0,"div")(1,"p",8),_._uU(2,"We have sent a confirmation email to "),_.TgZ(3,"strong"),_._uU(4),_.qZA(),_._uU(5,"."),_.qZA(),_.TgZ(6,"p",8),_._uU(7,"Please check your email and click on the link to verify your email address."),_.qZA()()),2&n){const t=e.ngIf;_.xp6(4),_.Oqu(t.email)}}let lj=(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(N_))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-verify-email"]],decls:14,vars:1,consts:[[1,"col-sm-9","col-md-6","container-fluid","pt-5","text-center"],[1,"row"],[1,"d-flex","flex-column","gap-3"],[4,"ngIf"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-redo-alt"],[1,"mt-3","d-flex","align-items-center","justify-content-center"],["routerLink","/dashboard",1,"btn","btn-link"],[1,"text-center"]],template:function(t,r){1&t&&(_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),_._uU(4,"Thank You for Registering"),_.qZA(),_.YNc(5,uj,8,1,"div",3),_.TgZ(6,"button",4),_.NdJ("click",function(){return r.authService.sendVerificationMail()}),_._UZ(7,"i",5),_._uU(8," Resend Verification Email "),_.qZA()(),_.TgZ(9,"div",6)(10,"span"),_._uU(11,"Go to"),_.qZA(),_.TgZ(12,"span",7),_._uU(13," Dashboard"),_.qZA()()()()),2&t&&(_.xp6(5),_.Q6J("ngIf",r.authService.userData))},directives:[Hr,Jl],encapsulation:2}),n})(),cj=(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(N_))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-forgot-password"]],decls:15,vars:0,consts:[[1,"col-sm-9","col-md-6","col-lg-3","container-fluid","mt-5","text-center"],[1,"row"],[1,"d-flex","flex-column","gap-3"],[1,"text-center"],["type","email","placeholder","Email Address","required","",1,"form-control"],["pswdResetEmail",""],["type","submit","value","Reset Password",1,"btn","btn-outline-success",3,"click"],[1,"mt-3","d-flex","align-items-center","justify-content-center"],["routerLink","/login",1,"btn","btn-link"]],template:function(t,r){if(1&t){const i=_.EpF();_.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),_._uU(4,"Reset Password"),_.qZA(),_.TgZ(5,"p",3),_._uU(6,"Please enter your email address to request a password reset."),_.qZA(),_._UZ(7,"input",4,5),_.TgZ(9,"input",6),_.NdJ("click",function(){_.CHM(i);const l=_.MAs(8);return r.authService.forgotPassword(l.value)}),_.qZA()(),_.TgZ(10,"div",7)(11,"span"),_._uU(12,"Go back to"),_.qZA(),_.TgZ(13,"span",8),_._uU(14," Login"),_.qZA()()()()}},directives:[Jl],encapsulation:2}),n})();function dj(n,e){if(1&n&&(_.TgZ(0,"div",13)(1,"div",14)(2,"div",15),_._UZ(3,"img",16),_.TgZ(4,"div",3)(5,"h1"),_._uU(6,"Hello, "),_.TgZ(7,"strong"),_._uU(8),_.qZA()(),_.TgZ(9,"p"),_._uU(10,"User ID: "),_.TgZ(11,"strong",17),_._uU(12),_.qZA()(),_.TgZ(13,"p"),_._uU(14,"Email: "),_.TgZ(15,"strong"),_._uU(16),_.qZA()(),_.TgZ(17,"p"),_._uU(18,"Email Verified: "),_.TgZ(19,"strong"),_._uU(20),_.qZA()()()()()()),2&n){const t=e.ngIf;_.xp6(3),_.s9C("src",t.photoURL?t.photoURL:"assets/icons8-male-user-64.png",_.LSH),_.s9C("alt",t.displayName),_.xp6(5),_.Oqu(t.displayName?t.displayName:"User"),_.xp6(4),_.Oqu(t.uid),_.xp6(4),_.Oqu(t.email),_.xp6(4),_.Oqu(t.emailVerified)}}const hj=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:oj},{path:"register",component:aj},{path:"verification",component:lj},{path:"forgot-pass",component:cj},{path:"dashboard",component:(()=>{class n{constructor(t){this.authService=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(N_))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-dashboard"]],decls:18,vars:1,consts:[[1,"navbar","navbar-dark","bg-dark","flex-md-nowrap","px-3","shadow","justify-content-between","text-white"],[1,"col-sm-4","col-md-3","mr-0","d-flex","justify-content-center","align-items-center","gap-3"],["src","assets/angular-icon.svg","alt","angular Logo",2,"width","50px"],[1,""],[1,"btn","btn-link",3,"click"],[1,"col-sm-12","col-md-9","container-fluid"],["role","main",1,"px-4"],[1,"inner-adjust"],[1,"pt-3","pb-2","mb-3","border-bottom"],[1,"h2"],["class","row",4,"ngIf"],[1,"fixed-bottom","bg-dark","text-white","py-1","px-2","text-center"],["href","https://github.com/Maxeemja",1,"text-lg-center"],[1,"row"],[1,"col-md-12"],[1,"d-flex","justify-content-start","gap-5"],[1,"align-self-start","mr-5","img-thumbnail","rounded-circle",3,"src","alt"],[1,"fs-6"]],template:function(t,r){1&t&&(_.TgZ(0,"nav",0)(1,"div",1),_._UZ(2,"img",2),_.TgZ(3,"span",3),_._uU(4,"NgFirebaseAuthApp"),_.qZA()(),_.TgZ(5,"div",4),_.NdJ("click",function(){return r.authService.logout()}),_._uU(6," Logout "),_.qZA()(),_.TgZ(7,"div",5)(8,"main",6)(9,"div",7)(10,"div",8)(11,"h1",9),_._uU(12,"User Profile"),_.qZA()(),_.YNc(13,dj,21,6,"div",10),_.qZA()(),_.TgZ(14,"footer",11),_._uU(15,"Made by "),_.TgZ(16,"a",12),_._uU(17,"Maxeemja"),_.qZA()()()),2&t&&(_.xp6(13),_.Q6J("ngIf",r.authService.userData))},directives:[Hr],encapsulation:2}),n})(),canActivate:[(()=>{class n{constructor(t,r){this.authService=t,this.router=r}canActivate(t,r){return this.authService.isLoggedIn||this.router.navigate(["login"]),!0}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(N_),_.LFG(mi))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()]}];let fj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[[tE.forRoot(hj)],tE]}),n})(),pj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n,bootstrap:[mf]}),n.\u0275inj=_.cJS({providers:[],imports:[[Pl,Dr.hO.initializeApp(WM_firebase),iL,Y1,KF,ij,fj]]}),n})();(0,_.G48)(),sd().bootstrapModule(pj).catch(n=>console.error(n))},5867:(nt,Ce,F)=>{F.d(Ce,{C6:()=>_.getApps,Mq:()=>_.getApp});var _=F(9681);(0,_.registerVersion)("firebase","9.14.0","app")},127:(nt,Ce,F)=>{F.d(Ce,{Z:()=>_.Z});var _=F(3942);_.Z.registerVersion("firebase","9.14.0","app-compat")},5881:(nt,Ce,F)=>{F.r(Ce);var _=F(5861),G=F(3942),P=F(8247),oe=F(2090),ge=(F(9681),F(1877),F(4859));function le(){return window}function q(){return(q=(0,_.Z)(function*($,N,B){var ae;const{BuildInfo:Le}=le();(0,P.ap)(N.sessionId,"AuthEvent did not contain a session ID");const et=yield De(N.sessionId),ut={};return(0,P.aq)()?ut.ibi=Le.packageName:(0,P.ar)()?ut.apn=Le.packageName:(0,P.as)($,"operation-not-supported-in-this-environment"),Le.displayName&&(ut.appDisplayName=Le.displayName),ut.sessionId=et,(0,P.at)($,B,N.type,void 0,null!==(ae=N.eventId)&&void 0!==ae?ae:void 0,ut)})).apply(this,arguments)}function je(){return(je=(0,_.Z)(function*($){const{BuildInfo:N}=le(),B={};(0,P.aq)()?B.iosBundleId=N.packageName:(0,P.ar)()?B.androidPackageName=N.packageName:(0,P.as)($,"operation-not-supported-in-this-environment"),yield(0,P.au)($,B)})).apply(this,arguments)}function He(){return(He=(0,_.Z)(function*($,N,B){const{cordova:ae}=le();let Le=()=>{};try{yield new Promise((et,ut)=>{let Mt=null;function it(){var Ut;et();const $r=null===(Ut=ae.plugins.browsertab)||void 0===Ut?void 0:Ut.close;"function"==typeof $r&&$r(),"function"==typeof(null==B?void 0:B.close)&&B.close()}function on(){Mt||(Mt=window.setTimeout(()=>{ut((0,P.aw)($,"redirect-cancelled-by-user"))},2e3))}function gr(){"visible"===(null==document?void 0:document.visibilityState)&&on()}N.addPassiveListener(it),document.addEventListener("resume",on,!1),(0,P.ar)()&&document.addEventListener("visibilitychange",gr,!1),Le=()=>{N.removePassiveListener(it),document.removeEventListener("resume",on,!1),document.removeEventListener("visibilitychange",gr,!1),Mt&&window.clearTimeout(Mt)}})}finally{Le()}})).apply(this,arguments)}function De($){return qe.apply(this,arguments)}function qe(){return(qe=(0,_.Z)(function*($){const N=Ge($),B=yield crypto.subtle.digest("SHA-256",N);return Array.from(new Uint8Array(B)).map(Le=>Le.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function Ge($){if((0,P.ap)(/[0-9a-zA-Z]+/.test($),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode($);const N=new ArrayBuffer($.length),B=new Uint8Array(N);for(let ae=0;ae<$.length;ae++)B[ae]=$.charCodeAt(ae);return B}class Ae extends P.ay{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(N=>{this.resolveInialized=N})}addPassiveListener(N){this.passiveListeners.add(N)}removePassiveListener(N){this.passiveListeners.delete(N)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(N){return this.resolveInialized(),this.passiveListeners.forEach(B=>B(N)),super.onEvent(N)}initialized(){var N=this;return(0,_.Z)(function*(){yield N.initPromise})()}}function ne($){return pe.apply(this,arguments)}function pe(){return(pe=(0,_.Z)(function*($){const N=yield te()._get(ie($));return N&&(yield te()._remove(ie($))),N})).apply(this,arguments)}function Q(){const $=[],N="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let B=0;B<20;B++){const ae=Math.floor(Math.random()*N.length);$.push(N.charAt(ae))}return $.join("")}function te(){return(0,P.az)(P.b)}function ie($){return(0,P.aA)("authEvent",$.config.apiKey,$.name)}function Fe($){if(!(null==$?void 0:$.includes("?")))return{};const[N,...B]=$.split("?");return(0,oe.zd)(B.join("?"))}function Ze(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,P.aw)("no-auth-event")}}function $t(){var $;return(null===($=null==self?void 0:self.location)||void 0===$?void 0:$.protocol)||null}function Nn($=(0,oe.z$)()){return!("file:"!==$t()&&"ionic:"!==$t()&&"capacitor:"!==$t()||!$.toLowerCase().match(/iphone|ipad|ipod|android/))}function bi(){try{const $=self.localStorage,N=P.aI();if($)return $.setItem(N,"1"),$.removeItem(N),!function ns($=(0,oe.z$)()){return function ai(){return(0,oe.w1)()&&11===(null==document?void 0:document.documentMode)}()||function Fn($=(0,oe.z$)()){return/Edge\/\d+/.test($)}($)}()||(0,oe.hl)()}catch($){return Ci()&&(0,oe.hl)()}return!1}function Ci(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function Hn(){return(function Yt(){return"http:"===$t()||"https:"===$t()}()||(0,oe.ru)()||Nn())&&!function Qr(){return(0,oe.b$)()||(0,oe.UG)()}()&&bi()&&!Ci()}function rs(){return Nn()&&"undefined"!=typeof document}function kr(){return(kr=(0,_.Z)(function*(){return!!rs()&&new Promise($=>{const N=setTimeout(()=>{$(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(N),$(!0)})})})).apply(this,arguments)}const dn={LOCAL:"local",NONE:"none",SESSION:"session"},Nr=P.ax,Vr="persistence";function Dn($){return pr.apply(this,arguments)}function pr(){return(pr=(0,_.Z)(function*($){yield $._initializationPromise;const N=Kt(),B=P.aA(Vr,$.config.apiKey,$.name);N&&N.setItem(B,$._getPersistence())})).apply(this,arguments)}function Kt(){var $;try{return(null===($=function wn(){return"undefined"!=typeof window?window:null}())||void 0===$?void 0:$.sessionStorage)||null}catch(N){return null}}const gt=P.ax;class rt{constructor(){this.browserResolver=P.az(P.k),this.cordovaResolver=P.az(class en{constructor(){this._redirectPersistence=P.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=P.aB,this._overrideRedirectResult=P.aC}_initialize(N){var B=this;return(0,_.Z)(function*(){const ae=N._key();let Le=B.eventManagers.get(ae);return Le||(Le=new Ae(N),B.eventManagers.set(ae,Le),B.attachCallbackListeners(N,Le)),Le})()}_openPopup(N){(0,P.as)(N,"operation-not-supported-in-this-environment")}_openRedirect(N,B,ae,Le){var et=this;return(0,_.Z)(function*(){!function _e($){var N,B,ae,Le,et,ut,Mt,it,on,gr;const Ut=le();(0,P.ax)("function"==typeof(null===(N=null==Ut?void 0:Ut.universalLinks)||void 0===N?void 0:N.subscribe),$,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,P.ax)(void 0!==(null===(B=null==Ut?void 0:Ut.BuildInfo)||void 0===B?void 0:B.packageName),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,P.ax)("function"==typeof(null===(et=null===(Le=null===(ae=null==Ut?void 0:Ut.cordova)||void 0===ae?void 0:ae.plugins)||void 0===Le?void 0:Le.browsertab)||void 0===et?void 0:et.openUrl),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,P.ax)("function"==typeof(null===(it=null===(Mt=null===(ut=null==Ut?void 0:Ut.cordova)||void 0===ut?void 0:ut.plugins)||void 0===Mt?void 0:Mt.browsertab)||void 0===it?void 0:it.isAvailable),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,P.ax)("function"==typeof(null===(gr=null===(on=null==Ut?void 0:Ut.cordova)||void 0===on?void 0:on.InAppBrowser)||void 0===gr?void 0:gr.open),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(N);const ut=yield et._initialize(N);yield ut.initialized(),ut.resetRedirect(),(0,P.aD)(),yield et._originValidation(N);const Mt=function Te($,N,B=null){return{type:N,eventId:B,urlResponse:null,sessionId:Q(),postBody:null,tenantId:$.tenantId,error:(0,P.aw)($,"no-auth-event")}}(N,ae,Le);yield function We($,N){return te()._set(ie($),N)}(N,Mt);const it=yield function z($,N,B){return q.apply(this,arguments)}(N,Mt,B),on=yield function Re($){const{cordova:N}=le();return new Promise(B=>{N.plugins.browsertab.isAvailable(ae=>{let Le=null;ae?N.plugins.browsertab.openUrl($):Le=N.InAppBrowser.open($,(0,P.av)()?"_blank":"_system","location=yes"),B(Le)})})}(it);return function Ve($,N,B){return He.apply(this,arguments)}(N,ut,on)})()}_isIframeWebStorageSupported(N,B){throw new Error("Method not implemented.")}_originValidation(N){const B=N._key();return this.originValidationPromises[B]||(this.originValidationPromises[B]=function re($){return je.apply(this,arguments)}(N)),this.originValidationPromises[B]}attachCallbackListeners(N,B){const{universalLinks:ae,handleOpenURL:Le,BuildInfo:et}=le(),ut=setTimeout((0,_.Z)(function*(){yield ne(N),B.onEvent(Ze())}),500),Mt=function(){var gr=(0,_.Z)(function*(Ut){clearTimeout(ut);const $r=yield ne(N);let is=null;$r&&(null==Ut?void 0:Ut.url)&&(is=function Ee($,N){var B,ae;const Le=function de($){const N=Fe($),B=N.link?decodeURIComponent(N.link):void 0,ae=Fe(B).link,Le=N.deep_link_id?decodeURIComponent(N.deep_link_id):void 0;return Fe(Le).link||Le||ae||B||$}(N);if(Le.includes("/__/auth/callback")){const et=Fe(Le),ut=et.firebaseError?function we($){try{return JSON.parse($)}catch(N){return null}}(decodeURIComponent(et.firebaseError)):null,Mt=null===(ae=null===(B=null==ut?void 0:ut.code)||void 0===B?void 0:B.split("auth/"))||void 0===ae?void 0:ae[1],it=Mt?(0,P.aw)(Mt):null;return it?{type:$.type,eventId:$.eventId,tenantId:$.tenantId,error:it,urlResponse:null,sessionId:null,postBody:null}:{type:$.type,eventId:$.eventId,tenantId:$.tenantId,sessionId:$.sessionId,urlResponse:Le,postBody:null}}return null}($r,Ut.url)),B.onEvent(is||Ze())});return function($r){return gr.apply(this,arguments)}}();void 0!==ae&&"function"==typeof ae.subscribe&&ae.subscribe(null,Mt);const it=Le,on=`${et.packageName.toLowerCase()}://`;le().handleOpenURL=function(){var gr=(0,_.Z)(function*(Ut){if(Ut.toLowerCase().startsWith(on)&&Mt({url:Ut}),"function"==typeof it)try{it(Ut)}catch($r){console.error($r)}});return function(Ut){return gr.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=P.a,this._completeRedirectFn=P.aB,this._overrideRedirectResult=P.aC}_initialize(N){var B=this;return(0,_.Z)(function*(){return yield B.selectUnderlyingResolver(),B.assertedUnderlyingResolver._initialize(N)})()}_openPopup(N,B,ae,Le){var et=this;return(0,_.Z)(function*(){return yield et.selectUnderlyingResolver(),et.assertedUnderlyingResolver._openPopup(N,B,ae,Le)})()}_openRedirect(N,B,ae,Le){var et=this;return(0,_.Z)(function*(){return yield et.selectUnderlyingResolver(),et.assertedUnderlyingResolver._openRedirect(N,B,ae,Le)})()}_isIframeWebStorageSupported(N,B){this.assertedUnderlyingResolver._isIframeWebStorageSupported(N,B)}_originValidation(N){return this.assertedUnderlyingResolver._originValidation(N)}get _shouldInitProactively(){return rs()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return gt(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var N=this;return(0,_.Z)(function*(){if(N.underlyingResolver)return;const B=yield function wt(){return kr.apply(this,arguments)}();N.underlyingResolver=B?N.cordovaResolver:N.browserResolver})()}}function Ti($){return $.unwrap()}function Zt($){return Gn($)}function Gn($){const{_tokenResponse:N}=$ instanceof oe.ZR?$.customData:$;if(!N)return null;if(!($ instanceof oe.ZR)&&"temporaryProof"in N&&"phoneNumber"in N)return P.P.credentialFromResult($);const B=N.providerId;if(!B||B===P.o.PASSWORD)return null;let ae;switch(B){case P.o.GOOGLE:ae=P.Q;break;case P.o.FACEBOOK:ae=P.N;break;case P.o.GITHUB:ae=P.T;break;case P.o.TWITTER:ae=P.W;break;default:const{oauthIdToken:Le,oauthAccessToken:et,oauthTokenSecret:ut,pendingToken:Mt,nonce:it}=N;return et||ut||Le||Mt?Mt?B.startsWith("saml.")?P.aL._create(B,Mt):P.J._fromParams({providerId:B,signInMethod:B,pendingToken:Mt,idToken:Le,accessToken:et}):new P.U(B).credential({idToken:Le,accessToken:et,rawNonce:it}):null}return $ instanceof oe.ZR?ae.credentialFromError($):ae.credentialFromResult($)}function pn($,N){return N.catch(B=>{throw B instanceof oe.ZR&&function Fi($,N){var B,ae;const Le=null===(B=N.customData)||void 0===B?void 0:B._tokenResponse;if("auth/multi-factor-auth-required"===(null===(ae=N)||void 0===ae?void 0:ae.code))N.resolver=new Gt($,P.an($,N));else if(Le){const et=Gn(N),ut=N;et&&(ut.credential=et,ut.tenantId=Le.tenantId||void 0,ut.email=Le.email||void 0,ut.phoneNumber=Le.phoneNumber||void 0)}}($,B),B}).then(B=>{const Le=B.user;return{operationType:B.operationType,credential:Zt(B),additionalUserInfo:P.al(B),user:ar.getOrCreate(Le)}})}function _t($,N){return ui.apply(this,arguments)}function ui(){return(ui=(0,_.Z)(function*($,N){const B=yield N;return{verificationId:B.verificationId,confirm:ae=>pn($,B.confirm(ae))}})).apply(this,arguments)}class Gt{constructor(N,B){this.resolver=B,this.auth=function jr($){return $.wrapped()}(N)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(N){return pn(Ti(this.auth),this.resolver.resolveSignIn(N))}}class ar{constructor(N){this._delegate=N,this.multiFactor=P.ao(N)}static getOrCreate(N){return ar.USER_MAP.has(N)||ar.USER_MAP.set(N,new ar(N)),ar.USER_MAP.get(N)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(N){return this._delegate.getIdTokenResult(N)}getIdToken(N){return this._delegate.getIdToken(N)}linkAndRetrieveDataWithCredential(N){return this.linkWithCredential(N)}linkWithCredential(N){var B=this;return(0,_.Z)(function*(){return pn(B.auth,P.Z(B._delegate,N))})()}linkWithPhoneNumber(N,B){var ae=this;return(0,_.Z)(function*(){return _t(ae.auth,P.l(ae._delegate,N,B))})()}linkWithPopup(N){var B=this;return(0,_.Z)(function*(){return pn(B.auth,P.d(B._delegate,N,rt))})()}linkWithRedirect(N){var B=this;return(0,_.Z)(function*(){return yield Dn(P.aE(B.auth)),P.g(B._delegate,N,rt)})()}reauthenticateAndRetrieveDataWithCredential(N){return this.reauthenticateWithCredential(N)}reauthenticateWithCredential(N){var B=this;return(0,_.Z)(function*(){return pn(B.auth,P._(B._delegate,N))})()}reauthenticateWithPhoneNumber(N,B){return _t(this.auth,P.r(this._delegate,N,B))}reauthenticateWithPopup(N){return pn(this.auth,P.e(this._delegate,N,rt))}reauthenticateWithRedirect(N){var B=this;return(0,_.Z)(function*(){return yield Dn(P.aE(B.auth)),P.h(B._delegate,N,rt)})()}sendEmailVerification(N){return P.ab(this._delegate,N)}unlink(N){var B=this;return(0,_.Z)(function*(){return yield P.ak(B._delegate,N),B})()}updateEmail(N){return P.ag(this._delegate,N)}updatePassword(N){return P.ah(this._delegate,N)}updatePhoneNumber(N){return P.u(this._delegate,N)}updateProfile(N){return P.af(this._delegate,N)}verifyBeforeUpdateEmail(N,B){return P.ac(this._delegate,N,B)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}ar.USER_MAP=new WeakMap;const Xe=P.ax;let Se=(()=>{class ${constructor(B,ae){if(this.app=B,ae.isInitialized())return this._delegate=ae.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:Le}=B.options;Xe(Le,"invalid-api-key",{appName:B.name}),Xe(Le,"invalid-api-key",{appName:B.name});const et="undefined"!=typeof window?rt:void 0;this._delegate=ae.initialize({options:{persistence:It(Le,B.name),popupRedirectResolver:et}}),this._delegate._updateErrorMap(P.B),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ar.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(B){this._delegate.languageCode=B}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(B){this._delegate.tenantId=B}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(B,ae){P.G(this._delegate,B,ae)}applyActionCode(B){return P.a2(this._delegate,B)}checkActionCode(B){return P.a3(this._delegate,B)}confirmPasswordReset(B,ae){return P.a1(this._delegate,B,ae)}createUserWithEmailAndPassword(B,ae){var Le=this;return(0,_.Z)(function*(){return pn(Le._delegate,P.a5(Le._delegate,B,ae))})()}fetchProvidersForEmail(B){return this.fetchSignInMethodsForEmail(B)}fetchSignInMethodsForEmail(B){return P.aa(this._delegate,B)}isSignInWithEmailLink(B){return P.a8(this._delegate,B)}getRedirectResult(){var B=this;return(0,_.Z)(function*(){Xe(Hn(),B._delegate,"operation-not-supported-in-this-environment");const ae=yield P.j(B._delegate,rt);return ae?pn(B._delegate,Promise.resolve(ae)):{credential:null,user:null}})()}addFrameworkForLogging(B){!function ln($,N){(0,P.aE)($)._logFramework(N)}(this._delegate,B)}onAuthStateChanged(B,ae,Le){const{next:et,error:ut,complete:Mt}=Ke(B,ae,Le);return this._delegate.onAuthStateChanged(et,ut,Mt)}onIdTokenChanged(B,ae,Le){const{next:et,error:ut,complete:Mt}=Ke(B,ae,Le);return this._delegate.onIdTokenChanged(et,ut,Mt)}sendSignInLinkToEmail(B,ae){return P.a7(this._delegate,B,ae)}sendPasswordResetEmail(B,ae){return P.a0(this._delegate,B,ae||void 0)}setPersistence(B){var ae=this;return(0,_.Z)(function*(){let Le;switch(function Br($,N){Nr(Object.values(dn).includes(N),$,"invalid-persistence-type"),(0,oe.b$)()?Nr(N!==dn.SESSION,$,"unsupported-persistence-type"):(0,oe.UG)()?Nr(N===dn.NONE,$,"unsupported-persistence-type"):Ci()?Nr(N===dn.NONE||N===dn.LOCAL&&(0,oe.hl)(),$,"unsupported-persistence-type"):Nr(N===dn.NONE||bi(),$,"unsupported-persistence-type")}(ae._delegate,B),B){case dn.SESSION:Le=P.a;break;case dn.LOCAL:Le=(yield P.az(P.i)._isAvailable())?P.i:P.b;break;case dn.NONE:Le=P.L;break;default:return P.as("argument-error",{appName:ae._delegate.name})}return ae._delegate.setPersistence(Le)})()}signInAndRetrieveDataWithCredential(B){return this.signInWithCredential(B)}signInAnonymously(){return pn(this._delegate,P.X(this._delegate))}signInWithCredential(B){return pn(this._delegate,P.Y(this._delegate,B))}signInWithCustomToken(B){return pn(this._delegate,P.$(this._delegate,B))}signInWithEmailAndPassword(B,ae){return pn(this._delegate,P.a6(this._delegate,B,ae))}signInWithEmailLink(B,ae){return pn(this._delegate,P.a9(this._delegate,B,ae))}signInWithPhoneNumber(B,ae){return _t(this._delegate,P.s(this._delegate,B,ae))}signInWithPopup(B){var ae=this;return(0,_.Z)(function*(){return Xe(Hn(),ae._delegate,"operation-not-supported-in-this-environment"),pn(ae._delegate,P.c(ae._delegate,B,rt))})()}signInWithRedirect(B){var ae=this;return(0,_.Z)(function*(){return Xe(Hn(),ae._delegate,"operation-not-supported-in-this-environment"),yield Dn(ae._delegate),P.f(ae._delegate,B,rt)})()}updateCurrentUser(B){return this._delegate.updateCurrentUser(B)}verifyPasswordResetCode(B){return P.a4(this._delegate,B)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return $.Persistence=dn,$})();function Ke($,N,B){let ae=$;"function"!=typeof $&&({next:ae,error:N,complete:B}=$);const Le=ae;return{next:ut=>Le(ut&&ar.getOrCreate(ut)),error:N,complete:B}}function It($,N){const B=function vs($,N){const B=Kt();if(!B)return[];const ae=P.aA(Vr,$,N);switch(B.getItem(ae)){case dn.NONE:return[P.L];case dn.LOCAL:return[P.i,P.a];case dn.SESSION:return[P.a];default:return[]}}($,N);if("undefined"!=typeof self&&!B.includes(P.i)&&B.push(P.i),"undefined"!=typeof window)for(const ae of[P.b,P.a])B.includes(ae)||B.push(ae);return B.includes(P.L)||B.push(P.L),B}class Et{constructor(){this.providerId="phone",this._delegate=new P.P(Ti(G.Z.auth()))}static credential(N,B){return P.P.credential(N,B)}verifyPhoneNumber(N,B){return this._delegate.verifyPhoneNumber(N,B)}unwrap(){return this._delegate}}Et.PHONE_SIGN_IN_METHOD=P.P.PHONE_SIGN_IN_METHOD,Et.PROVIDER_ID=P.P.PROVIDER_ID;const nn=P.ax;class W{constructor(N,B,ae=G.Z.app()){var Le;nn(null===(Le=ae.options)||void 0===Le?void 0:Le.apiKey,"invalid-api-key",{appName:ae.name}),this._delegate=new P.R(N,B,ae.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Y($){$.INTERNAL.registerComponent(new ge.wA("auth-compat",N=>{const B=N.getProvider("app-compat").getImmediate(),ae=N.getProvider("auth");return new Se(B,ae)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:P.A.EMAIL_SIGNIN,PASSWORD_RESET:P.A.PASSWORD_RESET,RECOVER_EMAIL:P.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:P.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:P.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:P.A.VERIFY_EMAIL}},EmailAuthProvider:P.M,FacebookAuthProvider:P.N,GithubAuthProvider:P.T,GoogleAuthProvider:P.Q,OAuthProvider:P.U,SAMLAuthProvider:P.V,PhoneAuthProvider:Et,PhoneMultiFactorGenerator:P.m,RecaptchaVerifier:W,TwitterAuthProvider:P.W,Auth:Se,AuthCredential:P.H,Error:oe.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),$.registerVersion("@firebase/auth-compat","0.2.24")}(G.Z)},8306:(nt,Ce,F)=>{F.d(Ce,{y:()=>z});var _=F(930),G=F(727),P=F(8822),oe=F(4671);var ge=F(2416),le=F(576),ve=F(2806);let z=(()=>{class Re{constructor(He){He&&(this._subscribe=He)}lift(He){const _e=new Re;return _e.source=this,_e.operator=He,_e}subscribe(He,_e,De){const qe=function je(Re){return Re&&Re instanceof _.Lv||function re(Re){return Re&&(0,le.m)(Re.next)&&(0,le.m)(Re.error)&&(0,le.m)(Re.complete)}(Re)&&(0,G.Nn)(Re)}(He)?He:new _.Hp(He,_e,De);return(0,ve.x)(()=>{const{operator:Ge,source:Pe}=this;qe.add(Ge?Ge.call(qe,Pe):Pe?this._subscribe(qe):this._trySubscribe(qe))}),qe}_trySubscribe(He){try{return this._subscribe(He)}catch(_e){He.error(_e)}}forEach(He,_e){return new(_e=q(_e))((De,qe)=>{const Ge=new _.Hp({next:Pe=>{try{He(Pe)}catch(Ae){qe(Ae),Ge.unsubscribe()}},error:qe,complete:De});this.subscribe(Ge)})}_subscribe(He){var _e;return null===(_e=this.source)||void 0===_e?void 0:_e.subscribe(He)}[P.L](){return this}pipe(...He){return function ye(Re){return 0===Re.length?oe.y:1===Re.length?Re[0]:function(He){return Re.reduce((_e,De)=>De(_e),He)}}(He)(this)}toPromise(He){return new(He=q(He))((_e,De)=>{let qe;this.subscribe(Ge=>qe=Ge,Ge=>De(Ge),()=>_e(qe))})}}return Re.create=Ve=>new Re(Ve),Re})();function q(Re){var Ve;return null!==(Ve=null!=Re?Re:ge.v.Promise)&&void 0!==Ve?Ve:Promise}},7579:(nt,Ce,F)=>{F.d(Ce,{x:()=>ge});var _=F(8306),G=F(727);const oe=(0,F(3888).d)(ve=>function(){ve(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ce=F(8737),ye=F(2806);let ge=(()=>{class ve extends _.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(q){const re=new le(this,this);return re.operator=q,re}_throwIfClosed(){if(this.closed)throw new oe}next(q){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const re of this.currentObservers)re.next(q)}})}error(q){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=q;const{observers:re}=this;for(;re.length;)re.shift().error(q)}})}complete(){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:q}=this;for(;q.length;)q.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var q;return(null===(q=this.observers)||void 0===q?void 0:q.length)>0}_trySubscribe(q){return this._throwIfClosed(),super._trySubscribe(q)}_subscribe(q){return this._throwIfClosed(),this._checkFinalizedStatuses(q),this._innerSubscribe(q)}_innerSubscribe(q){const{hasError:re,isStopped:je,observers:Re}=this;return re||je?G.Lc:(this.currentObservers=null,Re.push(q),new G.w0(()=>{this.currentObservers=null,(0,ce.P)(Re,q)}))}_checkFinalizedStatuses(q){const{hasError:re,thrownError:je,isStopped:Re}=this;re?q.error(je):Re&&q.complete()}asObservable(){const q=new _.y;return q.source=this,q}}return ve.create=(z,q)=>new le(z,q),ve})();class le extends ge{constructor(z,q){super(),this.destination=z,this.source=q}next(z){var q,re;null===(re=null===(q=this.destination)||void 0===q?void 0:q.next)||void 0===re||re.call(q,z)}error(z){var q,re;null===(re=null===(q=this.destination)||void 0===q?void 0:q.error)||void 0===re||re.call(q,z)}complete(){var z,q;null===(q=null===(z=this.destination)||void 0===z?void 0:z.complete)||void 0===q||q.call(z)}_subscribe(z){var q,re;return null!==(re=null===(q=this.source)||void 0===q?void 0:q.subscribe(z))&&void 0!==re?re:G.Lc}}},930:(nt,Ce,F)=>{F.d(Ce,{Hp:()=>He,Lv:()=>re});var _=F(576),G=F(727),P=F(2416),oe=F(7849),ce=F(5032);const ye=ve("C",void 0,void 0);function ve(Pe,Ae,Te){return{kind:Pe,value:Ae,error:Te}}var z=F(3410),q=F(2806);class re extends G.w0{constructor(Ae){super(),this.isStopped=!1,Ae?(this.destination=Ae,(0,G.Nn)(Ae)&&Ae.add(this)):this.destination=Ge}static create(Ae,Te,We){return new He(Ae,Te,We)}next(Ae){this.isStopped?qe(function le(Pe){return ve("N",Pe,void 0)}(Ae),this):this._next(Ae)}error(Ae){this.isStopped?qe(function ge(Pe){return ve("E",void 0,Pe)}(Ae),this):(this.isStopped=!0,this._error(Ae))}complete(){this.isStopped?qe(ye,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ae){this.destination.next(Ae)}_error(Ae){try{this.destination.error(Ae)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const je=Function.prototype.bind;function Re(Pe,Ae){return je.call(Pe,Ae)}class Ve{constructor(Ae){this.partialObserver=Ae}next(Ae){const{partialObserver:Te}=this;if(Te.next)try{Te.next(Ae)}catch(We){_e(We)}}error(Ae){const{partialObserver:Te}=this;if(Te.error)try{Te.error(Ae)}catch(We){_e(We)}else _e(Ae)}complete(){const{partialObserver:Ae}=this;if(Ae.complete)try{Ae.complete()}catch(Te){_e(Te)}}}class He extends re{constructor(Ae,Te,We){let ne;if(super(),(0,_.m)(Ae)||!Ae)ne={next:null!=Ae?Ae:void 0,error:null!=Te?Te:void 0,complete:null!=We?We:void 0};else{let pe;this&&P.v.useDeprecatedNextContext?(pe=Object.create(Ae),pe.unsubscribe=()=>this.unsubscribe(),ne={next:Ae.next&&Re(Ae.next,pe),error:Ae.error&&Re(Ae.error,pe),complete:Ae.complete&&Re(Ae.complete,pe)}):ne=Ae}this.destination=new Ve(ne)}}function _e(Pe){P.v.useDeprecatedSynchronousErrorHandling?(0,q.O)(Pe):(0,oe.h)(Pe)}function qe(Pe,Ae){const{onStoppedNotification:Te}=P.v;Te&&z.z.setTimeout(()=>Te(Pe,Ae))}const Ge={closed:!0,next:ce.Z,error:function De(Pe){throw Pe},complete:ce.Z}},727:(nt,Ce,F)=>{F.d(Ce,{Lc:()=>ye,w0:()=>ce,Nn:()=>ge});var _=F(576);const P=(0,F(3888).d)(ve=>function(q){ve(this),this.message=q?`${q.length} errors occurred during unsubscription:\n${q.map((re,je)=>`${je+1}) ${re.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=q});var oe=F(8737);class ce{constructor(z){this.initialTeardown=z,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let z;if(!this.closed){this.closed=!0;const{_parentage:q}=this;if(q)if(this._parentage=null,Array.isArray(q))for(const Re of q)Re.remove(this);else q.remove(this);const{initialTeardown:re}=this;if((0,_.m)(re))try{re()}catch(Re){z=Re instanceof P?Re.errors:[Re]}const{_finalizers:je}=this;if(je){this._finalizers=null;for(const Re of je)try{le(Re)}catch(Ve){z=null!=z?z:[],Ve instanceof P?z=[...z,...Ve.errors]:z.push(Ve)}}if(z)throw new P(z)}}add(z){var q;if(z&&z!==this)if(this.closed)le(z);else{if(z instanceof ce){if(z.closed||z._hasParent(this))return;z._addParent(this)}(this._finalizers=null!==(q=this._finalizers)&&void 0!==q?q:[]).push(z)}}_hasParent(z){const{_parentage:q}=this;return q===z||Array.isArray(q)&&q.includes(z)}_addParent(z){const{_parentage:q}=this;this._parentage=Array.isArray(q)?(q.push(z),q):q?[q,z]:z}_removeParent(z){const{_parentage:q}=this;q===z?this._parentage=null:Array.isArray(q)&&(0,oe.P)(q,z)}remove(z){const{_finalizers:q}=this;q&&(0,oe.P)(q,z),z instanceof ce&&z._removeParent(this)}}ce.EMPTY=(()=>{const ve=new ce;return ve.closed=!0,ve})();const ye=ce.EMPTY;function ge(ve){return ve instanceof ce||ve&&"closed"in ve&&(0,_.m)(ve.remove)&&(0,_.m)(ve.add)&&(0,_.m)(ve.unsubscribe)}function le(ve){(0,_.m)(ve)?ve():ve.unsubscribe()}},2416:(nt,Ce,F)=>{F.d(Ce,{v:()=>_});const _={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(nt,Ce,F)=>{F.d(Ce,{E:()=>G});const G=new(F(8306).y)(ce=>ce.complete())},8996:(nt,Ce,F)=>{F.d(Ce,{D:()=>Ae});var _=F(8421),G=F(5363),P=F(9468),ye=F(8306),le=F(2202),ve=F(576),z=F(9672);function re(Te,We){if(!Te)throw new Error("Iterable cannot be null");return new ye.y(ne=>{(0,z.f)(ne,We,()=>{const pe=Te[Symbol.asyncIterator]();(0,z.f)(ne,We,()=>{pe.next().then(Ee=>{Ee.done?ne.complete():ne.next(Ee.value)})},0,!0)})})}var je=F(3670),Re=F(8239),Ve=F(1144),He=F(6495),_e=F(2206),De=F(4532),qe=F(3260);function Ae(Te,We){return We?function Pe(Te,We){if(null!=Te){if((0,je.c)(Te))return function oe(Te,We){return(0,_.Xf)(Te).pipe((0,P.R)(We),(0,G.Q)(We))}(Te,We);if((0,Ve.z)(Te))return function ge(Te,We){return new ye.y(ne=>{let pe=0;return We.schedule(function(){pe===Te.length?ne.complete():(ne.next(Te[pe++]),ne.closed||this.schedule())})})}(Te,We);if((0,Re.t)(Te))return function ce(Te,We){return(0,_.Xf)(Te).pipe((0,P.R)(We),(0,G.Q)(We))}(Te,We);if((0,_e.D)(Te))return re(Te,We);if((0,He.T)(Te))return function q(Te,We){return new ye.y(ne=>{let pe;return(0,z.f)(ne,We,()=>{pe=Te[le.h](),(0,z.f)(ne,We,()=>{let Ee,Q;try{({value:Ee,done:Q}=pe.next())}catch(te){return void ne.error(te)}Q?ne.complete():ne.next(Ee)},0,!0)}),()=>(0,ve.m)(null==pe?void 0:pe.return)&&pe.return()})}(Te,We);if((0,qe.L)(Te))return function Ge(Te,We){return re((0,qe.Q)(Te),We)}(Te,We)}throw(0,De.z)(Te)}(Te,We):(0,_.Xf)(Te)}},8421:(nt,Ce,F)=>{F.d(Ce,{Xf:()=>je});var _=F(655),G=F(1144),P=F(8239),oe=F(8306),ce=F(3670),ye=F(2206),ge=F(4532),le=F(6495),ve=F(3260),z=F(576),q=F(7849),re=F(8822);function je(Pe){if(Pe instanceof oe.y)return Pe;if(null!=Pe){if((0,ce.c)(Pe))return function Re(Pe){return new oe.y(Ae=>{const Te=Pe[re.L]();if((0,z.m)(Te.subscribe))return Te.subscribe(Ae);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Pe);if((0,G.z)(Pe))return function Ve(Pe){return new oe.y(Ae=>{for(let Te=0;Te<Pe.length&&!Ae.closed;Te++)Ae.next(Pe[Te]);Ae.complete()})}(Pe);if((0,P.t)(Pe))return function He(Pe){return new oe.y(Ae=>{Pe.then(Te=>{Ae.closed||(Ae.next(Te),Ae.complete())},Te=>Ae.error(Te)).then(null,q.h)})}(Pe);if((0,ye.D)(Pe))return De(Pe);if((0,le.T)(Pe))return function _e(Pe){return new oe.y(Ae=>{for(const Te of Pe)if(Ae.next(Te),Ae.closed)return;Ae.complete()})}(Pe);if((0,ve.L)(Pe))return function qe(Pe){return De((0,ve.Q)(Pe))}(Pe)}throw(0,ge.z)(Pe)}function De(Pe){return new oe.y(Ae=>{(function Ge(Pe,Ae){var Te,We,ne,pe;return(0,_.mG)(this,void 0,void 0,function*(){try{for(Te=(0,_.KL)(Pe);!(We=yield Te.next()).done;)if(Ae.next(We.value),Ae.closed)return}catch(Ee){ne={error:Ee}}finally{try{We&&!We.done&&(pe=Te.return)&&(yield pe.call(Te))}finally{if(ne)throw ne.error}}Ae.complete()})})(Pe,Ae).catch(Te=>Ae.error(Te))})}},6451:(nt,Ce,F)=>{F.d(Ce,{T:()=>ye});var _=F(8189),G=F(8421),P=F(515),oe=F(7669),ce=F(8996);function ye(...ge){const le=(0,oe.yG)(ge),ve=(0,oe._6)(ge,1/0),z=ge;return z.length?1===z.length?(0,G.Xf)(z[0]):(0,_.J)(ve)((0,ce.D)(z,le)):P.E}},5403:(nt,Ce,F)=>{F.d(Ce,{x:()=>G});var _=F(930);function G(oe,ce,ye,ge,le){return new P(oe,ce,ye,ge,le)}class P extends _.Lv{constructor(ce,ye,ge,le,ve,z){super(ce),this.onFinalize=ve,this.shouldUnsubscribe=z,this._next=ye?function(q){try{ye(q)}catch(re){ce.error(re)}}:super._next,this._error=le?function(q){try{le(q)}catch(re){ce.error(re)}finally{this.unsubscribe()}}:super._error,this._complete=ge?function(){try{ge()}catch(q){ce.error(q)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ce;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ye}=this;super.unsubscribe(),!ye&&(null===(ce=this.onFinalize)||void 0===ce||ce.call(this))}}}},4004:(nt,Ce,F)=>{F.d(Ce,{U:()=>P});var _=F(4482),G=F(5403);function P(oe,ce){return(0,_.e)((ye,ge)=>{let le=0;ye.subscribe((0,G.x)(ge,ve=>{ge.next(oe.call(ce,ve,le++))}))})}},8189:(nt,Ce,F)=>{F.d(Ce,{J:()=>P});var _=F(5577),G=F(4671);function P(oe=1/0){return(0,_.z)(G.y,oe)}},5577:(nt,Ce,F)=>{F.d(Ce,{z:()=>le});var _=F(4004),G=F(8421),P=F(4482),oe=F(9672),ce=F(5403),ge=F(576);function le(ve,z,q=1/0){return(0,ge.m)(z)?le((re,je)=>(0,_.U)((Re,Ve)=>z(re,Re,je,Ve))((0,G.Xf)(ve(re,je))),q):("number"==typeof z&&(q=z),(0,P.e)((re,je)=>function ye(ve,z,q,re,je,Re,Ve,He){const _e=[];let De=0,qe=0,Ge=!1;const Pe=()=>{Ge&&!_e.length&&!De&&z.complete()},Ae=We=>De<re?Te(We):_e.push(We),Te=We=>{Re&&z.next(We),De++;let ne=!1;(0,G.Xf)(q(We,qe++)).subscribe((0,ce.x)(z,pe=>{null==je||je(pe),Re?Ae(pe):z.next(pe)},()=>{ne=!0},void 0,()=>{if(ne)try{for(De--;_e.length&&De<re;){const pe=_e.shift();Ve?(0,oe.f)(z,Ve,()=>Te(pe)):Te(pe)}Pe()}catch(pe){z.error(pe)}}))};return ve.subscribe((0,ce.x)(z,Ae,()=>{Ge=!0,Pe()})),()=>{null==He||He()}}(re,je,ve,q)))}},5363:(nt,Ce,F)=>{F.d(Ce,{Q:()=>oe});var _=F(9672),G=F(4482),P=F(5403);function oe(ce,ye=0){return(0,G.e)((ge,le)=>{ge.subscribe((0,P.x)(le,ve=>(0,_.f)(le,ce,()=>le.next(ve),ye),()=>(0,_.f)(le,ce,()=>le.complete(),ye),ve=>(0,_.f)(le,ce,()=>le.error(ve),ye)))})}},3099:(nt,Ce,F)=>{F.d(Ce,{B:()=>ce});var _=F(8421),G=F(7579),P=F(930),oe=F(4482);function ce(ge={}){const{connector:le=(()=>new G.x),resetOnError:ve=!0,resetOnComplete:z=!0,resetOnRefCountZero:q=!0}=ge;return re=>{let je,Re,Ve,He=0,_e=!1,De=!1;const qe=()=>{null==Re||Re.unsubscribe(),Re=void 0},Ge=()=>{qe(),je=Ve=void 0,_e=De=!1},Pe=()=>{const Ae=je;Ge(),null==Ae||Ae.unsubscribe()};return(0,oe.e)((Ae,Te)=>{He++,!De&&!_e&&qe();const We=Ve=null!=Ve?Ve:le();Te.add(()=>{He--,0===He&&!De&&!_e&&(Re=ye(Pe,q))}),We.subscribe(Te),!je&&He>0&&(je=new P.Hp({next:ne=>We.next(ne),error:ne=>{De=!0,qe(),Re=ye(Ge,ve,ne),We.error(ne)},complete:()=>{_e=!0,qe(),Re=ye(Ge,z),We.complete()}}),(0,_.Xf)(Ae).subscribe(je))})(re)}}function ye(ge,le,...ve){if(!0===le)return void ge();if(!1===le)return;const z=new P.Hp({next:()=>{z.unsubscribe(),ge()}});return le(...ve).subscribe(z)}},9468:(nt,Ce,F)=>{F.d(Ce,{R:()=>G});var _=F(4482);function G(P,oe=0){return(0,_.e)((ce,ye)=>{ye.add(P.schedule(()=>ce.subscribe(ye),oe))})}},8505:(nt,Ce,F)=>{F.d(Ce,{b:()=>ce});var _=F(576),G=F(4482),P=F(5403),oe=F(4671);function ce(ye,ge,le){const ve=(0,_.m)(ye)||ge||le?{next:ye,error:ge,complete:le}:ye;return ve?(0,G.e)((z,q)=>{var re;null===(re=ve.subscribe)||void 0===re||re.call(ve);let je=!0;z.subscribe((0,P.x)(q,Re=>{var Ve;null===(Ve=ve.next)||void 0===Ve||Ve.call(ve,Re),q.next(Re)},()=>{var Re;je=!1,null===(Re=ve.complete)||void 0===Re||Re.call(ve),q.complete()},Re=>{var Ve;je=!1,null===(Ve=ve.error)||void 0===Ve||Ve.call(ve,Re),q.error(Re)},()=>{var Re,Ve;je&&(null===(Re=ve.unsubscribe)||void 0===Re||Re.call(ve)),null===(Ve=ve.finalize)||void 0===Ve||Ve.call(ve)}))}):oe.y}},4408:(nt,Ce,F)=>{F.d(Ce,{o:()=>ce});var _=F(727);class G extends _.w0{constructor(ge,le){super()}schedule(ge,le=0){return this}}const P={setInterval(ye,ge,...le){const{delegate:ve}=P;return(null==ve?void 0:ve.setInterval)?ve.setInterval(ye,ge,...le):setInterval(ye,ge,...le)},clearInterval(ye){const{delegate:ge}=P;return((null==ge?void 0:ge.clearInterval)||clearInterval)(ye)},delegate:void 0};var oe=F(8737);class ce extends G{constructor(ge,le){super(ge,le),this.scheduler=ge,this.work=le,this.pending=!1}schedule(ge,le=0){var ve;if(this.closed)return this;this.state=ge;const z=this.id,q=this.scheduler;return null!=z&&(this.id=this.recycleAsyncId(q,z,le)),this.pending=!0,this.delay=le,this.id=null!==(ve=this.id)&&void 0!==ve?ve:this.requestAsyncId(q,this.id,le),this}requestAsyncId(ge,le,ve=0){return P.setInterval(ge.flush.bind(ge,this),ve)}recycleAsyncId(ge,le,ve=0){if(null!=ve&&this.delay===ve&&!1===this.pending)return le;null!=le&&P.clearInterval(le)}execute(ge,le){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ve=this._execute(ge,le);if(ve)return ve;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(ge,le){let z,ve=!1;try{this.work(ge)}catch(q){ve=!0,z=q||new Error("Scheduled action threw falsy error")}if(ve)return this.unsubscribe(),z}unsubscribe(){if(!this.closed){const{id:ge,scheduler:le}=this,{actions:ve}=le;this.work=this.state=this.scheduler=null,this.pending=!1,(0,oe.P)(ve,this),null!=ge&&(this.id=this.recycleAsyncId(le,ge,null)),this.delay=null,super.unsubscribe()}}}},7565:(nt,Ce,F)=>{F.d(Ce,{v:()=>P});var _=F(6063);class G{constructor(ce,ye=G.now){this.schedulerActionCtor=ce,this.now=ye}schedule(ce,ye=0,ge){return new this.schedulerActionCtor(this,ce).schedule(ge,ye)}}G.now=_.l.now;class P extends G{constructor(ce,ye=G.now){super(ce,ye),this.actions=[],this._active=!1}flush(ce){const{actions:ye}=this;if(this._active)return void ye.push(ce);let ge;this._active=!0;do{if(ge=ce.execute(ce.state,ce.delay))break}while(ce=ye.shift());if(this._active=!1,ge){for(;ce=ye.shift();)ce.unsubscribe();throw ge}}}},4986:(nt,Ce,F)=>{F.d(Ce,{z:()=>P});var _=F(4408);const P=new(F(7565).v)(_.o)},6063:(nt,Ce,F)=>{F.d(Ce,{l:()=>_});const _={now:()=>(_.delegate||Date).now(),delegate:void 0}},3410:(nt,Ce,F)=>{F.d(Ce,{z:()=>_});const _={setTimeout(G,P,...oe){const{delegate:ce}=_;return(null==ce?void 0:ce.setTimeout)?ce.setTimeout(G,P,...oe):setTimeout(G,P,...oe)},clearTimeout(G){const{delegate:P}=_;return((null==P?void 0:P.clearTimeout)||clearTimeout)(G)},delegate:void 0}},2202:(nt,Ce,F)=>{F.d(Ce,{h:()=>G});const G=function _(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(nt,Ce,F)=>{F.d(Ce,{L:()=>_});const _="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(nt,Ce,F)=>{F.d(Ce,{_6:()=>ye,jO:()=>oe,yG:()=>ce});var _=F(576);function P(ge){return ge[ge.length-1]}function oe(ge){return(0,_.m)(P(ge))?ge.pop():void 0}function ce(ge){return function G(ge){return ge&&(0,_.m)(ge.schedule)}(P(ge))?ge.pop():void 0}function ye(ge,le){return"number"==typeof P(ge)?ge.pop():le}},8737:(nt,Ce,F)=>{function _(G,P){if(G){const oe=G.indexOf(P);0<=oe&&G.splice(oe,1)}}F.d(Ce,{P:()=>_})},3888:(nt,Ce,F)=>{function _(G){const oe=G(ce=>{Error.call(ce),ce.stack=(new Error).stack});return oe.prototype=Object.create(Error.prototype),oe.prototype.constructor=oe,oe}F.d(Ce,{d:()=>_})},2806:(nt,Ce,F)=>{F.d(Ce,{O:()=>oe,x:()=>P});var _=F(2416);let G=null;function P(ce){if(_.v.useDeprecatedSynchronousErrorHandling){const ye=!G;if(ye&&(G={errorThrown:!1,error:null}),ce(),ye){const{errorThrown:ge,error:le}=G;if(G=null,ge)throw le}}else ce()}function oe(ce){_.v.useDeprecatedSynchronousErrorHandling&&G&&(G.errorThrown=!0,G.error=ce)}},9672:(nt,Ce,F)=>{function _(G,P,oe,ce=0,ye=!1){const ge=P.schedule(function(){oe(),ye?G.add(this.schedule(null,ce)):this.unsubscribe()},ce);if(G.add(ge),!ye)return ge}F.d(Ce,{f:()=>_})},4671:(nt,Ce,F)=>{function _(G){return G}F.d(Ce,{y:()=>_})},1144:(nt,Ce,F)=>{F.d(Ce,{z:()=>_});const _=G=>G&&"number"==typeof G.length&&"function"!=typeof G},2206:(nt,Ce,F)=>{F.d(Ce,{D:()=>G});var _=F(576);function G(P){return Symbol.asyncIterator&&(0,_.m)(null==P?void 0:P[Symbol.asyncIterator])}},576:(nt,Ce,F)=>{function _(G){return"function"==typeof G}F.d(Ce,{m:()=>_})},3670:(nt,Ce,F)=>{F.d(Ce,{c:()=>P});var _=F(8822),G=F(576);function P(oe){return(0,G.m)(oe[_.L])}},6495:(nt,Ce,F)=>{F.d(Ce,{T:()=>P});var _=F(2202),G=F(576);function P(oe){return(0,G.m)(null==oe?void 0:oe[_.h])}},8239:(nt,Ce,F)=>{F.d(Ce,{t:()=>G});var _=F(576);function G(P){return(0,_.m)(null==P?void 0:P.then)}},3260:(nt,Ce,F)=>{F.d(Ce,{L:()=>oe,Q:()=>P});var _=F(655),G=F(576);function P(ce){return(0,_.FC)(this,arguments,function*(){const ge=ce.getReader();try{for(;;){const{value:le,done:ve}=yield(0,_.qq)(ge.read());if(ve)return yield(0,_.qq)(void 0);yield yield(0,_.qq)(le)}}finally{ge.releaseLock()}})}function oe(ce){return(0,G.m)(null==ce?void 0:ce.getReader)}},4482:(nt,Ce,F)=>{F.d(Ce,{A:()=>G,e:()=>P});var _=F(576);function G(oe){return(0,_.m)(null==oe?void 0:oe.lift)}function P(oe){return ce=>{if(G(ce))return ce.lift(function(ye){try{return oe(ye,this)}catch(ge){this.error(ge)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(nt,Ce,F)=>{function _(){}F.d(Ce,{Z:()=>_})},7849:(nt,Ce,F)=>{F.d(Ce,{h:()=>P});var _=F(2416),G=F(3410);function P(oe){G.z.setTimeout(()=>{const{onUnhandledError:ce}=_.v;if(!ce)throw oe;ce(oe)})}},4532:(nt,Ce,F)=>{function _(G){return new TypeError(`You provided ${null!==G&&"object"==typeof G?"an invalid object":`'${G}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}F.d(Ce,{z:()=>_})},655:(nt,Ce,F)=>{function oe(Q,te){var ie={};for(var we in Q)Object.prototype.hasOwnProperty.call(Q,we)&&te.indexOf(we)<0&&(ie[we]=Q[we]);if(null!=Q&&"function"==typeof Object.getOwnPropertySymbols){var de=0;for(we=Object.getOwnPropertySymbols(Q);de<we.length;de++)te.indexOf(we[de])<0&&Object.prototype.propertyIsEnumerable.call(Q,we[de])&&(ie[we[de]]=Q[we[de]])}return ie}function le(Q,te,ie,we){return new(ie||(ie=Promise))(function(Fe,pt){function en(ln){try{Ze(we.next(ln))}catch(Tn){pt(Tn)}}function Ft(ln){try{Ze(we.throw(ln))}catch(Tn){pt(Tn)}}function Ze(ln){ln.done?Fe(ln.value):function de(Fe){return Fe instanceof ie?Fe:new ie(function(pt){pt(Fe)})}(ln.value).then(en,Ft)}Ze((we=we.apply(Q,te||[])).next())})}function _e(Q){return this instanceof _e?(this.v=Q,this):new _e(Q)}function De(Q,te,ie){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var de,we=ie.apply(Q,te||[]),Fe=[];return de={},pt("next"),pt("throw"),pt("return"),de[Symbol.asyncIterator]=function(){return this},de;function pt(cn){we[cn]&&(de[cn]=function(tn){return new Promise(function($t,Yt){Fe.push([cn,tn,$t,Yt])>1||en(cn,tn)})})}function en(cn,tn){try{!function Ft(cn){cn.value instanceof _e?Promise.resolve(cn.value.v).then(Ze,ln):Tn(Fe[0][2],cn)}(we[cn](tn))}catch($t){Tn(Fe[0][3],$t)}}function Ze(cn){en("next",cn)}function ln(cn){en("throw",cn)}function Tn(cn,tn){cn(tn),Fe.shift(),Fe.length&&en(Fe[0][0],Fe[0][1])}}function Ge(Q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ie,te=Q[Symbol.asyncIterator];return te?te.call(Q):(Q=function re(Q){var te="function"==typeof Symbol&&Symbol.iterator,ie=te&&Q[te],we=0;if(ie)return ie.call(Q);if(Q&&"number"==typeof Q.length)return{next:function(){return Q&&we>=Q.length&&(Q=void 0),{value:Q&&Q[we++],done:!Q}}};throw new TypeError(te?"Object is not iterable.":"Symbol.iterator is not defined.")}(Q),ie={},we("next"),we("throw"),we("return"),ie[Symbol.asyncIterator]=function(){return this},ie);function we(Fe){ie[Fe]=Q[Fe]&&function(pt){return new Promise(function(en,Ft){!function de(Fe,pt,en,Ft){Promise.resolve(Ft).then(function(Ze){Fe({value:Ze,done:en})},pt)}(en,Ft,(pt=Q[Fe](pt)).done,pt.value)})}}}F.d(Ce,{FC:()=>De,KL:()=>Ge,_T:()=>oe,mG:()=>le,qq:()=>_e})},5e3:(nt,Ce,F)=>{F.d(Ce,{$8M:()=>ds,$Z:()=>Ff,AFp:()=>Tb,AaK:()=>le,CHM:()=>Ru,CRH:()=>e0,CZH:()=>vp,CqO:()=>dr,EJc:()=>Db,EpF:()=>iv,F4k:()=>sv,FYo:()=>$v,FiY:()=>dt,G48:()=>k0,GfV:()=>Hv,JOm:()=>ha,LFG:()=>R,LSH:()=>Yu,Lbi:()=>m0,MAs:()=>ot,NdJ:()=>Qd,OlP:()=>Un,Oqu:()=>wm,PXZ:()=>D0,Q6J:()=>Ls,QGY:()=>ru,Qsj:()=>Lm,R0b:()=>Fs,RDi:()=>Rl,Rgc:()=>dp,SBq:()=>ph,Sil:()=>v0,Suo:()=>Jv,TTD:()=>Sa,TgZ:()=>Fo,VLi:()=>T0,X6Q:()=>pu,XFs:()=>wt,Xpm:()=>Et,Y36:()=>ue,YKP:()=>gh,YNc:()=>al,Yjl:()=>Le,Yz7:()=>tn,ZZ4:()=>co,_UZ:()=>nu,_Vd:()=>fh,_c5:()=>WS,_uU:()=>mI,aQg:()=>Th,c2e:()=>_0,cJS:()=>Yt,cg1:()=>Sm,dDg:()=>xb,deG:()=>md,dqk:()=>Zt,eFA:()=>Pb,g9A:()=>r_,h0i:()=>lu,hGG:()=>xR,iGM:()=>fp,ifc:()=>Kt,ip1:()=>Cb,kL8:()=>ya,lG2:()=>ae,oAB:()=>$,q4F:()=>ZI,qLn:()=>Eg,qZA:()=>pm,s9C:()=>ir,sBO:()=>VS,sIi:()=>il,s_b:()=>Vm,soG:()=>wl,tBr:()=>kt,tb:()=>Oc,tp0:()=>tr,uIk:()=>cm,vHH:()=>Ve,vpe:()=>Ln,wAp:()=>Dt,xp6:()=>dE,z2F:()=>bp,zSh:()=>rc,zs3:()=>uo});var _=F(7579),G=F(727),P=F(8306),oe=F(6451),ce=F(3099);function ye(s){for(let o in s)if(s[o]===ye)return o;throw Error("Could not find renamed property on target object.")}function le(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(le).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function ve(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const z=ye({__forward_ref__:ye});function q(s){return s.__forward_ref__=q,s.toString=function(){return le(this())},s}function re(s){return function je(s){return"function"==typeof s&&s.hasOwnProperty(z)&&s.__forward_ref__===q}(s)?s():s}class Ve extends Error{constructor(o,u){super(function He(s,o){return`NG0${Math.abs(s)}${o?": "+o:""}`}(o,u)),this.code=o}}function _e(s){return"string"==typeof s?s:null==s?"":String(s)}function De(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():_e(s)}function Ae(s,o){const u=o?` in ${o}`:"";throw new Ve(-201,`No provider for ${De(s)} found${u}`)}function Ft(s,o){null==s&&function Ze(s,o,u,c){throw new Error(`ASSERTION ERROR: ${s}`+(null==c?"":` [Expected=> ${u} ${c} ${o} <=Actual]`))}(o,s,null,"!=")}function tn(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function Yt(s){return{providers:s.providers||[],imports:s.imports||[]}}function Nn(s){return Qr(s,bi)||Qr(s,Hn)}function Qr(s,o){return s.hasOwnProperty(o)?s[o]:null}function ns(s){return s&&(s.hasOwnProperty(Ci)||s.hasOwnProperty(rs))?s[Ci]:null}const bi=ye({\u0275prov:ye}),Ci=ye({\u0275inj:ye}),Hn=ye({ngInjectableDef:ye}),rs=ye({ngInjectorDef:ye});var wt=(()=>((wt=wt||{})[wt.Default=0]="Default",wt[wt.Host=1]="Host",wt[wt.Self=2]="Self",wt[wt.SkipSelf=4]="SkipSelf",wt[wt.Optional=8]="Optional",wt))();let kr;function dn(s){const o=kr;return kr=s,o}function Nr(s,o,u){const c=Nn(s);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:u&wt.Optional?null:void 0!==o?o:void Ae(le(s),"Injector")}function Br(s){return{toString:s}.toString()}var Dn=(()=>((Dn=Dn||{})[Dn.OnPush=0]="OnPush",Dn[Dn.Default=1]="Default",Dn))(),Kt=(()=>{return(s=Kt||(Kt={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",Kt;var s})();const gt="undefined"!=typeof globalThis&&globalThis,rt="undefined"!=typeof window&&window,Ti="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Zt=gt||"undefined"!=typeof global&&global||rt||Ti,pn={},_t=[],ui=ye({\u0275cmp:ye}),Gt=ye({\u0275dir:ye}),ar=ye({\u0275pipe:ye}),Xe=ye({\u0275mod:ye}),Se=ye({\u0275fac:ye}),Ke=ye({__NG_ELEMENT_ID__:ye});let It=0;function Et(s){return Br(()=>{const u={},c={type:s.type,providersResolver:null,decls:s.decls,vars:s.vars,factory:null,template:s.template||null,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:u,inputs:null,outputs:null,exportAs:s.exportAs||null,onPush:s.changeDetection===Dn.OnPush,directiveDefs:null,pipeDefs:null,selectors:s.selectors||_t,viewQuery:s.viewQuery||null,features:s.features||null,data:s.data||{},encapsulation:s.encapsulation||Kt.Emulated,id:"c",styles:s.styles||_t,_:null,setInput:null,schemas:s.schemas||null,tView:null},d=s.directives,f=s.features,y=s.pipes;return c.id+=It++,c.inputs=B(s.inputs,u),c.outputs=B(s.outputs),f&&f.forEach(E=>E(c)),c.directiveDefs=d?()=>("function"==typeof d?d():d).map(W):null,c.pipeDefs=y?()=>("function"==typeof y?y():y).map(H):null,c})}function W(s){return et(s)||function ut(s){return s[Gt]||null}(s)}function H(s){return function Mt(s){return s[ar]||null}(s)}const Y={};function $(s){return Br(()=>{const o={type:s.type,bootstrap:s.bootstrap||_t,declarations:s.declarations||_t,imports:s.imports||_t,exports:s.exports||_t,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null};return null!=s.id&&(Y[s.id]=s.type),o})}function B(s,o){if(null==s)return pn;const u={};for(const c in s)if(s.hasOwnProperty(c)){let d=s[c],f=d;Array.isArray(d)&&(f=d[1],d=d[0]),u[d]=c,o&&(o[d]=f)}return u}const ae=Et;function Le(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,onDestroy:s.type.prototype.ngOnDestroy||null}}function et(s){return s[ui]||null}function it(s,o){const u=s[Xe]||null;if(!u&&!0===o)throw new Error(`Type ${le(s)} does not have '\u0275mod' property.`);return u}function Ui(s){return Array.isArray(s)&&"object"==typeof s[1]}function Di(s){return Array.isArray(s)&&!0===s[1]}function Gc(s){return 0!=(8&s.flags)}function Iu(s){return 2==(2&s.flags)}function qs(s){return 1==(1&s.flags)}function Si(s){return null!==s.template}function jh(s){return 0!=(512&s[2])}function Ai(s,o){return s.hasOwnProperty(Se)?s[Se]:null}class Jo{constructor(o,u,c){this.previousValue=o,this.currentValue=u,this.firstChange=c}isFirstChange(){return this.firstChange}}function Sa(){return Aa}function Aa(s){return s.type.prototype.ngOnChanges&&(s.setInput=Xp),Hh}function Hh(){const s=Yc(this),o=null==s?void 0:s.current;if(o){const u=s.previous;if(u===pn)s.previous=o;else for(let c in o)u[c]=o[c];s.current=null,this.ngOnChanges(o)}}function Xp(s,o,u,c){const d=Yc(s)||function Cs(s,o){return s[_o]=o}(s,{previous:pn,current:null}),f=d.current||(d.current={}),y=d.previous,E=this.declaredInputs[u],C=y[E];f[E]=new Jo(C&&C.currentValue,o,y===pn),s[c]=o}Sa.ngInherit=!0;const _o="__ngSimpleChanges__";function Yc(s){return s[_o]||null}let Du;function Rl(s){Du=s}function En(s){return!!s.listen}const xa={createRenderer:(s,o)=>function Ts(){return void 0!==Du?Du:"undefined"!=typeof document?document:void 0}()};function mn(s){for(;Array.isArray(s);)s=s[0];return s}function wr(s,o){return mn(o[s.index])}function qn(s,o){return s.data[o]}function Er(s,o){const u=o[s];return Ui(u)?u:u[0]}function ea(s){return 4==(4&s[2])}function ss(s){return 128==(128&s[2])}function ci(s,o){return null==o?null:s[o]}function Zs(s){s[18]=0}function Ys(s,o){s[5]+=o;let u=s,c=s[3];for(;null!==c&&(1===o&&1===u[5]||-1===o&&0===u[5]);)c[5]+=o,u=c,c=c[3]}const bt={lFrame:ud(null),bindingsEnabled:!0};function ta(){return bt.bindingsEnabled}function Ne(){return bt.lFrame.lView}function Wt(){return bt.lFrame.tView}function Ru(s){return bt.lFrame.contextLView=s,s[8]}function Sn(){let s=nd();for(;null!==s&&64===s.type;)s=s.parent;return s}function nd(){return bt.lFrame.currentTNode}function os(s,o){const u=bt.lFrame;u.currentTNode=s,u.isParent=o}function Nl(){return bt.lFrame.isParent}function ra(){return bt.lFrame.bindingIndex++}function sd(s,o){const u=bt.lFrame;u.bindingIndex=u.bindingRootIndex=s,Pl(o)}function Pl(s){bt.lFrame.currentDirectiveIndex=s}function od(){return bt.lFrame.currentQueryIndex}function ad(s){bt.lFrame.currentQueryIndex=s}function Ol(s){const o=s[1];return 2===o.type?o.declTNode:1===o.type?s[6]:null}function Pa(s,o,u){if(u&wt.SkipSelf){let d=o,f=s;for(;!(d=d.parent,null!==d||u&wt.Host||(d=Ol(f),null===d||(f=f[15],10&d.type))););if(null===d)return!1;o=d,s=f}const c=bt.lFrame=Eo();return c.currentTNode=o,c.lView=s,!0}function Oa(s){const o=Eo(),u=s[1];bt.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function Eo(){const s=bt.lFrame,o=null===s?null:s.child;return null===o?ud(s):o}function ud(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function zh(){const s=bt.lFrame;return bt.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const Mu=zh;function hi(){const s=zh();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function Pr(){return bt.lFrame.selectedIndex}function Xs(s){bt.lFrame.selectedIndex=s}function Jn(){const s=bt.lFrame;return qn(s.tView,s.selectedIndex)}function As(s,o){for(let u=o.directiveStart,c=o.directiveEnd;u<c;u++){const f=s.data[u].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:E,ngAfterViewInit:C,ngAfterViewChecked:A,ngOnDestroy:M}=f;y&&(s.contentHooks||(s.contentHooks=[])).push(-u,y),E&&((s.contentHooks||(s.contentHooks=[])).push(u,E),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(u,E)),C&&(s.viewHooks||(s.viewHooks=[])).push(-u,C),A&&((s.viewHooks||(s.viewHooks=[])).push(u,A),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(u,A)),null!=M&&(s.destroyHooks||(s.destroyHooks=[])).push(u,M)}}function La(s,o,u){dd(s,o,3,u)}function Fa(s,o,u,c){(3&s[2])===u&&dd(s,o,u,c)}function _r(s,o){let u=s[2];(3&u)===o&&(u&=2047,u+=1,s[2]=u)}function dd(s,o,u,c){const f=null!=c?c:-1,y=o.length-1;let E=0;for(let C=void 0!==c?65535&s[18]:0;C<y;C++)if("number"==typeof o[C+1]){if(E=o[C],null!=c&&E>=c)break}else o[C]<0&&(s[18]+=65536),(E<f||-1==f)&&(eg(s,u,o,C),s[18]=(4294901760&s[18])+C+2),C++}function eg(s,o,u,c){const d=u[c]<0,f=u[c+1],E=s[d?-u[c]:u[c]];if(d){if(s[2]>>11<s[18]>>16&&(3&s[2])===o){s[2]+=2048;try{f.call(E)}finally{}}}else try{f.call(E)}finally{}}class oa{constructor(o,u,c){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=c}}function us(s,o,u){const c=En(s);let d=0;for(;d<u.length;){const f=u[d];if("number"==typeof f){if(0!==f)break;d++;const y=u[d++],E=u[d++],C=u[d++];c?s.setAttribute(o,E,C,y):o.setAttributeNS(y,E,C)}else{const y=f,E=u[++d];xi(y)?c&&s.setProperty(o,y,E):c?s.setAttribute(o,y,E):o.setAttribute(y,E),d++}}return d}function Jr(s){return 3===s||4===s||6===s}function xi(s){return 64===s.charCodeAt(0)}function Ua(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let c=0;c<o.length;c++){const d=o[c];"number"==typeof d?u=d:0===u||aa(s,u,d,null,-1===u||2===u?o[++c]:null)}}return s}function aa(s,o,u,c,d){let f=0,y=s.length;if(-1===o)y=-1;else for(;f<s.length;){const E=s[f++];if("number"==typeof E){if(E===o){y=-1;break}if(E>o){y=f-1;break}}}for(;f<s.length;){const E=s[f];if("number"==typeof E)break;if(E===u){if(null===c)return void(null!==d&&(s[f+1]=d));if(c===s[f+1])return void(s[f+2]=d)}f++,null!==c&&f++,null!==d&&f++}-1!==y&&(s.splice(y,0,o),f=y+1),s.splice(f++,0,u),null!==c&&s.splice(f++,0,c),null!==d&&s.splice(f++,0,d)}function fd(s){return-1!==s}function In(s){return 32767&s}function ls(s,o){let u=function Yh(s){return s>>16}(s),c=o;for(;u>0;)c=c[15],u--;return c}let Rs=!0;function Ct(s){const o=Rs;return Rs=s,o}let Bl=0;function Js(s,o){const u=eo(s,o);if(-1!==u)return u;const c=o[1];c.firstCreatePass&&(s.injectorIndex=o.length,bo(c.data,s),bo(o,null),bo(c.blueprint,null));const d=Va(s,o),f=s.injectorIndex;if(fd(d)){const y=In(d),E=ls(d,o),C=E[1].data;for(let A=0;A<8;A++)o[f+A]=E[y+A]|C[y+A]}return o[f+8]=d,f}function bo(s,o){s.push(0,0,0,0,0,0,0,0,o)}function eo(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function Va(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,c=null,d=o;for(;null!==d;){const f=d[1],y=f.type;if(c=2===y?f.declTNode:1===y?d[6]:null,null===c)return-1;if(u++,d=d[15],-1!==c.injectorIndex)return c.injectorIndex|u<<16}return-1}function cs(s,o,u){!function zn(s,o,u){let c;"string"==typeof u?c=u.charCodeAt(0)||0:u.hasOwnProperty(Ke)&&(c=u[Ke]),null==c&&(c=u[Ke]=Bl++);const d=255&c;o.data[s+(d>>5)]|=1<<d}(s,o,u)}function ua(s,o,u){if(u&wt.Optional)return s;Ae(o,"NodeInjector")}function ja(s,o,u,c){if(u&wt.Optional&&void 0===c&&(c=null),0==(u&(wt.Self|wt.Host))){const d=s[9],f=dn(void 0);try{return d?d.get(o,c,u&wt.Optional):Nr(o,c,u&wt.Optional)}finally{dn(f)}}return ua(c,o,u)}function Ms(s,o,u,c=wt.Default,d){if(null!==s){const f=function gd(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(Ke)?s[Ke]:void 0;return"number"==typeof o?o>=0?255&o:Nu:o}(u);if("function"==typeof f){if(!Pa(o,s,c))return c&wt.Host?ua(d,u,c):ja(o,u,c,d);try{const y=f(c);if(null!=y||c&wt.Optional)return y;Ae(u)}finally{Mu()}}else if("number"==typeof f){let y=null,E=eo(s,o),C=-1,A=c&wt.Host?o[16][6]:null;for((-1===E||c&wt.SkipSelf)&&(C=-1===E?Va(s,o):o[E+8],-1!==C&&jl(c,!1)?(y=o[1],E=In(C),o=ls(C,o)):E=-1);-1!==E;){const M=o[1];if(er(f,E,M.data)){const V=Ha(E,o,u,y,c,A);if(V!==$a)return V}C=o[E+8],-1!==C&&jl(c,o[1].data[E+8]===A)&&er(f,E,o)?(y=M,E=In(C),o=ls(C,o)):E=-1}}}return ja(o,u,c,d)}const $a={};function Nu(){return new Or(Sn(),Ne())}function Ha(s,o,u,c,d,f){const y=o[1],E=y.data[s+8],M=Pu(E,y,u,null==c?Iu(E)&&Rs:c!=y&&0!=(3&E.type),d&wt.Host&&f===E);return null!==M?ei(o,y,M,E):$a}function Pu(s,o,u,c,d){const f=s.providerIndexes,y=o.data,E=1048575&f,C=s.directiveStart,M=f>>20,Z=d?E+M:s.directiveEnd;for(let ee=c?E:E+M;ee<Z;ee++){const Ie=y[ee];if(ee<C&&u===Ie||ee>=C&&Ie.type===u)return ee}if(d){const ee=y[C];if(ee&&Si(ee)&&ee.type===u)return C}return null}function ei(s,o,u,c){let d=s[u];const f=o.data;if(function hd(s){return s instanceof oa}(d)){const y=d;y.resolving&&function qe(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new Ve(-200,`Circular dependency in DI detected for ${s}${u}`)}(De(f[u]));const E=Ct(y.canSeeViewProviders);y.resolving=!0;const C=y.injectImpl?dn(y.injectImpl):null;Pa(s,c,wt.Default);try{d=s[u]=y.factory(void 0,f,s,c),o.firstCreatePass&&u>=c.directiveStart&&function cd(s,o,u){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:f}=o.type.prototype;if(c){const y=Aa(o);(u.preOrderHooks||(u.preOrderHooks=[])).push(s,y),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,y)}d&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-s,d),f&&((u.preOrderHooks||(u.preOrderHooks=[])).push(s,f),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,f))}(u,f[u],o)}finally{null!==C&&dn(C),Ct(E),y.resolving=!1,Mu()}}return d}function er(s,o,u){return!!(u[o+(s>>5)]&1<<s)}function jl(s,o){return!(s&wt.Self||s&wt.Host&&o)}class Or{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,c){return Ms(this._tNode,this._lView,o,c,u)}}function ds(s){return function Ba(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const c=u.length;let d=0;for(;d<c;){const f=u[d];if(Jr(f))break;if(0===f)d+=2;else if("number"==typeof f)for(d++;d<c&&"string"==typeof u[d];)d++;else{if(f===o)return u[d+1];d+=2}}}return null}(Sn(),s)}const fi="__parameters__";function hs(s,o,u){return Br(()=>{const c=function br(s){return function(...u){if(s){const c=s(...u);for(const d in c)this[d]=c[d]}}}(o);function d(...f){if(this instanceof d)return c.apply(this,f),this;const y=new d(...f);return E.annotation=y,E;function E(C,A,M){const V=C.hasOwnProperty(fi)?C[fi]:Object.defineProperty(C,fi,{value:[]})[fi];for(;V.length<=M;)V.push(null);return(V[M]=V[M]||[]).push(y),C}}return u&&(d.prototype=Object.create(u.prototype)),d.prototype.ngMetadataName=s,d.annotationCls=d,d})}class Un{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=tn({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}toString(){return`InjectionToken ${this._desc}`}}const md=new Un("AnalyzeForEntryComponents");function qr(s,o){void 0===o&&(o=s);for(let u=0;u<s.length;u++){let c=s[u];Array.isArray(c)?(o===s&&(o=s.slice(0,u)),qr(c,o)):o!==s&&o.push(c)}return o}function pi(s,o){s.forEach(u=>Array.isArray(u)?pi(u,o):o(u))}function Hl(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function Wa(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}const ti={},la="__NG_DI_FLAG__",fs="ngTempTokenPath",ef=/\n/gm,ql="__source",Hu=ye({provide:String,useValue:ye});let Mi;function b(s){const o=Mi;return Mi=s,o}function D(s,o=wt.Default){if(void 0===Mi)throw new Ve(203,"");return null===Mi?Nr(s,void 0,o):Mi.get(s,o&wt.Optional?null:void 0,o)}function R(s,o=wt.Default){return(function wn(){return kr}()||D)(re(s),o)}const X=R;function se(s){const o=[];for(let u=0;u<s.length;u++){const c=re(s[u]);if(Array.isArray(c)){if(0===c.length)throw new Ve(900,"");let d,f=wt.Default;for(let y=0;y<c.length;y++){const E=c[y],C=ze(E);"number"==typeof C?-1===C?d=E.token:f|=C:d=E}o.push(R(d,f))}else o.push(R(c))}return o}function Me(s,o){return s[la]=o,s.prototype[la]=o,s}function ze(s){return s[la]}const kt=Me(hs("Inject",s=>({token:s})),-1),dt=Me(hs("Optional"),8),tr=Me(hs("SkipSelf"),4);class Zl{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}const G_=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,pg=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var nr=(()=>((nr=nr||{})[nr.NONE=0]="NONE",nr[nr.HTML=1]="HTML",nr[nr.STYLE=2]="STYLE",nr[nr.SCRIPT=3]="SCRIPT",nr[nr.URL=4]="URL",nr[nr.RESOURCE_URL=5]="RESOURCE_URL",nr))();function Yu(s){const o=function Ad(){const s=Ne();return s&&s[12]}();return o?o.sanitize(nr.URL,s)||"":function Ps(s,o){const u=function af(s){return s instanceof Zl&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see https://g.co/ng/security#xss)`)}return u===o}(s,"URL")?function Ns(s){return s instanceof Zl?s.changingThisBreaksApplicationSecurity:s}(s):function Ql(s){return(s=String(s)).match(G_)||s.match(pg)?s:"unsafe:"+s}(_e(s))}const Bw="__ngContext__";function Ni(s,o){s[Bw]=o}function q_(s){const o=function df(s){return s[Bw]||null}(s);return o?Array.isArray(o)?o:o.lView:null}function Y_(s){return s.ngOriginalError}function ET(s,...o){s.error(...o)}class Eg{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o),c=function wT(s){return s&&s.ngErrorLogger||ET}(o);c(this._console,"ERROR",o),u&&c(this._console,"ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&Y_(o);for(;u&&Y_(u);)u=Y_(u);return u||null}}const MT=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Zt))();function Mo(s){return s instanceof Function?s():s}var ha=(()=>((ha=ha||{})[ha.Important=1]="Important",ha[ha.DashCase=2]="DashCase",ha))();function X_(s,o){return undefined(s,o)}function gf(s){const o=s[3];return Di(o)?o[3]:o}function Cg(s){return zw(s[13])}function ey(s){return zw(s[4])}function zw(s){for(;null!==s&&!Di(s);)s=s[4];return s}function xd(s,o,u,c,d){if(null!=c){let f,y=!1;Di(c)?f=c:Ui(c)&&(y=!0,c=c[0]);const E=mn(c);0===s&&null!==u?null==d?Jw(o,u,E):Xu(o,u,E,d||null,!0):1===s&&null!==u?Xu(o,u,E,d||null,!0):2===s?function oE(s,o,u){const c=Ag(s,o);c&&function tE(s,o,u,c){En(s)?s.removeChild(o,u,c):o.removeChild(u)}(s,c,o,u)}(o,E,y):3===s&&o.destroyNode(E),null!=f&&function oy(s,o,u,c,d){const f=u[7];f!==mn(u)&&xd(o,s,c,f,d);for(let E=10;E<u.length;E++){const C=u[E];mf(C[1],C,s,o,c,f)}}(o,s,f,u,d)}}function mi(s,o,u){if(En(s))return s.createElement(o,u);{const c=null!==u?function Tu(s){const o=s.toLowerCase();return"svg"===o?"http://www.w3.org/2000/svg":"math"===o?"http://www.w3.org/1998/MathML/":null}(u):null;return null===c?s.createElement(o):s.createElementNS(c,o)}}function Yw(s,o){const u=s[9],c=u.indexOf(o),d=o[3];1024&o[2]&&(o[2]&=-1025,Ys(d,-1)),u.splice(c,1)}function Dg(s,o){if(s.length<=10)return;const u=10+o,c=s[u];if(c){const d=c[17];null!==d&&d!==s&&Yw(d,c),o>0&&(s[u-1][4]=c[4]);const f=Wa(s,10+o);!function PT(s,o){mf(s,o,o[11],2,null,null),o[0]=null,o[6]=null}(c[1],c);const y=f[19];null!==y&&y.detachView(f[1]),c[3]=null,c[4]=null,c[2]&=-129}return c}function Qw(s,o){if(!(256&o[2])){const u=o[11];En(u)&&u.destroyNode&&mf(s,o,u,3,null,null),function ty(s){let o=s[13];if(!o)return Sg(s[1],s);for(;o;){let u=null;if(Ui(o))u=o[13];else{const c=o[10];c&&(u=c)}if(!u){for(;o&&!o[4]&&o!==s;)Ui(o)&&Sg(o[1],o),o=o[3];null===o&&(o=s),Ui(o)&&Sg(o[1],o),u=o&&o[4]}o=u}}(o)}}function Sg(s,o){if(!(256&o[2])){o[2]&=-129,o[2]|=256,function ny(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let c=0;c<u.length;c+=2){const d=o[u[c]];if(!(d instanceof oa)){const f=u[c+1];if(Array.isArray(f))for(let y=0;y<f.length;y+=2){const E=d[f[y]],C=f[y+1];try{C.call(E)}finally{}}else try{f.call(d)}finally{}}}}(s,o),function Xw(s,o){const u=s.cleanup,c=o[7];let d=-1;if(null!==u)for(let f=0;f<u.length-1;f+=2)if("string"==typeof u[f]){const y=u[f+1],E="function"==typeof y?y(o):mn(o[y]),C=c[d=u[f+2]],A=u[f+3];"boolean"==typeof A?E.removeEventListener(u[f],C,A):A>=0?c[d=A]():c[d=-A].unsubscribe(),f+=2}else{const y=c[d=u[f+1]];u[f].call(y)}if(null!==c){for(let f=d+1;f<c.length;f++)c[f]();o[7]=null}}(s,o),1===o[1].type&&En(o[11])&&o[11].destroy();const u=o[17];if(null!==u&&Di(o[3])){u!==o[3]&&Yw(u,o);const c=o[19];null!==c&&c.detachView(s)}}}function LT(s,o,u){return function Qu(s,o,u){let c=o;for(;null!==c&&40&c.type;)c=(o=c).parent;if(null===c)return u[0];if(2&c.flags){const d=s.data[c.directiveStart].encapsulation;if(d===Kt.None||d===Kt.Emulated)return null}return wr(c,u)}(s,o.parent,u)}function Xu(s,o,u,c,d){En(s)?s.insertBefore(o,u,c,d):o.insertBefore(u,c,d)}function Jw(s,o,u){En(s)?s.appendChild(o,u):o.appendChild(u)}function eE(s,o,u,c,d){null!==c?Xu(s,o,u,c,d):Jw(s,o,u)}function Ag(s,o){return En(s)?s.parentNode(o):o.parentNode}let rE=function ry(s,o,u){return 40&s.type?wr(s,u):null};function Md(s,o,u,c){const d=LT(s,c,o),f=o[11],E=function nE(s,o,u){return rE(s,o,u)}(c.parent||o[6],c,o);if(null!=d)if(Array.isArray(u))for(let C=0;C<u.length;C++)eE(f,d,u[C],E,!1);else eE(f,d,u,E,!1)}function xg(s,o){if(null!==o){const u=o.type;if(3&u)return wr(o,s);if(4&u)return Rg(-1,s[o.index]);if(8&u){const c=o.child;if(null!==c)return xg(s,c);{const d=s[o.index];return Di(d)?Rg(-1,d):mn(d)}}if(32&u)return X_(o,s)()||mn(s[o.index]);{const c=sE(s,o);return null!==c?Array.isArray(c)?c[0]:xg(gf(s[16]),c):xg(s,o.next)}}return null}function sE(s,o){return null!==o?s[16][6].projection[o.projection]:null}function Rg(s,o){const u=10+s+1;if(u<o.length){const c=o[u],d=c[1].firstChild;if(null!==d)return xg(c,d)}return o[7]}function aE(s,o,u,c,d,f,y){for(;null!=u;){const E=c[u.index],C=u.type;if(y&&0===o&&(E&&Ni(mn(E),c),u.flags|=4),64!=(64&u.flags))if(8&C)aE(s,o,u.child,c,d,f,!1),xd(o,s,d,E,f);else if(32&C){const A=X_(u,c);let M;for(;M=A();)xd(o,s,d,M,f);xd(o,s,d,E,f)}else 16&C?fn(s,o,c,u,d,f):xd(o,s,d,E,f);u=y?u.projectionNext:u.next}}function mf(s,o,u,c,d,f){aE(u,c,s.firstChild,o,d,f,!1)}function fn(s,o,u,c,d,f){const y=u[16],C=y[6].projection[c.projection];if(Array.isArray(C))for(let A=0;A<C.length;A++)xd(o,s,d,C[A],f);else aE(s,o,C,y[3],d,f,!0)}function lE(s,o,u){En(s)?s.setAttribute(o,"style",u):o.style.cssText=u}function Dr(s,o,u){En(s)?""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u):o.className=u}function UT(s,o,u){let c=s.length;for(;;){const d=s.indexOf(o,u);if(-1===d)return d;if(0===d||s.charCodeAt(d-1)<=32){const f=o.length;if(d+f===c||s.charCodeAt(d+f)<=32)return d}u=d+1}}const me="ng-template";function qi(s,o,u){let c=0;for(;c<s.length;){let d=s[c++];if(u&&"class"===d){if(d=s[c],-1!==UT(d.toLowerCase(),o,0))return!0}else if(1===d){for(;c<s.length&&"string"==typeof(d=s[c++]);)if(d.toLowerCase()===o)return!0;return!1}}return!1}function oo(s){return 4===s.type&&s.value!==me}function ko(s,o,u){return o===(4!==s.type||u?s.value:me)}function L(s,o,u){let c=4;const d=s.attrs||[],f=function Ot(s){for(let o=0;o<s.length;o++)if(Jr(s[o]))return o;return s.length}(d);let y=!1;for(let E=0;E<o.length;E++){const C=o[E];if("number"!=typeof C){if(!y)if(4&c){if(c=2|1&c,""!==C&&!ko(s,C,u)||""===C&&1===o.length){if(No(c))return!1;y=!0}}else{const A=8&c?C:o[++E];if(8&c&&null!==s.attrs){if(!qi(s.attrs,A,u)){if(No(c))return!1;y=!0}continue}const V=Ya(8&c?"class":C,d,oo(s),u);if(-1===V){if(No(c))return!1;y=!0;continue}if(""!==A){let Z;Z=V>f?"":d[V+1].toLowerCase();const ee=8&c?Z:null;if(ee&&-1!==UT(ee,A,0)||2&c&&A!==Z){if(No(c))return!1;y=!0}}}}else{if(!y&&!No(c)&&!No(C))return!1;if(y&&No(C))continue;y=!1,c=C|1&c}}return No(c)||y}function No(s){return 0==(1&s)}function Ya(s,o,u,c){if(null===o)return-1;let d=0;if(c||!u){let f=!1;for(;d<o.length;){const y=o[d];if(y===s)return d;if(3===y||6===y)f=!0;else{if(1===y||2===y){let E=o[++d];for(;"string"==typeof E;)E=o[++d];continue}if(4===y)break;if(0===y){d+=4;continue}}d+=f?1:2}return-1}return function Mg(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const c=s[u];if("number"==typeof c)return-1;if(c===o)return u;u++}return-1}(o,s)}function mt(s,o,u=!1){for(let c=0;c<o.length;c++)if(L(s,o[c],u))return!0;return!1}function kd(s,o){return s?":not("+o.trim()+")":o}function VT(s){let o=s[0],u=1,c=2,d="",f=!1;for(;u<s.length;){let y=s[u];if("string"==typeof y)if(2&c){const E=s[++u];d+="["+y+(E.length>0?'="'+E+'"':"")+"]"}else 8&c?d+="."+y:4&c&&(d+=" "+y);else""!==d&&!No(y)&&(o+=kd(f,d),d=""),c=y,f=f||!No(c);u++}return""!==d&&(o+=kd(f,d)),o}const Bt={};function dE(s){_i(Wt(),Ne(),Pr()+s,!1)}function _i(s,o,u,c){if(!c)if(3==(3&o[2])){const f=s.preOrderCheckHooks;null!==f&&La(o,f,u)}else{const f=s.preOrderHooks;null!==f&&Fa(o,f,0,u)}Xs(u)}function TE(s,o){const u=s.contentQueries;if(null!==u)for(let c=0;c<u.length;c+=2){const d=u[c],f=u[c+1];if(-1!==f){const y=s.data[f];ad(d),y.contentQueries(2,o[f],f)}}}function ec(s,o,u,c,d,f,y,E,C,A){const M=o.blueprint.slice();return M[0]=d,M[2]=140|c,Zs(M),M[3]=M[15]=s,M[8]=u,M[10]=y||s&&s[10],M[11]=E||s&&s[11],M[12]=C||s&&s[12]||null,M[9]=A||s&&s[9]||null,M[6]=f,M[16]=2==o.type?s[16]:M,M}function cr(s,o,u,c,d){let f=s.data[o];if(null===f)f=function Kr(s,o,u,c,d){const f=nd(),y=Nl(),C=s.data[o]=function Cy(s,o,u,c,d,f){return{type:u,index:c,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?f:f&&f.parent,u,o,c,d);return null===s.firstChild&&(s.firstChild=C),null!==f&&(y?null==f.child&&null!==C.parent&&(f.child=C):null===f.next&&(f.next=C)),C}(s,o,u,c,d),function qh(){return bt.lFrame.inI18n}()&&(f.flags|=64);else if(64&f.type){f.type=u,f.value=c,f.attrs=d;const y=function Ss(){const s=bt.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();f.injectorIndex=null===y?-1:y.injectorIndex}return os(f,!0),f}function Xa(s,o,u,c){if(0===u)return-1;const d=o.length;for(let f=0;f<u;f++)o.push(c),s.blueprint.push(c),s.data.push(null);return d}function tc(s,o,u){Oa(o);try{const c=s.viewQuery;null!==c&&nc(1,c,u);const d=s.template;null!==d&&wy(s,o,d,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&TE(s,o),s.staticViewQueries&&nc(2,s.viewQuery,u);const f=s.components;null!==f&&function vy(s,o){for(let u=0;u<o.length;u++)ky(s,o[u])}(o,f)}catch(c){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),c}finally{o[2]&=-5,hi()}}function Ld(s,o,u,c){const d=o[2];if(256!=(256&d)){Oa(o);try{Zs(o),function na(s){return bt.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&wy(s,o,u,2,c);const y=3==(3&d);if(y){const A=s.preOrderCheckHooks;null!==A&&La(o,A,null)}else{const A=s.preOrderHooks;null!==A&&Fa(o,A,0,null),_r(o,0)}if(function Af(s){for(let o=Cg(s);null!==o;o=ey(o)){if(!o[2])continue;const u=o[9];for(let c=0;c<u.length;c++){const d=u[c],f=d[3];0==(1024&d[2])&&Ys(f,1),d[2]|=1024}}}(o),function zg(s){for(let o=Cg(s);null!==o;o=ey(o))for(let u=10;u<o.length;u++){const c=o[u],d=c[1];ss(c)&&Ld(d,c,d.template,c[8])}}(o),null!==s.contentQueries&&TE(s,o),y){const A=s.contentCheckHooks;null!==A&&La(o,A)}else{const A=s.contentHooks;null!==A&&Fa(o,A,1),_r(o,1)}!function CE(s,o){const u=s.hostBindingOpCodes;if(null!==u)try{for(let c=0;c<u.length;c++){const d=u[c];if(d<0)Xs(~d);else{const f=d,y=u[++c],E=u[++c];sd(y,f),E(2,o[f])}}}finally{Xs(-1)}}(s,o);const E=s.components;null!==E&&function yy(s,o){for(let u=0;u<o.length;u++)OE(s,o[u])}(o,E);const C=s.viewQuery;if(null!==C&&nc(2,C,c),y){const A=s.viewCheckHooks;null!==A&&La(o,A)}else{const A=s.viewHooks;null!==A&&Fa(o,A,2),_r(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[2]&=-73,1024&o[2]&&(o[2]&=-1025,Ys(o[3],-1))}finally{hi()}}}function qT(s,o,u,c){const d=o[10],y=ea(o);try{!y&&d.begin&&d.begin(),y&&tc(s,o,c),Ld(s,o,u,c)}finally{!y&&d.end&&d.end()}}function wy(s,o,u,c,d){const f=Pr(),y=2&c;try{Xs(-1),y&&o.length>20&&_i(s,o,20,!1),u(c,d)}finally{Xs(f)}}function Ey(s,o,u){!ta()||(function Gg(s,o,u,c){const d=u.directiveStart,f=u.directiveEnd;s.firstCreatePass||Js(u,o),Ni(c,o);const y=u.initialInputs;for(let E=d;E<f;E++){const C=s.data[E],A=Si(C);A&&xy(o,u,C);const M=ei(o,s,E,u);Ni(M,o),null!==y&&Sf(0,E-d,M,C,0,y),A&&(Er(u.index,o)[8]=M)}}(s,o,u,wr(u,o)),128==(128&u.flags)&&function ME(s,o,u){const c=u.directiveStart,d=u.directiveEnd,y=u.index,E=function Na(){return bt.lFrame.currentDirectiveIndex}();try{Xs(y);for(let C=c;C<d;C++){const A=s.data[C],M=o[C];Pl(C),(null!==A.hostBindings||0!==A.hostVars||null!==A.hostAttrs)&&Fd(A,M)}}finally{Xs(-1),Pl(E)}}(s,o,u))}function Bg(s,o,u=wr){const c=o.localNames;if(null!==c){let d=o.index+1;for(let f=0;f<c.length;f+=2){const y=c[f+1],E=-1===y?u(o,s):s[y];s[d++]=E}}}function jg(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=$g(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function $g(s,o,u,c,d,f,y,E,C,A){const M=20+c,V=M+d,Z=function Iy(s,o){const u=[];for(let c=0;c<o;c++)u.push(c<s?null:Bt);return u}(M,V),ee="function"==typeof A?A():A;return Z[1]={type:s,blueprint:Z,template:u,queries:null,viewQuery:E,declTNode:o,data:Z.slice().fill(null,M),bindingStartIndex:M,expandoStartIndex:V,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:C,consts:ee,incompleteFirstPass:!1}}function Hg(s,o,u,c){const d=FE(o);null===u?d.push(c):(d.push(u),s.firstCreatePass&&UE(s).push(c,d.length-1))}function Ty(s,o,u){for(let c in s)if(s.hasOwnProperty(c)){const d=s[c];(u=null===u?{}:u).hasOwnProperty(c)?u[c].push(o,d):u[c]=[o,d]}return u}function gs(s,o,u,c,d,f,y,E){const C=wr(o,u);let M,A=o.inputs;!E&&null!=A&&(M=A[c])?(VE(s,u,M,c,d),Iu(o)&&function SE(s,o){const u=Er(o,s);16&u[2]||(u[2]|=64)}(u,o.index)):3&o.type&&(c=function bf(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(c),d=null!=y?y(d,o.value||"",c):d,En(f)?f.setProperty(C,c,d):xi(c)||(C.setProperty?C.setProperty(c,d):C[c]=d))}function Sy(s,o,u,c){let d=!1;if(ta()){const f=function kE(s,o,u){const c=s.directiveRegistry;let d=null;if(c)for(let f=0;f<c.length;f++){const y=c[f];mt(u,y.selectors,!1)&&(d||(d=[]),cs(Js(u,o),s,y.type),Si(y)?(Pi(s,u),d.unshift(y)):d.push(y))}return d}(s,o,u),y=null===c?null:{"":-1};if(null!==f){d=!0,Df(u,s.data.length,f.length);for(let M=0;M<f.length;M++){const V=f[M];V.providersResolver&&V.providersResolver(V)}let E=!1,C=!1,A=Xa(s,o,f.length,null);for(let M=0;M<f.length;M++){const V=f[M];u.mergedAttrs=Ua(u.mergedAttrs,V.hostAttrs),Ay(s,u,o,A,V),Tf(A,V,y),null!==V.contentQueries&&(u.flags|=8),(null!==V.hostBindings||null!==V.hostAttrs||0!==V.hostVars)&&(u.flags|=128);const Z=V.type.prototype;!E&&(Z.ngOnChanges||Z.ngOnInit||Z.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(u.index),E=!0),!C&&(Z.ngOnChanges||Z.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(u.index),C=!0),A++}!function zT(s,o){const c=o.directiveEnd,d=s.data,f=o.attrs,y=[];let E=null,C=null;for(let A=o.directiveStart;A<c;A++){const M=d[A],V=M.inputs,Z=null===f||oo(o)?null:Ry(V,f);y.push(Z),E=Ty(V,A,E),C=Ty(M.outputs,A,C)}null!==E&&(E.hasOwnProperty("class")&&(o.flags|=16),E.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=y,o.inputs=E,o.outputs=C}(s,u)}y&&function NE(s,o,u){if(o){const c=s.localNames=[];for(let d=0;d<o.length;d+=2){const f=u[o[d+1]];if(null==f)throw new Ve(-301,!1);c.push(o[d],f)}}}(u,c,y)}return u.mergedAttrs=Ua(u.mergedAttrs,u.attrs),d}function tl(s,o,u,c,d,f){const y=f.hostBindings;if(y){let E=s.hostBindingOpCodes;null===E&&(E=s.hostBindingOpCodes=[]);const C=~o.index;(function RE(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(E)!=C&&E.push(C),E.push(c,d,y)}}function Fd(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function Pi(s,o){o.flags|=2,(s.components||(s.components=[])).push(o.index)}function Tf(s,o,u){if(u){if(o.exportAs)for(let c=0;c<o.exportAs.length;c++)u[o.exportAs[c]]=s;Si(o)&&(u[""]=s)}}function Df(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}function Ay(s,o,u,c,d){s.data[c]=d;const f=d.factory||(d.factory=Ai(d.type)),y=new oa(f,Si(d),null);s.blueprint[c]=y,u[c]=y,tl(s,o,0,c,Xa(s,u,d.hostVars,Bt),d)}function xy(s,o,u){const c=wr(o,s),d=jg(u),f=s[10],y=Ud(s,ec(s,d,null,u.onPush?64:16,c,o,f,f.createRenderer(c,u),null,null));s[o.index]=y}function Po(s,o,u,c,d,f){const y=wr(s,o);!function Wg(s,o,u,c,d,f,y){if(null==f)En(s)?s.removeAttribute(o,d,u):o.removeAttribute(d);else{const E=null==y?_e(f):y(f,c||"",d);En(s)?s.setAttribute(o,d,E,u):u?o.setAttributeNS(u,d,E):o.setAttribute(d,E)}}(o[11],y,f,s.value,u,c,d)}function Sf(s,o,u,c,d,f){const y=f[o];if(null!==y){const E=c.setInput;for(let C=0;C<y.length;){const A=y[C++],M=y[C++],V=y[C++];null!==E?c.setInput(u,V,A,M):u[M]=V}}}function Ry(s,o){let u=null,c=0;for(;c<o.length;){const d=o[c];if(0!==d)if(5!==d){if("number"==typeof d)break;s.hasOwnProperty(d)&&(null===u&&(u=[]),u.push(d,s[d],o[c+1])),c+=2}else c+=2;else c+=4}return u}function qg(s,o,u,c){return new Array(s,!0,!1,o,null,0,c,u,null,null)}function OE(s,o){const u=Er(o,s);if(ss(u)){const c=u[1];80&u[2]?Ld(c,u,c.template,u[8]):u[5]>0&&My(u)}}function My(s){for(let c=Cg(s);null!==c;c=ey(c))for(let d=10;d<c.length;d++){const f=c[d];if(1024&f[2]){const y=f[1];Ld(y,f,y.template,f[8])}else f[5]>0&&My(f)}const u=s[1].components;if(null!==u)for(let c=0;c<u.length;c++){const d=Er(u[c],s);ss(d)&&d[5]>0&&My(d)}}function ky(s,o){const u=Er(o,s),c=u[1];(function Kg(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])})(c,u),tc(c,u,u[8])}function Ud(s,o){return s[13]?s[14][4]=o:s[13]=o,s[14]=o,o}function Zg(s){for(;s;){s[2]|=64;const o=gf(s);if(jh(s)&&!o)return s;s=o}return null}function Vd(s){!function Yg(s){for(let o=0;o<s.components.length;o++){const u=s.components[o],c=q_(u),d=c[1];qT(d,c,d.template,u)}}(s[8])}function nc(s,o,u){ad(0),o(s,u)}const Oy=(()=>Promise.resolve(null))();function FE(s){return s[7]||(s[7]=[])}function UE(s){return s.cleanup||(s.cleanup=[])}function Fy(s,o){const u=s[9],c=u?u.get(Eg,null):null;c&&c.handleError(o)}function VE(s,o,u,c,d){for(let f=0;f<u.length;){const y=u[f++],E=u[f++],C=o[y],A=s.data[y];null!==A.setInput?A.setInput(C,d,c,E):C[E]=d}}function zi(s,o,u){const c=function yo(s,o){return mn(o[s])}(o,s);!function Kw(s,o,u){En(s)?s.setValue(o,u):o.textContent=u}(s[11],c,u)}function ao(s,o,u){let c=u?s.styles:null,d=u?s.classes:null,f=0;if(null!==o)for(let y=0;y<o.length;y++){const E=o[y];"number"==typeof E?f=E:1==f?d=ve(d,E):2==f&&(c=ve(c,E+": "+o[++y]+";"))}u?s.styles=c:s.stylesWithoutHost=c,u?s.classes=d:s.classesWithoutHost=d}const Bn=new Un("INJECTOR",-1);class xf{get(o,u=ti){if(u===ti){const c=new Error(`NullInjectorError: No provider for ${le(o)}!`);throw c.name="NullInjectorError",c}return u}}const rc=new Un("Set Injector scope."),Ja={},QT={};let Jg;function BE(){return void 0===Jg&&(Jg=new xf),Jg}function jE(s,o=null,u=null,c){const d=$E(s,o,u,c);return d._resolveInjectorDefTypes(),d}function $E(s,o=null,u=null,c){return new XT(s,u,o||BE(),c)}class XT{constructor(o,u,c,d=null){this.parent=c,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const f=[];u&&pi(u,E=>this.processProvider(E,o,u)),pi([o],E=>this.processInjectorType(E,[],f)),this.records.set(Bn,sc(void 0,this));const y=this.records.get(rc);this.scope=null!=y?y.value:null,this.source=d||("object"==typeof o?null:le(o))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(o=>o.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(o,u=ti,c=wt.Default){this.assertNotDestroyed();const d=b(this),f=dn(void 0);try{if(!(c&wt.SkipSelf)){let E=this.records.get(o);if(void 0===E){const C=function Vy(s){return"function"==typeof s||"object"==typeof s&&s instanceof Un}(o)&&Nn(o);E=C&&this.injectableDefInScope(C)?sc(ic(o),Ja):null,this.records.set(o,E)}if(null!=E)return this.hydrate(o,E)}return(c&wt.Self?BE():this.parent).get(o,u=c&wt.Optional&&u===ti?null:u)}catch(y){if("NullInjectorError"===y.name){if((y[fs]=y[fs]||[]).unshift(le(o)),d)throw y;return function yt(s,o,u,c){const d=s[fs];throw o[ql]&&d.unshift(o[ql]),s.message=function St(s,o,u,c=null){s=s&&"\n"===s.charAt(0)&&"\u0275"==s.charAt(1)?s.substr(2):s;let d=le(o);if(Array.isArray(o))d=o.map(le).join(" -> ");else if("object"==typeof o){let f=[];for(let y in o)if(o.hasOwnProperty(y)){let E=o[y];f.push(y+":"+("string"==typeof E?JSON.stringify(E):le(E)))}d=`{${f.join(", ")}}`}return`${u}${c?"("+c+")":""}[${d}]: ${s.replace(ef,"\n  ")}`}("\n"+s.message,d,u,c),s.ngTokenPath=d,s[fs]=null,s}(y,o,"R3InjectorError",this.source)}throw y}finally{dn(f),b(d)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(o=>this.get(o))}toString(){const o=[];return this.records.forEach((c,d)=>o.push(le(d))),`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ve(205,!1)}processInjectorType(o,u,c){if(!(o=re(o)))return!1;let d=ns(o);const f=null==d&&o.ngModule||void 0,y=void 0===f?o:f,E=-1!==c.indexOf(y);if(void 0!==f&&(d=ns(f)),null==d)return!1;if(null!=d.imports&&!E){let M;c.push(y);try{pi(d.imports,V=>{this.processInjectorType(V,u,c)&&(void 0===M&&(M=[]),M.push(V))})}finally{}if(void 0!==M)for(let V=0;V<M.length;V++){const{ngModule:Z,providers:ee}=M[V];pi(ee,Ie=>this.processProvider(Ie,Z,ee||_t))}}this.injectorDefTypes.add(y);const C=Ai(y)||(()=>new y);this.records.set(y,sc(C,Ja));const A=d.providers;if(null!=A&&!E){const M=o;pi(A,V=>this.processProvider(V,M,A))}return void 0!==f&&void 0!==o.providers}processProvider(o,u,c){let d=ac(o=re(o))?o:re(o&&o.provide);const f=function HE(s,o,u){return oc(s)?sc(void 0,s.useValue):sc(function Uy(s,o,u){let c;if(ac(s)){const d=re(s);return Ai(d)||ic(d)}if(oc(s))c=()=>re(s.useValue);else if(function eD(s){return!(!s||!s.useFactory)}(s))c=()=>s.useFactory(...se(s.deps||[]));else if(function JT(s){return!(!s||!s.useExisting)}(s))c=()=>R(re(s.useExisting));else{const d=re(s&&(s.useClass||s.provide));if(!function GE(s){return!!s.deps}(s))return Ai(d)||ic(d);c=()=>new d(...se(s.deps))}return c}(s),Ja)}(o);if(ac(o)||!0!==o.multi)this.records.get(d);else{let y=this.records.get(d);y||(y=sc(void 0,Ja,!0),y.factory=()=>se(y.multi),this.records.set(d,y)),d=o,y.multi.push(o)}this.records.set(d,f)}hydrate(o,u){return u.value===Ja&&(u.value=QT,u.value=u.factory()),"object"==typeof u.value&&u.value&&function WE(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this.onDestroy.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=re(o.providedIn);return"string"==typeof u?"any"===u||u===this.scope:this.injectorDefTypes.has(u)}}function ic(s){const o=Nn(s),u=null!==o?o.factory:Ai(s);if(null!==u)return u;if(s instanceof Un)throw new Ve(204,!1);if(s instanceof Function)return function nl(s){const o=s.length;if(o>0)throw function qa(s,o){const u=[];for(let c=0;c<s;c++)u.push(o);return u}(o,"?"),new Ve(204,!1);const u=function ai(s){const o=s&&(s[bi]||s[Hn]);if(o){const u=function Fn(s){if(s.hasOwnProperty("name"))return s.name;const o=(""+s).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(s);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),o}return null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new Ve(204,!1)}function sc(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function oc(s){return null!==s&&"object"==typeof s&&Hu in s}function ac(s){return"function"==typeof s}let uo=(()=>{class s{static create(u,c){var d;if(Array.isArray(u))return jE({name:""},c,u,"");{const f=null!==(d=u.name)&&void 0!==d?d:"";return jE({name:f},u.parent,u.providers,f)}}}return s.THROW_IF_NOT_FOUND=ti,s.NULL=new xf,s.\u0275prov=tn({token:s,providedIn:"any",factory:()=>R(Bn)}),s.__NG_ELEMENT_ID__=-1,s})();function qy(s,o){As(q_(s)[1],Sn())}let $d=null;function rl(){if(!$d){const s=Zt.Symbol;if(s&&s.iterator)$d=s.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<o.length;++u){const c=o[u];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&($d=c)}}}return $d}function il(s){return!!eu(s)&&(Array.isArray(s)||!(s instanceof Map)&&rl()in s)}function eu(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function yi(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function cm(s,o,u,c){const d=Ne();return yi(d,ra(),o)&&(Wt(),Po(Jn(),d,s,o,u,c)),cm}function Lo(s,o,u,c){return yi(s,ra(),u)?o+_e(u)+c:Bt}function al(s,o,u,c,d,f,y,E){const C=Ne(),A=Wt(),M=s+20,V=A.firstCreatePass?function Ar(s,o,u,c,d,f,y,E,C){const A=o.consts,M=cr(o,s,4,y||null,ci(A,E));Sy(o,u,M,ci(A,C)),As(o,M);const V=M.tViews=$g(2,M,c,d,f,o.directiveRegistry,o.pipeRegistry,null,o.schemas,A);return null!==o.queries&&(o.queries.template(o,M),V.queries=o.queries.embeddedTView(M)),M}(M,A,C,o,u,c,d,f,y):A.data[M];os(V,!1);const Z=C[11].createComment("");Md(A,C,Z,V),Ni(Z,C),Ud(C,C[M]=qg(Z,C,Z,V)),qs(V)&&Ey(A,C,V),null!=y&&Bg(C,V,E)}function ot(s){return function Ds(s,o){return s[o]}(function rd(){return bt.lFrame.contextLView}(),20+s)}function ue(s,o=wt.Default){const u=Ne();return null===u?R(s,o):Ms(Sn(),u,re(s),o)}function Ff(){throw new Error("invalid")}function Ls(s,o,u){const c=Ne();return yi(c,ra(),o)&&gs(Wt(),Jn(),c,s,o,c[11],u,!1),Ls}function ev(s,o,u,c,d){const y=d?"class":"style";VE(s,u,o.inputs[y],y,c)}function Fo(s,o,u,c){const d=Ne(),f=Wt(),y=20+s,E=d[11],C=d[y]=mi(E,o,function Jp(){return bt.lFrame.currentNamespace}()),A=f.firstCreatePass?function Uf(s,o,u,c,d,f,y){const E=o.consts,A=cr(o,s,2,d,ci(E,f));return Sy(o,u,A,ci(E,y)),null!==A.attrs&&ao(A,A.attrs,!1),null!==A.mergedAttrs&&ao(A,A.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,A),A}(y,f,d,0,o,u,c):f.data[y];os(A,!0);const M=A.mergedAttrs;null!==M&&us(E,C,M);const V=A.classes;null!==V&&Dr(E,C,V);const Z=A.styles;return null!==Z&&lE(E,C,Z),64!=(64&A.flags)&&Md(f,d,C,A),0===function ed(){return bt.lFrame.elementDepthCount}()&&Ni(C,d),function Ma(){bt.lFrame.elementDepthCount++}(),qs(A)&&(Ey(f,d,A),function DE(s,o,u){if(Gc(o)){const d=o.directiveEnd;for(let f=o.directiveStart;f<d;f++){const y=s.data[f];y.contentQueries&&y.contentQueries(1,u[f],f)}}}(f,A,d)),null!==c&&Bg(d,A),Fo}function pm(){let s=Sn();Nl()?function ka(){bt.lFrame.isParent=!1}():(s=s.parent,os(s,!1));const o=s;!function td(){bt.lFrame.elementDepthCount--}();const u=Wt();return u.firstCreatePass&&(As(u,s),Gc(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function tg(s){return 0!=(16&s.flags)}(o)&&ev(u,o,Ne(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function An(s){return 0!=(32&s.flags)}(o)&&ev(u,o,Ne(),o.stylesWithoutHost,!1),pm}function nu(s,o,u,c){return Fo(s,o,u,c),pm(),nu}function iv(){return Ne()}function ru(s){return!!s&&"function"==typeof s.then}function sv(s){return!!s&&"function"==typeof s.subscribe}const dr=sv;function Qd(s,o,u,c){const d=Ne(),f=Wt(),y=Sn();return function ov(s,o,u,c,d,f,y,E){const C=qs(c),M=s.firstCreatePass&&UE(s),V=o[8],Z=FE(o);let ee=!0;if(3&c.type||E){const Ye=wr(c,o),at=E?E(Ye):Ye,ke=Z.length,Tt=E?Qt=>E(mn(Qt[c.index])):c.index;if(En(u)){let Qt=null;if(!E&&C&&(Qt=function Pn(s,o,u,c){const d=s.cleanup;if(null!=d)for(let f=0;f<d.length-1;f+=2){const y=d[f];if(y===u&&d[f+1]===c){const E=o[7],C=d[f+2];return E.length>C?E[C]:null}"string"==typeof y&&(f+=2)}return null}(s,o,d,c.index)),null!==Qt)(Qt.__ngLastListenerFn__||Qt).__ngNextListenerFn__=f,Qt.__ngLastListenerFn__=f,ee=!1;else{f=Zi(c,o,V,f,!1);const bn=u.listen(at,d,f);Z.push(f,bn),M&&M.push(d,Tt,ke,ke+1)}}else f=Zi(c,o,V,f,!0),at.addEventListener(d,f,y),Z.push(f),M&&M.push(d,Tt,ke,y)}else f=Zi(c,o,V,f,!1);const Ie=c.outputs;let Be;if(ee&&null!==Ie&&(Be=Ie[d])){const Ye=Be.length;if(Ye)for(let at=0;at<Ye;at+=2){const Us=o[Be[at]][Be[at+1]].subscribe(f),vn=Z.length;Z.push(f,Us),M&&M.push(d,c.index,vn,-(vn+1))}}}(f,d,d[11],y,s,o,!!u,c),Qd}function fc(s,o,u,c){try{return!1!==u(c)}catch(d){return Fy(s,d),!1}}function Zi(s,o,u,c,d){return function f(y){if(y===Function)return c;const E=2&s.flags?Er(s.index,o):o;0==(32&o[2])&&Zg(E);let C=fc(o,0,c,y),A=f.__ngNextListenerFn__;for(;A;)C=fc(o,0,A,y)&&C,A=A.__ngNextListenerFn__;return d&&!1===C&&(y.preventDefault(),y.returnValue=!1),C}}function ir(s,o,u){return iu(s,"",o,"",u),ir}function iu(s,o,u,c,d){const f=Ne(),y=Lo(f,o,u,c);return y!==Bt&&gs(Wt(),Jn(),f,s,y,f[11],d,!1),iu}function mI(s,o=""){const u=Ne(),c=Wt(),d=s+20,f=c.firstCreatePass?cr(c,d,1,o,null):c.data[d],y=u[d]=function Tg(s,o){return En(s)?s.createText(o):s.createTextNode(o)}(u[11],o);Md(c,u,y,f),os(f,!1)}function wm(s){return Em("",s,""),wm}function Em(s,o,u){const c=Ne(),d=Lo(c,s,o,u);return d!==Bt&&zi(c,Pr(),d),Em}const ma=void 0;var SD=["en",[["a","p"],["AM","PM"],ma],[["AM","PM"],ma,ma],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ma,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ma,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ma,"{1} 'at' {0}",ma],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function DI(s){const u=Math.floor(Math.abs(s)),c=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===c?1:5}];let _a={};function Sm(s){const o=function oh(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=Tv(o);if(u)return u;const c=o.split("-")[0];if(u=Tv(c),u)return u;if("en"===c)return SD;throw new Error(`Missing locale data for the locale "${s}".`)}function ya(s){return Sm(s)[Dt.PluralCase]}function Tv(s){return s in _a||(_a[s]=Zt.ng&&Zt.ng.common&&Zt.ng.common.locales&&Zt.ng.common.locales[s]),_a[s]}var Dt=(()=>((Dt=Dt||{})[Dt.LocaleId=0]="LocaleId",Dt[Dt.DayPeriodsFormat=1]="DayPeriodsFormat",Dt[Dt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Dt[Dt.DaysFormat=3]="DaysFormat",Dt[Dt.DaysStandalone=4]="DaysStandalone",Dt[Dt.MonthsFormat=5]="MonthsFormat",Dt[Dt.MonthsStandalone=6]="MonthsStandalone",Dt[Dt.Eras=7]="Eras",Dt[Dt.FirstDayOfWeek=8]="FirstDayOfWeek",Dt[Dt.WeekendRange=9]="WeekendRange",Dt[Dt.DateFormat=10]="DateFormat",Dt[Dt.TimeFormat=11]="TimeFormat",Dt[Dt.DateTimeFormat=12]="DateTimeFormat",Dt[Dt.NumberSymbols=13]="NumberSymbols",Dt[Dt.NumberFormats=14]="NumberFormats",Dt[Dt.CurrencyCode=15]="CurrencyCode",Dt[Dt.CurrencySymbol=16]="CurrencySymbol",Dt[Dt.CurrencyName=17]="CurrencyName",Dt[Dt.Currencies=18]="Currencies",Dt[Dt.Directionality=19]="Directionality",Dt[Dt.PluralCase=20]="PluralCase",Dt[Dt.ExtraData=21]="ExtraData",Dt))();const hr="en-US";let Qi=hr;class pl{}class KI{resolveComponentFactory(o){throw function Cc(s){const o=Error(`No component factory found for ${le(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let fh=(()=>{class s{}return s.NULL=new KI,s})();function jv(){return Tc(Sn(),Ne())}function Tc(s,o){return new ph(wr(s,o))}let ph=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=jv,s})();function tS(s){return s instanceof ph?s.nativeElement:s}class $v{}let Lm=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function Dc(){const s=Ne(),u=Er(Sn().index,s);return function np(s){return s[11]}(Ui(u)?u:s)}(),s})(),rS=(()=>{class s{}return s.\u0275prov=tn({token:s,providedIn:"root",factory:()=>null}),s})();class Hv{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const ZI=new Hv("13.3.11"),Gv={};function Fm(s,o,u,c,d=!1){for(;null!==u;){const f=o[u.index];if(null!==f&&c.push(mn(f)),Di(f))for(let E=10;E<f.length;E++){const C=f[E],A=C[1].firstChild;null!==A&&Fm(C[1],C,A,c)}const y=u.type;if(8&y)Fm(s,o,u.child,c);else if(32&y){const E=X_(u,o);let C;for(;C=E();)c.push(C)}else if(16&y){const E=sE(o,u);if(Array.isArray(E))c.push(...E);else{const C=gf(o[16]);Fm(C[1],C,E,c,!0)}}u=d?u.projectionNext:u.next}return c}class uu{constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,u=o[1];return Fm(u,o,u.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(Di(o)){const u=o[8],c=u?u.indexOf(this):-1;c>-1&&(Dg(o,c),Wa(u,c))}this._attachedToViewContainer=!1}Qw(this._lView[1],this._lView)}onDestroy(o){Hg(this._lView[1],this._lView,null,o)}markForCheck(){Zg(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function Ny(s,o,u){const c=o[10];c.begin&&c.begin();try{Ld(s,o,s.template,u)}catch(d){throw Fy(o,d),d}finally{c.end&&c.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ve(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Jl(s,o){mf(s,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Ve(902,"");this._appRef=o}}class Sc extends uu{constructor(o){super(o),this._view=o}detectChanges(){Vd(this._view)}checkNoChanges(){}get context(){return null}}class ml extends fh{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=et(o);return new rp(u,this.ngModule)}}function Wv(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class rp extends pl{constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function uy(s){return s.map(VT).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return Wv(this.componentDef.inputs)}get outputs(){return Wv(this.componentDef.outputs)}create(o,u,c,d){const f=(d=d||this.ngModule)?function sS(s,o){return{get:(u,c,d)=>{const f=s.get(u,Gv,d);return f!==Gv||c===Gv?f:o.get(u,c,d)}}}(o,d.injector):o,y=f.get($v,xa),E=f.get(rS,null),C=y.createRenderer(null,this.componentDef),A=this.componentDef.selectors[0][0]||"div",M=c?function If(s,o,u){if(En(s))return s.selectRootElement(o,u===Kt.ShadowDom);let c="string"==typeof o?s.querySelector(o):o;return c.textContent="",c}(C,c,this.componentDef.encapsulation):mi(y.createRenderer(null,this.componentDef),A,function iS(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(A)),V=this.componentDef.onPush?576:528,Z=function Wy(s,o){return{components:[],scheduler:s||MT,clean:Oy,playerHandler:o||null,flags:0}}(),ee=$g(0,null,null,1,0,null,null,null,null,null),Ie=ec(null,ee,Z,V,null,null,y,C,E,f);let Be,Ye;Oa(Ie);try{const at=function pa(s,o,u,c,d,f){const y=u[1];u[20]=s;const C=cr(y,20,2,"#host",null),A=C.mergedAttrs=o.hostAttrs;null!==A&&(ao(C,A,!0),null!==s&&(us(d,s,A),null!==C.classes&&Dr(d,s,C.classes),null!==C.styles&&lE(d,s,C.styles)));const M=c.createRenderer(s,o),V=ec(u,jg(o),null,o.onPush?64:16,u[20],C,c,M,f||null,null);return y.firstCreatePass&&(cs(Js(C,u),y,o.type),Pi(y,C),Df(C,u.length,1)),Ud(u,V),u[20]=V}(M,this.componentDef,Ie,y,C);if(M)if(c)us(C,M,["ng-version",ZI.full]);else{const{attrs:ke,classes:Tt}=function BT(s){const o=[],u=[];let c=1,d=2;for(;c<s.length;){let f=s[c];if("string"==typeof f)2===d?""!==f&&o.push(f,s[++c]):8===d&&u.push(f);else{if(!No(d))break;d=f}c++}return{attrs:o,classes:u}}(this.componentDef.selectors[0]);ke&&us(C,M,ke),Tt&&Tt.length>0&&Dr(C,M,Tt.join(" "))}if(Ye=qn(ee,20),void 0!==u){const ke=Ye.projection=[];for(let Tt=0;Tt<this.ngContentSelectors.length;Tt++){const Qt=u[Tt];ke.push(null!=Qt?Array.from(Qt):null)}}Be=function Gy(s,o,u,c,d){const f=u[1],y=function KT(s,o,u){const c=Sn();s.firstCreatePass&&(u.providersResolver&&u.providersResolver(u),Ay(s,c,o,Xa(s,o,1,null),u));const d=ei(o,s,c.directiveStart,c);Ni(d,o);const f=wr(c,o);return f&&Ni(f,o),d}(f,u,o);if(c.components.push(y),s[8]=y,d&&d.forEach(C=>C(y,o)),o.contentQueries){const C=Sn();o.contentQueries(1,y,C.directiveStart)}const E=Sn();return!f.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(Xs(E.index),tl(u[1],E,0,E.directiveStart,E.directiveEnd,o),Fd(o,y)),y}(at,this.componentDef,Ie,Z,[qy]),tc(ee,Ie,null)}finally{hi()}return new YI(this.componentType,Be,Tc(Ye,Ie),Ie,Ye)}}class YI extends class Pm{}{constructor(o,u,c,d,f){super(),this.location=c,this._rootLView=d,this._tNode=f,this.instance=u,this.hostView=this.changeDetectorRef=new Sc(d),this.componentType=o}get injector(){return new Or(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}class lu{}class gh{}const Ac=new Map;class cu extends lu{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new ml(this);const c=it(o);this._bootstrapComponents=Mo(c.bootstrap),this._r3Injector=$E(o,u,[{provide:lu,useValue:this},{provide:fh,useValue:this.componentFactoryResolver}],le(o)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(o)}get(o,u=uo.THROW_IF_NOT_FOUND,c=wt.Default){return o===uo||o===lu||o===Bn?this:this._r3Injector.get(o,u,c)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class _l extends gh{constructor(o){super(),this.moduleType=o,null!==it(o)&&function QI(s){const o=new Set;!function u(c){const d=it(c,!0),f=d.id;null!==f&&(function Ji(s,o,u){if(o&&o!==u)throw new Error(`Duplicate module registered for ${s} - ${le(o)} vs ${le(o.name)}`)}(f,Ac.get(f),c),Ac.set(f,c));const y=Mo(d.imports);for(const E of y)o.has(E)||(o.add(E),u(E))}(s)}(o)}create(o){return new cu(this.moduleType,o)}}function cp(s){return o=>{setTimeout(s,void 0,o)}}const Ln=class fS extends _.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,c){var d,f,y;let E=o,C=u||(()=>null),A=c;if(o&&"object"==typeof o){const V=o;E=null===(d=V.next)||void 0===d?void 0:d.bind(V),C=null===(f=V.error)||void 0===f?void 0:f.bind(V),A=null===(y=V.complete)||void 0===y?void 0:y.bind(V)}this.__isAsync&&(C=cp(C),E&&(E=cp(E)),A&&(A=cp(A)));const M=super.subscribe({next:E,error:C,complete:A});return o instanceof G.w0&&o.add(M),M}};function pS(){return this._results[rl()]()}class Zv{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=rl(),c=Zv.prototype;c[u]||(c[u]=pS)}get changes(){return this._changes||(this._changes=new Ln)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const c=this;c.dirty=!1;const d=qr(o);(this._changesDetected=!function $l(s,o,u){if(s.length!==o.length)return!1;for(let c=0;c<s.length;c++){let d=s[c],f=o[c];if(u&&(d=u(d),f=u(f)),f!==d)return!1}return!0}(c._results,d,u))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let dp=(()=>{class s{}return s.__NG_ELEMENT_ID__=mS,s})();const gS=dp,ab=class extends gS{constructor(o,u,c){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=c}createEmbeddedView(o){const u=this._declarationTContainer.tViews,c=ec(this._declarationLView,u,o,16,null,u.declTNode,null,null,null,null);c[17]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[19];return null!==f&&(c[19]=f.createEmbeddedView(u)),tc(u,c,o),new uu(c)}};function mS(){return Mc(Sn(),Ne())}function Mc(s,o){return 4&s.type?new ab(o,s,Tc(s,o)):null}let Vm=(()=>{class s{}return s.__NG_ELEMENT_ID__=ub,s})();function ub(){return jm(Sn(),Ne())}const Yv=Vm,Bm=class extends Yv{constructor(o,u,c){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=c}get element(){return Tc(this._hostTNode,this._hostLView)}get injector(){return new Or(this._hostTNode,this._hostLView)}get parentInjector(){const o=Va(this._hostTNode,this._hostLView);if(fd(o)){const u=ls(o,this._hostLView),c=In(o);return new Or(u[1].data[c+8],u)}return new Or(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=_h(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,u,c){const d=o.createEmbeddedView(u||{});return this.insert(d,c),d}createComponent(o,u,c,d,f){const y=o&&!function So(s){return"function"==typeof s}(o);let E;if(y)E=u;else{const V=u||{};E=V.index,c=V.injector,d=V.projectableNodes,f=V.ngModuleRef}const C=y?o:new rp(et(o)),A=c||this.parentInjector;if(!f&&null==C.ngModule){const Z=(y?A:this.parentInjector).get(lu,null);Z&&(f=Z)}const M=C.create(A,d,void 0,f);return this.insert(M.hostView,E),M}insert(o,u){const c=o._lView,d=c[1];if(function kl(s){return Di(s[3])}(c)){const M=this.indexOf(o);if(-1!==M)this.detach(M);else{const V=c[3],Z=new Bm(V,V[6],V[3]);Z.detach(Z.indexOf(o))}}const f=this._adjustIndex(u),y=this._lContainer;!function Rd(s,o,u,c){const d=10+c,f=u.length;c>0&&(u[d-1][4]=o),c<f-10?(o[4]=u[d],Hl(u,10+c,o)):(u.push(o),o[4]=null),o[3]=u;const y=o[17];null!==y&&u!==y&&function OT(s,o){const u=s[9];o[16]!==o[3][3][16]&&(s[2]=!0),null===u?s[9]=[o]:u.push(o)}(y,o);const E=o[19];null!==E&&E.insertView(s),o[2]|=128}(d,c,y,f);const E=Rg(f,y),C=c[11],A=Ag(C,y[7]);return null!==A&&function Zw(s,o,u,c,d,f){c[0]=d,c[6]=o,mf(s,c,u,1,d,f)}(d,y[6],C,c,A,E),o.attachToViewContainerRef(),Hl(yh(y),f,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=_h(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),c=Dg(this._lContainer,u);c&&(Wa(yh(this._lContainer),u),Qw(c[1],c))}detach(o){const u=this._adjustIndex(o,-1),c=Dg(this._lContainer,u);return c&&null!=Wa(yh(this._lContainer),u)?new uu(c):null}_adjustIndex(o,u=0){return null==o?this.length+u:o}};function _h(s){return s[8]}function yh(s){return s[8]||(s[8]=[])}function jm(s,o){let u;const c=o[s.index];if(Di(c))u=c;else{let d;if(8&s.type)d=mn(c);else{const f=o[11];d=f.createComment("");const y=wr(s,o);Xu(f,Ag(f,y),d,function FT(s,o){return En(s)?s.nextSibling(o):o.nextSibling}(f,y),!1)}o[s.index]=u=qg(c,o,d,s),Ud(o,u)}return new Bm(u,s,o)}class $m{constructor(o){this.queryList=o,this.matches=null}clone(){return new $m(this.queryList)}setDirty(){this.queryList.setDirty()}}class Hm{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const c=null!==o.contentQueries?o.contentQueries[0]:u.length,d=[];for(let f=0;f<c;f++){const y=u.getByIndex(f);d.push(this.queries[y.indexInDeclarationView].clone())}return new Hm(d)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==n0(o,u).matches&&this.queries[u].setDirty()}}class Gm{constructor(o,u,c=null){this.predicate=o,this.flags=u,this.read=c}}class Xv{constructor(o=[]){this.queries=o}elementStart(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let c=0;c<this.length;c++){const d=null!==u?u.length:0,f=this.getByIndex(c).embeddedTView(o,d);f&&(f.indexInDeclarationView=c,null!==u?u.push(f):u=[f])}return null!==u?new Xv(u):null}template(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class Wm{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new Wm(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let c=o.parent;for(;null!==c&&8&c.type&&c.index!==u;)c=c.parent;return u===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const f=c[d];this.matchTNodeWithReadOption(o,u,_S(u,f)),this.matchTNodeWithReadOption(o,u,Pu(u,o,f,!1,!1))}else c===dp?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,Pu(u,o,c,!1,!1))}matchTNodeWithReadOption(o,u,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===ph||d===Vm||d===dp&&4&u.type)this.addMatch(u.index,-2);else{const f=Pu(u,o,d,!1,!1);null!==f&&this.addMatch(u.index,f)}else this.addMatch(u.index,c)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function _S(s,o){const u=s.localNames;if(null!==u)for(let c=0;c<u.length;c+=2)if(u[c]===o)return u[c+1];return null}function yS(s,o,u,c){return-1===u?function cb(s,o){return 11&s.type?Tc(s,o):4&s.type?Mc(s,o):null}(o,s):-2===u?function vh(s,o,u){return u===ph?Tc(o,s):u===dp?Mc(o,s):u===Vm?jm(o,s):void 0}(s,o,c):ei(s,s[1],u,o)}function kc(s,o,u,c){const d=o[19].queries[c];if(null===d.matches){const f=s.data,y=u.matches,E=[];for(let C=0;C<y.length;C+=2){const A=y[C];E.push(A<0?null:yS(o,f[A],y[C+1],u.metadata.read))}d.matches=E}return d.matches}function hp(s,o,u,c){const d=s.queries.getByIndex(u),f=d.matches;if(null!==f){const y=kc(s,o,d,u);for(let E=0;E<f.length;E+=2){const C=f[E];if(C>0)c.push(y[E/2]);else{const A=f[E+1],M=o[-C];for(let V=10;V<M.length;V++){const Z=M[V];Z[17]===Z[3]&&hp(Z[1],Z,A,c)}if(null!==M[9]){const V=M[9];for(let Z=0;Z<V.length;Z++){const ee=V[Z];hp(ee[1],ee,A,c)}}}}}return c}function fp(s){const o=Ne(),u=Wt(),c=od();ad(c+1);const d=n0(u,c);if(s.dirty&&ea(o)===(2==(2&d.metadata.flags))){if(null===d.matches)s.reset([]);else{const f=d.crossesNgTemplate?hp(u,o,c,[]):kc(u,o,d,c);s.reset(f,tS),s.notifyOnChanges()}return!0}return!1}function Jv(s,o,u,c){const d=Wt();if(d.firstCreatePass){const f=Sn();(function hb(s,o,u){null===s.queries&&(s.queries=new Xv),s.queries.track(new Wm(o,u))})(d,new Gm(o,u,c),f.index),function t0(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(d,s),2==(2&u)&&(d.staticContentQueries=!0)}!function qm(s,o,u){const c=new Zv(4==(4&u));Hg(s,o,c,c.destroy),null===o[19]&&(o[19]=new Hm),o[19].queries.push(new $m(c))}(d,Ne(),u)}function e0(){return function vS(s,o){return s[19].queries[o].queryList}(Ne(),od())}function n0(s,o){return s.queries.getByIndex(o)}function t_(...s){}const Cb=new Un("Application Initializer");let vp=(()=>{class s{constructor(u){this.appInits=u,this.resolve=t_,this.reject=t_,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,d)=>{this.resolve=c,this.reject=d})}runInitializers(){if(this.initialized)return;const u=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const f=this.appInits[d]();if(ru(f))u.push(f);else if(dr(f)){const y=new Promise((E,C)=>{f.subscribe({complete:E,error:C})});u.push(y)}}Promise.all(u).then(()=>{c()}).catch(d=>{this.reject(d)}),0===u.length&&c(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)(R(Cb,8))},s.\u0275prov=tn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const Tb=new Un("AppId",{providedIn:"root",factory:function n_(){return`${wp()}${wp()}${wp()}`}});function wp(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const r_=new Un("Platform Initializer"),m0=new Un("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Oc=new Un("appBootstrapListener");let _0=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=tn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const wl=new Un("LocaleId",{providedIn:"root",factory:()=>X(wl,wt.Optional|wt.SkipSelf)||function Ih(){return"undefined"!=typeof $localize&&$localize.locale||hr}()}),Db=new Un("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class y0{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let v0=(()=>{class s{compileModuleSync(u){return new _l(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const c=this.compileModuleSync(u),f=Mo(it(u).declarations).reduce((y,E)=>{const C=et(E);return C&&y.push(new rp(C)),y},[]);return new y0(c,f)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=tn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const RS=(()=>Promise.resolve(0))();function E0(s){"undefined"==typeof Zone?RS.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class Fs{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ln(!1),this.onMicrotaskEmpty=new Ln(!1),this.onStable=new Ln(!1),this.onError=new Ln(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&u,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function I0(){let s=Zt.requestAnimationFrame,o=Zt.cancelAnimationFrame;if("undefined"!=typeof Zone&&s&&o){const u=s[Zone.__symbol__("OriginalDelegate")];u&&(s=u);const c=o[Zone.__symbol__("OriginalDelegate")];c&&(o=c)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function Ab(s){const o=()=>{!function kS(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(Zt,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,s_(s),s.isCheckStableRunning=!0,i_(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),s_(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,c,d,f,y,E)=>{try{return b0(s),u.invokeTask(d,f,y,E)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||s.shouldCoalesceRunChangeDetection)&&o(),C0(s)}},onInvoke:(u,c,d,f,y,E,C)=>{try{return b0(s),u.invoke(d,f,y,E,C)}finally{s.shouldCoalesceRunChangeDetection&&o(),C0(s)}},onHasTask:(u,c,d,f)=>{u.hasTask(d,f),c===d&&("microTask"==f.change?(s._hasPendingMicrotasks=f.microTask,s_(s),i_(s)):"macroTask"==f.change&&(s.hasPendingMacrotasks=f.macroTask))},onHandleError:(u,c,d,f)=>(u.handleError(d,f),s.runOutsideAngular(()=>s.onError.emit(f)),!1)})}(d)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Fs.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Fs.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(o,u,c){return this._inner.run(o,u,c)}runTask(o,u,c,d){const f=this._inner,y=f.scheduleEventTask("NgZoneEvent: "+d,o,MS,t_,t_);try{return f.runTask(y,u,c)}finally{f.cancelTask(y)}}runGuarded(o,u,c){return this._inner.runGuarded(o,u,c)}runOutsideAngular(o){return this._outer.run(o)}}const MS={};function i_(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function s_(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function b0(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function C0(s){s._nesting--,i_(s)}class NS{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ln,this.onMicrotaskEmpty=new Ln,this.onStable=new Ln,this.onError=new Ln}run(o,u,c){return o.apply(u,c)}runGuarded(o,u,c){return o.apply(u,c)}runOutsideAngular(o){return o()}runTask(o,u,c,d){return o.apply(u,c)}}let xb=(()=>{class s{constructor(u){this._ngZone=u,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Fs.assertNotInAngularZone(),E0(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())E0(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(u)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,c,d){let f=-1;c&&c>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(y=>y.timeoutId!==f),u(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:u,timeoutId:f,updateCb:d})}whenStable(u,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(u,c,d){return[]}}return s.\u0275fac=function(u){return new(u||s)(R(Fs))},s.\u0275prov=tn({token:s,factory:s.\u0275fac}),s})(),PS=(()=>{class s{constructor(){this._applications=new Map,Ip.addToWindow(this)}registerApplication(u,c){this._applications.set(u,c)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,c=!0){return Ip.findTestabilityInTree(this,u,c)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=tn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();class OS{addToWindow(o){}findTestabilityInTree(o,u,c){return null}}function T0(s){Ip=s}let Ip=new OS,fu=null;const Rb=new Un("AllowMultipleToken"),o_=new Un("PlatformOnDestroy");class D0{constructor(o,u){this.name=o,this.token=u}}function Pb(s,o,u=[]){const c=`Platform: ${o}`,d=new Un(c);return(f=[])=>{let y=A0();if(!y||y.injector.get(Rb,!1)){const E=[...u,...f,{provide:d,useValue:!0}];s?s(E):function Nb(s){if(fu&&!fu.get(Rb,!1))throw new Ve(400,"");fu=s;const o=s.get(a_),u=s.get(r_,null);u&&u.forEach(c=>c())}(function FS(s=[],o){return uo.create({name:o,providers:[{provide:rc,useValue:"platform"},{provide:o_,useValue:()=>fu=null},...s]})}(E,c))}return function S0(s){const o=A0();if(!o)throw new Ve(401,"");return o}()}}function A0(){var s;return null!==(s=null==fu?void 0:fu.get(a_))&&void 0!==s?s:null}let a_=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,c){const E=function US(s,o){let u;return u="noop"===s?new NS:("zone.js"===s?void 0:s)||new Fs({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==o?void 0:o.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==o?void 0:o.ngZoneRunCoalescing)}),u}(c?c.ngZone:void 0,{ngZoneEventCoalescing:c&&c.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:c&&c.ngZoneRunCoalescing||!1}),C=[{provide:Fs,useValue:E}];return E.run(()=>{const A=uo.create({providers:C,parent:this.injector,name:u.moduleType.name}),M=u.create(A),V=M.injector.get(Eg,null);if(!V)throw new Ve(402,"");return E.runOutsideAngular(()=>{const Z=E.onError.subscribe({next:ee=>{V.handleError(ee)}});M.onDestroy(()=>{El(this._modules,M),Z.unsubscribe()})}),function x0(s,o,u){try{const c=u();return ru(c)?c.catch(d=>{throw o.runOutsideAngular(()=>s.handleError(d)),d}):c}catch(c){throw o.runOutsideAngular(()=>s.handleError(c)),c}}(V,E,()=>{const Z=M.injector.get(vp);return Z.runInitializers(),Z.donePromise.then(()=>(function SI(s){Ft(s,"Expected localeId to be defined"),"string"==typeof s&&(Qi=s.toLowerCase().replace(/_/g,"-"))}(M.injector.get(wl,hr)||hr),this._moduleDoBootstrap(M),M))})})}bootstrapModule(u,c=[]){const d=u_({},c);return function LS(s,o,u){const c=new _l(u);return Promise.resolve(c)}(0,0,u).then(f=>this.bootstrapModuleFactory(f,d))}_moduleDoBootstrap(u){const c=u.injector.get(bp);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!u.instance.ngDoBootstrap)throw new Ve(403,"");u.instance.ngDoBootstrap(c)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ve(404,"");this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const u=this._injector.get(o_,null);null==u||u(),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)(R(uo))},s.\u0275prov=tn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function u_(s,o){return Array.isArray(o)?o.reduce(u_,s):Object.assign(Object.assign({},s),o)}let bp=(()=>{class s{constructor(u,c,d,f){this._zone=u,this._injector=c,this._exceptionHandler=d,this._initStatus=f,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const y=new P.y(C=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{C.next(this._stable),C.complete()})}),E=new P.y(C=>{let A;this._zone.runOutsideAngular(()=>{A=this._zone.onStable.subscribe(()=>{Fs.assertNotInAngularZone(),E0(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,C.next(!0))})})});const M=this._zone.onUnstable.subscribe(()=>{Fs.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{C.next(!1)}))});return()=>{A.unsubscribe(),M.unsubscribe()}});this.isStable=(0,oe.T)(y,E.pipe((0,ce.B)()))}bootstrap(u,c){if(!this._initStatus.done)throw new Ve(405,"");let d;d=u instanceof pl?u:this._injector.get(fh).resolveComponentFactory(u),this.componentTypes.push(d.componentType);const f=function kb(s){return s.isBoundToModule}(d)?void 0:this._injector.get(lu),E=d.create(uo.NULL,[],c||d.selector,f),C=E.location.nativeElement,A=E.injector.get(xb,null),M=A&&E.injector.get(PS);return A&&M&&M.registerApplication(C,A),E.onDestroy(()=>{this.detachView(E.hostView),El(this.components,E),M&&M.unregisterApplication(C)}),this._loadComponent(E),E}tick(){if(this._runningTick)throw new Ve(101,"");try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const c=u;this._views.push(c),c.attachToAppRef(this)}detachView(u){const c=u;El(this._views,c),c.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u),this._injector.get(Oc,[]).concat(this._bootstrapListeners).forEach(d=>d(u))}ngOnDestroy(){this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return s.\u0275fac=function(u){return new(u||s)(R(Fs),R(uo),R(Eg),R(vp))},s.\u0275prov=tn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function El(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}let Lb=!0,l_=!1;function pu(){return l_=!0,Lb}function k0(){if(l_)throw new Error("Cannot enable prod mode after platform setup.");Lb=!1}let VS=(()=>{class s{}return s.__NG_ELEMENT_ID__=N0,s})();function N0(s){return function BS(s,o,u){if(Iu(s)&&!u){const c=Er(s.index,o);return new uu(c,c)}return 47&s.type?new uu(o[16],o):null}(Sn(),Ne(),16==(16&s))}class L0{constructor(){}supports(o){return il(o)}create(o){return new d_(o)}}const Kb=(s,o)=>o;class d_{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||Kb}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,c=this._removalsHead,d=0,f=null;for(;u||c;){const y=!c||u&&u.currentIndex<U0(c,d,f)?u:c,E=U0(y,d,f),C=y.currentIndex;if(y===c)d--,c=c._nextRemoved;else if(u=u._next,null==y.previousIndex)d++;else{f||(f=[]);const A=E-d,M=C-d;if(A!=M){for(let Z=0;Z<A;Z++){const ee=Z<f.length?f[Z]:f[Z]=0,Ie=ee+Z;M<=Ie&&Ie<A&&(f[Z]=ee+1)}f[y.previousIndex]=M-A}}E!==C&&o(y,E,C)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!il(o))throw new Ve(900,"");return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let d,f,y,u=this._itHead,c=!1;if(Array.isArray(o)){this.length=o.length;for(let E=0;E<this.length;E++)f=o[E],y=this._trackByFn(E,f),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,f,y,E)),Object.is(u.item,f)||this._addIdentityChange(u,f)):(u=this._mismatch(u,f,y,E),c=!0),u=u._next}else d=0,function eI(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[rl()]();let c;for(;!(c=u.next()).done;)o(c.value)}}(o,E=>{y=this._trackByFn(d,E),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,E,y,d)),Object.is(u.item,E)||this._addIdentityChange(u,E)):(u=this._mismatch(u,E,y,d),c=!0),u=u._next,d++}),this.length=d;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,c,d){let f;return null===o?f=this._itTail:(f=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,f,d)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,f,d)):o=this._addAfter(new rn(u,c),f,d),o}_verifyReinsertion(o,u,c,d){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==f?o=this._reinsertAfter(f,o._prev,d):o.currentIndex!=d&&(o.currentIndex=d,this._addToMoves(o,d)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const d=o._prevRemoved,f=o._nextRemoved;return null===d?this._removalsHead=f:d._nextRemoved=f,null===f?this._removalsTail=d:f._prevRemoved=d,this._insertAfter(o,u,c),this._addToMoves(o,c),o}_moveAfter(o,u,c){return this._unlink(o),this._insertAfter(o,u,c),this._addToMoves(o,c),o}_addAfter(o,u,c){return this._insertAfter(o,u,c),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,c){const d=null===u?this._itHead:u._next;return o._next=d,o._prev=u,null===d?this._itTail=o:d._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new F0),this._linkedRecords.put(o),o.currentIndex=c,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,c=o._next;return null===u?this._itHead=c:u._next=c,null===c?this._itTail=u:c._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new F0),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class rn{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Zb{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===u||u<=c.currentIndex)&&Object.is(c.trackById,o))return c;return null}remove(o){const u=o._prevDup,c=o._nextDup;return null===u?this._head=c:u._nextDup=c,null===c?this._tail=u:c._prevDup=u,null===this._head}}class F0{constructor(){this.map=new Map}put(o){const u=o.trackById;let c=this.map.get(u);c||(c=new Zb,this.map.set(u,c)),c.add(o)}get(o,u){const d=this.map.get(o);return d?d.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function U0(s,o,u){const c=s.previousIndex;if(null===c)return c;let d=0;return u&&c<u.length&&(d=u[c]),c+o+d}class Ch{constructor(){}supports(o){return o instanceof Map||eu(o)}create(){return new Yb}}class Yb{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||eu(o)))throw new Ve(900,"")}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(c,d)=>{if(u&&u.key===d)this._maybeAddToChanges(u,c),this._appendAfter=u,u=u._next;else{const f=this._getOrCreateRecordForKey(d,c);u=this._insertBeforeOrAppend(u,f)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let c=u;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const c=o._prev;return u._next=o,u._prev=c,o._prev=u,c&&(c._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const d=this._records.get(o);this._maybeAddToChanges(d,u);const f=d._prev,y=d._next;return f&&(f._next=y),y&&(y._prev=f),d._next=null,d._prev=null,d}const c=new Yn(o);return this._records.set(o,c),c.currentValue=u,this._addToAdditions(c),c}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(c=>u(o[c],c))}}class Yn{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Ii(){return new co([new L0])}let co=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(null!=c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||Ii()),deps:[[s,new tr,new dt]]}}find(u){const c=this.factories.find(d=>d.supports(u));if(null!=c)return c;throw new Ve(901,"")}}return s.\u0275prov=tn({token:s,providedIn:"root",factory:Ii}),s})();function Qb(){return new Th([new Ch])}let Th=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||Qb()),deps:[[s,new tr,new dt]]}}find(u){const c=this.factories.find(f=>f.supports(u));if(c)return c;throw new Ve(901,"")}}return s.\u0275prov=tn({token:s,providedIn:"root",factory:Qb}),s})();const WS=Pb(null,"core",[]);let xR=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)(R(bp))},s.\u0275mod=$({type:s}),s.\u0275inj=Yt({}),s})()},3942:(nt,Ce,F)=>{F.d(Ce,{Z:()=>Ve});var _=F(2090),G=F(4859),P=F(9681),oe=F(1877);class ce{constructor(_e,De){this._delegate=_e,this.firebase=De,(0,P._addComponent)(_e,new G.wA("app-compat",()=>this,"PUBLIC")),this.container=_e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(_e){this._delegate.automaticDataCollectionEnabled=_e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(_e=>{this._delegate.checkDestroyed(),_e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,P.deleteApp)(this._delegate)))}_getService(_e,De=P._DEFAULT_ENTRY_NAME){var qe;this._delegate.checkDestroyed();const Ge=this._delegate.container.getProvider(_e);return!Ge.isInitialized()&&"EXPLICIT"===(null===(qe=Ge.getComponent())||void 0===qe?void 0:qe.instantiationMode)&&Ge.initialize(),Ge.getImmediate({identifier:De})}_removeServiceInstance(_e,De=P._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(_e).clearInstance(De)}_addComponent(_e){(0,P._addComponent)(this._delegate,_e)}_addOrOverwriteComponent(_e){(0,P._addOrOverwriteComponent)(this._delegate,_e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const ge=new _.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),z=function ve(){const He=function le(He){const _e={},De={__esModule:!0,initializeApp:function Pe(ne,pe={}){const Ee=P.initializeApp(ne,pe);if((0,_.r3)(_e,Ee.name))return _e[Ee.name];const Q=new He(Ee,De);return _e[Ee.name]=Q,Q},app:Ge,registerVersion:P.registerVersion,setLogLevel:P.setLogLevel,onLog:P.onLog,apps:null,SDK_VERSION:P.SDK_VERSION,INTERNAL:{registerComponent:function Te(ne){const pe=ne.name,Ee=pe.replace("-compat","");if(P._registerComponent(ne)&&"PUBLIC"===ne.type){const Q=(te=Ge())=>{if("function"!=typeof te[Ee])throw ge.create("invalid-app-argument",{appName:pe});return te[Ee]()};void 0!==ne.serviceProps&&(0,_.ZB)(Q,ne.serviceProps),De[Ee]=Q,He.prototype[Ee]=function(...te){return this._getService.bind(this,pe).apply(this,ne.multipleInstances?te:[])}}return"PUBLIC"===ne.type?De[Ee]:null},removeApp:function qe(ne){delete _e[ne]},useAsService:function We(ne,pe){return"serverAuth"===pe?null:pe},modularAPIs:P}};function Ge(ne){if(!(0,_.r3)(_e,ne=ne||P._DEFAULT_ENTRY_NAME))throw ge.create("no-app",{appName:ne});return _e[ne]}return De.default=De,Object.defineProperty(De,"apps",{get:function Ae(){return Object.keys(_e).map(ne=>_e[ne])}}),Ge.App=He,De}(ce);return He.INTERNAL=Object.assign(Object.assign({},He.INTERNAL),{createFirebaseNamespace:ve,extendNamespace:function _e(De){(0,_.ZB)(He,De)},createSubscribe:_.ne,ErrorFactory:_.LL,deepExtend:_.ZB}),He}(),q=new oe.Yd("@firebase/app-compat");if((0,_.jU)()&&void 0!==self.firebase){q.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const He=self.firebase.SDK_VERSION;He&&He.indexOf("LITE")>=0&&q.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Ve=z;!function Re(He){(0,P.registerVersion)("@firebase/app-compat","0.1.39",He)}()},9681:(nt,Ce,F)=>{F.r(Ce),F.d(Ce,{FirebaseError:()=>oe.ZR,SDK_VERSION:()=>bi,_DEFAULT_ENTRY_NAME:()=>Ft,_addComponent:()=>cn,_addOrOverwriteComponent:()=>tn,_apps:()=>ln,_clearComponents:()=>Qr,_components:()=>Tn,_getProvider:()=>Yt,_registerComponent:()=>$t,_removeServiceInstance:()=>Nn,deleteApp:()=>wt,getApp:()=>Hn,getApps:()=>rs,initializeApp:()=>Ci,onLog:()=>dn,registerVersion:()=>wn,setLogLevel:()=>Nr});var _=F(5861),G=F(4859),P=F(1877),oe=F(2090),ce=F(8766);class ye{constructor(Se){this.container=Se}getPlatformInfoString(){return this.container.getProviders().map(Ke=>{if(function ge(Xe){const Se=Xe.getComponent();return"VERSION"===(null==Se?void 0:Se.type)}(Ke)){const It=Ke.getImmediate();return`${It.library}/${It.version}`}return null}).filter(Ke=>Ke).join(" ")}}const le="@firebase/app",z=new P.Yd("@firebase/app"),Ft="[DEFAULT]",Ze={[le]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ln=new Map,Tn=new Map;function cn(Xe,Se){try{Xe.container.addComponent(Se)}catch(Ke){z.debug(`Component ${Se.name} failed to register with FirebaseApp ${Xe.name}`,Ke)}}function tn(Xe,Se){Xe.container.addOrOverwriteComponent(Se)}function $t(Xe){const Se=Xe.name;if(Tn.has(Se))return z.debug(`There were multiple attempts to register component ${Se}.`),!1;Tn.set(Se,Xe);for(const Ke of ln.values())cn(Ke,Xe);return!0}function Yt(Xe,Se){const Ke=Xe.container.getProvider("heartbeat").getImmediate({optional:!0});return Ke&&Ke.triggerHeartbeat(),Xe.container.getProvider(Se)}function Nn(Xe,Se,Ke=Ft){Yt(Xe,Se).clearInstance(Ke)}function Qr(){Tn.clear()}const Fn=new oe.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ns{constructor(Se,Ke,It){this._isDeleted=!1,this._options=Object.assign({},Se),this._config=Object.assign({},Ke),this._name=Ke.name,this._automaticDataCollectionEnabled=Ke.automaticDataCollectionEnabled,this._container=It,this.container.addComponent(new G.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Se){this.checkDestroyed(),this._automaticDataCollectionEnabled=Se}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Se){this._isDeleted=Se}checkDestroyed(){if(this.isDeleted)throw Fn.create("app-deleted",{appName:this._name})}}const bi="9.14.0";function Ci(Xe,Se={}){let Ke=Xe;"object"!=typeof Se&&(Se={name:Se});const It=Object.assign({name:Ft,automaticDataCollectionEnabled:!1},Se),Et=It.name;if("string"!=typeof Et||!Et)throw Fn.create("bad-app-name",{appName:String(Et)});if(Ke||(Ke=(0,oe.aH)()),!Ke)throw Fn.create("no-options");const nn=ln.get(Et);if(nn){if((0,oe.vZ)(Ke,nn.options)&&(0,oe.vZ)(It,nn.config))return nn;throw Fn.create("duplicate-app",{appName:Et})}const W=new G.H0(Et);for(const Y of Tn.values())W.addComponent(Y);const H=new ns(Ke,It,W);return ln.set(Et,H),H}function Hn(Xe=Ft){const Se=ln.get(Xe);if(!Se&&Xe===Ft)return Ci();if(!Se)throw Fn.create("no-app",{appName:Xe});return Se}function rs(){return Array.from(ln.values())}function wt(Xe){return kr.apply(this,arguments)}function kr(){return(kr=(0,_.Z)(function*(Xe){const Se=Xe.name;ln.has(Se)&&(ln.delete(Se),yield Promise.all(Xe.container.getProviders().map(Ke=>Ke.delete())),Xe.isDeleted=!0)})).apply(this,arguments)}function wn(Xe,Se,Ke){var It;let Et=null!==(It=Ze[Xe])&&void 0!==It?It:Xe;Ke&&(Et+=`-${Ke}`);const nn=Et.match(/\s|\//),W=Se.match(/\s|\//);if(nn||W){const H=[`Unable to register library "${Et}" with version "${Se}":`];return nn&&H.push(`library name "${Et}" contains illegal characters (whitespace or "/")`),nn&&W&&H.push("and"),W&&H.push(`version name "${Se}" contains illegal characters (whitespace or "/")`),void z.warn(H.join(" "))}$t(new G.wA(`${Et}-version`,()=>({library:Et,version:Se}),"VERSION"))}function dn(Xe,Se){if(null!==Xe&&"function"!=typeof Xe)throw Fn.create("invalid-log-argument");(0,P.Am)(Xe,Se)}function Nr(Xe){(0,P.Ub)(Xe)}const Dn="firebase-heartbeat-store";let pr=null;function vs(){return pr||(pr=(0,ce.X3)("firebase-heartbeat-database",1,{upgrade:(Xe,Se)=>{0===Se&&Xe.createObjectStore(Dn)}}).catch(Xe=>{throw Fn.create("idb-open",{originalErrorMessage:Xe.message})})),pr}function gt(){return(gt=(0,_.Z)(function*(Xe){var Se;try{return(yield vs()).transaction(Dn).objectStore(Dn).get(jr(Xe))}catch(Ke){if(Ke instanceof oe.ZR)z.warn(Ke.message);else{const It=Fn.create("idb-get",{originalErrorMessage:null===(Se=Ke)||void 0===Se?void 0:Se.message});z.warn(It.message)}}})).apply(this,arguments)}function rt(Xe,Se){return Ti.apply(this,arguments)}function Ti(){return(Ti=(0,_.Z)(function*(Xe,Se){var Ke;try{const Et=(yield vs()).transaction(Dn,"readwrite");return yield Et.objectStore(Dn).put(Se,jr(Xe)),Et.done}catch(It){if(It instanceof oe.ZR)z.warn(It.message);else{const Et=Fn.create("idb-set",{originalErrorMessage:null===(Ke=It)||void 0===Ke?void 0:Ke.message});z.warn(Et.message)}}})).apply(this,arguments)}function jr(Xe){return`${Xe.name}!${Xe.options.appId}`}class Gn{constructor(Se){this.container=Se,this._heartbeatsCache=null;const Ke=this.container.getProvider("app").getImmediate();this._storage=new ui(Ke),this._heartbeatsCachePromise=this._storage.read().then(It=>(this._heartbeatsCache=It,It))}triggerHeartbeat(){var Se=this;return(0,_.Z)(function*(){const It=Se.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Et=pn();if(null===Se._heartbeatsCache&&(Se._heartbeatsCache=yield Se._heartbeatsCachePromise),Se._heartbeatsCache.lastSentHeartbeatDate!==Et&&!Se._heartbeatsCache.heartbeats.some(nn=>nn.date===Et))return Se._heartbeatsCache.heartbeats.push({date:Et,agent:It}),Se._heartbeatsCache.heartbeats=Se._heartbeatsCache.heartbeats.filter(nn=>{const W=new Date(nn.date).valueOf();return Date.now()-W<=2592e6}),Se._storage.overwrite(Se._heartbeatsCache)})()}getHeartbeatsHeader(){var Se=this;return(0,_.Z)(function*(){if(null===Se._heartbeatsCache&&(yield Se._heartbeatsCachePromise),null===Se._heartbeatsCache||0===Se._heartbeatsCache.heartbeats.length)return"";const Ke=pn(),{heartbeatsToSend:It,unsentEntries:Et}=function _t(Xe,Se=1024){const Ke=[];let It=Xe.slice();for(const Et of Xe){const nn=Ke.find(W=>W.agent===Et.agent);if(nn){if(nn.dates.push(Et.date),Gt(Ke)>Se){nn.dates.pop();break}}else if(Ke.push({agent:Et.agent,dates:[Et.date]}),Gt(Ke)>Se){Ke.pop();break}It=It.slice(1)}return{heartbeatsToSend:Ke,unsentEntries:It}}(Se._heartbeatsCache.heartbeats),nn=(0,oe.L)(JSON.stringify({version:2,heartbeats:It}));return Se._heartbeatsCache.lastSentHeartbeatDate=Ke,Et.length>0?(Se._heartbeatsCache.heartbeats=Et,yield Se._storage.overwrite(Se._heartbeatsCache)):(Se._heartbeatsCache.heartbeats=[],Se._storage.overwrite(Se._heartbeatsCache)),nn})()}}function pn(){return(new Date).toISOString().substring(0,10)}class ui{constructor(Se){this.app=Se,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,_.Z)(function*(){return!!(0,oe.hl)()&&(0,oe.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Se=this;return(0,_.Z)(function*(){return(yield Se._canUseIndexedDBPromise)&&(yield function Kt(Xe){return gt.apply(this,arguments)}(Se.app))||{heartbeats:[]}})()}overwrite(Se){var Ke=this;return(0,_.Z)(function*(){var It;if(yield Ke._canUseIndexedDBPromise){const nn=yield Ke.read();return rt(Ke.app,{lastSentHeartbeatDate:null!==(It=Se.lastSentHeartbeatDate)&&void 0!==It?It:nn.lastSentHeartbeatDate,heartbeats:Se.heartbeats})}})()}add(Se){var Ke=this;return(0,_.Z)(function*(){var It;if(yield Ke._canUseIndexedDBPromise){const nn=yield Ke.read();return rt(Ke.app,{lastSentHeartbeatDate:null!==(It=Se.lastSentHeartbeatDate)&&void 0!==It?It:nn.lastSentHeartbeatDate,heartbeats:[...nn.heartbeats,...Se.heartbeats]})}})()}}function Gt(Xe){return(0,oe.L)(JSON.stringify({version:2,heartbeats:Xe})).length}!function ar(Xe){$t(new G.wA("platform-logger",Se=>new ye(Se),"PRIVATE")),$t(new G.wA("heartbeat",Se=>new Gn(Se),"PRIVATE")),wn(le,"0.8.4",Xe),wn(le,"0.8.4","esm2017"),wn("fire-js","")}("")},4859:(nt,Ce,F)=>{F.d(Ce,{H0:()=>le,wA:()=>P,zt:()=>ce});var _=F(5861),G=F(2090);class P{constructor(z,q,re){this.name=z,this.instanceFactory=q,this.type=re,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(z){return this.instantiationMode=z,this}setMultipleInstances(z){return this.multipleInstances=z,this}setServiceProps(z){return this.serviceProps=z,this}setInstanceCreatedCallback(z){return this.onInstanceCreated=z,this}}const oe="[DEFAULT]";class ce{constructor(z,q){this.name=z,this.container=q,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(z){const q=this.normalizeInstanceIdentifier(z);if(!this.instancesDeferred.has(q)){const re=new G.BH;if(this.instancesDeferred.set(q,re),this.isInitialized(q)||this.shouldAutoInitialize())try{const je=this.getOrInitializeService({instanceIdentifier:q});je&&re.resolve(je)}catch(je){}}return this.instancesDeferred.get(q).promise}getImmediate(z){var q;const re=this.normalizeInstanceIdentifier(null==z?void 0:z.identifier),je=null!==(q=null==z?void 0:z.optional)&&void 0!==q&&q;if(!this.isInitialized(re)&&!this.shouldAutoInitialize()){if(je)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:re})}catch(Re){if(je)return null;throw Re}}getComponent(){return this.component}setComponent(z){if(z.name!==this.name)throw Error(`Mismatching Component ${z.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=z,this.shouldAutoInitialize()){if(function ge(ve){return"EAGER"===ve.instantiationMode}(z))try{this.getOrInitializeService({instanceIdentifier:oe})}catch(q){}for(const[q,re]of this.instancesDeferred.entries()){const je=this.normalizeInstanceIdentifier(q);try{const Re=this.getOrInitializeService({instanceIdentifier:je});re.resolve(Re)}catch(Re){}}}}clearInstance(z=oe){this.instancesDeferred.delete(z),this.instancesOptions.delete(z),this.instances.delete(z)}delete(){var z=this;return(0,_.Z)(function*(){const q=Array.from(z.instances.values());yield Promise.all([...q.filter(re=>"INTERNAL"in re).map(re=>re.INTERNAL.delete()),...q.filter(re=>"_delete"in re).map(re=>re._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(z=oe){return this.instances.has(z)}getOptions(z=oe){return this.instancesOptions.get(z)||{}}initialize(z={}){const{options:q={}}=z,re=this.normalizeInstanceIdentifier(z.instanceIdentifier);if(this.isInitialized(re))throw Error(`${this.name}(${re}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const je=this.getOrInitializeService({instanceIdentifier:re,options:q});for(const[Re,Ve]of this.instancesDeferred.entries())re===this.normalizeInstanceIdentifier(Re)&&Ve.resolve(je);return je}onInit(z,q){var re;const je=this.normalizeInstanceIdentifier(q),Re=null!==(re=this.onInitCallbacks.get(je))&&void 0!==re?re:new Set;Re.add(z),this.onInitCallbacks.set(je,Re);const Ve=this.instances.get(je);return Ve&&z(Ve,je),()=>{Re.delete(z)}}invokeOnInitCallbacks(z,q){const re=this.onInitCallbacks.get(q);if(re)for(const je of re)try{je(z,q)}catch(Re){}}getOrInitializeService({instanceIdentifier:z,options:q={}}){let re=this.instances.get(z);if(!re&&this.component&&(re=this.component.instanceFactory(this.container,{instanceIdentifier:(ve=z,ve===oe?void 0:ve),options:q}),this.instances.set(z,re),this.instancesOptions.set(z,q),this.invokeOnInitCallbacks(re,z),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,z,re)}catch(je){}var ve;return re||null}normalizeInstanceIdentifier(z=oe){return this.component?this.component.multipleInstances?z:oe:z}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class le{constructor(z){this.name=z,this.providers=new Map}addComponent(z){const q=this.getProvider(z.name);if(q.isComponentSet())throw new Error(`Component ${z.name} has already been registered with ${this.name}`);q.setComponent(z)}addOrOverwriteComponent(z){this.getProvider(z.name).isComponentSet()&&this.providers.delete(z.name),this.addComponent(z)}getProvider(z){if(this.providers.has(z))return this.providers.get(z);const q=new ce(z,this);return this.providers.set(z,q),q}getProviders(){return Array.from(this.providers.values())}}},1877:(nt,Ce,F)=>{F.d(Ce,{Am:()=>ve,Ub:()=>le,Yd:()=>ge,in:()=>G});const _=[];var G=(()=>{return(z=G||(G={}))[z.DEBUG=0]="DEBUG",z[z.VERBOSE=1]="VERBOSE",z[z.INFO=2]="INFO",z[z.WARN=3]="WARN",z[z.ERROR=4]="ERROR",z[z.SILENT=5]="SILENT",G;var z})();const P={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},oe=G.INFO,ce={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},ye=(z,q,...re)=>{if(q<z.logLevel)return;const je=(new Date).toISOString(),Re=ce[q];if(!Re)throw new Error(`Attempted to log a message with an invalid logType (value: ${q})`);console[Re](`[${je}]  ${z.name}:`,...re)};class ge{constructor(q){this.name=q,this._logLevel=oe,this._logHandler=ye,this._userLogHandler=null,_.push(this)}get logLevel(){return this._logLevel}set logLevel(q){if(!(q in G))throw new TypeError(`Invalid value "${q}" assigned to \`logLevel\``);this._logLevel=q}setLogLevel(q){this._logLevel="string"==typeof q?P[q]:q}get logHandler(){return this._logHandler}set logHandler(q){if("function"!=typeof q)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=q}get userLogHandler(){return this._userLogHandler}set userLogHandler(q){this._userLogHandler=q}debug(...q){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...q),this._logHandler(this,G.DEBUG,...q)}log(...q){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...q),this._logHandler(this,G.VERBOSE,...q)}info(...q){this._userLogHandler&&this._userLogHandler(this,G.INFO,...q),this._logHandler(this,G.INFO,...q)}warn(...q){this._userLogHandler&&this._userLogHandler(this,G.WARN,...q),this._logHandler(this,G.WARN,...q)}error(...q){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...q),this._logHandler(this,G.ERROR,...q)}}function le(z){_.forEach(q=>{q.setLogLevel(z)})}function ve(z,q){for(const re of _){let je=null;q&&q.level&&(je=P[q.level]),re.userLogHandler=null===z?null:(Re,Ve,...He)=>{const _e=He.map(De=>{if(null==De)return null;if("string"==typeof De)return De;if("number"==typeof De||"boolean"==typeof De)return De.toString();if(De instanceof Error)return De.message;try{return JSON.stringify(De)}catch(qe){return null}}).filter(De=>De).join(" ");Ve>=(null!=je?je:Re.logLevel)&&z({level:G[Ve].toLowerCase(),message:_e,args:He,type:Re.name})}}}},8766:(nt,Ce,F)=>{F.d(Ce,{Lj:()=>Pe,X3:()=>Ge});var _=F(5861);let P,oe;const ge=new WeakMap,le=new WeakMap,ve=new WeakMap,z=new WeakMap,q=new WeakMap;let Re={get(pe,Ee,Q){if(pe instanceof IDBTransaction){if("done"===Ee)return le.get(pe);if("objectStoreNames"===Ee)return pe.objectStoreNames||ve.get(pe);if("store"===Ee)return Q.objectStoreNames[1]?void 0:Q.objectStore(Q.objectStoreNames[0])}return De(pe[Ee])},set:(pe,Ee,Q)=>(pe[Ee]=Q,!0),has:(pe,Ee)=>pe instanceof IDBTransaction&&("done"===Ee||"store"===Ee)||Ee in pe};function _e(pe){return"function"==typeof pe?function He(pe){return pe!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ye(){return oe||(oe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(pe)?function(...Ee){return pe.apply(qe(this),Ee),De(ge.get(this))}:function(...Ee){return De(pe.apply(qe(this),Ee))}:function(Ee,...Q){const te=pe.call(qe(this),Ee,...Q);return ve.set(te,Ee.sort?Ee.sort():[Ee]),De(te)}}(pe):(pe instanceof IDBTransaction&&function je(pe){if(le.has(pe))return;const Ee=new Promise((Q,te)=>{const ie=()=>{pe.removeEventListener("complete",we),pe.removeEventListener("error",de),pe.removeEventListener("abort",de)},we=()=>{Q(),ie()},de=()=>{te(pe.error||new DOMException("AbortError","AbortError")),ie()};pe.addEventListener("complete",we),pe.addEventListener("error",de),pe.addEventListener("abort",de)});le.set(pe,Ee)}(pe),((pe,Ee)=>Ee.some(Q=>pe instanceof Q))(pe,function ce(){return P||(P=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(pe,Re):pe)}function De(pe){if(pe instanceof IDBRequest)return function re(pe){const Ee=new Promise((Q,te)=>{const ie=()=>{pe.removeEventListener("success",we),pe.removeEventListener("error",de)},we=()=>{Q(De(pe.result)),ie()},de=()=>{te(pe.error),ie()};pe.addEventListener("success",we),pe.addEventListener("error",de)});return Ee.then(Q=>{Q instanceof IDBCursor&&ge.set(Q,pe)}).catch(()=>{}),q.set(Ee,pe),Ee}(pe);if(z.has(pe))return z.get(pe);const Ee=_e(pe);return Ee!==pe&&(z.set(pe,Ee),q.set(Ee,pe)),Ee}const qe=pe=>q.get(pe);function Ge(pe,Ee,{blocked:Q,upgrade:te,blocking:ie,terminated:we}={}){const de=indexedDB.open(pe,Ee),Fe=De(de);return te&&de.addEventListener("upgradeneeded",pt=>{te(De(de.result),pt.oldVersion,pt.newVersion,De(de.transaction))}),Q&&de.addEventListener("blocked",()=>Q()),Fe.then(pt=>{we&&pt.addEventListener("close",()=>we()),ie&&pt.addEventListener("versionchange",()=>ie())}).catch(()=>{}),Fe}function Pe(pe,{blocked:Ee}={}){const Q=indexedDB.deleteDatabase(pe);return Ee&&Q.addEventListener("blocked",()=>Ee()),De(Q).then(()=>{})}const Ae=["get","getKey","getAll","getAllKeys","count"],Te=["put","add","delete","clear"],We=new Map;function ne(pe,Ee){if(!(pe instanceof IDBDatabase)||Ee in pe||"string"!=typeof Ee)return;if(We.get(Ee))return We.get(Ee);const Q=Ee.replace(/FromIndex$/,""),te=Ee!==Q,ie=Te.includes(Q);if(!(Q in(te?IDBIndex:IDBObjectStore).prototype)||!ie&&!Ae.includes(Q))return;const we=function(){var de=(0,_.Z)(function*(Fe,...pt){const en=this.transaction(Fe,ie?"readwrite":"readonly");let Ft=en.store;return te&&(Ft=Ft.index(pt.shift())),(yield Promise.all([Ft[Q](...pt),ie&&en.done]))[0]});return function(pt){return de.apply(this,arguments)}}();return We.set(Ee,we),we}!function Ve(pe){Re=pe(Re)}(pe=>nO(tO({},pe),{get:(Ee,Q,te)=>ne(Ee,Q)||pe.get(Ee,Q,te),has:(Ee,Q)=>!!ne(Ee,Q)||pe.has(Ee,Q)}))},5861:(nt,Ce,F)=>{function _(P,oe,ce,ye,ge,le,ve){try{var z=P[le](ve),q=z.value}catch(re){return void ce(re)}z.done?oe(q):Promise.resolve(q).then(ye,ge)}function G(P){return function(){var oe=this,ce=arguments;return new Promise(function(ye,ge){var le=P.apply(oe,ce);function ve(q){_(le,ye,ge,ve,z,"next",q)}function z(q){_(le,ye,ge,ve,z,"throw",q)}ve(void 0)})}}F.d(Ce,{Z:()=>G})}},nt=>{nt(nt.s=1081)}]);